(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();function om(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nu={exports:{}},Wi={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pg;function dN(){if(pg)return Wi;pg=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function s(r,l,c){var d=null;if(c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),"key"in l){c={};for(var u in l)u!=="key"&&(c[u]=l[u])}else c=l;return l=c.ref,{$$typeof:t,type:r,key:d,ref:l!==void 0?l:null,props:c}}return Wi.Fragment=n,Wi.jsx=s,Wi.jsxs=s,Wi}var hg;function uN(){return hg||(hg=1,Nu.exports=dN()),Nu.exports}var e=uN(),Su={exports:{}},it={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gg;function mN(){if(gg)return it;gg=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),x=Symbol.iterator;function S(H){return H===null||typeof H!="object"?null:(H=x&&H[x]||H["@@iterator"],typeof H=="function"?H:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,T={};function E(H,ie,ue){this.props=H,this.context=ie,this.refs=T,this.updater=ue||w}E.prototype.isReactComponent={},E.prototype.setState=function(H,ie){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ie,"setState")},E.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function R(){}R.prototype=E.prototype;function _(H,ie,ue){this.props=H,this.context=ie,this.refs=T,this.updater=ue||w}var D=_.prototype=new R;D.constructor=_,C(D,E.prototype),D.isPureReactComponent=!0;var M=Array.isArray;function I(){}var O={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function U(H,ie,ue){var Ne=ue.ref;return{$$typeof:t,type:H,key:ie,ref:Ne!==void 0?Ne:null,props:ue}}function P(H,ie){return U(H.type,ie,H.props)}function F(H){return typeof H=="object"&&H!==null&&H.$$typeof===t}function q(H){var ie={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ue){return ie[ue]})}var z=/\/+/g;function J(H,ie){return typeof H=="object"&&H!==null&&H.key!=null?q(""+H.key):ie.toString(36)}function W(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(I,I):(H.status="pending",H.then(function(ie){H.status==="pending"&&(H.status="fulfilled",H.value=ie)},function(ie){H.status==="pending"&&(H.status="rejected",H.reason=ie)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function G(H,ie,ue,Ne,oe){var ne=typeof H;(ne==="undefined"||ne==="boolean")&&(H=null);var we=!1;if(H===null)we=!0;else switch(ne){case"bigint":case"string":case"number":we=!0;break;case"object":switch(H.$$typeof){case t:case n:we=!0;break;case f:return we=H._init,G(we(H._payload),ie,ue,Ne,oe)}}if(we)return oe=oe(H),we=Ne===""?"."+J(H,0):Ne,M(oe)?(ue="",we!=null&&(ue=we.replace(z,"$&/")+"/"),G(oe,ie,ue,"",function(ee){return ee})):oe!=null&&(F(oe)&&(oe=P(oe,ue+(oe.key==null||H&&H.key===oe.key?"":(""+oe.key).replace(z,"$&/")+"/")+we)),ie.push(oe)),1;we=0;var fe=Ne===""?".":Ne+":";if(M(H))for(var Q=0;Q<H.length;Q++)Ne=H[Q],ne=fe+J(Ne,Q),we+=G(Ne,ie,ue,ne,oe);else if(Q=S(H),typeof Q=="function")for(H=Q.call(H),Q=0;!(Ne=H.next()).done;)Ne=Ne.value,ne=fe+J(Ne,Q++),we+=G(Ne,ie,ue,ne,oe);else if(ne==="object"){if(typeof H.then=="function")return G(W(H),ie,ue,Ne,oe);throw ie=String(H),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return we}function B(H,ie,ue){if(H==null)return H;var Ne=[],oe=0;return G(H,Ne,"","",function(ne){return ie.call(ue,ne,oe++)}),Ne}function X(H){if(H._status===-1){var ie=H._result;ie=ie(),ie.then(function(ue){(H._status===0||H._status===-1)&&(H._status=1,H._result=ue)},function(ue){(H._status===0||H._status===-1)&&(H._status=2,H._result=ue)}),H._status===-1&&(H._status=0,H._result=ie)}if(H._status===1)return H._result.default;throw H._result}var $=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},ae={map:B,forEach:function(H,ie,ue){B(H,function(){ie.apply(this,arguments)},ue)},count:function(H){var ie=0;return B(H,function(){ie++}),ie},toArray:function(H){return B(H,function(ie){return ie})||[]},only:function(H){if(!F(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return it.Activity=v,it.Children=ae,it.Component=E,it.Fragment=s,it.Profiler=l,it.PureComponent=_,it.StrictMode=r,it.Suspense=h,it.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,it.__COMPILER_RUNTIME={__proto__:null,c:function(H){return O.H.useMemoCache(H)}},it.cache=function(H){return function(){return H.apply(null,arguments)}},it.cacheSignal=function(){return null},it.cloneElement=function(H,ie,ue){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var Ne=C({},H.props),oe=H.key;if(ie!=null)for(ne in ie.key!==void 0&&(oe=""+ie.key),ie)!A.call(ie,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&ie.ref===void 0||(Ne[ne]=ie[ne]);var ne=arguments.length-2;if(ne===1)Ne.children=ue;else if(1<ne){for(var we=Array(ne),fe=0;fe<ne;fe++)we[fe]=arguments[fe+2];Ne.children=we}return U(H.type,oe,Ne)},it.createContext=function(H){return H={$$typeof:d,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:c,_context:H},H},it.createElement=function(H,ie,ue){var Ne,oe={},ne=null;if(ie!=null)for(Ne in ie.key!==void 0&&(ne=""+ie.key),ie)A.call(ie,Ne)&&Ne!=="key"&&Ne!=="__self"&&Ne!=="__source"&&(oe[Ne]=ie[Ne]);var we=arguments.length-2;if(we===1)oe.children=ue;else if(1<we){for(var fe=Array(we),Q=0;Q<we;Q++)fe[Q]=arguments[Q+2];oe.children=fe}if(H&&H.defaultProps)for(Ne in we=H.defaultProps,we)oe[Ne]===void 0&&(oe[Ne]=we[Ne]);return U(H,ne,oe)},it.createRef=function(){return{current:null}},it.forwardRef=function(H){return{$$typeof:u,render:H}},it.isValidElement=F,it.lazy=function(H){return{$$typeof:f,_payload:{_status:-1,_result:H},_init:X}},it.memo=function(H,ie){return{$$typeof:m,type:H,compare:ie===void 0?null:ie}},it.startTransition=function(H){var ie=O.T,ue={};O.T=ue;try{var Ne=H(),oe=O.S;oe!==null&&oe(ue,Ne),typeof Ne=="object"&&Ne!==null&&typeof Ne.then=="function"&&Ne.then(I,$)}catch(ne){$(ne)}finally{ie!==null&&ue.types!==null&&(ie.types=ue.types),O.T=ie}},it.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},it.use=function(H){return O.H.use(H)},it.useActionState=function(H,ie,ue){return O.H.useActionState(H,ie,ue)},it.useCallback=function(H,ie){return O.H.useCallback(H,ie)},it.useContext=function(H){return O.H.useContext(H)},it.useDebugValue=function(){},it.useDeferredValue=function(H,ie){return O.H.useDeferredValue(H,ie)},it.useEffect=function(H,ie){return O.H.useEffect(H,ie)},it.useEffectEvent=function(H){return O.H.useEffectEvent(H)},it.useId=function(){return O.H.useId()},it.useImperativeHandle=function(H,ie,ue){return O.H.useImperativeHandle(H,ie,ue)},it.useInsertionEffect=function(H,ie){return O.H.useInsertionEffect(H,ie)},it.useLayoutEffect=function(H,ie){return O.H.useLayoutEffect(H,ie)},it.useMemo=function(H,ie){return O.H.useMemo(H,ie)},it.useOptimistic=function(H,ie){return O.H.useOptimistic(H,ie)},it.useReducer=function(H,ie,ue){return O.H.useReducer(H,ie,ue)},it.useRef=function(H){return O.H.useRef(H)},it.useState=function(H){return O.H.useState(H)},it.useSyncExternalStore=function(H,ie,ue){return O.H.useSyncExternalStore(H,ie,ue)},it.useTransition=function(){return O.H.useTransition()},it.version="19.2.4",it}var xg;function cm(){return xg||(xg=1,Su.exports=mN()),Su.exports}var N=cm();const ft=om(N);var ju={exports:{}},Yi={},Tu={exports:{}},wu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yg;function fN(){return yg||(yg=1,(function(t){function n(G,B){var X=G.length;G.push(B);e:for(;0<X;){var $=X-1>>>1,ae=G[$];if(0<l(ae,B))G[$]=B,G[X]=ae,X=$;else break e}}function s(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var B=G[0],X=G.pop();if(X!==B){G[0]=X;e:for(var $=0,ae=G.length,H=ae>>>1;$<H;){var ie=2*($+1)-1,ue=G[ie],Ne=ie+1,oe=G[Ne];if(0>l(ue,X))Ne<ae&&0>l(oe,ue)?(G[$]=oe,G[Ne]=X,$=Ne):(G[$]=ue,G[ie]=X,$=ie);else if(Ne<ae&&0>l(oe,X))G[$]=oe,G[Ne]=X,$=Ne;else break e}}return B}function l(G,B){var X=G.sortIndex-B.sortIndex;return X!==0?X:G.id-B.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var d=Date,u=d.now();t.unstable_now=function(){return d.now()-u}}var h=[],m=[],f=1,v=null,x=3,S=!1,w=!1,C=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function D(G){for(var B=s(m);B!==null;){if(B.callback===null)r(m);else if(B.startTime<=G)r(m),B.sortIndex=B.expirationTime,n(h,B);else break;B=s(m)}}function M(G){if(C=!1,D(G),!w)if(s(h)!==null)w=!0,I||(I=!0,q());else{var B=s(m);B!==null&&W(M,B.startTime-G)}}var I=!1,O=-1,A=5,U=-1;function P(){return T?!0:!(t.unstable_now()-U<A)}function F(){if(T=!1,I){var G=t.unstable_now();U=G;var B=!0;try{e:{w=!1,C&&(C=!1,R(O),O=-1),S=!0;var X=x;try{t:{for(D(G),v=s(h);v!==null&&!(v.expirationTime>G&&P());){var $=v.callback;if(typeof $=="function"){v.callback=null,x=v.priorityLevel;var ae=$(v.expirationTime<=G);if(G=t.unstable_now(),typeof ae=="function"){v.callback=ae,D(G),B=!0;break t}v===s(h)&&r(h),D(G)}else r(h);v=s(h)}if(v!==null)B=!0;else{var H=s(m);H!==null&&W(M,H.startTime-G),B=!1}}break e}finally{v=null,x=X,S=!1}B=void 0}}finally{B?q():I=!1}}}var q;if(typeof _=="function")q=function(){_(F)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,J=z.port2;z.port1.onmessage=F,q=function(){J.postMessage(null)}}else q=function(){E(F,0)};function W(G,B){O=E(function(){G(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(G){switch(x){case 1:case 2:case 3:var B=3;break;default:B=x}var X=x;x=B;try{return G()}finally{x=X}},t.unstable_requestPaint=function(){T=!0},t.unstable_runWithPriority=function(G,B){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var X=x;x=G;try{return B()}finally{x=X}},t.unstable_scheduleCallback=function(G,B,X){var $=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?$+X:$):X=$,G){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=X+ae,G={id:f++,callback:B,priorityLevel:G,startTime:X,expirationTime:ae,sortIndex:-1},X>$?(G.sortIndex=X,n(m,G),s(h)===null&&G===s(m)&&(C?(R(O),O=-1):C=!0,W(M,X-$))):(G.sortIndex=ae,n(h,G),w||S||(w=!0,I||(I=!0,q()))),G},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(G){var B=x;return function(){var X=x;x=B;try{return G.apply(this,arguments)}finally{x=X}}}})(wu)),wu}var vg;function pN(){return vg||(vg=1,Tu.exports=fN()),Tu.exports}var Cu={exports:{}},wn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bg;function hN(){if(bg)return wn;bg=1;var t=cm();function n(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)m+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var r={d:{f:s,r:function(){throw Error(n(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(h,m,f){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:v==null?null:""+v,children:h,containerInfo:m,implementation:f}}var d=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,wn.createPortal=function(h,m){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(n(299));return c(h,m,null,f)},wn.flushSync=function(h){var m=d.T,f=r.p;try{if(d.T=null,r.p=2,h)return h()}finally{d.T=m,r.p=f,r.d.f()}},wn.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(h,m))},wn.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},wn.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var f=m.as,v=u(f,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;f==="style"?r.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:S}):f==="script"&&r.d.X(h,{crossOrigin:v,integrity:x,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},wn.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var f=u(m.as,m.crossOrigin);r.d.M(h,{crossOrigin:f,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(h)},wn.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var f=m.as,v=u(f,m.crossOrigin);r.d.L(h,f,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},wn.preloadModule=function(h,m){if(typeof h=="string")if(m){var f=u(m.as,m.crossOrigin);r.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:f,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(h)},wn.requestFormReset=function(h){r.d.r(h)},wn.unstable_batchedUpdates=function(h,m){return h(m)},wn.useFormState=function(h,m,f){return d.H.useFormState(h,m,f)},wn.useFormStatus=function(){return d.H.useHostTransitionStatus()},wn.version="19.2.4",wn}var Ng;function Ay(){if(Ng)return Cu.exports;Ng=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),Cu.exports=hN(),Cu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sg;function gN(){if(Sg)return Yi;Sg=1;var t=pN(),n=cm(),s=Ay();function r(a){var i="https://react.dev/errors/"+a;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function c(a){var i=a,o=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(o=i.return),a=i.return;while(a)}return i.tag===3?o:null}function d(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function u(a){if(a.tag===31){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function h(a){if(c(a)!==a)throw Error(r(188))}function m(a){var i=a.alternate;if(!i){if(i=c(a),i===null)throw Error(r(188));return i!==a?null:a}for(var o=a,p=i;;){var b=o.return;if(b===null)break;var j=b.alternate;if(j===null){if(p=b.return,p!==null){o=p;continue}break}if(b.child===j.child){for(j=b.child;j;){if(j===o)return h(b),a;if(j===p)return h(b),i;j=j.sibling}throw Error(r(188))}if(o.return!==p.return)o=b,p=j;else{for(var k=!1,V=b.child;V;){if(V===o){k=!0,o=b,p=j;break}if(V===p){k=!0,p=b,o=j;break}V=V.sibling}if(!k){for(V=j.child;V;){if(V===o){k=!0,o=j,p=b;break}if(V===p){k=!0,p=j,o=b;break}V=V.sibling}if(!k)throw Error(r(189))}}if(o.alternate!==p)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?a:i}function f(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a;for(a=a.child;a!==null;){if(i=f(a),i!==null)return i;a=a.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),_=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function q(a){return a===null||typeof a!="object"?null:(a=F&&a[F]||a["@@iterator"],typeof a=="function"?a:null)}var z=Symbol.for("react.client.reference");function J(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===z?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case C:return"Fragment";case E:return"Profiler";case T:return"StrictMode";case M:return"Suspense";case I:return"SuspenseList";case U:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case w:return"Portal";case _:return a.displayName||"Context";case R:return(a._context.displayName||"Context")+".Consumer";case D:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case O:return i=a.displayName||null,i!==null?i:J(a.type)||"Memo";case A:i=a._payload,a=a._init;try{return J(a(i))}catch{}}return null}var W=Array.isArray,G=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},$=[],ae=-1;function H(a){return{current:a}}function ie(a){0>ae||(a.current=$[ae],$[ae]=null,ae--)}function ue(a,i){ae++,$[ae]=a.current,a.current=i}var Ne=H(null),oe=H(null),ne=H(null),we=H(null);function fe(a,i){switch(ue(ne,i),ue(oe,a),ue(Ne,null),i.nodeType){case 9:case 11:a=(a=i.documentElement)&&(a=a.namespaceURI)?Oh(a):0;break;default:if(a=i.tagName,i=i.namespaceURI)i=Oh(i),a=Uh(i,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}ie(Ne),ue(Ne,a)}function Q(){ie(Ne),ie(oe),ie(ne)}function ee(a){a.memoizedState!==null&&ue(we,a);var i=Ne.current,o=Uh(i,a.type);i!==o&&(ue(oe,a),ue(Ne,o))}function ye(a){oe.current===a&&(ie(Ne),ie(oe)),we.current===a&&(ie(we),qi._currentValue=X)}var Le,ke;function Re(a){if(Le===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);Le=i&&i[1]||"",ke=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Le+a+ke}var Ke=!1;function ze(a,i){if(!a||Ke)return"";Ke=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(i){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(Te){var ve=Te}Reflect.construct(a,[],_e)}else{try{_e.call()}catch(Te){ve=Te}a.call(_e.prototype)}}else{try{throw Error()}catch(Te){ve=Te}(_e=a())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(Te){if(Te&&ve&&typeof Te.stack=="string")return[Te.stack,ve.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var j=p.DetermineComponentFrameRoot(),k=j[0],V=j[1];if(k&&V){var re=k.split(`
`),ge=V.split(`
`);for(b=p=0;p<re.length&&!re[p].includes("DetermineComponentFrameRoot");)p++;for(;b<ge.length&&!ge[b].includes("DetermineComponentFrameRoot");)b++;if(p===re.length||b===ge.length)for(p=re.length-1,b=ge.length-1;1<=p&&0<=b&&re[p]!==ge[b];)b--;for(;1<=p&&0<=b;p--,b--)if(re[p]!==ge[b]){if(p!==1||b!==1)do if(p--,b--,0>b||re[p]!==ge[b]){var Ee=`
`+re[p].replace(" at new "," at ");return a.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",a.displayName)),Ee}while(1<=p&&0<=b);break}}}finally{Ke=!1,Error.prepareStackTrace=o}return(o=a?a.displayName||a.name:"")?Re(o):""}function Se(a,i){switch(a.tag){case 26:case 27:case 5:return Re(a.type);case 16:return Re("Lazy");case 13:return a.child!==i&&i!==null?Re("Suspense Fallback"):Re("Suspense");case 19:return Re("SuspenseList");case 0:case 15:return ze(a.type,!1);case 11:return ze(a.type.render,!1);case 1:return ze(a.type,!0);case 31:return Re("Activity");default:return""}}function Oe(a){try{var i="",o=null;do i+=Se(a,o),o=a,a=a.return;while(a);return i}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var be=Object.prototype.hasOwnProperty,xe=t.unstable_scheduleCallback,Ue=t.unstable_cancelCallback,Ze=t.unstable_shouldYield,Et=t.unstable_requestPaint,ot=t.unstable_now,Pt=t.unstable_getCurrentPriorityLevel,wt=t.unstable_ImmediatePriority,gt=t.unstable_UserBlockingPriority,Kt=t.unstable_NormalPriority,bs=t.unstable_LowPriority,Ds=t.unstable_IdlePriority,rr=t.log,Be=t.unstable_setDisableYieldValue,Ye=null,He=null;function bt(a){if(typeof rr=="function"&&Be(a),He&&typeof He.setStrictMode=="function")try{He.setStrictMode(Ye,a)}catch{}}var st=Math.clz32?Math.clz32:yn,It=Math.log,xn=Math.LN2;function yn(a){return a>>>=0,a===0?32:31-(It(a)/xn|0)|0}var cn=256,Ns=262144,$t=4194304;function Xn(a){var i=a&42;if(i!==0)return i;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function aa(a,i,o){var p=a.pendingLanes;if(p===0)return 0;var b=0,j=a.suspendedLanes,k=a.pingedLanes;a=a.warmLanes;var V=p&134217727;return V!==0?(p=V&~j,p!==0?b=Xn(p):(k&=V,k!==0?b=Xn(k):o||(o=V&~a,o!==0&&(b=Xn(o))))):(V=p&~j,V!==0?b=Xn(V):k!==0?b=Xn(k):o||(o=p&~a,o!==0&&(b=Xn(o)))),b===0?0:i!==0&&i!==b&&(i&j)===0&&(j=b&-b,o=i&-i,j>=o||j===32&&(o&4194048)!==0)?i:b}function Ss(a,i){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&i)===0}function uc(a,i){switch(a){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ul(){var a=$t;return $t<<=1,($t&62914560)===0&&($t=4194304),a}function Zr(a){for(var i=[],o=0;31>o;o++)i.push(a);return i}function Pa(a,i){a.pendingLanes|=i,i!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function mc(a,i,o,p,b,j){var k=a.pendingLanes;a.pendingLanes=o,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=o,a.entangledLanes&=o,a.errorRecoveryDisabledLanes&=o,a.shellSuspendCounter=0;var V=a.entanglements,re=a.expirationTimes,ge=a.hiddenUpdates;for(o=k&~o;0<o;){var Ee=31-st(o),_e=1<<Ee;V[Ee]=0,re[Ee]=-1;var ve=ge[Ee];if(ve!==null)for(ge[Ee]=null,Ee=0;Ee<ve.length;Ee++){var Te=ve[Ee];Te!==null&&(Te.lane&=-536870913)}o&=~_e}p!==0&&ml(a,p,0),j!==0&&b===0&&a.tag!==0&&(a.suspendedLanes|=j&~(k&~i))}function ml(a,i,o){a.pendingLanes|=i,a.suspendedLanes&=~i;var p=31-st(i);a.entangledLanes|=i,a.entanglements[p]=a.entanglements[p]|1073741824|o&261930}function fl(a,i){var o=a.entangledLanes|=i;for(a=a.entanglements;o;){var p=31-st(o),b=1<<p;b&i|a[p]&i&&(a[p]|=i),o&=~b}}function pl(a,i){var o=i&-i;return o=(o&42)!==0?1:ei(o),(o&(a.suspendedLanes|i))!==0?0:o}function ei(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ti(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function hl(){var a=B.p;return a!==0?a:(a=window.event,a===void 0?32:lg(a.type))}function gl(a,i){var o=B.p;try{return B.p=a,i()}finally{B.p=o}}var js=Math.random().toString(36).slice(2),tn="__reactFiber$"+js,vn="__reactProps$"+js,ks="__reactContainer$"+js,ni="__reactEvents$"+js,fc="__reactListeners$"+js,Rs="__reactHandles$"+js,si="__reactResources$"+js,ir="__reactMarker$"+js;function xl(a){delete a[tn],delete a[vn],delete a[ni],delete a[fc],delete a[Rs]}function La(a){var i=a[tn];if(i)return i;for(var o=a.parentNode;o;){if(i=o[ks]||o[tn]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(a=Vh(a);a!==null;){if(o=a[tn])return o;a=Vh(a)}return i}a=o,o=a.parentNode}return null}function Oa(a){if(a=a[tn]||a[ks]){var i=a.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return a}return null}function lr(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a.stateNode;throw Error(r(33))}function Ua(a){var i=a[si];return i||(i=a[si]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function dn(a){a[ir]=!0}var pc=new Set,hc={};function ra(a,i){Fa(a,i),Fa(a+"Capture",i)}function Fa(a,i){for(hc[a]=i,a=0;a<i.length;a++)pc.add(i[a])}var Rm=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gc={},xc={};function Mm(a){return be.call(xc,a)?!0:be.call(gc,a)?!1:Rm.test(a)?xc[a]=!0:(gc[a]=!0,!1)}function ai(a,i,o){if(Mm(i))if(o===null)a.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":a.removeAttribute(i);return;case"boolean":var p=i.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){a.removeAttribute(i);return}}a.setAttribute(i,""+o)}}function ri(a,i,o){if(o===null)a.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(i);return}a.setAttribute(i,""+o)}}function Ts(a,i,o,p){if(p===null)a.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttributeNS(i,o,""+p)}}function On(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function yc(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Pm(a,i,o){var p=Object.getOwnPropertyDescriptor(a.constructor.prototype,i);if(!a.hasOwnProperty(i)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var b=p.get,j=p.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return b.call(this)},set:function(k){o=""+k,j.call(this,k)}}),Object.defineProperty(a,i,{enumerable:p.enumerable}),{getValue:function(){return o},setValue:function(k){o=""+k},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function yl(a){if(!a._valueTracker){var i=yc(a)?"checked":"value";a._valueTracker=Pm(a,i,""+a[i])}}function vc(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var o=i.getValue(),p="";return a&&(p=yc(a)?a.checked?"true":"false":a.value),a=p,a!==o?(i.setValue(a),!0):!1}function ii(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Lm=/[\n"\\]/g;function Un(a){return a.replace(Lm,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function vl(a,i,o,p,b,j,k,V){a.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?a.type=k:a.removeAttribute("type"),i!=null?k==="number"?(i===0&&a.value===""||a.value!=i)&&(a.value=""+On(i)):a.value!==""+On(i)&&(a.value=""+On(i)):k!=="submit"&&k!=="reset"||a.removeAttribute("value"),i!=null?bl(a,k,On(i)):o!=null?bl(a,k,On(o)):p!=null&&a.removeAttribute("value"),b==null&&j!=null&&(a.defaultChecked=!!j),b!=null&&(a.checked=b&&typeof b!="function"&&typeof b!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?a.name=""+On(V):a.removeAttribute("name")}function bc(a,i,o,p,b,j,k,V){if(j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(a.type=j),i!=null||o!=null){if(!(j!=="submit"&&j!=="reset"||i!=null)){yl(a);return}o=o!=null?""+On(o):"",i=i!=null?""+On(i):o,V||i===a.value||(a.value=i),a.defaultValue=i}p=p??b,p=typeof p!="function"&&typeof p!="symbol"&&!!p,a.checked=V?a.checked:!!p,a.defaultChecked=!!p,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(a.name=k),yl(a)}function bl(a,i,o){i==="number"&&ii(a.ownerDocument)===a||a.defaultValue===""+o||(a.defaultValue=""+o)}function ia(a,i,o,p){if(a=a.options,i){i={};for(var b=0;b<o.length;b++)i["$"+o[b]]=!0;for(o=0;o<a.length;o++)b=i.hasOwnProperty("$"+a[o].value),a[o].selected!==b&&(a[o].selected=b),b&&p&&(a[o].defaultSelected=!0)}else{for(o=""+On(o),i=null,b=0;b<a.length;b++){if(a[b].value===o){a[b].selected=!0,p&&(a[b].defaultSelected=!0);return}i!==null||a[b].disabled||(i=a[b])}i!==null&&(i.selected=!0)}}function K(a,i,o){if(i!=null&&(i=""+On(i),i!==a.value&&(a.value=i),o==null)){a.defaultValue!==i&&(a.defaultValue=i);return}a.defaultValue=o!=null?""+On(o):""}function Z(a,i,o,p){if(i==null){if(p!=null){if(o!=null)throw Error(r(92));if(W(p)){if(1<p.length)throw Error(r(93));p=p[0]}o=p}o==null&&(o=""),i=o}o=On(i),a.defaultValue=o,p=a.textContent,p===o&&p!==""&&p!==null&&(a.value=p),yl(a)}function Y(a,i){if(i){var o=a.firstChild;if(o&&o===a.lastChild&&o.nodeType===3){o.nodeValue=i;return}}a.textContent=i}var pe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Me(a,i,o){var p=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?p?a.setProperty(i,""):i==="float"?a.cssFloat="":a[i]="":p?a.setProperty(i,o):typeof o!="number"||o===0||pe.has(i)?i==="float"?a.cssFloat=o:a[i]=(""+o).trim():a[i]=o+"px"}function Pe(a,i,o){if(i!=null&&typeof i!="object")throw Error(r(62));if(a=a.style,o!=null){for(var p in o)!o.hasOwnProperty(p)||i!=null&&i.hasOwnProperty(p)||(p.indexOf("--")===0?a.setProperty(p,""):p==="float"?a.cssFloat="":a[p]="");for(var b in i)p=i[b],i.hasOwnProperty(b)&&o[b]!==p&&Me(a,b,p)}else for(var j in i)i.hasOwnProperty(j)&&Me(a,j,i[j])}function Qe(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wt(a){return lt.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Ht(){}var Yt=null;function Cn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var fn=null,Jt=null;function la(a){var i=Oa(a);if(i&&(a=i.stateNode)){var o=a[vn]||null;e:switch(a=i.stateNode,i.type){case"input":if(vl(a,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=a;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Un(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var p=o[i];if(p!==a&&p.form===a.form){var b=p[vn]||null;if(!b)throw Error(r(90));vl(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(i=0;i<o.length;i++)p=o[i],p.form===a.form&&vc(p)}break e;case"textarea":K(a,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&ia(a,!!o.multiple,i,!1)}}}var Ms=!1;function Nl(a,i,o){if(Ms)return a(i,o);Ms=!0;try{var p=a(i);return p}finally{if(Ms=!1,(fn!==null||Jt!==null)&&(oo(),fn&&(i=fn,a=Jt,Jt=fn=null,la(i),a)))for(i=0;i<a.length;i++)la(a[i])}}function li(a,i){var o=a.stateNode;if(o===null)return null;var p=o[vn]||null;if(p===null)return null;o=p[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break e;default:a=!1}if(a)return null;if(o&&typeof o!="function")throw Error(r(231,i,typeof o));return o}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nc=!1;if(Ps)try{var oi={};Object.defineProperty(oi,"passive",{get:function(){Nc=!0}}),window.addEventListener("test",oi,oi),window.removeEventListener("test",oi,oi)}catch{Nc=!1}var oa=null,Sc=null,Sl=null;function Om(){if(Sl)return Sl;var a,i=Sc,o=i.length,p,b="value"in oa?oa.value:oa.textContent,j=b.length;for(a=0;a<o&&i[a]===b[a];a++);var k=o-a;for(p=1;p<=k&&i[o-p]===b[j-p];p++);return Sl=b.slice(a,1<p?1-p:void 0)}function jl(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function Tl(){return!0}function Um(){return!1}function Dn(a){function i(o,p,b,j,k){this._reactName=o,this._targetInst=b,this.type=p,this.nativeEvent=j,this.target=k,this.currentTarget=null;for(var V in a)a.hasOwnProperty(V)&&(o=a[V],this[V]=o?o(j):j[V]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?Tl:Um,this.isPropagationStopped=Um,this}return v(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Tl)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Tl)},persist:function(){},isPersistent:Tl}),i}var Ba={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wl=Dn(Ba),ci=v({},Ba,{view:0,detail:0}),ov=Dn(ci),jc,Tc,di,Cl=v({},ci,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cc,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==di&&(di&&a.type==="mousemove"?(jc=a.screenX-di.screenX,Tc=a.screenY-di.screenY):Tc=jc=0,di=a),jc)},movementY:function(a){return"movementY"in a?a.movementY:Tc}}),Fm=Dn(Cl),cv=v({},Cl,{dataTransfer:0}),dv=Dn(cv),uv=v({},ci,{relatedTarget:0}),wc=Dn(uv),mv=v({},Ba,{animationName:0,elapsedTime:0,pseudoElement:0}),fv=Dn(mv),pv=v({},Ba,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),hv=Dn(pv),gv=v({},Ba,{data:0}),Bm=Dn(gv),xv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bv(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=vv[a])?!!i[a]:!1}function Cc(){return bv}var Nv=v({},ci,{key:function(a){if(a.key){var i=xv[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=jl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?yv[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cc,charCode:function(a){return a.type==="keypress"?jl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?jl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Sv=Dn(Nv),jv=v({},Cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gm=Dn(jv),Tv=v({},ci,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cc}),wv=Dn(Tv),Cv=v({},Ba,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ev=Dn(Cv),Iv=v({},Cl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),_v=Dn(Iv),Av=v({},Ba,{newState:0,oldState:0}),Dv=Dn(Av),kv=[9,13,27,32],Ec=Ps&&"CompositionEvent"in window,ui=null;Ps&&"documentMode"in document&&(ui=document.documentMode);var Rv=Ps&&"TextEvent"in window&&!ui,zm=Ps&&(!Ec||ui&&8<ui&&11>=ui),Hm=" ",qm=!1;function Vm(a,i){switch(a){case"keyup":return kv.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Km(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var or=!1;function Mv(a,i){switch(a){case"compositionend":return Km(i);case"keypress":return i.which!==32?null:(qm=!0,Hm);case"textInput":return a=i.data,a===Hm&&qm?null:a;default:return null}}function Pv(a,i){if(or)return a==="compositionend"||!Ec&&Vm(a,i)?(a=Om(),Sl=Sc=oa=null,or=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return zm&&i.locale!=="ko"?null:i.data;default:return null}}var Lv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $m(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!Lv[a.type]:i==="textarea"}function Wm(a,i,o,p){fn?Jt?Jt.push(p):Jt=[p]:fn=p,i=go(i,"onChange"),0<i.length&&(o=new wl("onChange","change",null,o,p),a.push({event:o,listeners:i}))}var mi=null,fi=null;function Ov(a){Dh(a,0)}function El(a){var i=lr(a);if(vc(i))return a}function Ym(a,i){if(a==="change")return i}var Jm=!1;if(Ps){var Ic;if(Ps){var _c="oninput"in document;if(!_c){var Xm=document.createElement("div");Xm.setAttribute("oninput","return;"),_c=typeof Xm.oninput=="function"}Ic=_c}else Ic=!1;Jm=Ic&&(!document.documentMode||9<document.documentMode)}function Qm(){mi&&(mi.detachEvent("onpropertychange",Zm),fi=mi=null)}function Zm(a){if(a.propertyName==="value"&&El(fi)){var i=[];Wm(i,fi,a,Cn(a)),Nl(Ov,i)}}function Uv(a,i,o){a==="focusin"?(Qm(),mi=i,fi=o,mi.attachEvent("onpropertychange",Zm)):a==="focusout"&&Qm()}function Fv(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return El(fi)}function Bv(a,i){if(a==="click")return El(i)}function Gv(a,i){if(a==="input"||a==="change")return El(i)}function zv(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var Fn=typeof Object.is=="function"?Object.is:zv;function pi(a,i){if(Fn(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var o=Object.keys(a),p=Object.keys(i);if(o.length!==p.length)return!1;for(p=0;p<o.length;p++){var b=o[p];if(!be.call(i,b)||!Fn(a[b],i[b]))return!1}return!0}function ef(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function tf(a,i){var o=ef(a);a=0;for(var p;o;){if(o.nodeType===3){if(p=a+o.textContent.length,a<=i&&p>=i)return{node:o,offset:i-a};a=p}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ef(o)}}function nf(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?nf(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function sf(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var i=ii(a.document);i instanceof a.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)a=i.contentWindow;else break;i=ii(a.document)}return i}function Ac(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}var Hv=Ps&&"documentMode"in document&&11>=document.documentMode,cr=null,Dc=null,hi=null,kc=!1;function af(a,i,o){var p=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;kc||cr==null||cr!==ii(p)||(p=cr,"selectionStart"in p&&Ac(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),hi&&pi(hi,p)||(hi=p,p=go(Dc,"onSelect"),0<p.length&&(i=new wl("onSelect","select",null,i,o),a.push({event:i,listeners:p}),i.target=cr)))}function Ga(a,i){var o={};return o[a.toLowerCase()]=i.toLowerCase(),o["Webkit"+a]="webkit"+i,o["Moz"+a]="moz"+i,o}var dr={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionrun:Ga("Transition","TransitionRun"),transitionstart:Ga("Transition","TransitionStart"),transitioncancel:Ga("Transition","TransitionCancel"),transitionend:Ga("Transition","TransitionEnd")},Rc={},rf={};Ps&&(rf=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);function za(a){if(Rc[a])return Rc[a];if(!dr[a])return a;var i=dr[a],o;for(o in i)if(i.hasOwnProperty(o)&&o in rf)return Rc[a]=i[o];return a}var lf=za("animationend"),of=za("animationiteration"),cf=za("animationstart"),qv=za("transitionrun"),Vv=za("transitionstart"),Kv=za("transitioncancel"),df=za("transitionend"),uf=new Map,Mc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Mc.push("scrollEnd");function us(a,i){uf.set(a,i),ra(i,[a])}var Il=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Qn=[],ur=0,Pc=0;function _l(){for(var a=ur,i=Pc=ur=0;i<a;){var o=Qn[i];Qn[i++]=null;var p=Qn[i];Qn[i++]=null;var b=Qn[i];Qn[i++]=null;var j=Qn[i];if(Qn[i++]=null,p!==null&&b!==null){var k=p.pending;k===null?b.next=b:(b.next=k.next,k.next=b),p.pending=b}j!==0&&mf(o,b,j)}}function Al(a,i,o,p){Qn[ur++]=a,Qn[ur++]=i,Qn[ur++]=o,Qn[ur++]=p,Pc|=p,a.lanes|=p,a=a.alternate,a!==null&&(a.lanes|=p)}function Lc(a,i,o,p){return Al(a,i,o,p),Dl(a)}function Ha(a,i){return Al(a,null,null,i),Dl(a)}function mf(a,i,o){a.lanes|=o;var p=a.alternate;p!==null&&(p.lanes|=o);for(var b=!1,j=a.return;j!==null;)j.childLanes|=o,p=j.alternate,p!==null&&(p.childLanes|=o),j.tag===22&&(a=j.stateNode,a===null||a._visibility&1||(b=!0)),a=j,j=j.return;return a.tag===3?(j=a.stateNode,b&&i!==null&&(b=31-st(o),a=j.hiddenUpdates,p=a[b],p===null?a[b]=[i]:p.push(i),i.lane=o|536870912),j):null}function Dl(a){if(50<Oi)throw Oi=0,Vd=null,Error(r(185));for(var i=a.return;i!==null;)a=i,i=a.return;return a.tag===3?a.stateNode:null}var mr={};function $v(a,i,o,p){this.tag=a,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(a,i,o,p){return new $v(a,i,o,p)}function Oc(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ls(a,i){var o=a.alternate;return o===null?(o=Bn(a.tag,i,a.key,a.mode),o.elementType=a.elementType,o.type=a.type,o.stateNode=a.stateNode,o.alternate=a,a.alternate=o):(o.pendingProps=i,o.type=a.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=a.flags&65011712,o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,i=a.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=a.sibling,o.index=a.index,o.ref=a.ref,o.refCleanup=a.refCleanup,o}function ff(a,i){a.flags&=65011714;var o=a.alternate;return o===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,i=o.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),a}function kl(a,i,o,p,b,j){var k=0;if(p=a,typeof a=="function")Oc(a)&&(k=1);else if(typeof a=="string")k=Qb(a,o,Ne.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case U:return a=Bn(31,o,i,b),a.elementType=U,a.lanes=j,a;case C:return qa(o.children,b,j,i);case T:k=8,b|=24;break;case E:return a=Bn(12,o,i,b|2),a.elementType=E,a.lanes=j,a;case M:return a=Bn(13,o,i,b),a.elementType=M,a.lanes=j,a;case I:return a=Bn(19,o,i,b),a.elementType=I,a.lanes=j,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case _:k=10;break e;case R:k=9;break e;case D:k=11;break e;case O:k=14;break e;case A:k=16,p=null;break e}k=29,o=Error(r(130,a===null?"null":typeof a,"")),p=null}return i=Bn(k,o,i,b),i.elementType=a,i.type=p,i.lanes=j,i}function qa(a,i,o,p){return a=Bn(7,a,p,i),a.lanes=o,a}function Uc(a,i,o){return a=Bn(6,a,null,i),a.lanes=o,a}function pf(a){var i=Bn(18,null,null,0);return i.stateNode=a,i}function Fc(a,i,o){return i=Bn(4,a.children!==null?a.children:[],a.key,i),i.lanes=o,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}var hf=new WeakMap;function Zn(a,i){if(typeof a=="object"&&a!==null){var o=hf.get(a);return o!==void 0?o:(i={value:a,source:i,stack:Oe(i)},hf.set(a,i),i)}return{value:a,source:i,stack:Oe(i)}}var fr=[],pr=0,Rl=null,gi=0,es=[],ts=0,ca=null,ws=1,Cs="";function Os(a,i){fr[pr++]=gi,fr[pr++]=Rl,Rl=a,gi=i}function gf(a,i,o){es[ts++]=ws,es[ts++]=Cs,es[ts++]=ca,ca=a;var p=ws;a=Cs;var b=32-st(p)-1;p&=~(1<<b),o+=1;var j=32-st(i)+b;if(30<j){var k=b-b%5;j=(p&(1<<k)-1).toString(32),p>>=k,b-=k,ws=1<<32-st(i)+b|o<<b|p,Cs=j+a}else ws=1<<j|o<<b|p,Cs=a}function Bc(a){a.return!==null&&(Os(a,1),gf(a,1,0))}function Gc(a){for(;a===Rl;)Rl=fr[--pr],fr[pr]=null,gi=fr[--pr],fr[pr]=null;for(;a===ca;)ca=es[--ts],es[ts]=null,Cs=es[--ts],es[ts]=null,ws=es[--ts],es[ts]=null}function xf(a,i){es[ts++]=ws,es[ts++]=Cs,es[ts++]=ca,ws=i.id,Cs=i.overflow,ca=a}var bn=null,Ft=null,vt=!1,da=null,ns=!1,zc=Error(r(519));function ua(a){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw xi(Zn(i,a)),zc}function yf(a){var i=a.stateNode,o=a.type,p=a.memoizedProps;switch(i[tn]=a,i[vn]=p,o){case"dialog":ht("cancel",i),ht("close",i);break;case"iframe":case"object":case"embed":ht("load",i);break;case"video":case"audio":for(o=0;o<Fi.length;o++)ht(Fi[o],i);break;case"source":ht("error",i);break;case"img":case"image":case"link":ht("error",i),ht("load",i);break;case"details":ht("toggle",i);break;case"input":ht("invalid",i),bc(i,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":ht("invalid",i);break;case"textarea":ht("invalid",i),Z(i,p.value,p.defaultValue,p.children)}o=p.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||p.suppressHydrationWarning===!0||Ph(i.textContent,o)?(p.popover!=null&&(ht("beforetoggle",i),ht("toggle",i)),p.onScroll!=null&&ht("scroll",i),p.onScrollEnd!=null&&ht("scrollend",i),p.onClick!=null&&(i.onclick=Ht),i=!0):i=!1,i||ua(a,!0)}function vf(a){for(bn=a.return;bn;)switch(bn.tag){case 5:case 31:case 13:ns=!1;return;case 27:case 3:ns=!0;return;default:bn=bn.return}}function hr(a){if(a!==bn)return!1;if(!vt)return vf(a),vt=!0,!1;var i=a.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=a.type,o=!(o!=="form"&&o!=="button")||iu(a.type,a.memoizedProps)),o=!o),o&&Ft&&ua(a),vf(a),i===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Ft=qh(a)}else if(i===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Ft=qh(a)}else i===27?(i=Ft,wa(a.type)?(a=uu,uu=null,Ft=a):Ft=i):Ft=bn?as(a.stateNode.nextSibling):null;return!0}function Va(){Ft=bn=null,vt=!1}function Hc(){var a=da;return a!==null&&(Pn===null?Pn=a:Pn.push.apply(Pn,a),da=null),a}function xi(a){da===null?da=[a]:da.push(a)}var qc=H(null),Ka=null,Us=null;function ma(a,i,o){ue(qc,i._currentValue),i._currentValue=o}function Fs(a){a._currentValue=qc.current,ie(qc)}function Vc(a,i,o){for(;a!==null;){var p=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,p!==null&&(p.childLanes|=i)):p!==null&&(p.childLanes&i)!==i&&(p.childLanes|=i),a===o)break;a=a.return}}function Kc(a,i,o,p){var b=a.child;for(b!==null&&(b.return=a);b!==null;){var j=b.dependencies;if(j!==null){var k=b.child;j=j.firstContext;e:for(;j!==null;){var V=j;j=b;for(var re=0;re<i.length;re++)if(V.context===i[re]){j.lanes|=o,V=j.alternate,V!==null&&(V.lanes|=o),Vc(j.return,o,a),p||(k=null);break e}j=V.next}}else if(b.tag===18){if(k=b.return,k===null)throw Error(r(341));k.lanes|=o,j=k.alternate,j!==null&&(j.lanes|=o),Vc(k,o,a),k=null}else k=b.child;if(k!==null)k.return=b;else for(k=b;k!==null;){if(k===a){k=null;break}if(b=k.sibling,b!==null){b.return=k.return,k=b;break}k=k.return}b=k}}function gr(a,i,o,p){a=null;for(var b=i,j=!1;b!==null;){if(!j){if((b.flags&524288)!==0)j=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var k=b.alternate;if(k===null)throw Error(r(387));if(k=k.memoizedProps,k!==null){var V=b.type;Fn(b.pendingProps.value,k.value)||(a!==null?a.push(V):a=[V])}}else if(b===we.current){if(k=b.alternate,k===null)throw Error(r(387));k.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(a!==null?a.push(qi):a=[qi])}b=b.return}a!==null&&Kc(i,a,o,p),i.flags|=262144}function Ml(a){for(a=a.firstContext;a!==null;){if(!Fn(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function $a(a){Ka=a,Us=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Nn(a){return bf(Ka,a)}function Pl(a,i){return Ka===null&&$a(a),bf(a,i)}function bf(a,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Us===null){if(a===null)throw Error(r(308));Us=i,a.dependencies={lanes:0,firstContext:i},a.flags|=524288}else Us=Us.next=i;return o}var Wv=typeof AbortController<"u"?AbortController:function(){var a=[],i=this.signal={aborted:!1,addEventListener:function(o,p){a.push(p)}};this.abort=function(){i.aborted=!0,a.forEach(function(o){return o()})}},Yv=t.unstable_scheduleCallback,Jv=t.unstable_NormalPriority,nn={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $c(){return{controller:new Wv,data:new Map,refCount:0}}function yi(a){a.refCount--,a.refCount===0&&Yv(Jv,function(){a.controller.abort()})}var vi=null,Wc=0,xr=0,yr=null;function Xv(a,i){if(vi===null){var o=vi=[];Wc=0,xr=Xd(),yr={status:"pending",value:void 0,then:function(p){o.push(p)}}}return Wc++,i.then(Nf,Nf),i}function Nf(){if(--Wc===0&&vi!==null){yr!==null&&(yr.status="fulfilled");var a=vi;vi=null,xr=0,yr=null;for(var i=0;i<a.length;i++)(0,a[i])()}}function Qv(a,i){var o=[],p={status:"pending",value:null,reason:null,then:function(b){o.push(b)}};return a.then(function(){p.status="fulfilled",p.value=i;for(var b=0;b<o.length;b++)(0,o[b])(i)},function(b){for(p.status="rejected",p.reason=b,b=0;b<o.length;b++)(0,o[b])(void 0)}),p}var Sf=G.S;G.S=function(a,i){rh=ot(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&Xv(a,i),Sf!==null&&Sf(a,i)};var Wa=H(null);function Yc(){var a=Wa.current;return a!==null?a:Lt.pooledCache}function Ll(a,i){i===null?ue(Wa,Wa.current):ue(Wa,i.pool)}function jf(){var a=Yc();return a===null?null:{parent:nn._currentValue,pool:a}}var vr=Error(r(460)),Jc=Error(r(474)),Ol=Error(r(542)),Ul={then:function(){}};function Tf(a){return a=a.status,a==="fulfilled"||a==="rejected"}function wf(a,i,o){switch(o=a[o],o===void 0?a.push(i):o!==i&&(i.then(Ht,Ht),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Ef(a),a;default:if(typeof i.status=="string")i.then(Ht,Ht);else{if(a=Lt,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=i,a.status="pending",a.then(function(p){if(i.status==="pending"){var b=i;b.status="fulfilled",b.value=p}},function(p){if(i.status==="pending"){var b=i;b.status="rejected",b.reason=p}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Ef(a),a}throw Ja=i,vr}}function Ya(a){try{var i=a._init;return i(a._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ja=o,vr):o}}var Ja=null;function Cf(){if(Ja===null)throw Error(r(459));var a=Ja;return Ja=null,a}function Ef(a){if(a===vr||a===Ol)throw Error(r(483))}var br=null,bi=0;function Fl(a){var i=bi;return bi+=1,br===null&&(br=[]),wf(br,a,i)}function Ni(a,i){i=i.props.ref,a.ref=i!==void 0?i:null}function Bl(a,i){throw i.$$typeof===x?Error(r(525)):(a=Object.prototype.toString.call(i),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)))}function If(a){function i(me,ce){if(a){var he=me.deletions;he===null?(me.deletions=[ce],me.flags|=16):he.push(ce)}}function o(me,ce){if(!a)return null;for(;ce!==null;)i(me,ce),ce=ce.sibling;return null}function p(me){for(var ce=new Map;me!==null;)me.key!==null?ce.set(me.key,me):ce.set(me.index,me),me=me.sibling;return ce}function b(me,ce){return me=Ls(me,ce),me.index=0,me.sibling=null,me}function j(me,ce,he){return me.index=he,a?(he=me.alternate,he!==null?(he=he.index,he<ce?(me.flags|=67108866,ce):he):(me.flags|=67108866,ce)):(me.flags|=1048576,ce)}function k(me){return a&&me.alternate===null&&(me.flags|=67108866),me}function V(me,ce,he,Ie){return ce===null||ce.tag!==6?(ce=Uc(he,me.mode,Ie),ce.return=me,ce):(ce=b(ce,he),ce.return=me,ce)}function re(me,ce,he,Ie){var et=he.type;return et===C?Ee(me,ce,he.props.children,Ie,he.key):ce!==null&&(ce.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===A&&Ya(et)===ce.type)?(ce=b(ce,he.props),Ni(ce,he),ce.return=me,ce):(ce=kl(he.type,he.key,he.props,null,me.mode,Ie),Ni(ce,he),ce.return=me,ce)}function ge(me,ce,he,Ie){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==he.containerInfo||ce.stateNode.implementation!==he.implementation?(ce=Fc(he,me.mode,Ie),ce.return=me,ce):(ce=b(ce,he.children||[]),ce.return=me,ce)}function Ee(me,ce,he,Ie,et){return ce===null||ce.tag!==7?(ce=qa(he,me.mode,Ie,et),ce.return=me,ce):(ce=b(ce,he),ce.return=me,ce)}function _e(me,ce,he){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=Uc(""+ce,me.mode,he),ce.return=me,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case S:return he=kl(ce.type,ce.key,ce.props,null,me.mode,he),Ni(he,ce),he.return=me,he;case w:return ce=Fc(ce,me.mode,he),ce.return=me,ce;case A:return ce=Ya(ce),_e(me,ce,he)}if(W(ce)||q(ce))return ce=qa(ce,me.mode,he,null),ce.return=me,ce;if(typeof ce.then=="function")return _e(me,Fl(ce),he);if(ce.$$typeof===_)return _e(me,Pl(me,ce),he);Bl(me,ce)}return null}function ve(me,ce,he,Ie){var et=ce!==null?ce.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return et!==null?null:V(me,ce,""+he,Ie);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case S:return he.key===et?re(me,ce,he,Ie):null;case w:return he.key===et?ge(me,ce,he,Ie):null;case A:return he=Ya(he),ve(me,ce,he,Ie)}if(W(he)||q(he))return et!==null?null:Ee(me,ce,he,Ie,null);if(typeof he.then=="function")return ve(me,ce,Fl(he),Ie);if(he.$$typeof===_)return ve(me,ce,Pl(me,he),Ie);Bl(me,he)}return null}function Te(me,ce,he,Ie,et){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return me=me.get(he)||null,V(ce,me,""+Ie,et);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case S:return me=me.get(Ie.key===null?he:Ie.key)||null,re(ce,me,Ie,et);case w:return me=me.get(Ie.key===null?he:Ie.key)||null,ge(ce,me,Ie,et);case A:return Ie=Ya(Ie),Te(me,ce,he,Ie,et)}if(W(Ie)||q(Ie))return me=me.get(he)||null,Ee(ce,me,Ie,et,null);if(typeof Ie.then=="function")return Te(me,ce,he,Fl(Ie),et);if(Ie.$$typeof===_)return Te(me,ce,he,Pl(ce,Ie),et);Bl(ce,Ie)}return null}function We(me,ce,he,Ie){for(var et=null,Nt=null,Xe=ce,dt=ce=0,yt=null;Xe!==null&&dt<he.length;dt++){Xe.index>dt?(yt=Xe,Xe=null):yt=Xe.sibling;var St=ve(me,Xe,he[dt],Ie);if(St===null){Xe===null&&(Xe=yt);break}a&&Xe&&St.alternate===null&&i(me,Xe),ce=j(St,ce,dt),Nt===null?et=St:Nt.sibling=St,Nt=St,Xe=yt}if(dt===he.length)return o(me,Xe),vt&&Os(me,dt),et;if(Xe===null){for(;dt<he.length;dt++)Xe=_e(me,he[dt],Ie),Xe!==null&&(ce=j(Xe,ce,dt),Nt===null?et=Xe:Nt.sibling=Xe,Nt=Xe);return vt&&Os(me,dt),et}for(Xe=p(Xe);dt<he.length;dt++)yt=Te(Xe,me,dt,he[dt],Ie),yt!==null&&(a&&yt.alternate!==null&&Xe.delete(yt.key===null?dt:yt.key),ce=j(yt,ce,dt),Nt===null?et=yt:Nt.sibling=yt,Nt=yt);return a&&Xe.forEach(function(Aa){return i(me,Aa)}),vt&&Os(me,dt),et}function nt(me,ce,he,Ie){if(he==null)throw Error(r(151));for(var et=null,Nt=null,Xe=ce,dt=ce=0,yt=null,St=he.next();Xe!==null&&!St.done;dt++,St=he.next()){Xe.index>dt?(yt=Xe,Xe=null):yt=Xe.sibling;var Aa=ve(me,Xe,St.value,Ie);if(Aa===null){Xe===null&&(Xe=yt);break}a&&Xe&&Aa.alternate===null&&i(me,Xe),ce=j(Aa,ce,dt),Nt===null?et=Aa:Nt.sibling=Aa,Nt=Aa,Xe=yt}if(St.done)return o(me,Xe),vt&&Os(me,dt),et;if(Xe===null){for(;!St.done;dt++,St=he.next())St=_e(me,St.value,Ie),St!==null&&(ce=j(St,ce,dt),Nt===null?et=St:Nt.sibling=St,Nt=St);return vt&&Os(me,dt),et}for(Xe=p(Xe);!St.done;dt++,St=he.next())St=Te(Xe,me,dt,St.value,Ie),St!==null&&(a&&St.alternate!==null&&Xe.delete(St.key===null?dt:St.key),ce=j(St,ce,dt),Nt===null?et=St:Nt.sibling=St,Nt=St);return a&&Xe.forEach(function(cN){return i(me,cN)}),vt&&Os(me,dt),et}function Rt(me,ce,he,Ie){if(typeof he=="object"&&he!==null&&he.type===C&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case S:e:{for(var et=he.key;ce!==null;){if(ce.key===et){if(et=he.type,et===C){if(ce.tag===7){o(me,ce.sibling),Ie=b(ce,he.props.children),Ie.return=me,me=Ie;break e}}else if(ce.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===A&&Ya(et)===ce.type){o(me,ce.sibling),Ie=b(ce,he.props),Ni(Ie,he),Ie.return=me,me=Ie;break e}o(me,ce);break}else i(me,ce);ce=ce.sibling}he.type===C?(Ie=qa(he.props.children,me.mode,Ie,he.key),Ie.return=me,me=Ie):(Ie=kl(he.type,he.key,he.props,null,me.mode,Ie),Ni(Ie,he),Ie.return=me,me=Ie)}return k(me);case w:e:{for(et=he.key;ce!==null;){if(ce.key===et)if(ce.tag===4&&ce.stateNode.containerInfo===he.containerInfo&&ce.stateNode.implementation===he.implementation){o(me,ce.sibling),Ie=b(ce,he.children||[]),Ie.return=me,me=Ie;break e}else{o(me,ce);break}else i(me,ce);ce=ce.sibling}Ie=Fc(he,me.mode,Ie),Ie.return=me,me=Ie}return k(me);case A:return he=Ya(he),Rt(me,ce,he,Ie)}if(W(he))return We(me,ce,he,Ie);if(q(he)){if(et=q(he),typeof et!="function")throw Error(r(150));return he=et.call(he),nt(me,ce,he,Ie)}if(typeof he.then=="function")return Rt(me,ce,Fl(he),Ie);if(he.$$typeof===_)return Rt(me,ce,Pl(me,he),Ie);Bl(me,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ce!==null&&ce.tag===6?(o(me,ce.sibling),Ie=b(ce,he),Ie.return=me,me=Ie):(o(me,ce),Ie=Uc(he,me.mode,Ie),Ie.return=me,me=Ie),k(me)):o(me,ce)}return function(me,ce,he,Ie){try{bi=0;var et=Rt(me,ce,he,Ie);return br=null,et}catch(Xe){if(Xe===vr||Xe===Ol)throw Xe;var Nt=Bn(29,Xe,null,me.mode);return Nt.lanes=Ie,Nt.return=me,Nt}finally{}}}var Xa=If(!0),_f=If(!1),fa=!1;function Xc(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qc(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function pa(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ha(a,i,o){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(Ct&2)!==0){var b=p.pending;return b===null?i.next=i:(i.next=b.next,b.next=i),p.pending=i,i=Dl(a),mf(a,null,o),i}return Al(a,p,i,o),Dl(a)}function Si(a,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var p=i.lanes;p&=a.pendingLanes,o|=p,i.lanes=o,fl(a,o)}}function Zc(a,i){var o=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,o===p)){var b=null,j=null;if(o=o.firstBaseUpdate,o!==null){do{var k={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};j===null?b=j=k:j=j.next=k,o=o.next}while(o!==null);j===null?b=j=i:j=j.next=i}else b=j=i;o={baseState:p.baseState,firstBaseUpdate:b,lastBaseUpdate:j,shared:p.shared,callbacks:p.callbacks},a.updateQueue=o;return}a=o.lastBaseUpdate,a===null?o.firstBaseUpdate=i:a.next=i,o.lastBaseUpdate=i}var ed=!1;function ji(){if(ed){var a=yr;if(a!==null)throw a}}function Ti(a,i,o,p){ed=!1;var b=a.updateQueue;fa=!1;var j=b.firstBaseUpdate,k=b.lastBaseUpdate,V=b.shared.pending;if(V!==null){b.shared.pending=null;var re=V,ge=re.next;re.next=null,k===null?j=ge:k.next=ge,k=re;var Ee=a.alternate;Ee!==null&&(Ee=Ee.updateQueue,V=Ee.lastBaseUpdate,V!==k&&(V===null?Ee.firstBaseUpdate=ge:V.next=ge,Ee.lastBaseUpdate=re))}if(j!==null){var _e=b.baseState;k=0,Ee=ge=re=null,V=j;do{var ve=V.lane&-536870913,Te=ve!==V.lane;if(Te?(xt&ve)===ve:(p&ve)===ve){ve!==0&&ve===xr&&(ed=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var We=a,nt=V;ve=i;var Rt=o;switch(nt.tag){case 1:if(We=nt.payload,typeof We=="function"){_e=We.call(Rt,_e,ve);break e}_e=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=nt.payload,ve=typeof We=="function"?We.call(Rt,_e,ve):We,ve==null)break e;_e=v({},_e,ve);break e;case 2:fa=!0}}ve=V.callback,ve!==null&&(a.flags|=64,Te&&(a.flags|=8192),Te=b.callbacks,Te===null?b.callbacks=[ve]:Te.push(ve))}else Te={lane:ve,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Ee===null?(ge=Ee=Te,re=_e):Ee=Ee.next=Te,k|=ve;if(V=V.next,V===null){if(V=b.shared.pending,V===null)break;Te=V,V=Te.next,Te.next=null,b.lastBaseUpdate=Te,b.shared.pending=null}}while(!0);Ee===null&&(re=_e),b.baseState=re,b.firstBaseUpdate=ge,b.lastBaseUpdate=Ee,j===null&&(b.shared.lanes=0),ba|=k,a.lanes=k,a.memoizedState=_e}}function Af(a,i){if(typeof a!="function")throw Error(r(191,a));a.call(i)}function Df(a,i){var o=a.callbacks;if(o!==null)for(a.callbacks=null,a=0;a<o.length;a++)Af(o[a],i)}var Nr=H(null),Gl=H(0);function kf(a,i){a=Ws,ue(Gl,a),ue(Nr,i),Ws=a|i.baseLanes}function td(){ue(Gl,Ws),ue(Nr,Nr.current)}function nd(){Ws=Gl.current,ie(Nr),ie(Gl)}var Gn=H(null),ss=null;function ga(a){var i=a.alternate;ue(Zt,Zt.current&1),ue(Gn,a),ss===null&&(i===null||Nr.current!==null||i.memoizedState!==null)&&(ss=a)}function sd(a){ue(Zt,Zt.current),ue(Gn,a),ss===null&&(ss=a)}function Rf(a){a.tag===22?(ue(Zt,Zt.current),ue(Gn,a),ss===null&&(ss=a)):xa()}function xa(){ue(Zt,Zt.current),ue(Gn,Gn.current)}function zn(a){ie(Gn),ss===a&&(ss=null),ie(Zt)}var Zt=H(0);function zl(a){for(var i=a;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||cu(o)||du(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Bs=0,ct=null,Dt=null,sn=null,Hl=!1,Sr=!1,Qa=!1,ql=0,wi=0,jr=null,Zv=0;function Xt(){throw Error(r(321))}function ad(a,i){if(i===null)return!1;for(var o=0;o<i.length&&o<a.length;o++)if(!Fn(a[o],i[o]))return!1;return!0}function rd(a,i,o,p,b,j){return Bs=j,ct=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,G.H=a===null||a.memoizedState===null?gp:bd,Qa=!1,j=o(p,b),Qa=!1,Sr&&(j=Pf(i,o,p,b)),Mf(a),j}function Mf(a){G.H=Ii;var i=Dt!==null&&Dt.next!==null;if(Bs=0,sn=Dt=ct=null,Hl=!1,wi=0,jr=null,i)throw Error(r(300));a===null||an||(a=a.dependencies,a!==null&&Ml(a)&&(an=!0))}function Pf(a,i,o,p){ct=a;var b=0;do{if(Sr&&(jr=null),wi=0,Sr=!1,25<=b)throw Error(r(301));if(b+=1,sn=Dt=null,a.updateQueue!=null){var j=a.updateQueue;j.lastEffect=null,j.events=null,j.stores=null,j.memoCache!=null&&(j.memoCache.index=0)}G.H=xp,j=i(o,p)}while(Sr);return j}function eb(){var a=G.H,i=a.useState()[0];return i=typeof i.then=="function"?Ci(i):i,a=a.useState()[0],(Dt!==null?Dt.memoizedState:null)!==a&&(ct.flags|=1024),i}function id(){var a=ql!==0;return ql=0,a}function ld(a,i,o){i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~o}function od(a){if(Hl){for(a=a.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}Hl=!1}Bs=0,sn=Dt=ct=null,Sr=!1,wi=ql=0,jr=null}function En(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?ct.memoizedState=sn=a:sn=sn.next=a,sn}function en(){if(Dt===null){var a=ct.alternate;a=a!==null?a.memoizedState:null}else a=Dt.next;var i=sn===null?ct.memoizedState:sn.next;if(i!==null)sn=i,Dt=a;else{if(a===null)throw ct.alternate===null?Error(r(467)):Error(r(310));Dt=a,a={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},sn===null?ct.memoizedState=sn=a:sn=sn.next=a}return sn}function Vl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ci(a){var i=wi;return wi+=1,jr===null&&(jr=[]),a=wf(jr,a,i),i=ct,(sn===null?i.memoizedState:sn.next)===null&&(i=i.alternate,G.H=i===null||i.memoizedState===null?gp:bd),a}function Kl(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ci(a);if(a.$$typeof===_)return Nn(a)}throw Error(r(438,String(a)))}function cd(a){var i=null,o=ct.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var p=ct.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(i={data:p.data.map(function(b){return b.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Vl(),ct.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(a),p=0;p<a;p++)o[p]=P;return i.index++,o}function Gs(a,i){return typeof i=="function"?i(a):i}function $l(a){var i=en();return dd(i,Dt,a)}function dd(a,i,o){var p=a.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=o;var b=a.baseQueue,j=p.pending;if(j!==null){if(b!==null){var k=b.next;b.next=j.next,j.next=k}i.baseQueue=b=j,p.pending=null}if(j=a.baseState,b===null)a.memoizedState=j;else{i=b.next;var V=k=null,re=null,ge=i,Ee=!1;do{var _e=ge.lane&-536870913;if(_e!==ge.lane?(xt&_e)===_e:(Bs&_e)===_e){var ve=ge.revertLane;if(ve===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),_e===xr&&(Ee=!0);else if((Bs&ve)===ve){ge=ge.next,ve===xr&&(Ee=!0);continue}else _e={lane:0,revertLane:ge.revertLane,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},re===null?(V=re=_e,k=j):re=re.next=_e,ct.lanes|=ve,ba|=ve;_e=ge.action,Qa&&o(j,_e),j=ge.hasEagerState?ge.eagerState:o(j,_e)}else ve={lane:_e,revertLane:ge.revertLane,gesture:ge.gesture,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},re===null?(V=re=ve,k=j):re=re.next=ve,ct.lanes|=_e,ba|=_e;ge=ge.next}while(ge!==null&&ge!==i);if(re===null?k=j:re.next=V,!Fn(j,a.memoizedState)&&(an=!0,Ee&&(o=yr,o!==null)))throw o;a.memoizedState=j,a.baseState=k,a.baseQueue=re,p.lastRenderedState=j}return b===null&&(p.lanes=0),[a.memoizedState,p.dispatch]}function ud(a){var i=en(),o=i.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=a;var p=o.dispatch,b=o.pending,j=i.memoizedState;if(b!==null){o.pending=null;var k=b=b.next;do j=a(j,k.action),k=k.next;while(k!==b);Fn(j,i.memoizedState)||(an=!0),i.memoizedState=j,i.baseQueue===null&&(i.baseState=j),o.lastRenderedState=j}return[j,p]}function Lf(a,i,o){var p=ct,b=en(),j=vt;if(j){if(o===void 0)throw Error(r(407));o=o()}else o=i();var k=!Fn((Dt||b).memoizedState,o);if(k&&(b.memoizedState=o,an=!0),b=b.queue,pd(Ff.bind(null,p,b,a),[a]),b.getSnapshot!==i||k||sn!==null&&sn.memoizedState.tag&1){if(p.flags|=2048,Tr(9,{destroy:void 0},Uf.bind(null,p,b,o,i),null),Lt===null)throw Error(r(349));j||(Bs&127)!==0||Of(p,i,o)}return o}function Of(a,i,o){a.flags|=16384,a={getSnapshot:i,value:o},i=ct.updateQueue,i===null?(i=Vl(),ct.updateQueue=i,i.stores=[a]):(o=i.stores,o===null?i.stores=[a]:o.push(a))}function Uf(a,i,o,p){i.value=o,i.getSnapshot=p,Bf(i)&&Gf(a)}function Ff(a,i,o){return o(function(){Bf(i)&&Gf(a)})}function Bf(a){var i=a.getSnapshot;a=a.value;try{var o=i();return!Fn(a,o)}catch{return!0}}function Gf(a){var i=Ha(a,2);i!==null&&Ln(i,a,2)}function md(a){var i=En();if(typeof a=="function"){var o=a;if(a=o(),Qa){bt(!0);try{o()}finally{bt(!1)}}}return i.memoizedState=i.baseState=a,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:a},i}function zf(a,i,o,p){return a.baseState=o,dd(a,Dt,typeof p=="function"?p:Gs)}function tb(a,i,o,p,b){if(Jl(a))throw Error(r(485));if(a=i.action,a!==null){var j={payload:b,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){j.listeners.push(k)}};G.T!==null?o(!0):j.isTransition=!1,p(j),o=i.pending,o===null?(j.next=i.pending=j,Hf(i,j)):(j.next=o.next,i.pending=o.next=j)}}function Hf(a,i){var o=i.action,p=i.payload,b=a.state;if(i.isTransition){var j=G.T,k={};G.T=k;try{var V=o(b,p),re=G.S;re!==null&&re(k,V),qf(a,i,V)}catch(ge){fd(a,i,ge)}finally{j!==null&&k.types!==null&&(j.types=k.types),G.T=j}}else try{j=o(b,p),qf(a,i,j)}catch(ge){fd(a,i,ge)}}function qf(a,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(p){Vf(a,i,p)},function(p){return fd(a,i,p)}):Vf(a,i,o)}function Vf(a,i,o){i.status="fulfilled",i.value=o,Kf(i),a.state=o,i=a.pending,i!==null&&(o=i.next,o===i?a.pending=null:(o=o.next,i.next=o,Hf(a,o)))}function fd(a,i,o){var p=a.pending;if(a.pending=null,p!==null){p=p.next;do i.status="rejected",i.reason=o,Kf(i),i=i.next;while(i!==p)}a.action=null}function Kf(a){a=a.listeners;for(var i=0;i<a.length;i++)(0,a[i])()}function $f(a,i){return i}function Wf(a,i){if(vt){var o=Lt.formState;if(o!==null){e:{var p=ct;if(vt){if(Ft){t:{for(var b=Ft,j=ns;b.nodeType!==8;){if(!j){b=null;break t}if(b=as(b.nextSibling),b===null){b=null;break t}}j=b.data,b=j==="F!"||j==="F"?b:null}if(b){Ft=as(b.nextSibling),p=b.data==="F!";break e}}ua(p)}p=!1}p&&(i=o[0])}}return o=En(),o.memoizedState=o.baseState=i,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$f,lastRenderedState:i},o.queue=p,o=fp.bind(null,ct,p),p.dispatch=o,p=md(!1),j=vd.bind(null,ct,!1,p.queue),p=En(),b={state:i,dispatch:null,action:a,pending:null},p.queue=b,o=tb.bind(null,ct,b,j,o),b.dispatch=o,p.memoizedState=a,[i,o,!1]}function Yf(a){var i=en();return Jf(i,Dt,a)}function Jf(a,i,o){if(i=dd(a,i,$f)[0],a=$l(Gs)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var p=Ci(i)}catch(k){throw k===vr?Ol:k}else p=i;i=en();var b=i.queue,j=b.dispatch;return o!==i.memoizedState&&(ct.flags|=2048,Tr(9,{destroy:void 0},nb.bind(null,b,o),null)),[p,j,a]}function nb(a,i){a.action=i}function Xf(a){var i=en(),o=Dt;if(o!==null)return Jf(i,o,a);en(),i=i.memoizedState,o=en();var p=o.queue.dispatch;return o.memoizedState=a,[i,p,!1]}function Tr(a,i,o,p){return a={tag:a,create:o,deps:p,inst:i,next:null},i=ct.updateQueue,i===null&&(i=Vl(),ct.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=a.next=a:(p=o.next,o.next=a,a.next=p,i.lastEffect=a),a}function Qf(){return en().memoizedState}function Wl(a,i,o,p){var b=En();ct.flags|=a,b.memoizedState=Tr(1|i,{destroy:void 0},o,p===void 0?null:p)}function Yl(a,i,o,p){var b=en();p=p===void 0?null:p;var j=b.memoizedState.inst;Dt!==null&&p!==null&&ad(p,Dt.memoizedState.deps)?b.memoizedState=Tr(i,j,o,p):(ct.flags|=a,b.memoizedState=Tr(1|i,j,o,p))}function Zf(a,i){Wl(8390656,8,a,i)}function pd(a,i){Yl(2048,8,a,i)}function sb(a){ct.flags|=4;var i=ct.updateQueue;if(i===null)i=Vl(),ct.updateQueue=i,i.events=[a];else{var o=i.events;o===null?i.events=[a]:o.push(a)}}function ep(a){var i=en().memoizedState;return sb({ref:i,nextImpl:a}),function(){if((Ct&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function tp(a,i){return Yl(4,2,a,i)}function np(a,i){return Yl(4,4,a,i)}function sp(a,i){if(typeof i=="function"){a=a();var o=i(a);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function ap(a,i,o){o=o!=null?o.concat([a]):null,Yl(4,4,sp.bind(null,i,a),o)}function hd(){}function rp(a,i){var o=en();i=i===void 0?null:i;var p=o.memoizedState;return i!==null&&ad(i,p[1])?p[0]:(o.memoizedState=[a,i],a)}function ip(a,i){var o=en();i=i===void 0?null:i;var p=o.memoizedState;if(i!==null&&ad(i,p[1]))return p[0];if(p=a(),Qa){bt(!0);try{a()}finally{bt(!1)}}return o.memoizedState=[p,i],p}function gd(a,i,o){return o===void 0||(Bs&1073741824)!==0&&(xt&261930)===0?a.memoizedState=i:(a.memoizedState=o,a=lh(),ct.lanes|=a,ba|=a,o)}function lp(a,i,o,p){return Fn(o,i)?o:Nr.current!==null?(a=gd(a,o,p),Fn(a,i)||(an=!0),a):(Bs&42)===0||(Bs&1073741824)!==0&&(xt&261930)===0?(an=!0,a.memoizedState=o):(a=lh(),ct.lanes|=a,ba|=a,i)}function op(a,i,o,p,b){var j=B.p;B.p=j!==0&&8>j?j:8;var k=G.T,V={};G.T=V,vd(a,!1,i,o);try{var re=b(),ge=G.S;if(ge!==null&&ge(V,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ee=Qv(re,p);Ei(a,i,Ee,Vn(a))}else Ei(a,i,p,Vn(a))}catch(_e){Ei(a,i,{then:function(){},status:"rejected",reason:_e},Vn())}finally{B.p=j,k!==null&&V.types!==null&&(k.types=V.types),G.T=k}}function ab(){}function xd(a,i,o,p){if(a.tag!==5)throw Error(r(476));var b=cp(a).queue;op(a,b,i,X,o===null?ab:function(){return dp(a),o(p)})}function cp(a){var i=a.memoizedState;if(i!==null)return i;i={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:X},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:o},next:null},a.memoizedState=i,a=a.alternate,a!==null&&(a.memoizedState=i),i}function dp(a){var i=cp(a);i.next===null&&(i=a.alternate.memoizedState),Ei(a,i.next.queue,{},Vn())}function yd(){return Nn(qi)}function up(){return en().memoizedState}function mp(){return en().memoizedState}function rb(a){for(var i=a.return;i!==null;){switch(i.tag){case 24:case 3:var o=Vn();a=pa(o);var p=ha(i,a,o);p!==null&&(Ln(p,i,o),Si(p,i,o)),i={cache:$c()},a.payload=i;return}i=i.return}}function ib(a,i,o){var p=Vn();o={lane:p,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Jl(a)?pp(i,o):(o=Lc(a,i,o,p),o!==null&&(Ln(o,a,p),hp(o,i,p)))}function fp(a,i,o){var p=Vn();Ei(a,i,o,p)}function Ei(a,i,o,p){var b={lane:p,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Jl(a))pp(i,b);else{var j=a.alternate;if(a.lanes===0&&(j===null||j.lanes===0)&&(j=i.lastRenderedReducer,j!==null))try{var k=i.lastRenderedState,V=j(k,o);if(b.hasEagerState=!0,b.eagerState=V,Fn(V,k))return Al(a,i,b,0),Lt===null&&_l(),!1}catch{}finally{}if(o=Lc(a,i,b,p),o!==null)return Ln(o,a,p),hp(o,i,p),!0}return!1}function vd(a,i,o,p){if(p={lane:2,revertLane:Xd(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Jl(a)){if(i)throw Error(r(479))}else i=Lc(a,o,p,2),i!==null&&Ln(i,a,2)}function Jl(a){var i=a.alternate;return a===ct||i!==null&&i===ct}function pp(a,i){Sr=Hl=!0;var o=a.pending;o===null?i.next=i:(i.next=o.next,o.next=i),a.pending=i}function hp(a,i,o){if((o&4194048)!==0){var p=i.lanes;p&=a.pendingLanes,o|=p,i.lanes=o,fl(a,o)}}var Ii={readContext:Nn,use:Kl,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useLayoutEffect:Xt,useInsertionEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useSyncExternalStore:Xt,useId:Xt,useHostTransitionStatus:Xt,useFormState:Xt,useActionState:Xt,useOptimistic:Xt,useMemoCache:Xt,useCacheRefresh:Xt};Ii.useEffectEvent=Xt;var gp={readContext:Nn,use:Kl,useCallback:function(a,i){return En().memoizedState=[a,i===void 0?null:i],a},useContext:Nn,useEffect:Zf,useImperativeHandle:function(a,i,o){o=o!=null?o.concat([a]):null,Wl(4194308,4,sp.bind(null,i,a),o)},useLayoutEffect:function(a,i){return Wl(4194308,4,a,i)},useInsertionEffect:function(a,i){Wl(4,2,a,i)},useMemo:function(a,i){var o=En();i=i===void 0?null:i;var p=a();if(Qa){bt(!0);try{a()}finally{bt(!1)}}return o.memoizedState=[p,i],p},useReducer:function(a,i,o){var p=En();if(o!==void 0){var b=o(i);if(Qa){bt(!0);try{o(i)}finally{bt(!1)}}}else b=i;return p.memoizedState=p.baseState=b,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b},p.queue=a,a=a.dispatch=ib.bind(null,ct,a),[p.memoizedState,a]},useRef:function(a){var i=En();return a={current:a},i.memoizedState=a},useState:function(a){a=md(a);var i=a.queue,o=fp.bind(null,ct,i);return i.dispatch=o,[a.memoizedState,o]},useDebugValue:hd,useDeferredValue:function(a,i){var o=En();return gd(o,a,i)},useTransition:function(){var a=md(!1);return a=op.bind(null,ct,a.queue,!0,!1),En().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,i,o){var p=ct,b=En();if(vt){if(o===void 0)throw Error(r(407));o=o()}else{if(o=i(),Lt===null)throw Error(r(349));(xt&127)!==0||Of(p,i,o)}b.memoizedState=o;var j={value:o,getSnapshot:i};return b.queue=j,Zf(Ff.bind(null,p,j,a),[a]),p.flags|=2048,Tr(9,{destroy:void 0},Uf.bind(null,p,j,o,i),null),o},useId:function(){var a=En(),i=Lt.identifierPrefix;if(vt){var o=Cs,p=ws;o=(p&~(1<<32-st(p)-1)).toString(32)+o,i="_"+i+"R_"+o,o=ql++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=Zv++,i="_"+i+"r_"+o.toString(32)+"_";return a.memoizedState=i},useHostTransitionStatus:yd,useFormState:Wf,useActionState:Wf,useOptimistic:function(a){var i=En();i.memoizedState=i.baseState=a;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=vd.bind(null,ct,!0,o),o.dispatch=i,[a,i]},useMemoCache:cd,useCacheRefresh:function(){return En().memoizedState=rb.bind(null,ct)},useEffectEvent:function(a){var i=En(),o={impl:a};return i.memoizedState=o,function(){if((Ct&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},bd={readContext:Nn,use:Kl,useCallback:rp,useContext:Nn,useEffect:pd,useImperativeHandle:ap,useInsertionEffect:tp,useLayoutEffect:np,useMemo:ip,useReducer:$l,useRef:Qf,useState:function(){return $l(Gs)},useDebugValue:hd,useDeferredValue:function(a,i){var o=en();return lp(o,Dt.memoizedState,a,i)},useTransition:function(){var a=$l(Gs)[0],i=en().memoizedState;return[typeof a=="boolean"?a:Ci(a),i]},useSyncExternalStore:Lf,useId:up,useHostTransitionStatus:yd,useFormState:Yf,useActionState:Yf,useOptimistic:function(a,i){var o=en();return zf(o,Dt,a,i)},useMemoCache:cd,useCacheRefresh:mp};bd.useEffectEvent=ep;var xp={readContext:Nn,use:Kl,useCallback:rp,useContext:Nn,useEffect:pd,useImperativeHandle:ap,useInsertionEffect:tp,useLayoutEffect:np,useMemo:ip,useReducer:ud,useRef:Qf,useState:function(){return ud(Gs)},useDebugValue:hd,useDeferredValue:function(a,i){var o=en();return Dt===null?gd(o,a,i):lp(o,Dt.memoizedState,a,i)},useTransition:function(){var a=ud(Gs)[0],i=en().memoizedState;return[typeof a=="boolean"?a:Ci(a),i]},useSyncExternalStore:Lf,useId:up,useHostTransitionStatus:yd,useFormState:Xf,useActionState:Xf,useOptimistic:function(a,i){var o=en();return Dt!==null?zf(o,Dt,a,i):(o.baseState=a,[a,o.queue.dispatch])},useMemoCache:cd,useCacheRefresh:mp};xp.useEffectEvent=ep;function Nd(a,i,o,p){i=a.memoizedState,o=o(p,i),o=o==null?i:v({},i,o),a.memoizedState=o,a.lanes===0&&(a.updateQueue.baseState=o)}var Sd={enqueueSetState:function(a,i,o){a=a._reactInternals;var p=Vn(),b=pa(p);b.payload=i,o!=null&&(b.callback=o),i=ha(a,b,p),i!==null&&(Ln(i,a,p),Si(i,a,p))},enqueueReplaceState:function(a,i,o){a=a._reactInternals;var p=Vn(),b=pa(p);b.tag=1,b.payload=i,o!=null&&(b.callback=o),i=ha(a,b,p),i!==null&&(Ln(i,a,p),Si(i,a,p))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var o=Vn(),p=pa(o);p.tag=2,i!=null&&(p.callback=i),i=ha(a,p,o),i!==null&&(Ln(i,a,o),Si(i,a,o))}};function yp(a,i,o,p,b,j,k){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,j,k):i.prototype&&i.prototype.isPureReactComponent?!pi(o,p)||!pi(b,j):!0}function vp(a,i,o,p){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,p),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,p),i.state!==a&&Sd.enqueueReplaceState(i,i.state,null)}function Za(a,i){var o=i;if("ref"in i){o={};for(var p in i)p!=="ref"&&(o[p]=i[p])}if(a=a.defaultProps){o===i&&(o=v({},o));for(var b in a)o[b]===void 0&&(o[b]=a[b])}return o}function bp(a){Il(a)}function Np(a){console.error(a)}function Sp(a){Il(a)}function Xl(a,i){try{var o=a.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(p){setTimeout(function(){throw p})}}function jp(a,i,o){try{var p=a.onCaughtError;p(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function jd(a,i,o){return o=pa(o),o.tag=3,o.payload={element:null},o.callback=function(){Xl(a,i)},o}function Tp(a){return a=pa(a),a.tag=3,a}function wp(a,i,o,p){var b=o.type.getDerivedStateFromError;if(typeof b=="function"){var j=p.value;a.payload=function(){return b(j)},a.callback=function(){jp(i,o,p)}}var k=o.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(a.callback=function(){jp(i,o,p),typeof b!="function"&&(Na===null?Na=new Set([this]):Na.add(this));var V=p.stack;this.componentDidCatch(p.value,{componentStack:V!==null?V:""})})}function lb(a,i,o,p,b){if(o.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(i=o.alternate,i!==null&&gr(i,o,b,!0),o=Gn.current,o!==null){switch(o.tag){case 31:case 13:return ss===null?co():o.alternate===null&&Qt===0&&(Qt=3),o.flags&=-257,o.flags|=65536,o.lanes=b,p===Ul?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([p]):i.add(p),Wd(a,p,b)),!1;case 22:return o.flags|=65536,p===Ul?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([p])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([p]):o.add(p)),Wd(a,p,b)),!1}throw Error(r(435,o.tag))}return Wd(a,p,b),co(),!1}if(vt)return i=Gn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=b,p!==zc&&(a=Error(r(422),{cause:p}),xi(Zn(a,o)))):(p!==zc&&(i=Error(r(423),{cause:p}),xi(Zn(i,o))),a=a.current.alternate,a.flags|=65536,b&=-b,a.lanes|=b,p=Zn(p,o),b=jd(a.stateNode,p,b),Zc(a,b),Qt!==4&&(Qt=2)),!1;var j=Error(r(520),{cause:p});if(j=Zn(j,o),Li===null?Li=[j]:Li.push(j),Qt!==4&&(Qt=2),i===null)return!0;p=Zn(p,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,a=b&-b,o.lanes|=a,a=jd(o.stateNode,p,a),Zc(o,a),!1;case 1:if(i=o.type,j=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Na===null||!Na.has(j))))return o.flags|=65536,b&=-b,o.lanes|=b,b=Tp(b),wp(b,a,o,p),Zc(o,b),!1}o=o.return}while(o!==null);return!1}var Td=Error(r(461)),an=!1;function Sn(a,i,o,p){i.child=a===null?_f(i,null,o,p):Xa(i,a.child,o,p)}function Cp(a,i,o,p,b){o=o.render;var j=i.ref;if("ref"in p){var k={};for(var V in p)V!=="ref"&&(k[V]=p[V])}else k=p;return $a(i),p=rd(a,i,o,k,j,b),V=id(),a!==null&&!an?(ld(a,i,b),zs(a,i,b)):(vt&&V&&Bc(i),i.flags|=1,Sn(a,i,p,b),i.child)}function Ep(a,i,o,p,b){if(a===null){var j=o.type;return typeof j=="function"&&!Oc(j)&&j.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=j,Ip(a,i,j,p,b)):(a=kl(o.type,null,p,i,i.mode,b),a.ref=i.ref,a.return=i,i.child=a)}if(j=a.child,!kd(a,b)){var k=j.memoizedProps;if(o=o.compare,o=o!==null?o:pi,o(k,p)&&a.ref===i.ref)return zs(a,i,b)}return i.flags|=1,a=Ls(j,p),a.ref=i.ref,a.return=i,i.child=a}function Ip(a,i,o,p,b){if(a!==null){var j=a.memoizedProps;if(pi(j,p)&&a.ref===i.ref)if(an=!1,i.pendingProps=p=j,kd(a,b))(a.flags&131072)!==0&&(an=!0);else return i.lanes=a.lanes,zs(a,i,b)}return wd(a,i,o,p,b)}function _p(a,i,o,p){var b=p.children,j=a!==null?a.memoizedState:null;if(a===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((i.flags&128)!==0){if(j=j!==null?j.baseLanes|o:o,a!==null){for(p=i.child=a.child,b=0;p!==null;)b=b|p.lanes|p.childLanes,p=p.sibling;p=b&~j}else p=0,i.child=null;return Ap(a,i,j,o,p)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},a!==null&&Ll(i,j!==null?j.cachePool:null),j!==null?kf(i,j):td(),Rf(i);else return p=i.lanes=536870912,Ap(a,i,j!==null?j.baseLanes|o:o,o,p)}else j!==null?(Ll(i,j.cachePool),kf(i,j),xa(),i.memoizedState=null):(a!==null&&Ll(i,null),td(),xa());return Sn(a,i,b,o),i.child}function _i(a,i){return a!==null&&a.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Ap(a,i,o,p,b){var j=Yc();return j=j===null?null:{parent:nn._currentValue,pool:j},i.memoizedState={baseLanes:o,cachePool:j},a!==null&&Ll(i,null),td(),Rf(i),a!==null&&gr(a,i,p,!0),i.childLanes=b,null}function Ql(a,i){return i=eo({mode:i.mode,children:i.children},a.mode),i.ref=a.ref,a.child=i,i.return=a,i}function Dp(a,i,o){return Xa(i,a.child,null,o),a=Ql(i,i.pendingProps),a.flags|=2,zn(i),i.memoizedState=null,a}function ob(a,i,o){var p=i.pendingProps,b=(i.flags&128)!==0;if(i.flags&=-129,a===null){if(vt){if(p.mode==="hidden")return a=Ql(i,p),i.lanes=536870912,_i(null,a);if(sd(i),(a=Ft)?(a=Hh(a,ns),a=a!==null&&a.data==="&"?a:null,a!==null&&(i.memoizedState={dehydrated:a,treeContext:ca!==null?{id:ws,overflow:Cs}:null,retryLane:536870912,hydrationErrors:null},o=pf(a),o.return=i,i.child=o,bn=i,Ft=null)):a=null,a===null)throw ua(i);return i.lanes=536870912,null}return Ql(i,p)}var j=a.memoizedState;if(j!==null){var k=j.dehydrated;if(sd(i),b)if(i.flags&256)i.flags&=-257,i=Dp(a,i,o);else if(i.memoizedState!==null)i.child=a.child,i.flags|=128,i=null;else throw Error(r(558));else if(an||gr(a,i,o,!1),b=(o&a.childLanes)!==0,an||b){if(p=Lt,p!==null&&(k=pl(p,o),k!==0&&k!==j.retryLane))throw j.retryLane=k,Ha(a,k),Ln(p,a,k),Td;co(),i=Dp(a,i,o)}else a=j.treeContext,Ft=as(k.nextSibling),bn=i,vt=!0,da=null,ns=!1,a!==null&&xf(i,a),i=Ql(i,p),i.flags|=4096;return i}return a=Ls(a.child,{mode:p.mode,children:p.children}),a.ref=i.ref,i.child=a,a.return=i,a}function Zl(a,i){var o=i.ref;if(o===null)a!==null&&a.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(a===null||a.ref!==o)&&(i.flags|=4194816)}}function wd(a,i,o,p,b){return $a(i),o=rd(a,i,o,p,void 0,b),p=id(),a!==null&&!an?(ld(a,i,b),zs(a,i,b)):(vt&&p&&Bc(i),i.flags|=1,Sn(a,i,o,b),i.child)}function kp(a,i,o,p,b,j){return $a(i),i.updateQueue=null,o=Pf(i,p,o,b),Mf(a),p=id(),a!==null&&!an?(ld(a,i,j),zs(a,i,j)):(vt&&p&&Bc(i),i.flags|=1,Sn(a,i,o,j),i.child)}function Rp(a,i,o,p,b){if($a(i),i.stateNode===null){var j=mr,k=o.contextType;typeof k=="object"&&k!==null&&(j=Nn(k)),j=new o(p,j),i.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=Sd,i.stateNode=j,j._reactInternals=i,j=i.stateNode,j.props=p,j.state=i.memoizedState,j.refs={},Xc(i),k=o.contextType,j.context=typeof k=="object"&&k!==null?Nn(k):mr,j.state=i.memoizedState,k=o.getDerivedStateFromProps,typeof k=="function"&&(Nd(i,o,k,p),j.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(k=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),k!==j.state&&Sd.enqueueReplaceState(j,j.state,null),Ti(i,p,j,b),ji(),j.state=i.memoizedState),typeof j.componentDidMount=="function"&&(i.flags|=4194308),p=!0}else if(a===null){j=i.stateNode;var V=i.memoizedProps,re=Za(o,V);j.props=re;var ge=j.context,Ee=o.contextType;k=mr,typeof Ee=="object"&&Ee!==null&&(k=Nn(Ee));var _e=o.getDerivedStateFromProps;Ee=typeof _e=="function"||typeof j.getSnapshotBeforeUpdate=="function",V=i.pendingProps!==V,Ee||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(V||ge!==k)&&vp(i,j,p,k),fa=!1;var ve=i.memoizedState;j.state=ve,Ti(i,p,j,b),ji(),ge=i.memoizedState,V||ve!==ge||fa?(typeof _e=="function"&&(Nd(i,o,_e,p),ge=i.memoizedState),(re=fa||yp(i,o,re,p,ve,ge,k))?(Ee||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(i.flags|=4194308)):(typeof j.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=p,i.memoizedState=ge),j.props=p,j.state=ge,j.context=k,p=re):(typeof j.componentDidMount=="function"&&(i.flags|=4194308),p=!1)}else{j=i.stateNode,Qc(a,i),k=i.memoizedProps,Ee=Za(o,k),j.props=Ee,_e=i.pendingProps,ve=j.context,ge=o.contextType,re=mr,typeof ge=="object"&&ge!==null&&(re=Nn(ge)),V=o.getDerivedStateFromProps,(ge=typeof V=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(k!==_e||ve!==re)&&vp(i,j,p,re),fa=!1,ve=i.memoizedState,j.state=ve,Ti(i,p,j,b),ji();var Te=i.memoizedState;k!==_e||ve!==Te||fa||a!==null&&a.dependencies!==null&&Ml(a.dependencies)?(typeof V=="function"&&(Nd(i,o,V,p),Te=i.memoizedState),(Ee=fa||yp(i,o,Ee,p,ve,Te,re)||a!==null&&a.dependencies!==null&&Ml(a.dependencies))?(ge||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(p,Te,re),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(p,Te,re)),typeof j.componentDidUpdate=="function"&&(i.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof j.componentDidUpdate!="function"||k===a.memoizedProps&&ve===a.memoizedState||(i.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&ve===a.memoizedState||(i.flags|=1024),i.memoizedProps=p,i.memoizedState=Te),j.props=p,j.state=Te,j.context=re,p=Ee):(typeof j.componentDidUpdate!="function"||k===a.memoizedProps&&ve===a.memoizedState||(i.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||k===a.memoizedProps&&ve===a.memoizedState||(i.flags|=1024),p=!1)}return j=p,Zl(a,i),p=(i.flags&128)!==0,j||p?(j=i.stateNode,o=p&&typeof o.getDerivedStateFromError!="function"?null:j.render(),i.flags|=1,a!==null&&p?(i.child=Xa(i,a.child,null,b),i.child=Xa(i,null,o,b)):Sn(a,i,o,b),i.memoizedState=j.state,a=i.child):a=zs(a,i,b),a}function Mp(a,i,o,p){return Va(),i.flags|=256,Sn(a,i,o,p),i.child}var Cd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ed(a){return{baseLanes:a,cachePool:jf()}}function Id(a,i,o){return a=a!==null?a.childLanes&~o:0,i&&(a|=qn),a}function Pp(a,i,o){var p=i.pendingProps,b=!1,j=(i.flags&128)!==0,k;if((k=j)||(k=a!==null&&a.memoizedState===null?!1:(Zt.current&2)!==0),k&&(b=!0,i.flags&=-129),k=(i.flags&32)!==0,i.flags&=-33,a===null){if(vt){if(b?ga(i):xa(),(a=Ft)?(a=Hh(a,ns),a=a!==null&&a.data!=="&"?a:null,a!==null&&(i.memoizedState={dehydrated:a,treeContext:ca!==null?{id:ws,overflow:Cs}:null,retryLane:536870912,hydrationErrors:null},o=pf(a),o.return=i,i.child=o,bn=i,Ft=null)):a=null,a===null)throw ua(i);return du(a)?i.lanes=32:i.lanes=536870912,null}var V=p.children;return p=p.fallback,b?(xa(),b=i.mode,V=eo({mode:"hidden",children:V},b),p=qa(p,b,o,null),V.return=i,p.return=i,V.sibling=p,i.child=V,p=i.child,p.memoizedState=Ed(o),p.childLanes=Id(a,k,o),i.memoizedState=Cd,_i(null,p)):(ga(i),_d(i,V))}var re=a.memoizedState;if(re!==null&&(V=re.dehydrated,V!==null)){if(j)i.flags&256?(ga(i),i.flags&=-257,i=Ad(a,i,o)):i.memoizedState!==null?(xa(),i.child=a.child,i.flags|=128,i=null):(xa(),V=p.fallback,b=i.mode,p=eo({mode:"visible",children:p.children},b),V=qa(V,b,o,null),V.flags|=2,p.return=i,V.return=i,p.sibling=V,i.child=p,Xa(i,a.child,null,o),p=i.child,p.memoizedState=Ed(o),p.childLanes=Id(a,k,o),i.memoizedState=Cd,i=_i(null,p));else if(ga(i),du(V)){if(k=V.nextSibling&&V.nextSibling.dataset,k)var ge=k.dgst;k=ge,p=Error(r(419)),p.stack="",p.digest=k,xi({value:p,source:null,stack:null}),i=Ad(a,i,o)}else if(an||gr(a,i,o,!1),k=(o&a.childLanes)!==0,an||k){if(k=Lt,k!==null&&(p=pl(k,o),p!==0&&p!==re.retryLane))throw re.retryLane=p,Ha(a,p),Ln(k,a,p),Td;cu(V)||co(),i=Ad(a,i,o)}else cu(V)?(i.flags|=192,i.child=a.child,i=null):(a=re.treeContext,Ft=as(V.nextSibling),bn=i,vt=!0,da=null,ns=!1,a!==null&&xf(i,a),i=_d(i,p.children),i.flags|=4096);return i}return b?(xa(),V=p.fallback,b=i.mode,re=a.child,ge=re.sibling,p=Ls(re,{mode:"hidden",children:p.children}),p.subtreeFlags=re.subtreeFlags&65011712,ge!==null?V=Ls(ge,V):(V=qa(V,b,o,null),V.flags|=2),V.return=i,p.return=i,p.sibling=V,i.child=p,_i(null,p),p=i.child,V=a.child.memoizedState,V===null?V=Ed(o):(b=V.cachePool,b!==null?(re=nn._currentValue,b=b.parent!==re?{parent:re,pool:re}:b):b=jf(),V={baseLanes:V.baseLanes|o,cachePool:b}),p.memoizedState=V,p.childLanes=Id(a,k,o),i.memoizedState=Cd,_i(a.child,p)):(ga(i),o=a.child,a=o.sibling,o=Ls(o,{mode:"visible",children:p.children}),o.return=i,o.sibling=null,a!==null&&(k=i.deletions,k===null?(i.deletions=[a],i.flags|=16):k.push(a)),i.child=o,i.memoizedState=null,o)}function _d(a,i){return i=eo({mode:"visible",children:i},a.mode),i.return=a,a.child=i}function eo(a,i){return a=Bn(22,a,null,i),a.lanes=0,a}function Ad(a,i,o){return Xa(i,a.child,null,o),a=_d(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function Lp(a,i,o){a.lanes|=i;var p=a.alternate;p!==null&&(p.lanes|=i),Vc(a.return,i,o)}function Dd(a,i,o,p,b,j){var k=a.memoizedState;k===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:p,tail:o,tailMode:b,treeForkCount:j}:(k.isBackwards=i,k.rendering=null,k.renderingStartTime=0,k.last=p,k.tail=o,k.tailMode=b,k.treeForkCount=j)}function Op(a,i,o){var p=i.pendingProps,b=p.revealOrder,j=p.tail;p=p.children;var k=Zt.current,V=(k&2)!==0;if(V?(k=k&1|2,i.flags|=128):k&=1,ue(Zt,k),Sn(a,i,p,o),p=vt?gi:0,!V&&a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Lp(a,o,i);else if(a.tag===19)Lp(a,o,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(b){case"forwards":for(o=i.child,b=null;o!==null;)a=o.alternate,a!==null&&zl(a)===null&&(b=o),o=o.sibling;o=b,o===null?(b=i.child,i.child=null):(b=o.sibling,o.sibling=null),Dd(i,!1,b,o,j,p);break;case"backwards":case"unstable_legacy-backwards":for(o=null,b=i.child,i.child=null;b!==null;){if(a=b.alternate,a!==null&&zl(a)===null){i.child=b;break}a=b.sibling,b.sibling=o,o=b,b=a}Dd(i,!0,o,null,j,p);break;case"together":Dd(i,!1,null,null,void 0,p);break;default:i.memoizedState=null}return i.child}function zs(a,i,o){if(a!==null&&(i.dependencies=a.dependencies),ba|=i.lanes,(o&i.childLanes)===0)if(a!==null){if(gr(a,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(a!==null&&i.child!==a.child)throw Error(r(153));if(i.child!==null){for(a=i.child,o=Ls(a,a.pendingProps),i.child=o,o.return=i;a.sibling!==null;)a=a.sibling,o=o.sibling=Ls(a,a.pendingProps),o.return=i;o.sibling=null}return i.child}function kd(a,i){return(a.lanes&i)!==0?!0:(a=a.dependencies,!!(a!==null&&Ml(a)))}function cb(a,i,o){switch(i.tag){case 3:fe(i,i.stateNode.containerInfo),ma(i,nn,a.memoizedState.cache),Va();break;case 27:case 5:ee(i);break;case 4:fe(i,i.stateNode.containerInfo);break;case 10:ma(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,sd(i),null;break;case 13:var p=i.memoizedState;if(p!==null)return p.dehydrated!==null?(ga(i),i.flags|=128,null):(o&i.child.childLanes)!==0?Pp(a,i,o):(ga(i),a=zs(a,i,o),a!==null?a.sibling:null);ga(i);break;case 19:var b=(a.flags&128)!==0;if(p=(o&i.childLanes)!==0,p||(gr(a,i,o,!1),p=(o&i.childLanes)!==0),b){if(p)return Op(a,i,o);i.flags|=128}if(b=i.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),ue(Zt,Zt.current),p)break;return null;case 22:return i.lanes=0,_p(a,i,o,i.pendingProps);case 24:ma(i,nn,a.memoizedState.cache)}return zs(a,i,o)}function Up(a,i,o){if(a!==null)if(a.memoizedProps!==i.pendingProps)an=!0;else{if(!kd(a,o)&&(i.flags&128)===0)return an=!1,cb(a,i,o);an=(a.flags&131072)!==0}else an=!1,vt&&(i.flags&1048576)!==0&&gf(i,gi,i.index);switch(i.lanes=0,i.tag){case 16:e:{var p=i.pendingProps;if(a=Ya(i.elementType),i.type=a,typeof a=="function")Oc(a)?(p=Za(a,p),i.tag=1,i=Rp(null,i,a,p,o)):(i.tag=0,i=wd(null,i,a,p,o));else{if(a!=null){var b=a.$$typeof;if(b===D){i.tag=11,i=Cp(null,i,a,p,o);break e}else if(b===O){i.tag=14,i=Ep(null,i,a,p,o);break e}}throw i=J(a)||a,Error(r(306,i,""))}}return i;case 0:return wd(a,i,i.type,i.pendingProps,o);case 1:return p=i.type,b=Za(p,i.pendingProps),Rp(a,i,p,b,o);case 3:e:{if(fe(i,i.stateNode.containerInfo),a===null)throw Error(r(387));p=i.pendingProps;var j=i.memoizedState;b=j.element,Qc(a,i),Ti(i,p,null,o);var k=i.memoizedState;if(p=k.cache,ma(i,nn,p),p!==j.cache&&Kc(i,[nn],o,!0),ji(),p=k.element,j.isDehydrated)if(j={element:p,isDehydrated:!1,cache:k.cache},i.updateQueue.baseState=j,i.memoizedState=j,i.flags&256){i=Mp(a,i,p,o);break e}else if(p!==b){b=Zn(Error(r(424)),i),xi(b),i=Mp(a,i,p,o);break e}else{switch(a=i.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Ft=as(a.firstChild),bn=i,vt=!0,da=null,ns=!0,o=_f(i,null,p,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Va(),p===b){i=zs(a,i,o);break e}Sn(a,i,p,o)}i=i.child}return i;case 26:return Zl(a,i),a===null?(o=Yh(i.type,null,i.pendingProps,null))?i.memoizedState=o:vt||(o=i.type,a=i.pendingProps,p=xo(ne.current).createElement(o),p[tn]=i,p[vn]=a,jn(p,o,a),dn(p),i.stateNode=p):i.memoizedState=Yh(i.type,a.memoizedProps,i.pendingProps,a.memoizedState),null;case 27:return ee(i),a===null&&vt&&(p=i.stateNode=Kh(i.type,i.pendingProps,ne.current),bn=i,ns=!0,b=Ft,wa(i.type)?(uu=b,Ft=as(p.firstChild)):Ft=b),Sn(a,i,i.pendingProps.children,o),Zl(a,i),a===null&&(i.flags|=4194304),i.child;case 5:return a===null&&vt&&((b=p=Ft)&&(p=Fb(p,i.type,i.pendingProps,ns),p!==null?(i.stateNode=p,bn=i,Ft=as(p.firstChild),ns=!1,b=!0):b=!1),b||ua(i)),ee(i),b=i.type,j=i.pendingProps,k=a!==null?a.memoizedProps:null,p=j.children,iu(b,j)?p=null:k!==null&&iu(b,k)&&(i.flags|=32),i.memoizedState!==null&&(b=rd(a,i,eb,null,null,o),qi._currentValue=b),Zl(a,i),Sn(a,i,p,o),i.child;case 6:return a===null&&vt&&((a=o=Ft)&&(o=Bb(o,i.pendingProps,ns),o!==null?(i.stateNode=o,bn=i,Ft=null,a=!0):a=!1),a||ua(i)),null;case 13:return Pp(a,i,o);case 4:return fe(i,i.stateNode.containerInfo),p=i.pendingProps,a===null?i.child=Xa(i,null,p,o):Sn(a,i,p,o),i.child;case 11:return Cp(a,i,i.type,i.pendingProps,o);case 7:return Sn(a,i,i.pendingProps,o),i.child;case 8:return Sn(a,i,i.pendingProps.children,o),i.child;case 12:return Sn(a,i,i.pendingProps.children,o),i.child;case 10:return p=i.pendingProps,ma(i,i.type,p.value),Sn(a,i,p.children,o),i.child;case 9:return b=i.type._context,p=i.pendingProps.children,$a(i),b=Nn(b),p=p(b),i.flags|=1,Sn(a,i,p,o),i.child;case 14:return Ep(a,i,i.type,i.pendingProps,o);case 15:return Ip(a,i,i.type,i.pendingProps,o);case 19:return Op(a,i,o);case 31:return ob(a,i,o);case 22:return _p(a,i,o,i.pendingProps);case 24:return $a(i),p=Nn(nn),a===null?(b=Yc(),b===null&&(b=Lt,j=$c(),b.pooledCache=j,j.refCount++,j!==null&&(b.pooledCacheLanes|=o),b=j),i.memoizedState={parent:p,cache:b},Xc(i),ma(i,nn,b)):((a.lanes&o)!==0&&(Qc(a,i),Ti(i,null,null,o),ji()),b=a.memoizedState,j=i.memoizedState,b.parent!==p?(b={parent:p,cache:p},i.memoizedState=b,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=b),ma(i,nn,p)):(p=j.cache,ma(i,nn,p),p!==b.cache&&Kc(i,[nn],o,!0))),Sn(a,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function Hs(a){a.flags|=4}function Rd(a,i,o,p,b){if((i=(a.mode&32)!==0)&&(i=!1),i){if(a.flags|=16777216,(b&335544128)===b)if(a.stateNode.complete)a.flags|=8192;else if(uh())a.flags|=8192;else throw Ja=Ul,Jc}else a.flags&=-16777217}function Fp(a,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!eg(i))if(uh())a.flags|=8192;else throw Ja=Ul,Jc}function to(a,i){i!==null&&(a.flags|=4),a.flags&16384&&(i=a.tag!==22?ul():536870912,a.lanes|=i,Ir|=i)}function Ai(a,i){if(!vt)switch(a.tailMode){case"hidden":i=a.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?a.tail=null:o.sibling=null;break;case"collapsed":o=a.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function Bt(a){var i=a.alternate!==null&&a.alternate.child===a.child,o=0,p=0;if(i)for(var b=a.child;b!==null;)o|=b.lanes|b.childLanes,p|=b.subtreeFlags&65011712,p|=b.flags&65011712,b.return=a,b=b.sibling;else for(b=a.child;b!==null;)o|=b.lanes|b.childLanes,p|=b.subtreeFlags,p|=b.flags,b.return=a,b=b.sibling;return a.subtreeFlags|=p,a.childLanes=o,i}function db(a,i,o){var p=i.pendingProps;switch(Gc(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(i),null;case 1:return Bt(i),null;case 3:return o=i.stateNode,p=null,a!==null&&(p=a.memoizedState.cache),i.memoizedState.cache!==p&&(i.flags|=2048),Fs(nn),Q(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(a===null||a.child===null)&&(hr(i)?Hs(i):a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Hc())),Bt(i),null;case 26:var b=i.type,j=i.memoizedState;return a===null?(Hs(i),j!==null?(Bt(i),Fp(i,j)):(Bt(i),Rd(i,b,null,p,o))):j?j!==a.memoizedState?(Hs(i),Bt(i),Fp(i,j)):(Bt(i),i.flags&=-16777217):(a=a.memoizedProps,a!==p&&Hs(i),Bt(i),Rd(i,b,a,p,o)),null;case 27:if(ye(i),o=ne.current,b=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==p&&Hs(i);else{if(!p){if(i.stateNode===null)throw Error(r(166));return Bt(i),null}a=Ne.current,hr(i)?yf(i):(a=Kh(b,p,o),i.stateNode=a,Hs(i))}return Bt(i),null;case 5:if(ye(i),b=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==p&&Hs(i);else{if(!p){if(i.stateNode===null)throw Error(r(166));return Bt(i),null}if(j=Ne.current,hr(i))yf(i);else{var k=xo(ne.current);switch(j){case 1:j=k.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:j=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":j=k.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":j=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":j=k.createElement("div"),j.innerHTML="<script><\/script>",j=j.removeChild(j.firstChild);break;case"select":j=typeof p.is=="string"?k.createElement("select",{is:p.is}):k.createElement("select"),p.multiple?j.multiple=!0:p.size&&(j.size=p.size);break;default:j=typeof p.is=="string"?k.createElement(b,{is:p.is}):k.createElement(b)}}j[tn]=i,j[vn]=p;e:for(k=i.child;k!==null;){if(k.tag===5||k.tag===6)j.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===i)break e;for(;k.sibling===null;){if(k.return===null||k.return===i)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}i.stateNode=j;e:switch(jn(j,b,p),b){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Hs(i)}}return Bt(i),Rd(i,i.type,a===null?null:a.memoizedProps,i.pendingProps,o),null;case 6:if(a&&i.stateNode!=null)a.memoizedProps!==p&&Hs(i);else{if(typeof p!="string"&&i.stateNode===null)throw Error(r(166));if(a=ne.current,hr(i)){if(a=i.stateNode,o=i.memoizedProps,p=null,b=bn,b!==null)switch(b.tag){case 27:case 5:p=b.memoizedProps}a[tn]=i,a=!!(a.nodeValue===o||p!==null&&p.suppressHydrationWarning===!0||Ph(a.nodeValue,o)),a||ua(i,!0)}else a=xo(a).createTextNode(p),a[tn]=i,i.stateNode=a}return Bt(i),null;case 31:if(o=i.memoizedState,a===null||a.memoizedState!==null){if(p=hr(i),o!==null){if(a===null){if(!p)throw Error(r(318));if(a=i.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[tn]=i}else Va(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Bt(i),a=!1}else o=Hc(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=o),a=!0;if(!a)return i.flags&256?(zn(i),i):(zn(i),null);if((i.flags&128)!==0)throw Error(r(558))}return Bt(i),null;case 13:if(p=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(b=hr(i),p!==null&&p.dehydrated!==null){if(a===null){if(!b)throw Error(r(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));b[tn]=i}else Va(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Bt(i),b=!1}else b=Hc(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=b),b=!0;if(!b)return i.flags&256?(zn(i),i):(zn(i),null)}return zn(i),(i.flags&128)!==0?(i.lanes=o,i):(o=p!==null,a=a!==null&&a.memoizedState!==null,o&&(p=i.child,b=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(b=p.alternate.memoizedState.cachePool.pool),j=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(j=p.memoizedState.cachePool.pool),j!==b&&(p.flags|=2048)),o!==a&&o&&(i.child.flags|=8192),to(i,i.updateQueue),Bt(i),null);case 4:return Q(),a===null&&tu(i.stateNode.containerInfo),Bt(i),null;case 10:return Fs(i.type),Bt(i),null;case 19:if(ie(Zt),p=i.memoizedState,p===null)return Bt(i),null;if(b=(i.flags&128)!==0,j=p.rendering,j===null)if(b)Ai(p,!1);else{if(Qt!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(j=zl(a),j!==null){for(i.flags|=128,Ai(p,!1),a=j.updateQueue,i.updateQueue=a,to(i,a),i.subtreeFlags=0,a=o,o=i.child;o!==null;)ff(o,a),o=o.sibling;return ue(Zt,Zt.current&1|2),vt&&Os(i,p.treeForkCount),i.child}a=a.sibling}p.tail!==null&&ot()>io&&(i.flags|=128,b=!0,Ai(p,!1),i.lanes=4194304)}else{if(!b)if(a=zl(j),a!==null){if(i.flags|=128,b=!0,a=a.updateQueue,i.updateQueue=a,to(i,a),Ai(p,!0),p.tail===null&&p.tailMode==="hidden"&&!j.alternate&&!vt)return Bt(i),null}else 2*ot()-p.renderingStartTime>io&&o!==536870912&&(i.flags|=128,b=!0,Ai(p,!1),i.lanes=4194304);p.isBackwards?(j.sibling=i.child,i.child=j):(a=p.last,a!==null?a.sibling=j:i.child=j,p.last=j)}return p.tail!==null?(a=p.tail,p.rendering=a,p.tail=a.sibling,p.renderingStartTime=ot(),a.sibling=null,o=Zt.current,ue(Zt,b?o&1|2:o&1),vt&&Os(i,p.treeForkCount),a):(Bt(i),null);case 22:case 23:return zn(i),nd(),p=i.memoizedState!==null,a!==null?a.memoizedState!==null!==p&&(i.flags|=8192):p&&(i.flags|=8192),p?(o&536870912)!==0&&(i.flags&128)===0&&(Bt(i),i.subtreeFlags&6&&(i.flags|=8192)):Bt(i),o=i.updateQueue,o!==null&&to(i,o.retryQueue),o=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),p=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),p!==o&&(i.flags|=2048),a!==null&&ie(Wa),null;case 24:return o=null,a!==null&&(o=a.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Fs(nn),Bt(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function ub(a,i){switch(Gc(i),i.tag){case 1:return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return Fs(nn),Q(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 26:case 27:case 5:return ye(i),null;case 31:if(i.memoizedState!==null){if(zn(i),i.alternate===null)throw Error(r(340));Va()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 13:if(zn(i),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Va()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return ie(Zt),null;case 4:return Q(),null;case 10:return Fs(i.type),null;case 22:case 23:return zn(i),nd(),a!==null&&ie(Wa),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 24:return Fs(nn),null;case 25:return null;default:return null}}function Bp(a,i){switch(Gc(i),i.tag){case 3:Fs(nn),Q();break;case 26:case 27:case 5:ye(i);break;case 4:Q();break;case 31:i.memoizedState!==null&&zn(i);break;case 13:zn(i);break;case 19:ie(Zt);break;case 10:Fs(i.type);break;case 22:case 23:zn(i),nd(),a!==null&&ie(Wa);break;case 24:Fs(nn)}}function Di(a,i){try{var o=i.updateQueue,p=o!==null?o.lastEffect:null;if(p!==null){var b=p.next;o=b;do{if((o.tag&a)===a){p=void 0;var j=o.create,k=o.inst;p=j(),k.destroy=p}o=o.next}while(o!==b)}}catch(V){At(i,i.return,V)}}function ya(a,i,o){try{var p=i.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var j=b.next;p=j;do{if((p.tag&a)===a){var k=p.inst,V=k.destroy;if(V!==void 0){k.destroy=void 0,b=i;var re=o,ge=V;try{ge()}catch(Ee){At(b,re,Ee)}}}p=p.next}while(p!==j)}}catch(Ee){At(i,i.return,Ee)}}function Gp(a){var i=a.updateQueue;if(i!==null){var o=a.stateNode;try{Df(i,o)}catch(p){At(a,a.return,p)}}}function zp(a,i,o){o.props=Za(a.type,a.memoizedProps),o.state=a.memoizedState;try{o.componentWillUnmount()}catch(p){At(a,i,p)}}function ki(a,i){try{var o=a.ref;if(o!==null){switch(a.tag){case 26:case 27:case 5:var p=a.stateNode;break;case 30:p=a.stateNode;break;default:p=a.stateNode}typeof o=="function"?a.refCleanup=o(p):o.current=p}}catch(b){At(a,i,b)}}function Es(a,i){var o=a.ref,p=a.refCleanup;if(o!==null)if(typeof p=="function")try{p()}catch(b){At(a,i,b)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(b){At(a,i,b)}else o.current=null}function Hp(a){var i=a.type,o=a.memoizedProps,p=a.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&p.focus();break e;case"img":o.src?p.src=o.src:o.srcSet&&(p.srcset=o.srcSet)}}catch(b){At(a,a.return,b)}}function Md(a,i,o){try{var p=a.stateNode;Rb(p,a.type,o,i),p[vn]=i}catch(b){At(a,a.return,b)}}function qp(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&wa(a.type)||a.tag===4}function Pd(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||qp(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&wa(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Ld(a,i,o){var p=a.tag;if(p===5||p===6)a=a.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(a,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(a),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Ht));else if(p!==4&&(p===27&&wa(a.type)&&(o=a.stateNode,i=null),a=a.child,a!==null))for(Ld(a,i,o),a=a.sibling;a!==null;)Ld(a,i,o),a=a.sibling}function no(a,i,o){var p=a.tag;if(p===5||p===6)a=a.stateNode,i?o.insertBefore(a,i):o.appendChild(a);else if(p!==4&&(p===27&&wa(a.type)&&(o=a.stateNode),a=a.child,a!==null))for(no(a,i,o),a=a.sibling;a!==null;)no(a,i,o),a=a.sibling}function Vp(a){var i=a.stateNode,o=a.memoizedProps;try{for(var p=a.type,b=i.attributes;b.length;)i.removeAttributeNode(b[0]);jn(i,p,o),i[tn]=a,i[vn]=o}catch(j){At(a,a.return,j)}}var qs=!1,rn=!1,Od=!1,Kp=typeof WeakSet=="function"?WeakSet:Set,pn=null;function mb(a,i){if(a=a.containerInfo,au=To,a=sf(a),Ac(a)){if("selectionStart"in a)var o={start:a.selectionStart,end:a.selectionEnd};else e:{o=(o=a.ownerDocument)&&o.defaultView||window;var p=o.getSelection&&o.getSelection();if(p&&p.rangeCount!==0){o=p.anchorNode;var b=p.anchorOffset,j=p.focusNode;p=p.focusOffset;try{o.nodeType,j.nodeType}catch{o=null;break e}var k=0,V=-1,re=-1,ge=0,Ee=0,_e=a,ve=null;t:for(;;){for(var Te;_e!==o||b!==0&&_e.nodeType!==3||(V=k+b),_e!==j||p!==0&&_e.nodeType!==3||(re=k+p),_e.nodeType===3&&(k+=_e.nodeValue.length),(Te=_e.firstChild)!==null;)ve=_e,_e=Te;for(;;){if(_e===a)break t;if(ve===o&&++ge===b&&(V=k),ve===j&&++Ee===p&&(re=k),(Te=_e.nextSibling)!==null)break;_e=ve,ve=_e.parentNode}_e=Te}o=V===-1||re===-1?null:{start:V,end:re}}else o=null}o=o||{start:0,end:0}}else o=null;for(ru={focusedElem:a,selectionRange:o},To=!1,pn=i;pn!==null;)if(i=pn,a=i.child,(i.subtreeFlags&1028)!==0&&a!==null)a.return=i,pn=a;else for(;pn!==null;){switch(i=pn,j=i.alternate,a=i.flags,i.tag){case 0:if((a&4)!==0&&(a=i.updateQueue,a=a!==null?a.events:null,a!==null))for(o=0;o<a.length;o++)b=a[o],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&j!==null){a=void 0,o=i,b=j.memoizedProps,j=j.memoizedState,p=o.stateNode;try{var We=Za(o.type,b);a=p.getSnapshotBeforeUpdate(We,j),p.__reactInternalSnapshotBeforeUpdate=a}catch(nt){At(o,o.return,nt)}}break;case 3:if((a&1024)!==0){if(a=i.stateNode.containerInfo,o=a.nodeType,o===9)ou(a);else if(o===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":ou(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=i.sibling,a!==null){a.return=i.return,pn=a;break}pn=i.return}}function $p(a,i,o){var p=o.flags;switch(o.tag){case 0:case 11:case 15:Ks(a,o),p&4&&Di(5,o);break;case 1:if(Ks(a,o),p&4)if(a=o.stateNode,i===null)try{a.componentDidMount()}catch(k){At(o,o.return,k)}else{var b=Za(o.type,i.memoizedProps);i=i.memoizedState;try{a.componentDidUpdate(b,i,a.__reactInternalSnapshotBeforeUpdate)}catch(k){At(o,o.return,k)}}p&64&&Gp(o),p&512&&ki(o,o.return);break;case 3:if(Ks(a,o),p&64&&(a=o.updateQueue,a!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{Df(a,i)}catch(k){At(o,o.return,k)}}break;case 27:i===null&&p&4&&Vp(o);case 26:case 5:Ks(a,o),i===null&&p&4&&Hp(o),p&512&&ki(o,o.return);break;case 12:Ks(a,o);break;case 31:Ks(a,o),p&4&&Jp(a,o);break;case 13:Ks(a,o),p&4&&Xp(a,o),p&64&&(a=o.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(o=Nb.bind(null,o),Gb(a,o))));break;case 22:if(p=o.memoizedState!==null||qs,!p){i=i!==null&&i.memoizedState!==null||rn,b=qs;var j=rn;qs=p,(rn=i)&&!j?$s(a,o,(o.subtreeFlags&8772)!==0):Ks(a,o),qs=b,rn=j}break;case 30:break;default:Ks(a,o)}}function Wp(a){var i=a.alternate;i!==null&&(a.alternate=null,Wp(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&xl(i)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Gt=null,kn=!1;function Vs(a,i,o){for(o=o.child;o!==null;)Yp(a,i,o),o=o.sibling}function Yp(a,i,o){if(He&&typeof He.onCommitFiberUnmount=="function")try{He.onCommitFiberUnmount(Ye,o)}catch{}switch(o.tag){case 26:rn||Es(o,i),Vs(a,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:rn||Es(o,i);var p=Gt,b=kn;wa(o.type)&&(Gt=o.stateNode,kn=!1),Vs(a,i,o),Gi(o.stateNode),Gt=p,kn=b;break;case 5:rn||Es(o,i);case 6:if(p=Gt,b=kn,Gt=null,Vs(a,i,o),Gt=p,kn=b,Gt!==null)if(kn)try{(Gt.nodeType===9?Gt.body:Gt.nodeName==="HTML"?Gt.ownerDocument.body:Gt).removeChild(o.stateNode)}catch(j){At(o,i,j)}else try{Gt.removeChild(o.stateNode)}catch(j){At(o,i,j)}break;case 18:Gt!==null&&(kn?(a=Gt,Gh(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,o.stateNode),Lr(a)):Gh(Gt,o.stateNode));break;case 4:p=Gt,b=kn,Gt=o.stateNode.containerInfo,kn=!0,Vs(a,i,o),Gt=p,kn=b;break;case 0:case 11:case 14:case 15:ya(2,o,i),rn||ya(4,o,i),Vs(a,i,o);break;case 1:rn||(Es(o,i),p=o.stateNode,typeof p.componentWillUnmount=="function"&&zp(o,i,p)),Vs(a,i,o);break;case 21:Vs(a,i,o);break;case 22:rn=(p=rn)||o.memoizedState!==null,Vs(a,i,o),rn=p;break;default:Vs(a,i,o)}}function Jp(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Lr(a)}catch(o){At(i,i.return,o)}}}function Xp(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Lr(a)}catch(o){At(i,i.return,o)}}function fb(a){switch(a.tag){case 31:case 13:case 19:var i=a.stateNode;return i===null&&(i=a.stateNode=new Kp),i;case 22:return a=a.stateNode,i=a._retryCache,i===null&&(i=a._retryCache=new Kp),i;default:throw Error(r(435,a.tag))}}function so(a,i){var o=fb(a);i.forEach(function(p){if(!o.has(p)){o.add(p);var b=Sb.bind(null,a,p);p.then(b,b)}})}function Rn(a,i){var o=i.deletions;if(o!==null)for(var p=0;p<o.length;p++){var b=o[p],j=a,k=i,V=k;e:for(;V!==null;){switch(V.tag){case 27:if(wa(V.type)){Gt=V.stateNode,kn=!1;break e}break;case 5:Gt=V.stateNode,kn=!1;break e;case 3:case 4:Gt=V.stateNode.containerInfo,kn=!0;break e}V=V.return}if(Gt===null)throw Error(r(160));Yp(j,k,b),Gt=null,kn=!1,j=b.alternate,j!==null&&(j.return=null),b.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Qp(i,a),i=i.sibling}var ms=null;function Qp(a,i){var o=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Rn(i,a),Mn(a),p&4&&(ya(3,a,a.return),Di(3,a),ya(5,a,a.return));break;case 1:Rn(i,a),Mn(a),p&512&&(rn||o===null||Es(o,o.return)),p&64&&qs&&(a=a.updateQueue,a!==null&&(p=a.callbacks,p!==null&&(o=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=o===null?p:o.concat(p))));break;case 26:var b=ms;if(Rn(i,a),Mn(a),p&512&&(rn||o===null||Es(o,o.return)),p&4){var j=o!==null?o.memoizedState:null;if(p=a.memoizedState,o===null)if(p===null)if(a.stateNode===null){e:{p=a.type,o=a.memoizedProps,b=b.ownerDocument||b;t:switch(p){case"title":j=b.getElementsByTagName("title")[0],(!j||j[ir]||j[tn]||j.namespaceURI==="http://www.w3.org/2000/svg"||j.hasAttribute("itemprop"))&&(j=b.createElement(p),b.head.insertBefore(j,b.querySelector("head > title"))),jn(j,p,o),j[tn]=a,dn(j),p=j;break e;case"link":var k=Qh("link","href",b).get(p+(o.href||""));if(k){for(var V=0;V<k.length;V++)if(j=k[V],j.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&j.getAttribute("rel")===(o.rel==null?null:o.rel)&&j.getAttribute("title")===(o.title==null?null:o.title)&&j.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){k.splice(V,1);break t}}j=b.createElement(p),jn(j,p,o),b.head.appendChild(j);break;case"meta":if(k=Qh("meta","content",b).get(p+(o.content||""))){for(V=0;V<k.length;V++)if(j=k[V],j.getAttribute("content")===(o.content==null?null:""+o.content)&&j.getAttribute("name")===(o.name==null?null:o.name)&&j.getAttribute("property")===(o.property==null?null:o.property)&&j.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&j.getAttribute("charset")===(o.charSet==null?null:o.charSet)){k.splice(V,1);break t}}j=b.createElement(p),jn(j,p,o),b.head.appendChild(j);break;default:throw Error(r(468,p))}j[tn]=a,dn(j),p=j}a.stateNode=p}else Zh(b,a.type,a.stateNode);else a.stateNode=Xh(b,p,a.memoizedProps);else j!==p?(j===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):j.count--,p===null?Zh(b,a.type,a.stateNode):Xh(b,p,a.memoizedProps)):p===null&&a.stateNode!==null&&Md(a,a.memoizedProps,o.memoizedProps)}break;case 27:Rn(i,a),Mn(a),p&512&&(rn||o===null||Es(o,o.return)),o!==null&&p&4&&Md(a,a.memoizedProps,o.memoizedProps);break;case 5:if(Rn(i,a),Mn(a),p&512&&(rn||o===null||Es(o,o.return)),a.flags&32){b=a.stateNode;try{Y(b,"")}catch(We){At(a,a.return,We)}}p&4&&a.stateNode!=null&&(b=a.memoizedProps,Md(a,b,o!==null?o.memoizedProps:b)),p&1024&&(Od=!0);break;case 6:if(Rn(i,a),Mn(a),p&4){if(a.stateNode===null)throw Error(r(162));p=a.memoizedProps,o=a.stateNode;try{o.nodeValue=p}catch(We){At(a,a.return,We)}}break;case 3:if(bo=null,b=ms,ms=yo(i.containerInfo),Rn(i,a),ms=b,Mn(a),p&4&&o!==null&&o.memoizedState.isDehydrated)try{Lr(i.containerInfo)}catch(We){At(a,a.return,We)}Od&&(Od=!1,Zp(a));break;case 4:p=ms,ms=yo(a.stateNode.containerInfo),Rn(i,a),Mn(a),ms=p;break;case 12:Rn(i,a),Mn(a);break;case 31:Rn(i,a),Mn(a),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,so(a,p)));break;case 13:Rn(i,a),Mn(a),a.child.flags&8192&&a.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(ro=ot()),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,so(a,p)));break;case 22:b=a.memoizedState!==null;var re=o!==null&&o.memoizedState!==null,ge=qs,Ee=rn;if(qs=ge||b,rn=Ee||re,Rn(i,a),rn=Ee,qs=ge,Mn(a),p&8192)e:for(i=a.stateNode,i._visibility=b?i._visibility&-2:i._visibility|1,b&&(o===null||re||qs||rn||er(a)),o=null,i=a;;){if(i.tag===5||i.tag===26){if(o===null){re=o=i;try{if(j=re.stateNode,b)k=j.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{V=re.stateNode;var _e=re.memoizedProps.style,ve=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;V.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(We){At(re,re.return,We)}}}else if(i.tag===6){if(o===null){re=i;try{re.stateNode.nodeValue=b?"":re.memoizedProps}catch(We){At(re,re.return,We)}}}else if(i.tag===18){if(o===null){re=i;try{var Te=re.stateNode;b?zh(Te,!0):zh(re.stateNode,!1)}catch(We){At(re,re.return,We)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===a)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}p&4&&(p=a.updateQueue,p!==null&&(o=p.retryQueue,o!==null&&(p.retryQueue=null,so(a,o))));break;case 19:Rn(i,a),Mn(a),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,so(a,p)));break;case 30:break;case 21:break;default:Rn(i,a),Mn(a)}}function Mn(a){var i=a.flags;if(i&2){try{for(var o,p=a.return;p!==null;){if(qp(p)){o=p;break}p=p.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var b=o.stateNode,j=Pd(a);no(a,j,b);break;case 5:var k=o.stateNode;o.flags&32&&(Y(k,""),o.flags&=-33);var V=Pd(a);no(a,V,k);break;case 3:case 4:var re=o.stateNode.containerInfo,ge=Pd(a);Ld(a,ge,re);break;default:throw Error(r(161))}}catch(Ee){At(a,a.return,Ee)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function Zp(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var i=a;Zp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),a=a.sibling}}function Ks(a,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)$p(a,i.alternate,i),i=i.sibling}function er(a){for(a=a.child;a!==null;){var i=a;switch(i.tag){case 0:case 11:case 14:case 15:ya(4,i,i.return),er(i);break;case 1:Es(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&zp(i,i.return,o),er(i);break;case 27:Gi(i.stateNode);case 26:case 5:Es(i,i.return),er(i);break;case 22:i.memoizedState===null&&er(i);break;case 30:er(i);break;default:er(i)}a=a.sibling}}function $s(a,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var p=i.alternate,b=a,j=i,k=j.flags;switch(j.tag){case 0:case 11:case 15:$s(b,j,o),Di(4,j);break;case 1:if($s(b,j,o),p=j,b=p.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(ge){At(p,p.return,ge)}if(p=j,b=p.updateQueue,b!==null){var V=p.stateNode;try{var re=b.shared.hiddenCallbacks;if(re!==null)for(b.shared.hiddenCallbacks=null,b=0;b<re.length;b++)Af(re[b],V)}catch(ge){At(p,p.return,ge)}}o&&k&64&&Gp(j),ki(j,j.return);break;case 27:Vp(j);case 26:case 5:$s(b,j,o),o&&p===null&&k&4&&Hp(j),ki(j,j.return);break;case 12:$s(b,j,o);break;case 31:$s(b,j,o),o&&k&4&&Jp(b,j);break;case 13:$s(b,j,o),o&&k&4&&Xp(b,j);break;case 22:j.memoizedState===null&&$s(b,j,o),ki(j,j.return);break;case 30:break;default:$s(b,j,o)}i=i.sibling}}function Ud(a,i){var o=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),a=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),a!==o&&(a!=null&&a.refCount++,o!=null&&yi(o))}function Fd(a,i){a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&yi(a))}function fs(a,i,o,p){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)eh(a,i,o,p),i=i.sibling}function eh(a,i,o,p){var b=i.flags;switch(i.tag){case 0:case 11:case 15:fs(a,i,o,p),b&2048&&Di(9,i);break;case 1:fs(a,i,o,p);break;case 3:fs(a,i,o,p),b&2048&&(a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&yi(a)));break;case 12:if(b&2048){fs(a,i,o,p),a=i.stateNode;try{var j=i.memoizedProps,k=j.id,V=j.onPostCommit;typeof V=="function"&&V(k,i.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(re){At(i,i.return,re)}}else fs(a,i,o,p);break;case 31:fs(a,i,o,p);break;case 13:fs(a,i,o,p);break;case 23:break;case 22:j=i.stateNode,k=i.alternate,i.memoizedState!==null?j._visibility&2?fs(a,i,o,p):Ri(a,i):j._visibility&2?fs(a,i,o,p):(j._visibility|=2,wr(a,i,o,p,(i.subtreeFlags&10256)!==0||!1)),b&2048&&Ud(k,i);break;case 24:fs(a,i,o,p),b&2048&&Fd(i.alternate,i);break;default:fs(a,i,o,p)}}function wr(a,i,o,p,b){for(b=b&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var j=a,k=i,V=o,re=p,ge=k.flags;switch(k.tag){case 0:case 11:case 15:wr(j,k,V,re,b),Di(8,k);break;case 23:break;case 22:var Ee=k.stateNode;k.memoizedState!==null?Ee._visibility&2?wr(j,k,V,re,b):Ri(j,k):(Ee._visibility|=2,wr(j,k,V,re,b)),b&&ge&2048&&Ud(k.alternate,k);break;case 24:wr(j,k,V,re,b),b&&ge&2048&&Fd(k.alternate,k);break;default:wr(j,k,V,re,b)}i=i.sibling}}function Ri(a,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=a,p=i,b=p.flags;switch(p.tag){case 22:Ri(o,p),b&2048&&Ud(p.alternate,p);break;case 24:Ri(o,p),b&2048&&Fd(p.alternate,p);break;default:Ri(o,p)}i=i.sibling}}var Mi=8192;function Cr(a,i,o){if(a.subtreeFlags&Mi)for(a=a.child;a!==null;)th(a,i,o),a=a.sibling}function th(a,i,o){switch(a.tag){case 26:Cr(a,i,o),a.flags&Mi&&a.memoizedState!==null&&Zb(o,ms,a.memoizedState,a.memoizedProps);break;case 5:Cr(a,i,o);break;case 3:case 4:var p=ms;ms=yo(a.stateNode.containerInfo),Cr(a,i,o),ms=p;break;case 22:a.memoizedState===null&&(p=a.alternate,p!==null&&p.memoizedState!==null?(p=Mi,Mi=16777216,Cr(a,i,o),Mi=p):Cr(a,i,o));break;default:Cr(a,i,o)}}function nh(a){var i=a.alternate;if(i!==null&&(a=i.child,a!==null)){i.child=null;do i=a.sibling,a.sibling=null,a=i;while(a!==null)}}function Pi(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var p=i[o];pn=p,ah(p,a)}nh(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)sh(a),a=a.sibling}function sh(a){switch(a.tag){case 0:case 11:case 15:Pi(a),a.flags&2048&&ya(9,a,a.return);break;case 3:Pi(a);break;case 12:Pi(a);break;case 22:var i=a.stateNode;a.memoizedState!==null&&i._visibility&2&&(a.return===null||a.return.tag!==13)?(i._visibility&=-3,ao(a)):Pi(a);break;default:Pi(a)}}function ao(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var p=i[o];pn=p,ah(p,a)}nh(a)}for(a=a.child;a!==null;){switch(i=a,i.tag){case 0:case 11:case 15:ya(8,i,i.return),ao(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,ao(i));break;default:ao(i)}a=a.sibling}}function ah(a,i){for(;pn!==null;){var o=pn;switch(o.tag){case 0:case 11:case 15:ya(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var p=o.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:yi(o.memoizedState.cache)}if(p=o.child,p!==null)p.return=o,pn=p;else e:for(o=a;pn!==null;){p=pn;var b=p.sibling,j=p.return;if(Wp(p),p===o){pn=null;break e}if(b!==null){b.return=j,pn=b;break e}pn=j}}}var pb={getCacheForType:function(a){var i=Nn(nn),o=i.data.get(a);return o===void 0&&(o=a(),i.data.set(a,o)),o},cacheSignal:function(){return Nn(nn).controller.signal}},hb=typeof WeakMap=="function"?WeakMap:Map,Ct=0,Lt=null,pt=null,xt=0,_t=0,Hn=null,va=!1,Er=!1,Bd=!1,Ws=0,Qt=0,ba=0,tr=0,Gd=0,qn=0,Ir=0,Li=null,Pn=null,zd=!1,ro=0,rh=0,io=1/0,lo=null,Na=null,un=0,Sa=null,_r=null,Ys=0,Hd=0,qd=null,ih=null,Oi=0,Vd=null;function Vn(){return(Ct&2)!==0&&xt!==0?xt&-xt:G.T!==null?Xd():hl()}function lh(){if(qn===0)if((xt&536870912)===0||vt){var a=Ns;Ns<<=1,(Ns&3932160)===0&&(Ns=262144),qn=a}else qn=536870912;return a=Gn.current,a!==null&&(a.flags|=32),qn}function Ln(a,i,o){(a===Lt&&(_t===2||_t===9)||a.cancelPendingCommit!==null)&&(Ar(a,0),ja(a,xt,qn,!1)),Pa(a,o),((Ct&2)===0||a!==Lt)&&(a===Lt&&((Ct&2)===0&&(tr|=o),Qt===4&&ja(a,xt,qn,!1)),Is(a))}function oh(a,i,o){if((Ct&6)!==0)throw Error(r(327));var p=!o&&(i&127)===0&&(i&a.expiredLanes)===0||Ss(a,i),b=p?yb(a,i):$d(a,i,!0),j=p;do{if(b===0){Er&&!p&&ja(a,i,0,!1);break}else{if(o=a.current.alternate,j&&!gb(o)){b=$d(a,i,!1),j=!1;continue}if(b===2){if(j=i,a.errorRecoveryDisabledLanes&j)var k=0;else k=a.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){i=k;e:{var V=a;b=Li;var re=V.current.memoizedState.isDehydrated;if(re&&(Ar(V,k).flags|=256),k=$d(V,k,!1),k!==2){if(Bd&&!re){V.errorRecoveryDisabledLanes|=j,tr|=j,b=4;break e}j=Pn,Pn=b,j!==null&&(Pn===null?Pn=j:Pn.push.apply(Pn,j))}b=k}if(j=!1,b!==2)continue}}if(b===1){Ar(a,0),ja(a,i,0,!0);break}e:{switch(p=a,j=b,j){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:ja(p,i,qn,!va);break e;case 2:Pn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(b=ro+300-ot(),10<b)){if(ja(p,i,qn,!va),aa(p,0,!0)!==0)break e;Ys=i,p.timeoutHandle=Fh(ch.bind(null,p,o,Pn,lo,zd,i,qn,tr,Ir,va,j,"Throttled",-0,0),b);break e}ch(p,o,Pn,lo,zd,i,qn,tr,Ir,va,j,null,-0,0)}}break}while(!0);Is(a)}function ch(a,i,o,p,b,j,k,V,re,ge,Ee,_e,ve,Te){if(a.timeoutHandle=-1,_e=i.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ht},th(i,j,_e);var We=(j&62914560)===j?ro-ot():(j&4194048)===j?rh-ot():0;if(We=eN(_e,We),We!==null){Ys=j,a.cancelPendingCommit=We(xh.bind(null,a,i,j,o,p,b,k,V,re,Ee,_e,null,ve,Te)),ja(a,j,k,!ge);return}}xh(a,i,j,o,p,b,k,V,re)}function gb(a){for(var i=a;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var p=0;p<o.length;p++){var b=o[p],j=b.getSnapshot;b=b.value;try{if(!Fn(j(),b))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ja(a,i,o,p){i&=~Gd,i&=~tr,a.suspendedLanes|=i,a.pingedLanes&=~i,p&&(a.warmLanes|=i),p=a.expirationTimes;for(var b=i;0<b;){var j=31-st(b),k=1<<j;p[j]=-1,b&=~k}o!==0&&ml(a,o,i)}function oo(){return(Ct&6)===0?(Ui(0),!1):!0}function Kd(){if(pt!==null){if(_t===0)var a=pt.return;else a=pt,Us=Ka=null,od(a),br=null,bi=0,a=pt;for(;a!==null;)Bp(a.alternate,a),a=a.return;pt=null}}function Ar(a,i){var o=a.timeoutHandle;o!==-1&&(a.timeoutHandle=-1,Lb(o)),o=a.cancelPendingCommit,o!==null&&(a.cancelPendingCommit=null,o()),Ys=0,Kd(),Lt=a,pt=o=Ls(a.current,null),xt=i,_t=0,Hn=null,va=!1,Er=Ss(a,i),Bd=!1,Ir=qn=Gd=tr=ba=Qt=0,Pn=Li=null,zd=!1,(i&8)!==0&&(i|=i&32);var p=a.entangledLanes;if(p!==0)for(a=a.entanglements,p&=i;0<p;){var b=31-st(p),j=1<<b;i|=a[b],p&=~j}return Ws=i,_l(),o}function dh(a,i){ct=null,G.H=Ii,i===vr||i===Ol?(i=Cf(),_t=3):i===Jc?(i=Cf(),_t=4):_t=i===Td?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Hn=i,pt===null&&(Qt=1,Xl(a,Zn(i,a.current)))}function uh(){var a=Gn.current;return a===null?!0:(xt&4194048)===xt?ss===null:(xt&62914560)===xt||(xt&536870912)!==0?a===ss:!1}function mh(){var a=G.H;return G.H=Ii,a===null?Ii:a}function fh(){var a=G.A;return G.A=pb,a}function co(){Qt=4,va||(xt&4194048)!==xt&&Gn.current!==null||(Er=!0),(ba&134217727)===0&&(tr&134217727)===0||Lt===null||ja(Lt,xt,qn,!1)}function $d(a,i,o){var p=Ct;Ct|=2;var b=mh(),j=fh();(Lt!==a||xt!==i)&&(lo=null,Ar(a,i)),i=!1;var k=Qt;e:do try{if(_t!==0&&pt!==null){var V=pt,re=Hn;switch(_t){case 8:Kd(),k=6;break e;case 3:case 2:case 9:case 6:Gn.current===null&&(i=!0);var ge=_t;if(_t=0,Hn=null,Dr(a,V,re,ge),o&&Er){k=0;break e}break;default:ge=_t,_t=0,Hn=null,Dr(a,V,re,ge)}}xb(),k=Qt;break}catch(Ee){dh(a,Ee)}while(!0);return i&&a.shellSuspendCounter++,Us=Ka=null,Ct=p,G.H=b,G.A=j,pt===null&&(Lt=null,xt=0,_l()),k}function xb(){for(;pt!==null;)ph(pt)}function yb(a,i){var o=Ct;Ct|=2;var p=mh(),b=fh();Lt!==a||xt!==i?(lo=null,io=ot()+500,Ar(a,i)):Er=Ss(a,i);e:do try{if(_t!==0&&pt!==null){i=pt;var j=Hn;t:switch(_t){case 1:_t=0,Hn=null,Dr(a,i,j,1);break;case 2:case 9:if(Tf(j)){_t=0,Hn=null,hh(i);break}i=function(){_t!==2&&_t!==9||Lt!==a||(_t=7),Is(a)},j.then(i,i);break e;case 3:_t=7;break e;case 4:_t=5;break e;case 7:Tf(j)?(_t=0,Hn=null,hh(i)):(_t=0,Hn=null,Dr(a,i,j,7));break;case 5:var k=null;switch(pt.tag){case 26:k=pt.memoizedState;case 5:case 27:var V=pt;if(k?eg(k):V.stateNode.complete){_t=0,Hn=null;var re=V.sibling;if(re!==null)pt=re;else{var ge=V.return;ge!==null?(pt=ge,uo(ge)):pt=null}break t}}_t=0,Hn=null,Dr(a,i,j,5);break;case 6:_t=0,Hn=null,Dr(a,i,j,6);break;case 8:Kd(),Qt=6;break e;default:throw Error(r(462))}}vb();break}catch(Ee){dh(a,Ee)}while(!0);return Us=Ka=null,G.H=p,G.A=b,Ct=o,pt!==null?0:(Lt=null,xt=0,_l(),Qt)}function vb(){for(;pt!==null&&!Ze();)ph(pt)}function ph(a){var i=Up(a.alternate,a,Ws);a.memoizedProps=a.pendingProps,i===null?uo(a):pt=i}function hh(a){var i=a,o=i.alternate;switch(i.tag){case 15:case 0:i=kp(o,i,i.pendingProps,i.type,void 0,xt);break;case 11:i=kp(o,i,i.pendingProps,i.type.render,i.ref,xt);break;case 5:od(i);default:Bp(o,i),i=pt=ff(i,Ws),i=Up(o,i,Ws)}a.memoizedProps=a.pendingProps,i===null?uo(a):pt=i}function Dr(a,i,o,p){Us=Ka=null,od(i),br=null,bi=0;var b=i.return;try{if(lb(a,b,i,o,xt)){Qt=1,Xl(a,Zn(o,a.current)),pt=null;return}}catch(j){if(b!==null)throw pt=b,j;Qt=1,Xl(a,Zn(o,a.current)),pt=null;return}i.flags&32768?(vt||p===1?a=!0:Er||(xt&536870912)!==0?a=!1:(va=a=!0,(p===2||p===9||p===3||p===6)&&(p=Gn.current,p!==null&&p.tag===13&&(p.flags|=16384))),gh(i,a)):uo(i)}function uo(a){var i=a;do{if((i.flags&32768)!==0){gh(i,va);return}a=i.return;var o=db(i.alternate,i,Ws);if(o!==null){pt=o;return}if(i=i.sibling,i!==null){pt=i;return}pt=i=a}while(i!==null);Qt===0&&(Qt=5)}function gh(a,i){do{var o=ub(a.alternate,a);if(o!==null){o.flags&=32767,pt=o;return}if(o=a.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(a=a.sibling,a!==null)){pt=a;return}pt=a=o}while(a!==null);Qt=6,pt=null}function xh(a,i,o,p,b,j,k,V,re){a.cancelPendingCommit=null;do mo();while(un!==0);if((Ct&6)!==0)throw Error(r(327));if(i!==null){if(i===a.current)throw Error(r(177));if(j=i.lanes|i.childLanes,j|=Pc,mc(a,o,j,k,V,re),a===Lt&&(pt=Lt=null,xt=0),_r=i,Sa=a,Ys=o,Hd=j,qd=b,ih=p,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,jb(Kt,function(){return Sh(),null})):(a.callbackNode=null,a.callbackPriority=0),p=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||p){p=G.T,G.T=null,b=B.p,B.p=2,k=Ct,Ct|=4;try{mb(a,i,o)}finally{Ct=k,B.p=b,G.T=p}}un=1,yh(),vh(),bh()}}function yh(){if(un===1){un=0;var a=Sa,i=_r,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var p=B.p;B.p=2;var b=Ct;Ct|=4;try{Qp(i,a);var j=ru,k=sf(a.containerInfo),V=j.focusedElem,re=j.selectionRange;if(k!==V&&V&&V.ownerDocument&&nf(V.ownerDocument.documentElement,V)){if(re!==null&&Ac(V)){var ge=re.start,Ee=re.end;if(Ee===void 0&&(Ee=ge),"selectionStart"in V)V.selectionStart=ge,V.selectionEnd=Math.min(Ee,V.value.length);else{var _e=V.ownerDocument||document,ve=_e&&_e.defaultView||window;if(ve.getSelection){var Te=ve.getSelection(),We=V.textContent.length,nt=Math.min(re.start,We),Rt=re.end===void 0?nt:Math.min(re.end,We);!Te.extend&&nt>Rt&&(k=Rt,Rt=nt,nt=k);var me=tf(V,nt),ce=tf(V,Rt);if(me&&ce&&(Te.rangeCount!==1||Te.anchorNode!==me.node||Te.anchorOffset!==me.offset||Te.focusNode!==ce.node||Te.focusOffset!==ce.offset)){var he=_e.createRange();he.setStart(me.node,me.offset),Te.removeAllRanges(),nt>Rt?(Te.addRange(he),Te.extend(ce.node,ce.offset)):(he.setEnd(ce.node,ce.offset),Te.addRange(he))}}}}for(_e=[],Te=V;Te=Te.parentNode;)Te.nodeType===1&&_e.push({element:Te,left:Te.scrollLeft,top:Te.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<_e.length;V++){var Ie=_e[V];Ie.element.scrollLeft=Ie.left,Ie.element.scrollTop=Ie.top}}To=!!au,ru=au=null}finally{Ct=b,B.p=p,G.T=o}}a.current=i,un=2}}function vh(){if(un===2){un=0;var a=Sa,i=_r,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var p=B.p;B.p=2;var b=Ct;Ct|=4;try{$p(a,i.alternate,i)}finally{Ct=b,B.p=p,G.T=o}}un=3}}function bh(){if(un===4||un===3){un=0,Et();var a=Sa,i=_r,o=Ys,p=ih;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?un=5:(un=0,_r=Sa=null,Nh(a,a.pendingLanes));var b=a.pendingLanes;if(b===0&&(Na=null),ti(o),i=i.stateNode,He&&typeof He.onCommitFiberRoot=="function")try{He.onCommitFiberRoot(Ye,i,void 0,(i.current.flags&128)===128)}catch{}if(p!==null){i=G.T,b=B.p,B.p=2,G.T=null;try{for(var j=a.onRecoverableError,k=0;k<p.length;k++){var V=p[k];j(V.value,{componentStack:V.stack})}}finally{G.T=i,B.p=b}}(Ys&3)!==0&&mo(),Is(a),b=a.pendingLanes,(o&261930)!==0&&(b&42)!==0?a===Vd?Oi++:(Oi=0,Vd=a):Oi=0,Ui(0)}}function Nh(a,i){(a.pooledCacheLanes&=i)===0&&(i=a.pooledCache,i!=null&&(a.pooledCache=null,yi(i)))}function mo(){return yh(),vh(),bh(),Sh()}function Sh(){if(un!==5)return!1;var a=Sa,i=Hd;Hd=0;var o=ti(Ys),p=G.T,b=B.p;try{B.p=32>o?32:o,G.T=null,o=qd,qd=null;var j=Sa,k=Ys;if(un=0,_r=Sa=null,Ys=0,(Ct&6)!==0)throw Error(r(331));var V=Ct;if(Ct|=4,sh(j.current),eh(j,j.current,k,o),Ct=V,Ui(0,!1),He&&typeof He.onPostCommitFiberRoot=="function")try{He.onPostCommitFiberRoot(Ye,j)}catch{}return!0}finally{B.p=b,G.T=p,Nh(a,i)}}function jh(a,i,o){i=Zn(o,i),i=jd(a.stateNode,i,2),a=ha(a,i,2),a!==null&&(Pa(a,2),Is(a))}function At(a,i,o){if(a.tag===3)jh(a,a,o);else for(;i!==null;){if(i.tag===3){jh(i,a,o);break}else if(i.tag===1){var p=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Na===null||!Na.has(p))){a=Zn(o,a),o=Tp(2),p=ha(i,o,2),p!==null&&(wp(o,p,i,a),Pa(p,2),Is(p));break}}i=i.return}}function Wd(a,i,o){var p=a.pingCache;if(p===null){p=a.pingCache=new hb;var b=new Set;p.set(i,b)}else b=p.get(i),b===void 0&&(b=new Set,p.set(i,b));b.has(o)||(Bd=!0,b.add(o),a=bb.bind(null,a,i,o),i.then(a,a))}function bb(a,i,o){var p=a.pingCache;p!==null&&p.delete(i),a.pingedLanes|=a.suspendedLanes&o,a.warmLanes&=~o,Lt===a&&(xt&o)===o&&(Qt===4||Qt===3&&(xt&62914560)===xt&&300>ot()-ro?(Ct&2)===0&&Ar(a,0):Gd|=o,Ir===xt&&(Ir=0)),Is(a)}function Th(a,i){i===0&&(i=ul()),a=Ha(a,i),a!==null&&(Pa(a,i),Is(a))}function Nb(a){var i=a.memoizedState,o=0;i!==null&&(o=i.retryLane),Th(a,o)}function Sb(a,i){var o=0;switch(a.tag){case 31:case 13:var p=a.stateNode,b=a.memoizedState;b!==null&&(o=b.retryLane);break;case 19:p=a.stateNode;break;case 22:p=a.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(i),Th(a,o)}function jb(a,i){return xe(a,i)}var fo=null,kr=null,Yd=!1,po=!1,Jd=!1,Ta=0;function Is(a){a!==kr&&a.next===null&&(kr===null?fo=kr=a:kr=kr.next=a),po=!0,Yd||(Yd=!0,wb())}function Ui(a,i){if(!Jd&&po){Jd=!0;do for(var o=!1,p=fo;p!==null;){if(a!==0){var b=p.pendingLanes;if(b===0)var j=0;else{var k=p.suspendedLanes,V=p.pingedLanes;j=(1<<31-st(42|a)+1)-1,j&=b&~(k&~V),j=j&201326741?j&201326741|1:j?j|2:0}j!==0&&(o=!0,Ih(p,j))}else j=xt,j=aa(p,p===Lt?j:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(j&3)===0||Ss(p,j)||(o=!0,Ih(p,j));p=p.next}while(o);Jd=!1}}function Tb(){wh()}function wh(){po=Yd=!1;var a=0;Ta!==0&&Pb()&&(a=Ta);for(var i=ot(),o=null,p=fo;p!==null;){var b=p.next,j=Ch(p,i);j===0?(p.next=null,o===null?fo=b:o.next=b,b===null&&(kr=o)):(o=p,(a!==0||(j&3)!==0)&&(po=!0)),p=b}un!==0&&un!==5||Ui(a),Ta!==0&&(Ta=0)}function Ch(a,i){for(var o=a.suspendedLanes,p=a.pingedLanes,b=a.expirationTimes,j=a.pendingLanes&-62914561;0<j;){var k=31-st(j),V=1<<k,re=b[k];re===-1?((V&o)===0||(V&p)!==0)&&(b[k]=uc(V,i)):re<=i&&(a.expiredLanes|=V),j&=~V}if(i=Lt,o=xt,o=aa(a,a===i?o:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),p=a.callbackNode,o===0||a===i&&(_t===2||_t===9)||a.cancelPendingCommit!==null)return p!==null&&p!==null&&Ue(p),a.callbackNode=null,a.callbackPriority=0;if((o&3)===0||Ss(a,o)){if(i=o&-o,i===a.callbackPriority)return i;switch(p!==null&&Ue(p),ti(o)){case 2:case 8:o=gt;break;case 32:o=Kt;break;case 268435456:o=Ds;break;default:o=Kt}return p=Eh.bind(null,a),o=xe(o,p),a.callbackPriority=i,a.callbackNode=o,i}return p!==null&&p!==null&&Ue(p),a.callbackPriority=2,a.callbackNode=null,2}function Eh(a,i){if(un!==0&&un!==5)return a.callbackNode=null,a.callbackPriority=0,null;var o=a.callbackNode;if(mo()&&a.callbackNode!==o)return null;var p=xt;return p=aa(a,a===Lt?p:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),p===0?null:(oh(a,p,i),Ch(a,ot()),a.callbackNode!=null&&a.callbackNode===o?Eh.bind(null,a):null)}function Ih(a,i){if(mo())return null;oh(a,i,!0)}function wb(){Ob(function(){(Ct&6)!==0?xe(wt,Tb):wh()})}function Xd(){if(Ta===0){var a=xr;a===0&&(a=cn,cn<<=1,(cn&261888)===0&&(cn=256)),Ta=a}return Ta}function _h(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Wt(""+a)}function Ah(a,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,a.id&&o.setAttribute("form",a.id),i.parentNode.insertBefore(o,i),a=new FormData(a),o.parentNode.removeChild(o),a}function Cb(a,i,o,p,b){if(i==="submit"&&o&&o.stateNode===b){var j=_h((b[vn]||null).action),k=p.submitter;k&&(i=(i=k[vn]||null)?_h(i.formAction):k.getAttribute("formAction"),i!==null&&(j=i,k=null));var V=new wl("action","action",null,p,b);a.push({event:V,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Ta!==0){var re=k?Ah(b,k):new FormData(b);xd(o,{pending:!0,data:re,method:b.method,action:j},null,re)}}else typeof j=="function"&&(V.preventDefault(),re=k?Ah(b,k):new FormData(b),xd(o,{pending:!0,data:re,method:b.method,action:j},j,re))},currentTarget:b}]})}}for(var Qd=0;Qd<Mc.length;Qd++){var Zd=Mc[Qd],Eb=Zd.toLowerCase(),Ib=Zd[0].toUpperCase()+Zd.slice(1);us(Eb,"on"+Ib)}us(lf,"onAnimationEnd"),us(of,"onAnimationIteration"),us(cf,"onAnimationStart"),us("dblclick","onDoubleClick"),us("focusin","onFocus"),us("focusout","onBlur"),us(qv,"onTransitionRun"),us(Vv,"onTransitionStart"),us(Kv,"onTransitionCancel"),us(df,"onTransitionEnd"),Fa("onMouseEnter",["mouseout","mouseover"]),Fa("onMouseLeave",["mouseout","mouseover"]),Fa("onPointerEnter",["pointerout","pointerover"]),Fa("onPointerLeave",["pointerout","pointerover"]),ra("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ra("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ra("onBeforeInput",["compositionend","keypress","textInput","paste"]),ra("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ra("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ra("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_b=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fi));function Dh(a,i){i=(i&4)!==0;for(var o=0;o<a.length;o++){var p=a[o],b=p.event;p=p.listeners;e:{var j=void 0;if(i)for(var k=p.length-1;0<=k;k--){var V=p[k],re=V.instance,ge=V.currentTarget;if(V=V.listener,re!==j&&b.isPropagationStopped())break e;j=V,b.currentTarget=ge;try{j(b)}catch(Ee){Il(Ee)}b.currentTarget=null,j=re}else for(k=0;k<p.length;k++){if(V=p[k],re=V.instance,ge=V.currentTarget,V=V.listener,re!==j&&b.isPropagationStopped())break e;j=V,b.currentTarget=ge;try{j(b)}catch(Ee){Il(Ee)}b.currentTarget=null,j=re}}}}function ht(a,i){var o=i[ni];o===void 0&&(o=i[ni]=new Set);var p=a+"__bubble";o.has(p)||(kh(i,a,2,!1),o.add(p))}function eu(a,i,o){var p=0;i&&(p|=4),kh(o,a,p,i)}var ho="_reactListening"+Math.random().toString(36).slice(2);function tu(a){if(!a[ho]){a[ho]=!0,pc.forEach(function(o){o!=="selectionchange"&&(_b.has(o)||eu(o,!1,a),eu(o,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[ho]||(i[ho]=!0,eu("selectionchange",!1,i))}}function kh(a,i,o,p){switch(lg(i)){case 2:var b=sN;break;case 8:b=aN;break;default:b=gu}o=b.bind(null,i,o,a),b=void 0,!Nc||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(b=!0),p?b!==void 0?a.addEventListener(i,o,{capture:!0,passive:b}):a.addEventListener(i,o,!0):b!==void 0?a.addEventListener(i,o,{passive:b}):a.addEventListener(i,o,!1)}function nu(a,i,o,p,b){var j=p;if((i&1)===0&&(i&2)===0&&p!==null)e:for(;;){if(p===null)return;var k=p.tag;if(k===3||k===4){var V=p.stateNode.containerInfo;if(V===b)break;if(k===4)for(k=p.return;k!==null;){var re=k.tag;if((re===3||re===4)&&k.stateNode.containerInfo===b)return;k=k.return}for(;V!==null;){if(k=La(V),k===null)return;if(re=k.tag,re===5||re===6||re===26||re===27){p=j=k;continue e}V=V.parentNode}}p=p.return}Nl(function(){var ge=j,Ee=Cn(o),_e=[];e:{var ve=uf.get(a);if(ve!==void 0){var Te=wl,We=a;switch(a){case"keypress":if(jl(o)===0)break e;case"keydown":case"keyup":Te=Sv;break;case"focusin":We="focus",Te=wc;break;case"focusout":We="blur",Te=wc;break;case"beforeblur":case"afterblur":Te=wc;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=Fm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=dv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=wv;break;case lf:case of:case cf:Te=fv;break;case df:Te=Ev;break;case"scroll":case"scrollend":Te=ov;break;case"wheel":Te=_v;break;case"copy":case"cut":case"paste":Te=hv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=Gm;break;case"toggle":case"beforetoggle":Te=Dv}var nt=(i&4)!==0,Rt=!nt&&(a==="scroll"||a==="scrollend"),me=nt?ve!==null?ve+"Capture":null:ve;nt=[];for(var ce=ge,he;ce!==null;){var Ie=ce;if(he=Ie.stateNode,Ie=Ie.tag,Ie!==5&&Ie!==26&&Ie!==27||he===null||me===null||(Ie=li(ce,me),Ie!=null&&nt.push(Bi(ce,Ie,he))),Rt)break;ce=ce.return}0<nt.length&&(ve=new Te(ve,We,null,o,Ee),_e.push({event:ve,listeners:nt}))}}if((i&7)===0){e:{if(ve=a==="mouseover"||a==="pointerover",Te=a==="mouseout"||a==="pointerout",ve&&o!==Yt&&(We=o.relatedTarget||o.fromElement)&&(La(We)||We[ks]))break e;if((Te||ve)&&(ve=Ee.window===Ee?Ee:(ve=Ee.ownerDocument)?ve.defaultView||ve.parentWindow:window,Te?(We=o.relatedTarget||o.toElement,Te=ge,We=We?La(We):null,We!==null&&(Rt=c(We),nt=We.tag,We!==Rt||nt!==5&&nt!==27&&nt!==6)&&(We=null)):(Te=null,We=ge),Te!==We)){if(nt=Fm,Ie="onMouseLeave",me="onMouseEnter",ce="mouse",(a==="pointerout"||a==="pointerover")&&(nt=Gm,Ie="onPointerLeave",me="onPointerEnter",ce="pointer"),Rt=Te==null?ve:lr(Te),he=We==null?ve:lr(We),ve=new nt(Ie,ce+"leave",Te,o,Ee),ve.target=Rt,ve.relatedTarget=he,Ie=null,La(Ee)===ge&&(nt=new nt(me,ce+"enter",We,o,Ee),nt.target=he,nt.relatedTarget=Rt,Ie=nt),Rt=Ie,Te&&We)t:{for(nt=Ab,me=Te,ce=We,he=0,Ie=me;Ie;Ie=nt(Ie))he++;Ie=0;for(var et=ce;et;et=nt(et))Ie++;for(;0<he-Ie;)me=nt(me),he--;for(;0<Ie-he;)ce=nt(ce),Ie--;for(;he--;){if(me===ce||ce!==null&&me===ce.alternate){nt=me;break t}me=nt(me),ce=nt(ce)}nt=null}else nt=null;Te!==null&&Rh(_e,ve,Te,nt,!1),We!==null&&Rt!==null&&Rh(_e,Rt,We,nt,!0)}}e:{if(ve=ge?lr(ge):window,Te=ve.nodeName&&ve.nodeName.toLowerCase(),Te==="select"||Te==="input"&&ve.type==="file")var Nt=Ym;else if($m(ve))if(Jm)Nt=Gv;else{Nt=Fv;var Xe=Uv}else Te=ve.nodeName,!Te||Te.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?ge&&Qe(ge.elementType)&&(Nt=Ym):Nt=Bv;if(Nt&&(Nt=Nt(a,ge))){Wm(_e,Nt,o,Ee);break e}Xe&&Xe(a,ve,ge),a==="focusout"&&ge&&ve.type==="number"&&ge.memoizedProps.value!=null&&bl(ve,"number",ve.value)}switch(Xe=ge?lr(ge):window,a){case"focusin":($m(Xe)||Xe.contentEditable==="true")&&(cr=Xe,Dc=ge,hi=null);break;case"focusout":hi=Dc=cr=null;break;case"mousedown":kc=!0;break;case"contextmenu":case"mouseup":case"dragend":kc=!1,af(_e,o,Ee);break;case"selectionchange":if(Hv)break;case"keydown":case"keyup":af(_e,o,Ee)}var dt;if(Ec)e:{switch(a){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else or?Vm(a,o)&&(yt="onCompositionEnd"):a==="keydown"&&o.keyCode===229&&(yt="onCompositionStart");yt&&(zm&&o.locale!=="ko"&&(or||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&or&&(dt=Om()):(oa=Ee,Sc="value"in oa?oa.value:oa.textContent,or=!0)),Xe=go(ge,yt),0<Xe.length&&(yt=new Bm(yt,a,null,o,Ee),_e.push({event:yt,listeners:Xe}),dt?yt.data=dt:(dt=Km(o),dt!==null&&(yt.data=dt)))),(dt=Rv?Mv(a,o):Pv(a,o))&&(yt=go(ge,"onBeforeInput"),0<yt.length&&(Xe=new Bm("onBeforeInput","beforeinput",null,o,Ee),_e.push({event:Xe,listeners:yt}),Xe.data=dt)),Cb(_e,a,ge,o,Ee)}Dh(_e,i)})}function Bi(a,i,o){return{instance:a,listener:i,currentTarget:o}}function go(a,i){for(var o=i+"Capture",p=[];a!==null;){var b=a,j=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||j===null||(b=li(a,o),b!=null&&p.unshift(Bi(a,b,j)),b=li(a,i),b!=null&&p.push(Bi(a,b,j))),a.tag===3)return p;a=a.return}return[]}function Ab(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Rh(a,i,o,p,b){for(var j=i._reactName,k=[];o!==null&&o!==p;){var V=o,re=V.alternate,ge=V.stateNode;if(V=V.tag,re!==null&&re===p)break;V!==5&&V!==26&&V!==27||ge===null||(re=ge,b?(ge=li(o,j),ge!=null&&k.unshift(Bi(o,ge,re))):b||(ge=li(o,j),ge!=null&&k.push(Bi(o,ge,re)))),o=o.return}k.length!==0&&a.push({event:i,listeners:k})}var Db=/\r\n?/g,kb=/\u0000|\uFFFD/g;function Mh(a){return(typeof a=="string"?a:""+a).replace(Db,`
`).replace(kb,"")}function Ph(a,i){return i=Mh(i),Mh(a)===i}function kt(a,i,o,p,b,j){switch(o){case"children":typeof p=="string"?i==="body"||i==="textarea"&&p===""||Y(a,p):(typeof p=="number"||typeof p=="bigint")&&i!=="body"&&Y(a,""+p);break;case"className":ri(a,"class",p);break;case"tabIndex":ri(a,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":ri(a,o,p);break;case"style":Pe(a,p,j);break;case"data":if(i!=="object"){ri(a,"data",p);break}case"src":case"href":if(p===""&&(i!=="a"||o!=="href")){a.removeAttribute(o);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){a.removeAttribute(o);break}p=Wt(""+p),a.setAttribute(o,p);break;case"action":case"formAction":if(typeof p=="function"){a.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof j=="function"&&(o==="formAction"?(i!=="input"&&kt(a,i,"name",b.name,b,null),kt(a,i,"formEncType",b.formEncType,b,null),kt(a,i,"formMethod",b.formMethod,b,null),kt(a,i,"formTarget",b.formTarget,b,null)):(kt(a,i,"encType",b.encType,b,null),kt(a,i,"method",b.method,b,null),kt(a,i,"target",b.target,b,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){a.removeAttribute(o);break}p=Wt(""+p),a.setAttribute(o,p);break;case"onClick":p!=null&&(a.onclick=Ht);break;case"onScroll":p!=null&&ht("scroll",a);break;case"onScrollEnd":p!=null&&ht("scrollend",a);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(o=p.__html,o!=null){if(b.children!=null)throw Error(r(60));a.innerHTML=o}}break;case"multiple":a.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":a.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){a.removeAttribute("xlink:href");break}o=Wt(""+p),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(o,""+p):a.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(o,""):a.removeAttribute(o);break;case"capture":case"download":p===!0?a.setAttribute(o,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(o,p):a.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?a.setAttribute(o,p):a.removeAttribute(o);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?a.removeAttribute(o):a.setAttribute(o,p);break;case"popover":ht("beforetoggle",a),ht("toggle",a),ai(a,"popover",p);break;case"xlinkActuate":Ts(a,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Ts(a,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Ts(a,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Ts(a,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Ts(a,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Ts(a,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Ts(a,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Ts(a,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Ts(a,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":ai(a,"is",p);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=mt.get(o)||o,ai(a,o,p))}}function su(a,i,o,p,b,j){switch(o){case"style":Pe(a,p,j);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(o=p.__html,o!=null){if(b.children!=null)throw Error(r(60));a.innerHTML=o}}break;case"children":typeof p=="string"?Y(a,p):(typeof p=="number"||typeof p=="bigint")&&Y(a,""+p);break;case"onScroll":p!=null&&ht("scroll",a);break;case"onScrollEnd":p!=null&&ht("scrollend",a);break;case"onClick":p!=null&&(a.onclick=Ht);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!hc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(b=o.endsWith("Capture"),i=o.slice(2,b?o.length-7:void 0),j=a[vn]||null,j=j!=null?j[o]:null,typeof j=="function"&&a.removeEventListener(i,j,b),typeof p=="function")){typeof j!="function"&&j!==null&&(o in a?a[o]=null:a.hasAttribute(o)&&a.removeAttribute(o)),a.addEventListener(i,p,b);break e}o in a?a[o]=p:p===!0?a.setAttribute(o,""):ai(a,o,p)}}}function jn(a,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",a),ht("load",a);var p=!1,b=!1,j;for(j in o)if(o.hasOwnProperty(j)){var k=o[j];if(k!=null)switch(j){case"src":p=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:kt(a,i,j,k,o,null)}}b&&kt(a,i,"srcSet",o.srcSet,o,null),p&&kt(a,i,"src",o.src,o,null);return;case"input":ht("invalid",a);var V=j=k=b=null,re=null,ge=null;for(p in o)if(o.hasOwnProperty(p)){var Ee=o[p];if(Ee!=null)switch(p){case"name":b=Ee;break;case"type":k=Ee;break;case"checked":re=Ee;break;case"defaultChecked":ge=Ee;break;case"value":j=Ee;break;case"defaultValue":V=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(r(137,i));break;default:kt(a,i,p,Ee,o,null)}}bc(a,j,V,re,ge,k,b,!1);return;case"select":ht("invalid",a),p=k=j=null;for(b in o)if(o.hasOwnProperty(b)&&(V=o[b],V!=null))switch(b){case"value":j=V;break;case"defaultValue":k=V;break;case"multiple":p=V;default:kt(a,i,b,V,o,null)}i=j,o=k,a.multiple=!!p,i!=null?ia(a,!!p,i,!1):o!=null&&ia(a,!!p,o,!0);return;case"textarea":ht("invalid",a),j=b=p=null;for(k in o)if(o.hasOwnProperty(k)&&(V=o[k],V!=null))switch(k){case"value":p=V;break;case"defaultValue":b=V;break;case"children":j=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(r(91));break;default:kt(a,i,k,V,o,null)}Z(a,p,b,j);return;case"option":for(re in o)if(o.hasOwnProperty(re)&&(p=o[re],p!=null))switch(re){case"selected":a.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:kt(a,i,re,p,o,null)}return;case"dialog":ht("beforetoggle",a),ht("toggle",a),ht("cancel",a),ht("close",a);break;case"iframe":case"object":ht("load",a);break;case"video":case"audio":for(p=0;p<Fi.length;p++)ht(Fi[p],a);break;case"image":ht("error",a),ht("load",a);break;case"details":ht("toggle",a);break;case"embed":case"source":case"link":ht("error",a),ht("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ge in o)if(o.hasOwnProperty(ge)&&(p=o[ge],p!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:kt(a,i,ge,p,o,null)}return;default:if(Qe(i)){for(Ee in o)o.hasOwnProperty(Ee)&&(p=o[Ee],p!==void 0&&su(a,i,Ee,p,o,void 0));return}}for(V in o)o.hasOwnProperty(V)&&(p=o[V],p!=null&&kt(a,i,V,p,o,null))}function Rb(a,i,o,p){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,j=null,k=null,V=null,re=null,ge=null,Ee=null;for(Te in o){var _e=o[Te];if(o.hasOwnProperty(Te)&&_e!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":re=_e;default:p.hasOwnProperty(Te)||kt(a,i,Te,null,p,_e)}}for(var ve in p){var Te=p[ve];if(_e=o[ve],p.hasOwnProperty(ve)&&(Te!=null||_e!=null))switch(ve){case"type":j=Te;break;case"name":b=Te;break;case"checked":ge=Te;break;case"defaultChecked":Ee=Te;break;case"value":k=Te;break;case"defaultValue":V=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(r(137,i));break;default:Te!==_e&&kt(a,i,ve,Te,p,_e)}}vl(a,k,V,re,ge,Ee,j,b);return;case"select":Te=k=V=ve=null;for(j in o)if(re=o[j],o.hasOwnProperty(j)&&re!=null)switch(j){case"value":break;case"multiple":Te=re;default:p.hasOwnProperty(j)||kt(a,i,j,null,p,re)}for(b in p)if(j=p[b],re=o[b],p.hasOwnProperty(b)&&(j!=null||re!=null))switch(b){case"value":ve=j;break;case"defaultValue":V=j;break;case"multiple":k=j;default:j!==re&&kt(a,i,b,j,p,re)}i=V,o=k,p=Te,ve!=null?ia(a,!!o,ve,!1):!!p!=!!o&&(i!=null?ia(a,!!o,i,!0):ia(a,!!o,o?[]:"",!1));return;case"textarea":Te=ve=null;for(V in o)if(b=o[V],o.hasOwnProperty(V)&&b!=null&&!p.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:kt(a,i,V,null,p,b)}for(k in p)if(b=p[k],j=o[k],p.hasOwnProperty(k)&&(b!=null||j!=null))switch(k){case"value":ve=b;break;case"defaultValue":Te=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:b!==j&&kt(a,i,k,b,p,j)}K(a,ve,Te);return;case"option":for(var We in o)if(ve=o[We],o.hasOwnProperty(We)&&ve!=null&&!p.hasOwnProperty(We))switch(We){case"selected":a.selected=!1;break;default:kt(a,i,We,null,p,ve)}for(re in p)if(ve=p[re],Te=o[re],p.hasOwnProperty(re)&&ve!==Te&&(ve!=null||Te!=null))switch(re){case"selected":a.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:kt(a,i,re,ve,p,Te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nt in o)ve=o[nt],o.hasOwnProperty(nt)&&ve!=null&&!p.hasOwnProperty(nt)&&kt(a,i,nt,null,p,ve);for(ge in p)if(ve=p[ge],Te=o[ge],p.hasOwnProperty(ge)&&ve!==Te&&(ve!=null||Te!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,i));break;default:kt(a,i,ge,ve,p,Te)}return;default:if(Qe(i)){for(var Rt in o)ve=o[Rt],o.hasOwnProperty(Rt)&&ve!==void 0&&!p.hasOwnProperty(Rt)&&su(a,i,Rt,void 0,p,ve);for(Ee in p)ve=p[Ee],Te=o[Ee],!p.hasOwnProperty(Ee)||ve===Te||ve===void 0&&Te===void 0||su(a,i,Ee,ve,p,Te);return}}for(var me in o)ve=o[me],o.hasOwnProperty(me)&&ve!=null&&!p.hasOwnProperty(me)&&kt(a,i,me,null,p,ve);for(_e in p)ve=p[_e],Te=o[_e],!p.hasOwnProperty(_e)||ve===Te||ve==null&&Te==null||kt(a,i,_e,ve,p,Te)}function Lh(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Mb(){if(typeof performance.getEntriesByType=="function"){for(var a=0,i=0,o=performance.getEntriesByType("resource"),p=0;p<o.length;p++){var b=o[p],j=b.transferSize,k=b.initiatorType,V=b.duration;if(j&&V&&Lh(k)){for(k=0,V=b.responseEnd,p+=1;p<o.length;p++){var re=o[p],ge=re.startTime;if(ge>V)break;var Ee=re.transferSize,_e=re.initiatorType;Ee&&Lh(_e)&&(re=re.responseEnd,k+=Ee*(re<V?1:(V-ge)/(re-ge)))}if(--p,i+=8*(j+k)/(b.duration/1e3),a++,10<a)break}}if(0<a)return i/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var au=null,ru=null;function xo(a){return a.nodeType===9?a:a.ownerDocument}function Oh(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uh(a,i){if(a===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&i==="foreignObject"?0:a}function iu(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var lu=null;function Pb(){var a=window.event;return a&&a.type==="popstate"?a===lu?!1:(lu=a,!0):(lu=null,!1)}var Fh=typeof setTimeout=="function"?setTimeout:void 0,Lb=typeof clearTimeout=="function"?clearTimeout:void 0,Bh=typeof Promise=="function"?Promise:void 0,Ob=typeof queueMicrotask=="function"?queueMicrotask:typeof Bh<"u"?function(a){return Bh.resolve(null).then(a).catch(Ub)}:Fh;function Ub(a){setTimeout(function(){throw a})}function wa(a){return a==="head"}function Gh(a,i){var o=i,p=0;do{var b=o.nextSibling;if(a.removeChild(o),b&&b.nodeType===8)if(o=b.data,o==="/$"||o==="/&"){if(p===0){a.removeChild(b),Lr(i);return}p--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")p++;else if(o==="html")Gi(a.ownerDocument.documentElement);else if(o==="head"){o=a.ownerDocument.head,Gi(o);for(var j=o.firstChild;j;){var k=j.nextSibling,V=j.nodeName;j[ir]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&j.rel.toLowerCase()==="stylesheet"||o.removeChild(j),j=k}}else o==="body"&&Gi(a.ownerDocument.body);o=b}while(o);Lr(i)}function zh(a,i){var o=a;a=0;do{var p=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(a===0)break;a--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||a++;o=p}while(o)}function ou(a){var i=a.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":ou(o),xl(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}a.removeChild(o)}}function Fb(a,i,o,p){for(;a.nodeType===1;){var b=o;if(a.nodeName.toLowerCase()!==i.toLowerCase()){if(!p&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(p){if(!a[ir])switch(i){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(j=a.getAttribute("rel"),j==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(j!==b.rel||a.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||a.getAttribute("title")!==(b.title==null?null:b.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(j=a.getAttribute("src"),(j!==(b.src==null?null:b.src)||a.getAttribute("type")!==(b.type==null?null:b.type)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&j&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(i==="input"&&a.type==="hidden"){var j=b.name==null?null:""+b.name;if(b.type==="hidden"&&a.getAttribute("name")===j)return a}else return a;if(a=as(a.nextSibling),a===null)break}return null}function Bb(a,i,o){if(i==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=as(a.nextSibling),a===null))return null;return a}function Hh(a,i){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!i||(a=as(a.nextSibling),a===null))return null;return a}function cu(a){return a.data==="$?"||a.data==="$~"}function du(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function Gb(a,i){var o=a.ownerDocument;if(a.data==="$~")a._reactRetry=i;else if(a.data!=="$?"||o.readyState!=="loading")i();else{var p=function(){i(),o.removeEventListener("DOMContentLoaded",p)};o.addEventListener("DOMContentLoaded",p),a._reactRetry=p}}function as(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return a}var uu=null;function qh(a){a=a.nextSibling;for(var i=0;a;){if(a.nodeType===8){var o=a.data;if(o==="/$"||o==="/&"){if(i===0)return as(a.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}a=a.nextSibling}return null}function Vh(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var o=a.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return a;i--}else o!=="/$"&&o!=="/&"||i++}a=a.previousSibling}return null}function Kh(a,i,o){switch(i=xo(o),a){case"html":if(a=i.documentElement,!a)throw Error(r(452));return a;case"head":if(a=i.head,!a)throw Error(r(453));return a;case"body":if(a=i.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Gi(a){for(var i=a.attributes;i.length;)a.removeAttributeNode(i[0]);xl(a)}var rs=new Map,$h=new Set;function yo(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Js=B.d;B.d={f:zb,r:Hb,D:qb,C:Vb,L:Kb,m:$b,X:Yb,S:Wb,M:Jb};function zb(){var a=Js.f(),i=oo();return a||i}function Hb(a){var i=Oa(a);i!==null&&i.tag===5&&i.type==="form"?dp(i):Js.r(a)}var Rr=typeof document>"u"?null:document;function Wh(a,i,o){var p=Rr;if(p&&typeof i=="string"&&i){var b=Un(i);b='link[rel="'+a+'"][href="'+b+'"]',typeof o=="string"&&(b+='[crossorigin="'+o+'"]'),$h.has(b)||($h.add(b),a={rel:a,crossOrigin:o,href:i},p.querySelector(b)===null&&(i=p.createElement("link"),jn(i,"link",a),dn(i),p.head.appendChild(i)))}}function qb(a){Js.D(a),Wh("dns-prefetch",a,null)}function Vb(a,i){Js.C(a,i),Wh("preconnect",a,i)}function Kb(a,i,o){Js.L(a,i,o);var p=Rr;if(p&&a&&i){var b='link[rel="preload"][as="'+Un(i)+'"]';i==="image"&&o&&o.imageSrcSet?(b+='[imagesrcset="'+Un(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(b+='[imagesizes="'+Un(o.imageSizes)+'"]')):b+='[href="'+Un(a)+'"]';var j=b;switch(i){case"style":j=Mr(a);break;case"script":j=Pr(a)}rs.has(j)||(a=v({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:a,as:i},o),rs.set(j,a),p.querySelector(b)!==null||i==="style"&&p.querySelector(zi(j))||i==="script"&&p.querySelector(Hi(j))||(i=p.createElement("link"),jn(i,"link",a),dn(i),p.head.appendChild(i)))}}function $b(a,i){Js.m(a,i);var o=Rr;if(o&&a){var p=i&&typeof i.as=="string"?i.as:"script",b='link[rel="modulepreload"][as="'+Un(p)+'"][href="'+Un(a)+'"]',j=b;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":j=Pr(a)}if(!rs.has(j)&&(a=v({rel:"modulepreload",href:a},i),rs.set(j,a),o.querySelector(b)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Hi(j)))return}p=o.createElement("link"),jn(p,"link",a),dn(p),o.head.appendChild(p)}}}function Wb(a,i,o){Js.S(a,i,o);var p=Rr;if(p&&a){var b=Ua(p).hoistableStyles,j=Mr(a);i=i||"default";var k=b.get(j);if(!k){var V={loading:0,preload:null};if(k=p.querySelector(zi(j)))V.loading=5;else{a=v({rel:"stylesheet",href:a,"data-precedence":i},o),(o=rs.get(j))&&mu(a,o);var re=k=p.createElement("link");dn(re),jn(re,"link",a),re._p=new Promise(function(ge,Ee){re.onload=ge,re.onerror=Ee}),re.addEventListener("load",function(){V.loading|=1}),re.addEventListener("error",function(){V.loading|=2}),V.loading|=4,vo(k,i,p)}k={type:"stylesheet",instance:k,count:1,state:V},b.set(j,k)}}}function Yb(a,i){Js.X(a,i);var o=Rr;if(o&&a){var p=Ua(o).hoistableScripts,b=Pr(a),j=p.get(b);j||(j=o.querySelector(Hi(b)),j||(a=v({src:a,async:!0},i),(i=rs.get(b))&&fu(a,i),j=o.createElement("script"),dn(j),jn(j,"link",a),o.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},p.set(b,j))}}function Jb(a,i){Js.M(a,i);var o=Rr;if(o&&a){var p=Ua(o).hoistableScripts,b=Pr(a),j=p.get(b);j||(j=o.querySelector(Hi(b)),j||(a=v({src:a,async:!0,type:"module"},i),(i=rs.get(b))&&fu(a,i),j=o.createElement("script"),dn(j),jn(j,"link",a),o.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},p.set(b,j))}}function Yh(a,i,o,p){var b=(b=ne.current)?yo(b):null;if(!b)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Mr(o.href),o=Ua(b).hoistableStyles,p=o.get(i),p||(p={type:"style",instance:null,count:0,state:null},o.set(i,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){a=Mr(o.href);var j=Ua(b).hoistableStyles,k=j.get(a);if(k||(b=b.ownerDocument||b,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},j.set(a,k),(j=b.querySelector(zi(a)))&&!j._p&&(k.instance=j,k.state.loading=5),rs.has(a)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},rs.set(a,o),j||Xb(b,a,o,k.state))),i&&p===null)throw Error(r(528,""));return k}if(i&&p!==null)throw Error(r(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Pr(o),o=Ua(b).hoistableScripts,p=o.get(i),p||(p={type:"script",instance:null,count:0,state:null},o.set(i,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function Mr(a){return'href="'+Un(a)+'"'}function zi(a){return'link[rel="stylesheet"]['+a+"]"}function Jh(a){return v({},a,{"data-precedence":a.precedence,precedence:null})}function Xb(a,i,o,p){a.querySelector('link[rel="preload"][as="style"]['+i+"]")?p.loading=1:(i=a.createElement("link"),p.preload=i,i.addEventListener("load",function(){return p.loading|=1}),i.addEventListener("error",function(){return p.loading|=2}),jn(i,"link",o),dn(i),a.head.appendChild(i))}function Pr(a){return'[src="'+Un(a)+'"]'}function Hi(a){return"script[async]"+a}function Xh(a,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var p=a.querySelector('style[data-href~="'+Un(o.href)+'"]');if(p)return i.instance=p,dn(p),p;var b=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return p=(a.ownerDocument||a).createElement("style"),dn(p),jn(p,"style",b),vo(p,o.precedence,a),i.instance=p;case"stylesheet":b=Mr(o.href);var j=a.querySelector(zi(b));if(j)return i.state.loading|=4,i.instance=j,dn(j),j;p=Jh(o),(b=rs.get(b))&&mu(p,b),j=(a.ownerDocument||a).createElement("link"),dn(j);var k=j;return k._p=new Promise(function(V,re){k.onload=V,k.onerror=re}),jn(j,"link",p),i.state.loading|=4,vo(j,o.precedence,a),i.instance=j;case"script":return j=Pr(o.src),(b=a.querySelector(Hi(j)))?(i.instance=b,dn(b),b):(p=o,(b=rs.get(j))&&(p=v({},o),fu(p,b)),a=a.ownerDocument||a,b=a.createElement("script"),dn(b),jn(b,"link",p),a.head.appendChild(b),i.instance=b);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(p=i.instance,i.state.loading|=4,vo(p,o.precedence,a));return i.instance}function vo(a,i,o){for(var p=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=p.length?p[p.length-1]:null,j=b,k=0;k<p.length;k++){var V=p[k];if(V.dataset.precedence===i)j=V;else if(j!==b)break}j?j.parentNode.insertBefore(a,j.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(a,i.firstChild))}function mu(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.title==null&&(a.title=i.title)}function fu(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.integrity==null&&(a.integrity=i.integrity)}var bo=null;function Qh(a,i,o){if(bo===null){var p=new Map,b=bo=new Map;b.set(o,p)}else b=bo,p=b.get(o),p||(p=new Map,b.set(o,p));if(p.has(a))return p;for(p.set(a,null),o=o.getElementsByTagName(a),b=0;b<o.length;b++){var j=o[b];if(!(j[ir]||j[tn]||a==="link"&&j.getAttribute("rel")==="stylesheet")&&j.namespaceURI!=="http://www.w3.org/2000/svg"){var k=j.getAttribute(i)||"";k=a+k;var V=p.get(k);V?V.push(j):p.set(k,[j])}}return p}function Zh(a,i,o){a=a.ownerDocument||a,a.head.insertBefore(o,i==="title"?a.querySelector("head > title"):null)}function Qb(a,i,o){if(o===1||i.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return a=i.disabled,typeof i.precedence=="string"&&a==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function eg(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function Zb(a,i,o,p){if(o.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var b=Mr(p.href),j=i.querySelector(zi(b));if(j){i=j._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(a.count++,a=No.bind(a),i.then(a,a)),o.state.loading|=4,o.instance=j,dn(j);return}j=i.ownerDocument||i,p=Jh(p),(b=rs.get(b))&&mu(p,b),j=j.createElement("link"),dn(j);var k=j;k._p=new Promise(function(V,re){k.onload=V,k.onerror=re}),jn(j,"link",p),o.instance=j}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(a.count++,o=No.bind(a),i.addEventListener("load",o),i.addEventListener("error",o))}}var pu=0;function eN(a,i){return a.stylesheets&&a.count===0&&jo(a,a.stylesheets),0<a.count||0<a.imgCount?function(o){var p=setTimeout(function(){if(a.stylesheets&&jo(a,a.stylesheets),a.unsuspend){var j=a.unsuspend;a.unsuspend=null,j()}},6e4+i);0<a.imgBytes&&pu===0&&(pu=62500*Mb());var b=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&jo(a,a.stylesheets),a.unsuspend)){var j=a.unsuspend;a.unsuspend=null,j()}},(a.imgBytes>pu?50:800)+i);return a.unsuspend=o,function(){a.unsuspend=null,clearTimeout(p),clearTimeout(b)}}:null}function No(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)jo(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var So=null;function jo(a,i){a.stylesheets=null,a.unsuspend!==null&&(a.count++,So=new Map,i.forEach(tN,a),So=null,No.call(a))}function tN(a,i){if(!(i.state.loading&4)){var o=So.get(a);if(o)var p=o.get(null);else{o=new Map,So.set(a,o);for(var b=a.querySelectorAll("link[data-precedence],style[data-precedence]"),j=0;j<b.length;j++){var k=b[j];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(o.set(k.dataset.precedence,k),p=k)}p&&o.set(null,p)}b=i.instance,k=b.getAttribute("data-precedence"),j=o.get(k)||p,j===p&&o.set(null,b),o.set(k,b),this.count++,p=No.bind(this),b.addEventListener("load",p),b.addEventListener("error",p),j?j.parentNode.insertBefore(b,j.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(b,a.firstChild)),i.state.loading|=4}}var qi={$$typeof:_,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function nN(a,i,o,p,b,j,k,V,re){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Zr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zr(0),this.hiddenUpdates=Zr(null),this.identifierPrefix=p,this.onUncaughtError=b,this.onCaughtError=j,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function tg(a,i,o,p,b,j,k,V,re,ge,Ee,_e){return a=new nN(a,i,o,k,re,ge,Ee,_e,V),i=1,j===!0&&(i|=24),j=Bn(3,null,null,i),a.current=j,j.stateNode=a,i=$c(),i.refCount++,a.pooledCache=i,i.refCount++,j.memoizedState={element:p,isDehydrated:o,cache:i},Xc(j),a}function ng(a){return a?(a=mr,a):mr}function sg(a,i,o,p,b,j){b=ng(b),p.context===null?p.context=b:p.pendingContext=b,p=pa(i),p.payload={element:o},j=j===void 0?null:j,j!==null&&(p.callback=j),o=ha(a,p,i),o!==null&&(Ln(o,a,i),Si(o,a,i))}function ag(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var o=a.retryLane;a.retryLane=o!==0&&o<i?o:i}}function hu(a,i){ag(a,i),(a=a.alternate)&&ag(a,i)}function rg(a){if(a.tag===13||a.tag===31){var i=Ha(a,67108864);i!==null&&Ln(i,a,67108864),hu(a,67108864)}}function ig(a){if(a.tag===13||a.tag===31){var i=Vn();i=ei(i);var o=Ha(a,i);o!==null&&Ln(o,a,i),hu(a,i)}}var To=!0;function sN(a,i,o,p){var b=G.T;G.T=null;var j=B.p;try{B.p=2,gu(a,i,o,p)}finally{B.p=j,G.T=b}}function aN(a,i,o,p){var b=G.T;G.T=null;var j=B.p;try{B.p=8,gu(a,i,o,p)}finally{B.p=j,G.T=b}}function gu(a,i,o,p){if(To){var b=xu(p);if(b===null)nu(a,i,p,wo,o),og(a,p);else if(iN(b,a,i,o,p))p.stopPropagation();else if(og(a,p),i&4&&-1<rN.indexOf(a)){for(;b!==null;){var j=Oa(b);if(j!==null)switch(j.tag){case 3:if(j=j.stateNode,j.current.memoizedState.isDehydrated){var k=Xn(j.pendingLanes);if(k!==0){var V=j;for(V.pendingLanes|=2,V.entangledLanes|=2;k;){var re=1<<31-st(k);V.entanglements[1]|=re,k&=~re}Is(j),(Ct&6)===0&&(io=ot()+500,Ui(0))}}break;case 31:case 13:V=Ha(j,2),V!==null&&Ln(V,j,2),oo(),hu(j,2)}if(j=xu(p),j===null&&nu(a,i,p,wo,o),j===b)break;b=j}b!==null&&p.stopPropagation()}else nu(a,i,p,null,o)}}function xu(a){return a=Cn(a),yu(a)}var wo=null;function yu(a){if(wo=null,a=La(a),a!==null){var i=c(a);if(i===null)a=null;else{var o=i.tag;if(o===13){if(a=d(i),a!==null)return a;a=null}else if(o===31){if(a=u(i),a!==null)return a;a=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return wo=a,null}function lg(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pt()){case wt:return 2;case gt:return 8;case Kt:case bs:return 32;case Ds:return 268435456;default:return 32}default:return 32}}var vu=!1,Ca=null,Ea=null,Ia=null,Vi=new Map,Ki=new Map,_a=[],rN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function og(a,i){switch(a){case"focusin":case"focusout":Ca=null;break;case"dragenter":case"dragleave":Ea=null;break;case"mouseover":case"mouseout":Ia=null;break;case"pointerover":case"pointerout":Vi.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ki.delete(i.pointerId)}}function $i(a,i,o,p,b,j){return a===null||a.nativeEvent!==j?(a={blockedOn:i,domEventName:o,eventSystemFlags:p,nativeEvent:j,targetContainers:[b]},i!==null&&(i=Oa(i),i!==null&&rg(i)),a):(a.eventSystemFlags|=p,i=a.targetContainers,b!==null&&i.indexOf(b)===-1&&i.push(b),a)}function iN(a,i,o,p,b){switch(i){case"focusin":return Ca=$i(Ca,a,i,o,p,b),!0;case"dragenter":return Ea=$i(Ea,a,i,o,p,b),!0;case"mouseover":return Ia=$i(Ia,a,i,o,p,b),!0;case"pointerover":var j=b.pointerId;return Vi.set(j,$i(Vi.get(j)||null,a,i,o,p,b)),!0;case"gotpointercapture":return j=b.pointerId,Ki.set(j,$i(Ki.get(j)||null,a,i,o,p,b)),!0}return!1}function cg(a){var i=La(a.target);if(i!==null){var o=c(i);if(o!==null){if(i=o.tag,i===13){if(i=d(o),i!==null){a.blockedOn=i,gl(a.priority,function(){ig(o)});return}}else if(i===31){if(i=u(o),i!==null){a.blockedOn=i,gl(a.priority,function(){ig(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){a.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Co(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var o=xu(a.nativeEvent);if(o===null){o=a.nativeEvent;var p=new o.constructor(o.type,o);Yt=p,o.target.dispatchEvent(p),Yt=null}else return i=Oa(o),i!==null&&rg(i),a.blockedOn=o,!1;i.shift()}return!0}function dg(a,i,o){Co(a)&&o.delete(i)}function lN(){vu=!1,Ca!==null&&Co(Ca)&&(Ca=null),Ea!==null&&Co(Ea)&&(Ea=null),Ia!==null&&Co(Ia)&&(Ia=null),Vi.forEach(dg),Ki.forEach(dg)}function Eo(a,i){a.blockedOn===i&&(a.blockedOn=null,vu||(vu=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,lN)))}var Io=null;function ug(a){Io!==a&&(Io=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Io===a&&(Io=null);for(var i=0;i<a.length;i+=3){var o=a[i],p=a[i+1],b=a[i+2];if(typeof p!="function"){if(yu(p||o)===null)continue;break}var j=Oa(o);j!==null&&(a.splice(i,3),i-=3,xd(j,{pending:!0,data:b,method:o.method,action:p},p,b))}}))}function Lr(a){function i(re){return Eo(re,a)}Ca!==null&&Eo(Ca,a),Ea!==null&&Eo(Ea,a),Ia!==null&&Eo(Ia,a),Vi.forEach(i),Ki.forEach(i);for(var o=0;o<_a.length;o++){var p=_a[o];p.blockedOn===a&&(p.blockedOn=null)}for(;0<_a.length&&(o=_a[0],o.blockedOn===null);)cg(o),o.blockedOn===null&&_a.shift();if(o=(a.ownerDocument||a).$$reactFormReplay,o!=null)for(p=0;p<o.length;p+=3){var b=o[p],j=o[p+1],k=b[vn]||null;if(typeof j=="function")k||ug(o);else if(k){var V=null;if(j&&j.hasAttribute("formAction")){if(b=j,k=j[vn]||null)V=k.formAction;else if(yu(b)!==null)continue}else V=k.action;typeof V=="function"?o[p+1]=V:(o.splice(p,3),p-=3),ug(o)}}}function mg(){function a(j){j.canIntercept&&j.info==="react-transition"&&j.intercept({handler:function(){return new Promise(function(k){return b=k})},focusReset:"manual",scroll:"manual"})}function i(){b!==null&&(b(),b=null),p||setTimeout(o,20)}function o(){if(!p&&!navigation.transition){var j=navigation.currentEntry;j&&j.url!=null&&navigation.navigate(j.url,{state:j.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,b=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){p=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),b!==null&&(b(),b=null)}}}function bu(a){this._internalRoot=a}_o.prototype.render=bu.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(r(409));var o=i.current,p=Vn();sg(o,p,a,i,null,null)},_o.prototype.unmount=bu.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;sg(a.current,2,null,a,null,null),oo(),i[ks]=null}};function _o(a){this._internalRoot=a}_o.prototype.unstable_scheduleHydration=function(a){if(a){var i=hl();a={blockedOn:null,target:a,priority:i};for(var o=0;o<_a.length&&i!==0&&i<_a[o].priority;o++);_a.splice(o,0,a),o===0&&cg(a)}};var fg=n.version;if(fg!=="19.2.4")throw Error(r(527,fg,"19.2.4"));B.findDOMNode=function(a){var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=m(i),a=a!==null?f(a):null,a=a===null?null:a.stateNode,a};var oN={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ao=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ao.isDisabled&&Ao.supportsFiber)try{Ye=Ao.inject(oN),He=Ao}catch{}}return Yi.createRoot=function(a,i){if(!l(a))throw Error(r(299));var o=!1,p="",b=bp,j=Np,k=Sp;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onUncaughtError!==void 0&&(b=i.onUncaughtError),i.onCaughtError!==void 0&&(j=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError)),i=tg(a,1,!1,null,null,o,p,null,b,j,k,mg),a[ks]=i.current,tu(a),new bu(i)},Yi.hydrateRoot=function(a,i,o){if(!l(a))throw Error(r(299));var p=!1,b="",j=bp,k=Np,V=Sp,re=null;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(b=o.identifierPrefix),o.onUncaughtError!==void 0&&(j=o.onUncaughtError),o.onCaughtError!==void 0&&(k=o.onCaughtError),o.onRecoverableError!==void 0&&(V=o.onRecoverableError),o.formState!==void 0&&(re=o.formState)),i=tg(a,1,!0,i,o??null,p,b,re,j,k,V,mg),i.context=ng(null),o=i.current,p=Vn(),p=ei(p),b=pa(p),b.callback=null,ha(o,b,p),o=p,i.current.lanes=o,Pa(i,o),Is(i),a[ks]=i.current,tu(a),new _o(i)},Yi.version="19.2.4",Yi}var jg;function xN(){if(jg)return ju.exports;jg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),ju.exports=gN(),ju.exports}var yN=xN();const vN=om(yN);/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Tg="popstate";function bN(t={}){function n(l,c){let{pathname:d="/",search:u="",hash:h=""}=sr(l.location.hash.substring(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),Fu("",{pathname:d,search:u,hash:h},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function s(l,c){let d=l.document.querySelector("base"),u="";if(d&&d.getAttribute("href")){let h=l.location.href,m=h.indexOf("#");u=m===-1?h:h.slice(0,m)}return u+"#"+(typeof c=="string"?c:al(c))}function r(l,c){Wn(l.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(c)})`)}return SN(n,s,r,t)}function zt(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function Wn(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function NN(){return Math.random().toString(36).substring(2,10)}function wg(t,n){return{usr:t.state,key:t.key,idx:n}}function Fu(t,n,s=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof n=="string"?sr(n):n,state:s,key:n&&n.key||r||NN()}}function al({pathname:t="/",search:n="",hash:s=""}){return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function sr(t){let n={};if(t){let s=t.indexOf("#");s>=0&&(n.hash=t.substring(s),t=t.substring(0,s));let r=t.indexOf("?");r>=0&&(n.search=t.substring(r),t=t.substring(0,r)),t&&(n.pathname=t)}return n}function SN(t,n,s,r={}){let{window:l=document.defaultView,v5Compat:c=!1}=r,d=l.history,u="POP",h=null,m=f();m==null&&(m=0,d.replaceState({...d.state,idx:m},""));function f(){return(d.state||{idx:null}).idx}function v(){u="POP";let T=f(),E=T==null?null:T-m;m=T,h&&h({action:u,location:C.location,delta:E})}function x(T,E){u="PUSH";let R=Fu(C.location,T,E);s&&s(R,T),m=f()+1;let _=wg(R,m),D=C.createHref(R);try{d.pushState(_,"",D)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;l.location.assign(D)}c&&h&&h({action:u,location:C.location,delta:1})}function S(T,E){u="REPLACE";let R=Fu(C.location,T,E);s&&s(R,T),m=f();let _=wg(R,m),D=C.createHref(R);d.replaceState(_,"",D),c&&h&&h({action:u,location:C.location,delta:0})}function w(T){return jN(T)}let C={get action(){return u},get location(){return t(l,d)},listen(T){if(h)throw new Error("A history only accepts one active listener");return l.addEventListener(Tg,v),h=T,()=>{l.removeEventListener(Tg,v),h=null}},createHref(T){return n(l,T)},createURL:w,encodeLocation(T){let E=w(T);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:x,replace:S,go(T){return d.go(T)}};return C}function jN(t,n=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),zt(s,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:al(t);return r=r.replace(/ $/,"%20"),!n&&r.startsWith("//")&&(r=s+r),new URL(r,s)}function Dy(t,n,s="/"){return TN(t,n,s,!1)}function TN(t,n,s,r){let l=typeof n=="string"?sr(n):n,c=ea(l.pathname||"/",s);if(c==null)return null;let d=ky(t);wN(d);let u=null;for(let h=0;u==null&&h<d.length;++h){let m=LN(c);u=MN(d[h],m,r)}return u}function ky(t,n=[],s=[],r="",l=!1){let c=(d,u,h=l,m)=>{let f={relativePath:m===void 0?d.path||"":m,caseSensitive:d.caseSensitive===!0,childrenIndex:u,route:d};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(r)&&h)return;zt(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length)}let v=Qs([r,f.relativePath]),x=s.concat(f);d.children&&d.children.length>0&&(zt(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),ky(d.children,n,x,v,h)),!(d.path==null&&!d.index)&&n.push({path:v,score:kN(v,d.index),routesMeta:x})};return t.forEach((d,u)=>{var h;if(d.path===""||!((h=d.path)!=null&&h.includes("?")))c(d,u);else for(let m of Ry(d.path))c(d,u,!0,m)}),n}function Ry(t){let n=t.split("/");if(n.length===0)return[];let[s,...r]=n,l=s.endsWith("?"),c=s.replace(/\?$/,"");if(r.length===0)return l?[c,""]:[c];let d=Ry(r.join("/")),u=[];return u.push(...d.map(h=>h===""?c:[c,h].join("/"))),l&&u.push(...d),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function wN(t){t.sort((n,s)=>n.score!==s.score?s.score-n.score:RN(n.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}var CN=/^:[\w-]+$/,EN=3,IN=2,_N=1,AN=10,DN=-2,Cg=t=>t==="*";function kN(t,n){let s=t.split("/"),r=s.length;return s.some(Cg)&&(r+=DN),n&&(r+=IN),s.filter(l=>!Cg(l)).reduce((l,c)=>l+(CN.test(c)?EN:c===""?_N:AN),r)}function RN(t,n){return t.length===n.length&&t.slice(0,-1).every((r,l)=>r===n[l])?t[t.length-1]-n[n.length-1]:0}function MN(t,n,s=!1){let{routesMeta:r}=t,l={},c="/",d=[];for(let u=0;u<r.length;++u){let h=r[u],m=u===r.length-1,f=c==="/"?n:n.slice(c.length)||"/",v=qo({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},f),x=h.route;if(!v&&m&&s&&!r[r.length-1].route.index&&(v=qo({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},f)),!v)return null;Object.assign(l,v.params),d.push({params:l,pathname:Qs([c,v.pathname]),pathnameBase:BN(Qs([c,v.pathnameBase])),route:x}),v.pathnameBase!=="/"&&(c=Qs([c,v.pathnameBase]))}return d}function qo(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,r]=PN(t.path,t.caseSensitive,t.end),l=n.match(s);if(!l)return null;let c=l[0],d=c.replace(/(.)\/+$/,"$1"),u=l.slice(1);return{params:r.reduce((m,{paramName:f,isOptional:v},x)=>{if(f==="*"){let w=u[x]||"";d=c.slice(0,c.length-w.length).replace(/(.)\/+$/,"$1")}const S=u[x];return v&&!S?m[f]=void 0:m[f]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:c,pathnameBase:d,pattern:t}}function PN(t,n=!1,s=!0){Wn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,u,h)=>(r.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,n?void 0:"i"),r]}function LN(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Wn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),t}}function ea(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let s=n.endsWith("/")?n.length-1:n.length,r=t.charAt(s);return r&&r!=="/"?null:t.slice(s)||"/"}var ON=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function UN(t,n="/"){let{pathname:s,search:r="",hash:l=""}=typeof t=="string"?sr(t):t,c;return s?(s=s.replace(/\/\/+/g,"/"),s.startsWith("/")?c=Eg(s.substring(1),"/"):c=Eg(s,n)):c=n,{pathname:c,search:GN(r),hash:zN(l)}}function Eg(t,n){let s=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?s.length>1&&s.pop():l!=="."&&s.push(l)}),s.length>1?s.join("/"):"/"}function Eu(t,n,s,r){return`Cannot include a '${t}' character in a manually specified \`to.${n}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function FN(t){return t.filter((n,s)=>s===0||n.route.path&&n.route.path.length>0)}function dm(t){let n=FN(t);return n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase)}function um(t,n,s,r=!1){let l;typeof t=="string"?l=sr(t):(l={...t},zt(!l.pathname||!l.pathname.includes("?"),Eu("?","pathname","search",l)),zt(!l.pathname||!l.pathname.includes("#"),Eu("#","pathname","hash",l)),zt(!l.search||!l.search.includes("#"),Eu("#","search","hash",l)));let c=t===""||l.pathname==="",d=c?"/":l.pathname,u;if(d==null)u=s;else{let v=n.length-1;if(!r&&d.startsWith("..")){let x=d.split("/");for(;x[0]==="..";)x.shift(),v-=1;l.pathname=x.join("/")}u=v>=0?n[v]:"/"}let h=UN(l,u),m=d&&d!=="/"&&d.endsWith("/"),f=(c||d===".")&&s.endsWith("/");return!h.pathname.endsWith("/")&&(m||f)&&(h.pathname+="/"),h}var Qs=t=>t.join("/").replace(/\/\/+/g,"/"),BN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,HN=class{constructor(t,n,s,r=!1){this.status=t,this.statusText=n||"",this.internal=r,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}};function qN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function VN(t){return t.map(n=>n.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var My=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Py(t,n){let s=t;if(typeof s!="string"||!ON.test(s))return{absoluteURL:void 0,isExternal:!1,to:s};let r=s,l=!1;if(My)try{let c=new URL(window.location.href),d=s.startsWith("//")?new URL(c.protocol+s):new URL(s),u=ea(d.pathname,n);d.origin===c.origin&&u!=null?s=u+d.search+d.hash:l=!0}catch{Wn(!1,`<Link to="${s}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:l,to:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Ly=["POST","PUT","PATCH","DELETE"];new Set(Ly);var KN=["GET",...Ly];new Set(KN);var qr=N.createContext(null);qr.displayName="DataRouter";var tc=N.createContext(null);tc.displayName="DataRouterState";var $N=N.createContext(!1),Oy=N.createContext({isTransitioning:!1});Oy.displayName="ViewTransition";var WN=N.createContext(new Map);WN.displayName="Fetchers";var YN=N.createContext(null);YN.displayName="Await";var Yn=N.createContext(null);Yn.displayName="Navigation";var ll=N.createContext(null);ll.displayName="Location";var ds=N.createContext({outlet:null,matches:[],isDataRoute:!1});ds.displayName="Route";var mm=N.createContext(null);mm.displayName="RouteError";var Uy="REACT_ROUTER_ERROR",JN="REDIRECT",XN="ROUTE_ERROR_RESPONSE";function QN(t){if(t.startsWith(`${Uy}:${JN}:{`))try{let n=JSON.parse(t.slice(28));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.location=="string"&&typeof n.reloadDocument=="boolean"&&typeof n.replace=="boolean")return n}catch{}}function ZN(t){if(t.startsWith(`${Uy}:${XN}:{`))try{let n=JSON.parse(t.slice(40));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string")return new HN(n.status,n.statusText,n.data)}catch{}}function eS(t,{relative:n}={}){zt(Vr(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:r}=N.useContext(Yn),{hash:l,pathname:c,search:d}=ol(t,{relative:n}),u=c;return s!=="/"&&(u=c==="/"?s:Qs([s,c])),r.createHref({pathname:u,search:d,hash:l})}function Vr(){return N.useContext(ll)!=null}function As(){return zt(Vr(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(ll).location}var Fy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function By(t){N.useContext(Yn).static||N.useLayoutEffect(t)}function xs(){let{isDataRoute:t}=N.useContext(ds);return t?hS():tS()}function tS(){zt(Vr(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(qr),{basename:n,navigator:s}=N.useContext(Yn),{matches:r}=N.useContext(ds),{pathname:l}=As(),c=JSON.stringify(dm(r)),d=N.useRef(!1);return By(()=>{d.current=!0}),N.useCallback((h,m={})=>{if(Wn(d.current,Fy),!d.current)return;if(typeof h=="number"){s.go(h);return}let f=um(h,JSON.parse(c),l,m.relative==="path");t==null&&n!=="/"&&(f.pathname=f.pathname==="/"?n:Qs([n,f.pathname])),(m.replace?s.replace:s.push)(f,m.state,m)},[n,s,c,l,t])}var nS=N.createContext(null);function sS(t){let n=N.useContext(ds).outlet;return N.useMemo(()=>n&&N.createElement(nS.Provider,{value:t},n),[n,t])}function Gy(){let{matches:t}=N.useContext(ds),n=t[t.length-1];return n?n.params:{}}function ol(t,{relative:n}={}){let{matches:s}=N.useContext(ds),{pathname:r}=As(),l=JSON.stringify(dm(s));return N.useMemo(()=>um(t,JSON.parse(l),r,n==="path"),[t,l,r,n])}function aS(t,n){return zy(t,n)}function zy(t,n,s,r,l){var R;zt(Vr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=N.useContext(Yn),{matches:d}=N.useContext(ds),u=d[d.length-1],h=u?u.params:{},m=u?u.pathname:"/",f=u?u.pathnameBase:"/",v=u&&u.route;{let _=v&&v.path||"";qy(m,!v||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let x=As(),S;if(n){let _=typeof n=="string"?sr(n):n;zt(f==="/"||((R=_.pathname)==null?void 0:R.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${_.pathname}" was given in the \`location\` prop.`),S=_}else S=x;let w=S.pathname||"/",C=w;if(f!=="/"){let _=f.replace(/^\//,"").split("/");C="/"+w.replace(/^\//,"").split("/").slice(_.length).join("/")}let T=Dy(t,{pathname:C});Wn(v||T!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),Wn(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=cS(T&&T.map(_=>Object.assign({},_,{params:Object.assign({},h,_.params),pathname:Qs([f,c.encodeLocation?c.encodeLocation(_.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?f:Qs([f,c.encodeLocation?c.encodeLocation(_.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathnameBase])})),d,s,r,l);return n&&E?N.createElement(ll.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},E):E}function rS(){let t=pS(),n=qN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:r},c={padding:"2px 4px",backgroundColor:r},d=null;return console.error("Error handled by React Router default ErrorBoundary:",t),d=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:c},"ErrorBoundary")," or"," ",N.createElement("code",{style:c},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},n),s?N.createElement("pre",{style:l},s):null,d)}var iS=N.createElement(rS,null),Hy=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){this.props.onError?this.props.onError(t,n):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const s=ZN(t.digest);s&&(t=s)}let n=t!==void 0?N.createElement(ds.Provider,{value:this.props.routeContext},N.createElement(mm.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?N.createElement(lS,{error:t},n):n}};Hy.contextType=$N;var Iu=new WeakMap;function lS({children:t,error:n}){let{basename:s}=N.useContext(Yn);if(typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){let r=QN(n.digest);if(r){let l=Iu.get(n);if(l)throw l;let c=Py(r.location,s);if(My&&!Iu.get(n))if(c.isExternal||r.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:r.replace}));throw Iu.set(n,d),d}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return t}function oS({routeContext:t,match:n,children:s}){let r=N.useContext(qr);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(ds.Provider,{value:t},s)}function cS(t,n=[],s=null,r=null,l=null){if(t==null){if(!s)return null;if(s.errors)t=s.matches;else if(n.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let c=t,d=s==null?void 0:s.errors;if(d!=null){let f=c.findIndex(v=>v.route.id&&(d==null?void 0:d[v.route.id])!==void 0);zt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,f+1))}let u=!1,h=-1;if(s)for(let f=0;f<c.length;f++){let v=c[f];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(h=f),v.route.id){let{loaderData:x,errors:S}=s,w=v.route.loader&&!x.hasOwnProperty(v.route.id)&&(!S||S[v.route.id]===void 0);if(v.route.lazy||w){u=!0,h>=0?c=c.slice(0,h+1):c=[c[0]];break}}}let m=s&&r?(f,v)=>{var x,S;r(f,{location:s.location,params:((S=(x=s.matches)==null?void 0:x[0])==null?void 0:S.params)??{},unstable_pattern:VN(s.matches),errorInfo:v})}:void 0;return c.reduceRight((f,v,x)=>{let S,w=!1,C=null,T=null;s&&(S=d&&v.route.id?d[v.route.id]:void 0,C=v.route.errorElement||iS,u&&(h<0&&x===0?(qy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,T=null):h===x&&(w=!0,T=v.route.hydrateFallbackElement||null)));let E=n.concat(c.slice(0,x+1)),R=()=>{let _;return S?_=C:w?_=T:v.route.Component?_=N.createElement(v.route.Component,null):v.route.element?_=v.route.element:_=f,N.createElement(oS,{match:v,routeContext:{outlet:f,matches:E,isDataRoute:s!=null},children:_})};return s&&(v.route.ErrorBoundary||v.route.errorElement||x===0)?N.createElement(Hy,{location:s.location,revalidation:s.revalidation,component:C,error:S,children:R(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:m}):R()},null)}function fm(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dS(t){let n=N.useContext(qr);return zt(n,fm(t)),n}function uS(t){let n=N.useContext(tc);return zt(n,fm(t)),n}function mS(t){let n=N.useContext(ds);return zt(n,fm(t)),n}function pm(t){let n=mS(t),s=n.matches[n.matches.length-1];return zt(s.route.id,`${t} can only be used on routes that contain a unique "id"`),s.route.id}function fS(){return pm("useRouteId")}function pS(){var r;let t=N.useContext(mm),n=uS("useRouteError"),s=pm("useRouteError");return t!==void 0?t:(r=n.errors)==null?void 0:r[s]}function hS(){let{router:t}=dS("useNavigate"),n=pm("useNavigate"),s=N.useRef(!1);return By(()=>{s.current=!0}),N.useCallback(async(l,c={})=>{Wn(s.current,Fy),s.current&&(typeof l=="number"?await t.navigate(l):await t.navigate(l,{fromRouteId:n,...c}))},[t,n])}var Ig={};function qy(t,n,s){!n&&!Ig[t]&&(Ig[t]=!0,Wn(!1,s))}N.memo(gS);function gS({routes:t,future:n,state:s,onError:r}){return zy(t,void 0,s,r,n)}function tl({to:t,replace:n,state:s,relative:r}){zt(Vr(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=N.useContext(Yn);Wn(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=N.useContext(ds),{pathname:d}=As(),u=xs(),h=um(t,dm(c),d,r==="path"),m=JSON.stringify(h);return N.useEffect(()=>{u(JSON.parse(m),{replace:n,state:s,relative:r})},[u,m,r,n,s]),null}function Vy(t){return sS(t.context)}function tt(t){zt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xS({basename:t="/",children:n=null,location:s,navigationType:r="POP",navigator:l,static:c=!1,unstable_useTransitions:d}){zt(!Vr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),h=N.useMemo(()=>({basename:u,navigator:l,static:c,unstable_useTransitions:d,future:{}}),[u,l,c,d]);typeof s=="string"&&(s=sr(s));let{pathname:m="/",search:f="",hash:v="",state:x=null,key:S="default"}=s,w=N.useMemo(()=>{let C=ea(m,u);return C==null?null:{location:{pathname:C,search:f,hash:v,state:x,key:S},navigationType:r}},[u,m,f,v,x,S,r]);return Wn(w!=null,`<Router basename="${u}"> is not able to match the URL "${m}${f}${v}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:N.createElement(Yn.Provider,{value:h},N.createElement(ll.Provider,{children:n,value:w}))}function yS({children:t,location:n}){return aS(Bu(t),n)}function Bu(t,n=[]){let s=[];return N.Children.forEach(t,(r,l)=>{if(!N.isValidElement(r))return;let c=[...n,l];if(r.type===N.Fragment){s.push.apply(s,Bu(r.props.children,c));return}zt(r.type===tt,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),zt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let d={id:r.props.id||c.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(d.children=Bu(r.props.children,c)),s.push(d)}),s}var Bo="get",Go="application/x-www-form-urlencoded";function nc(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function vS(t){return nc(t)&&t.tagName.toLowerCase()==="button"}function bS(t){return nc(t)&&t.tagName.toLowerCase()==="form"}function NS(t){return nc(t)&&t.tagName.toLowerCase()==="input"}function SS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function jS(t,n){return t.button===0&&(!n||n==="_self")&&!SS(t)}function Gu(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((n,s)=>{let r=t[s];return n.concat(Array.isArray(r)?r.map(l=>[s,l]):[[s,r]])},[]))}function TS(t,n){let s=Gu(t);return n&&n.forEach((r,l)=>{s.has(l)||n.getAll(l).forEach(c=>{s.append(l,c)})}),s}var Do=null;function wS(){if(Do===null)try{new FormData(document.createElement("form"),0),Do=!1}catch{Do=!0}return Do}var CS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _u(t){return t!=null&&!CS.has(t)?(Wn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Go}"`),null):t}function ES(t,n){let s,r,l,c,d;if(bS(t)){let u=t.getAttribute("action");r=u?ea(u,n):null,s=t.getAttribute("method")||Bo,l=_u(t.getAttribute("enctype"))||Go,c=new FormData(t)}else if(vS(t)||NS(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||u.getAttribute("action");if(r=h?ea(h,n):null,s=t.getAttribute("formmethod")||u.getAttribute("method")||Bo,l=_u(t.getAttribute("formenctype"))||_u(u.getAttribute("enctype"))||Go,c=new FormData(u,t),!wS()){let{name:m,type:f,value:v}=t;if(f==="image"){let x=m?`${m}.`:"";c.append(`${x}x`,"0"),c.append(`${x}y`,"0")}else m&&c.append(m,v)}}else{if(nc(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Bo,r=null,l=Go,d=t}return c&&l==="text/plain"&&(d=c,c=void 0),{action:r,method:s.toLowerCase(),encType:l,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function hm(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function IS(t,n,s,r){let l=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${r}`:l.pathname=`${l.pathname}.${r}`:l.pathname==="/"?l.pathname=`_root.${r}`:n&&ea(l.pathname,n)==="/"?l.pathname=`${n.replace(/\/$/,"")}/_root.${r}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${r}`,l}async function _S(t,n){if(t.id in n)return n[t.id];try{let s=await import(t.module);return n[t.id]=s,s}catch(s){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function AS(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function DS(t,n,s){let r=await Promise.all(t.map(async l=>{let c=n.routes[l.route.id];if(c){let d=await _S(c,s);return d.links?d.links():[]}return[]}));return PS(r.flat(1).filter(AS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function _g(t,n,s,r,l,c){let d=(h,m)=>s[m]?h.route.id!==s[m].route.id:!0,u=(h,m)=>{var f;return s[m].pathname!==h.pathname||((f=s[m].route.path)==null?void 0:f.endsWith("*"))&&s[m].params["*"]!==h.params["*"]};return c==="assets"?n.filter((h,m)=>d(h,m)||u(h,m)):c==="data"?n.filter((h,m)=>{var v;let f=r.routes[h.route.id];if(!f||!f.hasLoader)return!1;if(d(h,m)||u(h,m))return!0;if(h.route.shouldRevalidate){let x=h.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:((v=s[0])==null?void 0:v.params)||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function kS(t,n,{includeHydrateFallback:s}={}){return RS(t.map(r=>{let l=n.routes[r.route.id];if(!l)return[];let c=[l.module];return l.clientActionModule&&(c=c.concat(l.clientActionModule)),l.clientLoaderModule&&(c=c.concat(l.clientLoaderModule)),s&&l.hydrateFallbackModule&&(c=c.concat(l.hydrateFallbackModule)),l.imports&&(c=c.concat(l.imports)),c}).flat(1))}function RS(t){return[...new Set(t)]}function MS(t){let n={},s=Object.keys(t).sort();for(let r of s)n[r]=t[r];return n}function PS(t,n){let s=new Set;return new Set(n),t.reduce((r,l)=>{let c=JSON.stringify(MS(l));return s.has(c)||(s.add(c),r.push({key:c,link:l})),r},[])}function Ky(){let t=N.useContext(qr);return hm(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function LS(){let t=N.useContext(tc);return hm(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var gm=N.createContext(void 0);gm.displayName="FrameworkContext";function $y(){let t=N.useContext(gm);return hm(t,"You must render this element inside a <HydratedRouter> element"),t}function OS(t,n){let s=N.useContext(gm),[r,l]=N.useState(!1),[c,d]=N.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:m,onMouseLeave:f,onTouchStart:v}=n,x=N.useRef(null);N.useEffect(()=>{if(t==="render"&&d(!0),t==="viewport"){let C=E=>{E.forEach(R=>{d(R.isIntersecting)})},T=new IntersectionObserver(C,{threshold:.5});return x.current&&T.observe(x.current),()=>{T.disconnect()}}},[t]),N.useEffect(()=>{if(r){let C=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(C)}}},[r]);let S=()=>{l(!0)},w=()=>{l(!1),d(!1)};return s?t!=="intent"?[c,x,{}]:[c,x,{onFocus:Ji(u,S),onBlur:Ji(h,w),onMouseEnter:Ji(m,S),onMouseLeave:Ji(f,w),onTouchStart:Ji(v,S)}]:[!1,x,{}]}function Ji(t,n){return s=>{t&&t(s),s.defaultPrevented||n(s)}}function US({page:t,...n}){let{router:s}=Ky(),r=N.useMemo(()=>Dy(s.routes,t,s.basename),[s.routes,t,s.basename]);return r?N.createElement(BS,{page:t,matches:r,...n}):null}function FS(t){let{manifest:n,routeModules:s}=$y(),[r,l]=N.useState([]);return N.useEffect(()=>{let c=!1;return DS(t,n,s).then(d=>{c||l(d)}),()=>{c=!0}},[t,n,s]),r}function BS({page:t,matches:n,...s}){let r=As(),{future:l,manifest:c,routeModules:d}=$y(),{basename:u}=Ky(),{loaderData:h,matches:m}=LS(),f=N.useMemo(()=>_g(t,n,m,c,r,"data"),[t,n,m,c,r]),v=N.useMemo(()=>_g(t,n,m,c,r,"assets"),[t,n,m,c,r]),x=N.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let C=new Set,T=!1;if(n.forEach(R=>{var D;let _=c.routes[R.route.id];!_||!_.hasLoader||(!f.some(M=>M.route.id===R.route.id)&&R.route.id in h&&((D=d[R.route.id])!=null&&D.shouldRevalidate)||_.hasClientLoader?T=!0:C.add(R.route.id))}),C.size===0)return[];let E=IS(t,u,l.unstable_trailingSlashAwareDataRequests,"data");return T&&C.size>0&&E.searchParams.set("_routes",n.filter(R=>C.has(R.route.id)).map(R=>R.route.id).join(",")),[E.pathname+E.search]},[u,l.unstable_trailingSlashAwareDataRequests,h,r,c,f,n,t,d]),S=N.useMemo(()=>kS(v,c),[v,c]),w=FS(v);return N.createElement(N.Fragment,null,x.map(C=>N.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...s})),S.map(C=>N.createElement("link",{key:C,rel:"modulepreload",href:C,...s})),w.map(({key:C,link:T})=>N.createElement("link",{key:C,nonce:s.nonce,...T,crossOrigin:T.crossOrigin??s.crossOrigin})))}function GS(...t){return n=>{t.forEach(s=>{typeof s=="function"?s(n):s!=null&&(s.current=n)})}}var zS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{zS&&(window.__reactRouterVersion="7.13.0")}catch{}function HS({basename:t,children:n,unstable_useTransitions:s,window:r}){let l=N.useRef();l.current==null&&(l.current=bN({window:r,v5Compat:!0}));let c=l.current,[d,u]=N.useState({action:c.action,location:c.location}),h=N.useCallback(m=>{s===!1?u(m):N.startTransition(()=>u(m))},[s]);return N.useLayoutEffect(()=>c.listen(h),[c,h]),N.createElement(xS,{basename:t,children:n,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:s})}var Wy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,os=N.forwardRef(function({onClick:n,discover:s="render",prefetch:r="none",relative:l,reloadDocument:c,replace:d,state:u,target:h,to:m,preventScrollReset:f,viewTransition:v,unstable_defaultShouldRevalidate:x,...S},w){let{basename:C,unstable_useTransitions:T}=N.useContext(Yn),E=typeof m=="string"&&Wy.test(m),R=Py(m,C);m=R.to;let _=eS(m,{relative:l}),[D,M,I]=OS(r,S),O=KS(m,{replace:d,state:u,target:h,preventScrollReset:f,relative:l,viewTransition:v,unstable_defaultShouldRevalidate:x,unstable_useTransitions:T});function A(P){n&&n(P),P.defaultPrevented||O(P)}let U=N.createElement("a",{...S,...I,href:R.absoluteURL||_,onClick:R.isExternal||c?n:A,ref:GS(w,M),target:h,"data-discover":!E&&s==="render"?"true":void 0});return D&&!E?N.createElement(N.Fragment,null,U,N.createElement(US,{page:_})):U});os.displayName="Link";var Yy=N.forwardRef(function({"aria-current":n="page",caseSensitive:s=!1,className:r="",end:l=!1,style:c,to:d,viewTransition:u,children:h,...m},f){let v=ol(d,{relative:m.relative}),x=As(),S=N.useContext(tc),{navigator:w,basename:C}=N.useContext(Yn),T=S!=null&&XS(v)&&u===!0,E=w.encodeLocation?w.encodeLocation(v).pathname:v.pathname,R=x.pathname,_=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;s||(R=R.toLowerCase(),_=_?_.toLowerCase():null,E=E.toLowerCase()),_&&C&&(_=ea(_,C)||_);const D=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let M=R===E||!l&&R.startsWith(E)&&R.charAt(D)==="/",I=_!=null&&(_===E||!l&&_.startsWith(E)&&_.charAt(E.length)==="/"),O={isActive:M,isPending:I,isTransitioning:T},A=M?n:void 0,U;typeof r=="function"?U=r(O):U=[r,M?"active":null,I?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let P=typeof c=="function"?c(O):c;return N.createElement(os,{...m,"aria-current":A,className:U,ref:f,style:P,to:d,viewTransition:u},typeof h=="function"?h(O):h)});Yy.displayName="NavLink";var qS=N.forwardRef(({discover:t="render",fetcherKey:n,navigate:s,reloadDocument:r,replace:l,state:c,method:d=Bo,action:u,onSubmit:h,relative:m,preventScrollReset:f,viewTransition:v,unstable_defaultShouldRevalidate:x,...S},w)=>{let{unstable_useTransitions:C}=N.useContext(Yn),T=YS(),E=JS(u,{relative:m}),R=d.toLowerCase()==="get"?"get":"post",_=typeof u=="string"&&Wy.test(u),D=M=>{if(h&&h(M),M.defaultPrevented)return;M.preventDefault();let I=M.nativeEvent.submitter,O=(I==null?void 0:I.getAttribute("formmethod"))||d,A=()=>T(I||M.currentTarget,{fetcherKey:n,method:O,navigate:s,replace:l,state:c,relative:m,preventScrollReset:f,viewTransition:v,unstable_defaultShouldRevalidate:x});C&&s!==!1?N.startTransition(()=>A()):A()};return N.createElement("form",{ref:w,method:R,action:E,onSubmit:r?h:D,...S,"data-discover":!_&&t==="render"?"true":void 0})});qS.displayName="Form";function VS(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jy(t){let n=N.useContext(qr);return zt(n,VS(t)),n}function KS(t,{target:n,replace:s,state:r,preventScrollReset:l,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:u,unstable_useTransitions:h}={}){let m=xs(),f=As(),v=ol(t,{relative:c});return N.useCallback(x=>{if(jS(x,n)){x.preventDefault();let S=s!==void 0?s:al(f)===al(v),w=()=>m(t,{replace:S,state:r,preventScrollReset:l,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:u});h?N.startTransition(()=>w()):w()}},[f,m,v,s,r,n,t,l,c,d,u,h])}function xm(t){Wn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=N.useRef(Gu(t)),s=N.useRef(!1),r=As(),l=N.useMemo(()=>TS(r.search,s.current?null:n.current),[r.search]),c=xs(),d=N.useCallback((u,h)=>{const m=Gu(typeof u=="function"?u(new URLSearchParams(l)):u);s.current=!0,c("?"+m,h)},[c,l]);return[l,d]}var $S=0,WS=()=>`__${String(++$S)}__`;function YS(){let{router:t}=Jy("useSubmit"),{basename:n}=N.useContext(Yn),s=fS(),r=t.fetch,l=t.navigate;return N.useCallback(async(c,d={})=>{let{action:u,method:h,encType:m,formData:f,body:v}=ES(c,n);if(d.navigate===!1){let x=d.fetcherKey||WS();await r(x,s,d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:f,body:v,formMethod:d.method||h,formEncType:d.encType||m,flushSync:d.flushSync})}else await l(d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:f,body:v,formMethod:d.method||h,formEncType:d.encType||m,replace:d.replace,state:d.state,fromRouteId:s,flushSync:d.flushSync,viewTransition:d.viewTransition})},[r,l,n,s])}function JS(t,{relative:n}={}){let{basename:s}=N.useContext(Yn),r=N.useContext(ds);zt(r,"useFormAction must be used inside a RouteContext");let[l]=r.matches.slice(-1),c={...ol(t||".",{relative:n})},d=As();if(t==null){c.search=d.search;let u=new URLSearchParams(c.search),h=u.getAll("index");if(h.some(f=>f==="")){u.delete("index"),h.filter(v=>v).forEach(v=>u.append("index",v));let f=u.toString();c.search=f?`?${f}`:""}}return(!t||t===".")&&l.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(c.pathname=c.pathname==="/"?s:Qs([s,c.pathname])),al(c)}function XS(t,{relative:n}={}){let s=N.useContext(Oy);zt(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Jy("useViewTransitionState"),l=ol(t,{relative:n});if(!s.isTransitioning)return!1;let c=ea(s.currentLocation.pathname,r)||s.currentLocation.pathname,d=ea(s.nextLocation.pathname,r)||s.nextLocation.pathname;return qo(l.pathname,d)!=null||qo(l.pathname,c)!=null}var QS=Ay(),Vo=(t=>(t.EN="en",t.FR="fr",t))(Vo||{}),rl=(t=>(t.PENDING="PENDING",t.ACCEPTED="ACCEPTED",t.EXPIRED="EXPIRED",t))(rl||{}),ym=(t=>(t.ACTIVE="ACTIVE",t.INACTIVE="INACTIVE",t))(ym||{}),_s=(t=>(t.ACTIVE="ACTIVE",t.INACTIVE="INACTIVE",t))(_s||{}),vm=(t=>(t.ACTIVE="ACTIVE",t.INACTIVE="INACTIVE",t))(vm||{}),qt=(t=>(t.FARMER="FARMER",t.EMPLOYEE="EMPLOYEE",t.SERVICE_PROVIDER="SERVICE_PROVIDER",t))(qt||{}),Je=(t=>(t.CREATED="CREATED",t.FREE="FREE",t.ASSIGNED="ASSIGNED",t.CUTTING="CUTTING",t.PLANTED="PLANTED",t.GROWING="GROWING",t.HARVESTED="HARVESTED",t.DRYING="DRYING",t.BAGGING="BAGGING",t.BAGGED="BAGGED",t.IN_STOCK="IN_STOCK",t.EXPORTED="EXPORTED",t.MAINTENANCE="MAINTENANCE",t.STORED="STORED",t))(Je||{}),Kn=(t=>(t.INITIAL_STOCK="INITIAL_STOCK",t.BAGGING_TRANSFER="BAGGING_TRANSFER",t.EXPORT_OUT="EXPORT_OUT",t.FARMER_DELIVERY="FARMER_DELIVERY",t.PRESSING_OUT="PRESSING_OUT",t.PRESSING_IN="PRESSING_IN",t.SITE_TRANSFER_IN="SITE_TRANSFER_IN",t.SITE_TRANSFER_OUT="SITE_TRANSFER_OUT",t.ADJUSTMENT_IN="ADJUSTMENT_IN",t.ADJUSTMENT_OUT="ADJUSTMENT_OUT",t))(Kn||{}),ut=(t=>(t.INITIAL_STOCK="INITIAL_STOCK",t.PRESSING_IN="PRESSING_IN",t.EXPORT_OUT="EXPORT_OUT",t.RETURN_TO_SITE="RETURN_TO_SITE",t.BULK_IN_FROM_SITE="BULK_IN_FROM_SITE",t.PRESSING_CONSUMPTION="PRESSING_CONSUMPTION",t.FARMER_DELIVERY="FARMER_DELIVERY",t.ADJUSTMENT_IN="ADJUSTMENT_IN",t.ADJUSTMENT_OUT="ADJUSTMENT_OUT",t))(ut||{}),zu=(t=>(t.COMMERCIAL_INVOICE="COMMERCIAL_INVOICE",t.PACKING_LIST="PACKING_LIST",t.CERTIFICATE_OF_ORIGIN="CERTIFICATE_OF_ORIGIN",t))(zu||{}),Hu=(t=>(t.GP20="20' GP",t.GP40="40' GP",t.HC40="40' HC",t))(Hu||{}),Ot=(t=>(t.AWAITING_OUTBOUND="AWAITING_OUTBOUND",t.IN_TRANSIT="IN_TRANSIT",t.PENDING_RECEPTION="PENDING_RECEPTION",t.COMPLETED="COMPLETED",t.CANCELLED="CANCELLED",t))(Ot||{}),ls=(t=>(t.OPEN="OPEN",t.IN_PROGRESS="IN_PROGRESS",t.RESOLVED="RESOLVED",t.CLOSED="CLOSED",t))(ls||{});const Ce={DASHBOARD_VIEW:"dashboard:view",OPERATIONS_VIEW:"operations:view",FARM_MAP_VIEW:"farmmap:view",OPERATIONAL_CALENDAR_VIEW:"calendar:view",SITES_VIEW:"sites:view",SITES_MANAGE:"sites:manage",SEAWEED_TYPES_VIEW:"seaweed_types:view",SEAWEED_TYPES_MANAGE:"seaweed_types:manage",MODULES_VIEW:"modules:view",MODULES_MANAGE:"modules:manage",CUTTING_OPERATIONS_VIEW:"cutting_operations:view",CUTTING_OPERATIONS_MANAGE:"cutting_operations:manage",CYCLES_VIEW:"cycles:view",CYCLES_MANAGE:"cycles:manage",HARVESTING_VIEW:"harvesting:view",HARVESTING_MANAGE:"harvesting:manage",DRYING_VIEW:"drying:view",DRYING_MANAGE:"drying:manage",BAGGING_VIEW:"bagging:view",BAGGING_MANAGE:"bagging:manage",INVENTORY_VIEW:"inventory:view",INVENTORY_MANAGE_ON_SITE:"inventory:manage:on_site",INVENTORY_MANAGE_DELIVERIES:"inventory:manage:deliveries",INVENTORY_MANAGE_TRANSFERS:"inventory:manage:transfers",INVENTORY_MANAGE_WAREHOUSE:"inventory:manage:warehouse",EXPORTS_VIEW:"exports:view",EXPORTS_MANAGE:"exports:manage",STAKEHOLDERS_VIEW:"stakeholders:view",FARMERS_VIEW:"farmers:view",FARMERS_MANAGE:"farmers:manage",EMPLOYEES_VIEW:"employees:view",EMPLOYEES_MANAGE:"employees:manage",PROVIDERS_VIEW:"providers:view",PROVIDERS_MANAGE:"providers:manage",CREDITS_VIEW:"credits:view",CREDITS_MANAGE:"credits:manage",PAYMENTS_VIEW:"payments:view",PAYMENTS_MANAGE:"payments:manage",PAYROLL_VIEW:"payroll:view",PAYROLL_MANAGE:"payroll:manage",MONITORING_VIEW:"monitoring:view",TESTS_VIEW:"tests:view",TESTS_MANAGE:"tests:manage",INCIDENTS_VIEW:"incidents:view",INCIDENTS_MANAGE:"incidents:manage",GALLERY_VIEW:"gallery:view",GALLERY_MANAGE:"gallery:manage",REPORTS_VIEW:"reports:view",SETTINGS_VIEW:"settings:view",SETTINGS_GENERAL_MANAGE:"settings:general:manage",USERS_VIEW:"users:view",USERS_INVITE:"users:invite",ROLES_VIEW:"roles:view",ROLES_MANAGE:"roles:manage",INCIDENT_SETTINGS_MANAGE:"settings:incidents:manage"},Xy=[{name:"Dashboard",permissions:[{id:Ce.DASHBOARD_VIEW,label:"View Dashboard"}]},{name:"Operations",permissions:[{id:Ce.OPERATIONS_VIEW,label:"View Operations Menu"},{id:Ce.FARM_MAP_VIEW,label:"View Farm Map"},{id:Ce.OPERATIONAL_CALENDAR_VIEW,label:"View Calendar"},{id:Ce.SITES_VIEW,label:"View Sites"},{id:Ce.SITES_MANAGE,label:"Manage Sites"},{id:Ce.SEAWEED_TYPES_VIEW,label:"View Seaweed Types"},{id:Ce.SEAWEED_TYPES_MANAGE,label:"Manage Seaweed Types"},{id:Ce.MODULES_VIEW,label:"View Modules"},{id:Ce.MODULES_MANAGE,label:"Manage Modules"},{id:Ce.CUTTING_OPERATIONS_VIEW,label:"View Cutting Operations"},{id:Ce.CUTTING_OPERATIONS_MANAGE,label:"Manage Cutting Operations"},{id:Ce.CYCLES_VIEW,label:"View Cultivation Cycles"},{id:Ce.CYCLES_MANAGE,label:"Manage Cultivation Cycles"},{id:Ce.HARVESTING_VIEW,label:"View Harvesting"},{id:Ce.HARVESTING_MANAGE,label:"Manage Harvesting"},{id:Ce.DRYING_VIEW,label:"View Drying"},{id:Ce.DRYING_MANAGE,label:"Manage Drying"},{id:Ce.BAGGING_VIEW,label:"View Bagging"},{id:Ce.BAGGING_MANAGE,label:"Manage Bagging"}]},{name:"Inventory",permissions:[{id:Ce.INVENTORY_VIEW,label:"View Inventory Menu"},{id:Ce.INVENTORY_MANAGE_ON_SITE,label:"Manage On-Site Storage"},{id:Ce.INVENTORY_MANAGE_DELIVERIES,label:"Manage Farmer Deliveries"},{id:Ce.INVENTORY_MANAGE_TRANSFERS,label:"Manage Site Transfers"},{id:Ce.INVENTORY_MANAGE_WAREHOUSE,label:"Manage Pressing Warehouse"},{id:Ce.EXPORTS_VIEW,label:"View Exports"},{id:Ce.EXPORTS_MANAGE,label:"Manage Exports"}]},{name:"Stakeholders & Payments",permissions:[{id:Ce.STAKEHOLDERS_VIEW,label:"View Stakeholders Menu"},{id:Ce.FARMERS_VIEW,label:"View Farmers"},{id:Ce.FARMERS_MANAGE,label:"Manage Farmers"},{id:Ce.EMPLOYEES_VIEW,label:"View Employees"},{id:Ce.EMPLOYEES_MANAGE,label:"Manage Employees"},{id:Ce.PROVIDERS_VIEW,label:"View Service Providers"},{id:Ce.PROVIDERS_MANAGE,label:"Manage Service Providers"},{id:Ce.CREDITS_VIEW,label:"View Farmer Credits"},{id:Ce.CREDITS_MANAGE,label:"Manage Farmer Credits"},{id:Ce.PAYMENTS_VIEW,label:"View Payments"},{id:Ce.PAYMENTS_MANAGE,label:"Manage Payments"},{id:Ce.PAYROLL_VIEW,label:"View Payroll"},{id:Ce.PAYROLL_MANAGE,label:"Manage Payroll"}]},{name:"Monitoring",permissions:[{id:Ce.MONITORING_VIEW,label:"View Monitoring Menu"},{id:Ce.TESTS_VIEW,label:"View Periodic Tests"},{id:Ce.TESTS_MANAGE,label:"Manage Periodic Tests"},{id:Ce.INCIDENTS_VIEW,label:"View Incidents"},{id:Ce.INCIDENTS_MANAGE,label:"Manage Incidents"},{id:Ce.GALLERY_VIEW,label:"View Photo Gallery"},{id:Ce.GALLERY_MANAGE,label:"Manage Photo Gallery"}]},{name:"Reports",permissions:[{id:Ce.REPORTS_VIEW,label:"View Reports"}]},{name:"Settings",permissions:[{id:Ce.SETTINGS_VIEW,label:"View Settings Menu"},{id:Ce.SETTINGS_GENERAL_MANAGE,label:"Manage General Settings"},{id:Ce.USERS_VIEW,label:"View Users"},{id:Ce.USERS_INVITE,label:"Invite New Users"},{id:Ce.ROLES_VIEW,label:"View Roles"},{id:Ce.ROLES_MANAGE,label:"Manage Roles & Permissions"},{id:Ce.INCIDENT_SETTINGS_MANAGE,label:"Manage Incident Settings"}]}],Ko=[{id:"dark-formal",name:"Dark Formal",className:"dark",font:"font-serif"},{id:"dark-glass",name:"Dark Glass",className:"dark glass-dark",font:"font-sans"},{id:"light-formal",name:"Light Formal",className:"light",font:"font-serif"},{id:"light-glass",name:"Light Glass",className:"light glass-light",font:"font-sans"}],Qy=[{value:.01,type:"coin"},{value:.05,type:"coin"},{value:.1,type:"coin"},{value:.25,type:"coin"},{value:.5,type:"coin"},{value:1,type:"coin"},{value:1,type:"banknote"},{value:2,type:"banknote"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"}],Ag=[{value:.01,type:"coin"},{value:.02,type:"coin"},{value:.05,type:"coin"},{value:.1,type:"coin"},{value:.2,type:"coin"},{value:.5,type:"coin"},{value:1,type:"coin"},{value:2,type:"coin"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"},{value:200,type:"banknote"},{value:500,type:"banknote"}],ZS={company:{logoUrl:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMjAgNjAiIHdpZHRoPSIyMjAiIGhlaWdodD0iNjAiPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZDEiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMDZiNmQ0O3N0b3Atb3BhY2l0eToxIiAvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzA4OTFiMjtzdG9wLW9wYWNpdHk6MSIgLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48c3R5bGU+LmxvZ28tdGV4dCB7IGZvbnQtZmFtaWx5OiAnU2Vnb2UgVUknLCAnUm9ib3RvJywgJ0hlbHZldGljYSBOZXVlJywgc2Fucy1zZXJpZjsgZm9udC1zaXplOiAzMnB4OyBmb250LXdlaWdodDogNjAwOyBmaWxsOiB1cmwoI2dyYWQxKTsgfTwvc3R5bGU+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAsIDEwKSI+PHBhdGggZD0iTTE1LDAgQzUsNSA1LDE1IDE1LDIwIFMyNSwyNSAxNSwzMCBDNSwzNSA1LDQ1IDE1LDUwIiBzdHJva2U9Im5vbmUiIGZpbGw9IiMwODkxYjIiIHRyYW5zZm9ybT0ic2NhbGUoMC44KSB0cmFuc2xhdGUoMCwgLTUpIi8+PHBhdGggZD0iTTIwLDAgQzEwLDUgMTAsMTUgMjAsMjAgUzMwLDI1IDIwLDMwIEMxMCwzNSAxMCw0NSAyMCw1MCIgc3Ryb2tlPSJub25lIiBmaWxsPSIjMDZiNmQ0IiB0cmFuc2Zvcm09InNjYWxlKDAuNykgdHJhbnNsYXRlKDUsIC01KSIvPjwvZz48dGV4dCB4PSI1MCIgeT0iNDAiIGNsYXNzPSJsb2dvLXRleHQiPlNFQUZBUk08L3RleHQ+PC9zdmc+",name:"OceanReef Seaweed Inc.",phone:"+1 (555) 123-4567",email:"contact@oceanreef.com",address:"123 Ocean Drive, Marine City, MC 45678",nif:"123456789",rc:"RC/XYZ/2024/001",stat:"STAT-98765",capital:1e6},localization:{country:"US",currency:"USD",currencySymbol:"$",thousandsSeparator:",",decimalSeparator:".",monetaryDecimals:2,nonMonetaryDecimals:2,denominations:Qy.map(t=>({id:`d-${t.value}-${t.type}`,...t})),coordinateFormat:"DMS"},theme:Ko[0],language:Vo.EN},Vt=[{code:"BR",name:"Brazil",currency:"BRL",symbol:"R$",thousandsSeparator:".",decimalSeparator:",",denominations:[{value:.05,type:"coin"},{value:.1,type:"coin"},{value:.25,type:"coin"},{value:.5,type:"coin"},{value:1,type:"coin"},{value:2,type:"banknote"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"},{value:200,type:"banknote"}]},{code:"CA",name:"Canada",currency:"CAD",symbol:"$",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:.05,type:"coin"},{value:.1,type:"coin"},{value:.25,type:"coin"},{value:1,type:"coin"},{value:2,type:"coin"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"}]},{code:"CL",name:"Chile",currency:"CLP",symbol:"$",thousandsSeparator:".",decimalSeparator:",",denominations:[{value:10,type:"coin"},{value:50,type:"coin"},{value:100,type:"coin"},{value:500,type:"coin"},{value:1e3,type:"banknote"},{value:2e3,type:"banknote"},{value:5e3,type:"banknote"},{value:1e4,type:"banknote"},{value:2e4,type:"banknote"}]},{code:"CN",name:"China",currency:"CNY",symbol:"",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:.1,type:"coin"},{value:.5,type:"coin"},{value:1,type:"coin"},{value:1,type:"banknote"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"}]},{code:"FR",name:"France",currency:"EUR",symbol:"",thousandsSeparator:" ",decimalSeparator:",",denominations:Ag},{code:"IN",name:"India",currency:"INR",symbol:"",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:1,type:"coin"},{value:2,type:"coin"},{value:5,type:"coin"},{value:10,type:"coin"},{value:20,type:"coin"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"},{value:200,type:"banknote"},{value:500,type:"banknote"},{value:2e3,type:"banknote"}]},{code:"ID",name:"Indonesia",currency:"IDR",symbol:"Rp",thousandsSeparator:".",decimalSeparator:",",denominations:[{value:100,type:"coin"},{value:200,type:"coin"},{value:500,type:"coin"},{value:1e3,type:"coin"},{value:1e3,type:"banknote"},{value:2e3,type:"banknote"},{value:5e3,type:"banknote"},{value:1e4,type:"banknote"},{value:2e4,type:"banknote"},{value:5e4,type:"banknote"},{value:1e5,type:"banknote"}]},{code:"IE",name:"Ireland",currency:"EUR",symbol:"",thousandsSeparator:".",decimalSeparator:",",denominations:Ag},{code:"JP",name:"Japan",currency:"JPY",symbol:"",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:1,type:"coin"},{value:5,type:"coin"},{value:10,type:"coin"},{value:50,type:"coin"},{value:100,type:"coin"},{value:500,type:"coin"},{value:1e3,type:"banknote"},{value:2e3,type:"banknote"},{value:5e3,type:"banknote"},{value:1e4,type:"banknote"}]},{code:"MG",name:"Madagascar",currency:"MGA",symbol:"Ar",thousandsSeparator:" ",decimalSeparator:",",denominations:[{value:1,type:"coin"},{value:2,type:"coin"},{value:5,type:"coin"},{value:10,type:"coin"},{value:20,type:"coin"},{value:50,type:"coin"},{value:100,type:"banknote"},{value:200,type:"banknote"},{value:500,type:"banknote"},{value:1e3,type:"banknote"},{value:2e3,type:"banknote"},{value:5e3,type:"banknote"},{value:1e4,type:"banknote"},{value:2e4,type:"banknote"}],payroll:{constants:{socialContributions:[{key:"cnaps",rate:.01,cap:2041600},{key:"sanitary",rate:.01,cap:2041600}],incomeTax:{brackets:[{from:0,to:35e4,rate:0},{from:35e4,to:4e5,rate:.05},{from:4e5,to:5e5,rate:.1},{from:5e5,to:6e5,rate:.15},{from:6e5,to:1/0,rate:.2}],minimumPerception:3e3}},labels:{socialContributions:[{key:"cnaps",label:"CNaPS"},{key:"sanitary",label:"OSTIE / SANITAIRE"}],incomeTax:"IRSA"}}},{code:"MY",name:"Malaysia",currency:"MYR",symbol:"RM",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:.05,type:"coin"},{value:.1,type:"coin"},{value:.2,type:"coin"},{value:.5,type:"coin"},{value:1,type:"banknote"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"}]},{code:"KP",name:"North Korea",currency:"KPW",symbol:"",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:10,type:"coin"},{value:50,type:"coin"},{value:100,type:"coin"},{value:1,type:"banknote"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"},{value:200,type:"banknote"},{value:500,type:"banknote"},{value:1e3,type:"banknote"},{value:2e3,type:"banknote"},{value:5e3,type:"banknote"}]},{code:"NO",name:"Norway",currency:"NOK",symbol:"kr",thousandsSeparator:".",decimalSeparator:",",denominations:[{value:1,type:"coin"},{value:5,type:"coin"},{value:10,type:"coin"},{value:20,type:"coin"},{value:50,type:"banknote"},{value:100,type:"banknote"},{value:200,type:"banknote"},{value:500,type:"banknote"},{value:1e3,type:"banknote"}]},{code:"PH",name:"Philippines",currency:"PHP",symbol:"",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:1,type:"coin"},{value:5,type:"coin"},{value:10,type:"coin"},{value:20,type:"coin"},{value:20,type:"banknote"},{value:50,type:"banknote"},{value:100,type:"banknote"},{value:200,type:"banknote"},{value:500,type:"banknote"},{value:1e3,type:"banknote"}]},{code:"KR",name:"South Korea",currency:"KRW",symbol:"",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:10,type:"coin"},{value:50,type:"coin"},{value:100,type:"coin"},{value:500,type:"coin"},{value:1e3,type:"banknote"},{value:5e3,type:"banknote"},{value:1e4,type:"banknote"},{value:5e4,type:"banknote"}]},{code:"TZ",name:"Tanzania",currency:"TZS",symbol:"TSh",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:50,type:"coin"},{value:100,type:"coin"},{value:200,type:"coin"},{value:500,type:"coin"},{value:500,type:"banknote"},{value:1e3,type:"banknote"},{value:2e3,type:"banknote"},{value:5e3,type:"banknote"},{value:1e4,type:"banknote"}]},{code:"GB",name:"United Kingdom",currency:"GBP",symbol:"",thousandsSeparator:",",decimalSeparator:".",denominations:[{value:.01,type:"coin"},{value:.02,type:"coin"},{value:.05,type:"coin"},{value:.1,type:"coin"},{value:.2,type:"coin"},{value:.5,type:"coin"},{value:1,type:"coin"},{value:2,type:"coin"},{value:5,type:"banknote"},{value:10,type:"banknote"},{value:20,type:"banknote"},{value:50,type:"banknote"}]},{code:"US",name:"United States",currency:"USD",symbol:"$",thousandsSeparator:",",decimalSeparator:".",denominations:Qy},{code:"VN",name:"Vietnam",currency:"VND",symbol:"",thousandsSeparator:".",decimalSeparator:",",denominations:[{value:200,type:"coin"},{value:500,type:"coin"},{value:1e3,type:"coin"},{value:2e3,type:"coin"},{value:5e3,type:"coin"},{value:1e4,type:"banknote"},{value:2e4,type:"banknote"},{value:5e4,type:"banknote"},{value:1e5,type:"banknote"},{value:2e5,type:"banknote"},{value:5e5,type:"banknote"}]}],Dg=["EXW (Ex Works)","FCA (Free Carrier)","CPT (Carriage Paid To)","CIP (Carriage and Insurance Paid To)","DAP (Delivered at Place)","DPU (Delivered at Place Unloaded)","DDP (Delivered Duty Paid)","FAS (Free Alongside Ship)","FOB (Free on Board)","CFR (Cost and Freight)","CIF (Cost, Insurance and Freight)"],kg=["Cash in Advance (Prepayment)","Letter of Credit (L/C)","Documentary Collection (D/C)","Open Account (O/A)","Consignment"],ej=[{label:{en:"Dashboard",fr:"Tableau de bord"},path:"/dashboard",icon:"Home",permission:Ce.DASHBOARD_VIEW},{label:{en:"Operations",fr:"Oprations"},icon:"Layers",permission:Ce.OPERATIONS_VIEW,children:[{label:{en:"Farm Map",fr:"Carte de la ferme"},path:"/operations/map",icon:"Map"},{label:{en:"Operational Calendar",fr:"Calendrier Oprationnel"},path:"/operations/calendar",icon:"Calendar"},{label:{en:"Production Sites",fr:"Sites de production"},path:"/sites",icon:"MapPin"},{label:{en:"Seaweed Types",fr:"Types d'algues"},path:"/seaweed-types",icon:"Beaker"},{label:{en:"Module Management",fr:"Gestion des modules"},path:"/modules",icon:"Grid"},{label:{en:"Cutting Operations",fr:"Oprations de coupe"},path:"/operations/cutting",icon:"Scissors"},{label:{en:"Cultivation Cycle",fr:"Cycle de culture"},path:"/cultivation",icon:"GitBranch"},{label:{en:"Harvest & Processing",fr:"Rcolte et traitement"},path:"/harvesting",icon:"Scissors"},{label:{en:"Drying Management",fr:"Gestion du schage"},path:"/drying",icon:"Wind"},{label:{en:"Bagging",fr:"Mise en sac"},path:"/bagging",icon:"Archive"}]},{label:{en:"Inventory",fr:"Inventaire"},icon:"Package",permission:Ce.INVENTORY_VIEW,children:[{label:{en:"On-Site Storage",fr:"Stockage sur site"},path:"/inventory/on-site-storage",icon:"Warehouse"},{label:{en:"Farmer Dry Deliveries",fr:"Livraisons sches des fermiers"},path:"/inventory/farmer-deliveries",icon:"Truck"},{label:{en:"Shipping Slips",fr:"Bons d'expdition"},path:"/inventory/site-transfers",icon:"ArrowRightLeft"},{label:{en:"Pressing Warehouse",fr:"Magasin de presse"},path:"/inventory/pressed-warehouse",icon:"Building"},{label:{en:"Exports",fr:"Exportations"},path:"/exports",icon:"Globe"}]},{label:{en:"Stakeholders & Payments",fr:"Acteurs et paiements"},icon:"Users",permission:Ce.STAKEHOLDERS_VIEW,children:[{label:{en:"Farmer Management",fr:"Gestion des fermiers"},path:"/farmers",icon:"User"},{label:{en:"Employee Management",fr:"Gestion des employs"},path:"/employees",icon:"Briefcase"},{label:{en:"Service Providers",fr:"Prestataires de services"},path:"/providers",icon:"Truck"},{label:{en:"Farmer Credits",fr:"Crdits fermiers"},path:"/farmer-credits",icon:"CreditCard"},{label:{en:"Document Payments",fr:"Paiements sur document"},path:"/document-payments",icon:"FileText"}]},{label:{en:"Monitoring",fr:"Suivi"},icon:"Activity",permission:Ce.MONITORING_VIEW,children:[{label:{en:"Periodic Tests",fr:"Tests priodiques"},path:"/monitoring/tests",icon:"Beaker"},{label:{en:"Incident Management",fr:"Gestion des incidents"},path:"/monitoring/incidents",icon:"AlertTriangle"}]},{label:{en:"Reports",fr:"Rapports"},path:"/reports",icon:"FileSpreadsheet",permission:Ce.REPORTS_VIEW},{label:{en:"User Manual",fr:"Manuel d'utilisateur"},path:"/manual",icon:"BookOpen"},{label:{en:"Settings",fr:"Paramtres"},icon:"Settings",permission:Ce.SETTINGS_VIEW,children:[{label:{en:"General",fr:"Gnraux"},path:"/settings/general",icon:"SlidersHorizontal"},{label:{en:"User Management",fr:"Gestion des utilisateurs"},path:"/settings/users",icon:"Users"},{label:{en:"Roles",fr:"Rles"},path:"/settings/roles",icon:"UserCog"},{label:{en:"Incident Types",fr:"Types d'incident"},path:"/settings/incident-types",icon:"Layers"},{label:{en:"Incident Severities",fr:"Svrits d'incident"},path:"/settings/incident-severities",icon:"TrendingUp"}]}],Zs=45,bm=7,qu=30;function tj(t,n){const[s,r]=N.useState(()=>{if(typeof window>"u")return n;try{const c=window.localStorage.getItem(t);return c?JSON.parse(c):n}catch(c){return console.warn(`Error reading localStorage key ${t}:`,c),n}}),l=c=>{try{const d=c instanceof Function?c(s):c;r(d),typeof window<"u"&&window.localStorage.setItem(t,JSON.stringify(d))}catch(d){console.warn(`Error setting localStorage key ${t}:`,d)}};return N.useEffect(()=>{const c=d=>{if(d.key===t&&d.newValue!==null)try{r(JSON.parse(d.newValue))}catch(u){console.warn(`Error parsing storage change for key ${t}:`,u)}};return window.addEventListener("storage",c),()=>window.removeEventListener("storage",c)},[t]),[s,l]}const Zy=N.createContext(void 0),nj=({children:t})=>{const[n,s]=tj("appSettings",ZS);N.useEffect(()=>{document.body.className="";const l=n.theme.className.split(" ").filter(Boolean);document.body.classList.add(...l,n.theme.font)},[n]);const r=l=>{s(l)};return e.jsx(Zy.Provider,{value:{settings:n,updateSettings:r},children:t})},$e=()=>{const t=N.useContext(Zy);if(t===void 0)throw new Error("useSettings must be used within a SettingsProvider");return t},sj={appName:{en:"SEAFARM MONITOR",fr:"SEAFARM MONITOR"},seaweedType:{en:"Seaweed Type",fr:"Type d'algue"},serviceProvider:{en:"Service Provider",fr:"Prestataire"},farmer:{en:"Farmer",fr:"Fermier"},employee:{en:"Employee",fr:"Employ"},employees:{en:"Employees",fr:"Employs"},farmers:{en:"Farmers",fr:"Fermiers"},modules:{en:"Modules",fr:"Modules"},module:{en:"Module",fr:"Module"},site:{en:"Site",fr:"Site"},zone:{en:"Zone",fr:"Zone"},incident:{en:"Incident",fr:"Incident"},actions:{en:"Actions",fr:"Actions"},edit:{en:"Edit",fr:"Modifier"},delete:{en:"Delete",fr:"Supprimer"},cancel:{en:"Cancel",fr:"Annuler"},save:{en:"Save",fr:"Enregistrer"},confirm:{en:"Confirm",fr:"Confirmer"},close:{en:"Close",fr:"Fermer"},add:{en:"Add",fr:"Ajouter"},loading:{en:"Loading...",fr:"Chargement..."},date:{en:"Date",fr:"Date"},notes:{en:"Notes",fr:"Notes"},status:{en:"Status",fr:"Statut"},print:{en:"Print",fr:"Imprimer"},downloadPdf:{en:"Download PDF",fr:"Tlcharger en PDF"},exportExcel:{en:"Export Excel",fr:"Exporter Excel"},downloading:{en:"Downloading...",fr:"Tlchargement..."},back:{en:"Back",fr:"Retour"},optional:{en:"optional",fr:"optionnel"},apply:{en:"Apply",fr:"Appliquer"},all:{en:"All",fr:"Tous"},scan:{en:"Scan",fr:"Scanner"},unknown:{en:"Unknown",fr:"Inconnu"},yes:{en:"Yes",fr:"Oui"},no:{en:"No",fr:"Non"},none:{en:"None",fr:"Aucun"},batch:{en:"Batch",fr:"Lot"},unknown_batch:{en:"Unknown Batch",fr:"Lot inconnu"},welcomeBack:{en:"Welcome Back",fr:"Bon retour"},invalidCredentials:{en:"Invalid credentials",fr:"Identifiants invalides"},email:{en:"Email Address",fr:"Adresse email"},password:{en:"Password",fr:"Mot de passe"},forgotPassword:{en:"Forgot Password?",fr:"Mot de passe oubli ?"},forgotPasswordTitle:{en:"Forgot Password",fr:"Mot de passe oubli"},forgotPasswordInstructions:{en:"Enter your email address and we will send you a link to reset your password.",fr:"Entrez votre adresse email et nous vous enverrons un lien pour rinitialiser votre mot de passe."},sendResetLink:{en:"Send Reset Link",fr:"Envoyer le lien"},resetLinkSentTitle:{en:"Reset Link Sent",fr:"Lien de rinitialisation envoy"},resetLinkSentInstructions:{en:"Check your email for instructions to reset your password.",fr:"Vrifiez votre email pour les instructions de rinitialisation."},backToLogin:{en:"Back to Login",fr:"Retour  la connexion"},resetPasswordTitle:{en:"Reset Password",fr:"Rinitialiser le mot de passe"},newPassword:{en:"New Password",fr:"Nouveau mot de passe"},confirmNewPassword:{en:"Confirm New Password",fr:"Confirmer le nouveau mot de passe"},passwordMismatch:{en:"Passwords do not match",fr:"Les mots de passe ne correspondent pas"},passwordResetSuccess:{en:"Password reset successfully. Redirecting to login...",fr:"Mot de passe rinitialis avec succs. Redirection vers la connexion..."},invalidOrExpiredToken:{en:"Invalid or expired token.",fr:"Jeton invalide ou expir."},emailExists:{en:"Email already exists",fr:"L'email existe dj"},unassigned:{en:"Unassigned",fr:"Non assign"},traceabilityReport:{en:"Traceability Report",fr:"Rapport de traabilit"},moduleTraceability:{en:"Module Traceability",fr:"Traabilit du module"},batchTraceability:{en:"Batch Traceability",fr:"Traabilit du lot"},originInformation:{en:"Origin Information",fr:"Informations d'origine"},batchHistory:{en:"Batch History",fr:"Historique du lot"},dryingProcess:{en:"Drying Process",fr:"Processus de schage"},noActiveCycleFoundForModule:{en:"No active cycle found for this module.",fr:"Aucun cycle actif trouv pour ce module."},noDataForReport:{en:"No data available for this report period.",fr:"Aucune donne disponible pour cette priode de rapport."},noActions:{en:"No actions available.",fr:"Aucune action disponible."},search:{en:"Search",fr:"Rechercher"},stockHistory:{en:"Stock History",fr:"Historique du Stock"},clickForHistory:{en:"Click to view history",fr:"Cliquez pour voir l'historique"},firstName:{en:"First Name",fr:"Prnom"},lastName:{en:"Last Name",fr:"Nom"},confirmDeleteTitle:{en:"Confirm Deletion",fr:"Confirmer la suppression"},tip_title:{en:"Tip",fr:"Astuce"},noHistory:{en:"No history events.",fr:"Aucun historique."},days:{en:"days",fr:"jours"},category:{en:"Category",fr:"Catgorie"},viewDetails:{en:"View Details",fr:"Voir dtails"},weightKg:{en:"Weight (Kg)",fr:"Poids (Kg)"},termsOfUse:{en:"Terms of Use",fr:"Conditions d'utilisation"},privacyPolicy:{en:"Privacy Policy",fr:"Politique de confidentialit"},agreeToTerms:{en:"By signing up, you agree to our",fr:"En vous inscrivant, vous acceptez nos"},dashboard:{en:"Dashboard",fr:"Tableau de bord"},operations:{en:"Operations",fr:"Oprations"},inventory:{en:"Inventory",fr:"Inventaire"},stakeholders:{en:"Stakeholders & Payments",fr:"Acteurs et paiements"},monitoring:{en:"Monitoring",fr:"Suivi"},reports:{en:"Reports",fr:"Rapports"},userManual:{en:"User Manual",fr:"Manuel utilisateur"},settings:{en:"Settings",fr:"Paramtres"},profile:{en:"Profile",fr:"Profil"},logout:{en:"Logout",fr:"Dconnexion"},toggleTheme:{en:"Toggle Theme",fr:"Changer de thme"},notifications:{en:"Notifications",fr:"Notifications"},notifications_count:{en:"{count} notifications",fr:"{count} notifications"},noNotifications:{en:"No new notifications",fr:"Aucune nouvelle notification"},analyticalDashboard:{en:"Analytical Dashboard",fr:"Tableau de bord analytique"},activeCycles:{en:"Active Cycles",fr:"Cycles actifs"},totalCredits:{en:"Total Credits",fr:"Crdits totaux"},openIncidents:{en:"Open Incidents",fr:"Incidents ouverts"},employeeDistributionBySite:{en:"Employee Distribution by Site",fr:"Rpartition des employs par site"},recentIncidents:{en:"Recent Incidents",fr:"Incidents rcents"},noIncidents:{en:"No recent incidents.",fr:"Aucun incident rcent."},productionTrend:{en:"Production Trend",fr:"Tendance de la production"},performanceCorrelation:{en:"Performance Correlation",fr:"Corrlation des performances"},sitePerformance:{en:"Site Performance",fr:"Performance des sites"},farmerSegmentation:{en:"Farmer Segmentation",fr:"Segmentation des fermiers"},yieldBySeaweedType:{en:"Yield by Seaweed Type",fr:"Rendement par type d'algue"},yieldKgAxis:{en:"Yield (Kg)",fr:"Rendement (Kg)"},durationDaysAxis:{en:"Duration (days)",fr:"Dure (jours)"},totalYieldKgAxis:{en:"Total Yield (Kg)",fr:"Rendement total (Kg)"},numberOfCyclesAxis:{en:"Number of Cycles",fr:"Nombre de cycles"},averageYieldKg:{en:"Average Yield (Kg)",fr:"Rendement moyen (Kg)"},cyclePerformance:{en:"Cycle Performance",fr:"Performance du cycle"},totalYield:{en:"Total Yield",fr:"Rendement total"},aiOperationalInsights:{en:"AI Operational Insights",fr:"Aperus oprationnels par IA"},aiOperationalInsightsDescription:{en:"Get AI-powered insights on your farm operations.",fr:"Obtenez des aperus de vos oprations agricoles, optimiss par l'IA."},generateInsights:{en:"Generate Insights",fr:"Gnrer l'analyse"},farmMapTitle:{en:"Farm Map",fr:"Carte de la ferme"},streetView:{en:"Street View",fr:"Vue rue"},satelliteView:{en:"Satellite View",fr:"Vue satellite"},coordinates:{en:"Coordinates",fr:"Coordonnes"},activeLines:{en:"Active Lines",fr:"Lignes actives"},nearingHarvest:{en:"Nearing Harvest",fr:"Rcolte proche"},overdueHarvest:{en:"Overdue Harvest",fr:"Rcolte en retard"},satelliteAnalysisTitle:{en:"Satellite Analysis",fr:"Analyse satellite"},biomassLegendHigh:{en:"High Biomass",fr:"Biomasse leve"},algalBloomRisk:{en:"Algal Bloom Risk",fr:"Risque d'efflorescence algale"},satelliteSource:{en:"Source: Sentinel-2",fr:"Source: Sentinel-2"},analyzingSatellite:{en:"Analyzing...",fr:"Analyse..."},loadSatelliteData:{en:"Load Satellite Data",fr:"Charger donnes satellite"},operationalCalendarTitle:{en:"Operational Calendar",fr:"Calendrier oprationnel"},projectedHarvest:{en:"Projected Harvest",fr:"Rcolte prvue"},paymentRun:{en:"Payment Run",fr:"Paiement"},incidentsLabel:{en:"Incidents",fr:"Incidents"},periodicTest:{en:"Periodic Test",fr:"Test priodique"},growthRate:{en:"Growth Rate",fr:"Taux de croissance"},identity:{en:"Identity",fr:"Identit"},filterEvents:{en:"Filter Events",fr:"Filtrer les vnements"},invalidQRCode:{en:"Invalid QR Code",fr:"QR Code invalide"},scanInstruction:{en:"Position the QR code inside the frame.",fr:"Positionnez le code QR  l'intrieur du cadre."},photoGallery:{en:"Photo Gallery",fr:"Galerie Photos"},addPhoto:{en:"Add Photo",fr:"Ajouter une Photo"},photoCommentPlaceholder:{en:"Add a comment for this photo...",fr:"Ajoutez un commentaire pour cette photo..."},uploadDate:{en:"Uploaded on",fr:"Ajout le"},noPhotos:{en:"No photos in the gallery.",fr:"Aucune photo dans la galerie."},confirmDeletePhoto:{en:"Are you sure you want to delete this photo?",fr:"tes-vous sr de vouloir supprimer cette photo ?"},photoUploadedSuccess:{en:"Photo uploaded successfully.",fr:"Photo tlcharge avec succs."},validationRequired:{en:"This field is required",fr:"Ce champ est requis"},validationPositiveNumber:{en:"Must be a positive number",fr:"Doit tre un nombre positif"},validationNonNegative:{en:"Must be a non-negative number",fr:"Doit tre un nombre non-ngatif"},validationEmail:{en:"Invalid email format",fr:"Format d'email invalide"},validationSelectAtLeastOne:{en:"Select at least one item",fr:"Slectionnez au moins un lment"},validationDDLatitudeRange:{en:"Latitude must be a number between -90 and 90.",fr:"La latitude doit tre un nombre entre -90 et 90."},validationDDLongitudeRange:{en:"Longitude must be a number between -180 and 180.",fr:"La longitude doit tre un nombre entre -180 et 180."},settingsTitle:{en:"General Settings",fr:"Paramtres gnraux"},companySection:{en:"Company Information",fr:"Informations de l'entreprise"},localizationSection:{en:"Localization",fr:"Localisation"},denominationsSection:{en:"Currency Denominations",fr:"Coupures montaires"},interfaceSection:{en:"Interface",fr:"Interface"},saveConfiguration:{en:"Save Configuration",fr:"Enregistrer la configuration"},configurationSaved:{en:"Configuration saved successfully.",fr:"Configuration enregistre avec succs."},companyName:{en:"Company Name",fr:"Raison sociale"},capital:{en:"Share Capital",fr:"Capital social"},nif:{en:"Tax ID (NIF)",fr:"NIF"},rc:{en:"Trade Register (RC)",fr:"Registre du commerce (RCS)"},stat:{en:"Statistical ID (STAT)",fr:"Numro statistique (STAT)"},logo:{en:"Company Logo",fr:"Logo de l'entreprise"},changeLogo:{en:"Upload Logo",fr:"Tlcharger le logo"},removeLogo:{en:"Remove Logo",fr:"Supprimer le logo"},logoPreview:{en:"Logo Preview",fr:"Aperu du logo"},country:{en:"Country",fr:"Pays"},currencyFormat:{en:"Currency Format",fr:"Format de la devise"},separator_comma:{en:"Comma",fr:"Virgule"},separator_dot:{en:"Dot",fr:"Point"},separator_space:{en:"Space",fr:"Espace"},thousandsSeparator:{en:"Thousands Separator",fr:"Sparateur de milliers"},decimalSeparator:{en:"Decimal Separator",fr:"Sparateur dcimal"},monetaryDecimals:{en:"Monetary Decimals",fr:"Dcimales montaires"},nonMonetaryDecimals:{en:"Non-monetary Decimals",fr:"Dcimales non montaires"},coins:{en:"Coins",fr:"Pices"},banknotes:{en:"Bank Notes",fr:"Billets de banque"},denominationsDescriptionNew:{en:"Select the denominations available in your currency.",fr:"Slectionnez les coupures disponibles dans votre devise."},noDenominationsForCountry:{en:"No denominations found for this country.",fr:"Aucune coupure montaire trouve pour ce pays."},language_en:{en:"English",fr:"Anglais"},language_fr:{en:"French",fr:"Franais"},visualAppearance:{en:"Visual Appearance",fr:"Apparence visuelle"},roleManagementTitle:{en:"Role Management",fr:"Gestion des rles"},addRole:{en:"Add New Role",fr:"Ajouter un nouveau rle"},roleName:{en:"Role Name",fr:"Nom du rle"},editRole:{en:"Edit Role",fr:"Modifier le rle"},confirmDeleteRole:{en:"Are you sure you want to delete this role?",fr:"tes-vous sr de vouloir supprimer ce rle ?"},dataManagementSection:{en:"Data Management",fr:"Gestion des donnes"},resetData:{en:"Reset All Data",fr:"Rinitialiser les donnes"},resetDataWarning:{en:"This will permanently delete all data in the application. This action cannot be undone.",fr:"Cette action supprimera dfinitivement toutes les donnes de l'application. Cette action est irrversible."},confirmResetData:{en:"Are you sure you want to reset all data? This is irreversible.",fr:"tes-vous sr de vouloir rinitialiser toutes les donnes ? C'est irrversible."},dataResetSuccess:{en:"All data has been reset successfully.",fr:"Toutes les donnes ont t rinitialises avec succs."},userProfileTitle:{en:"User Profile",fr:"Profil Utilisateur"},editProfile:{en:"Edit Profile",fr:"Modifier le profil"},profileUpdatedSuccess:{en:"Profile updated successfully.",fr:"Profil mis  jour avec succs."},saveChanges:{en:"Save Changes",fr:"Enregistrer les modifications"},phoneNumber:{en:"Phone Number",fr:"Numro de Tlphone"},customRoleFor:{en:"Custom Role for {recipient}",fr:"Rle personnalis pour {recipient}"},sendInvitation:{en:"Send Invitation",fr:"Envoyer l'Invitation"},inviteMode:{en:"Invite Mode",fr:"Mode d'Invitation"},selectRoleMode:{en:"Assign Role",fr:"Assigner un Rle"},customPermissionsMode:{en:"Custom Permissions",fr:"Permissions Personnalises"},validationPhone:{en:"Invalid phone number",fr:"Numro de tlphone invalide"},manual_architecture_title:{en:"System Architecture",fr:"Architecture du systme"},manual_setup_title:{en:"Initial Setup & Configuration",fr:"Configuration initiale"},manual_production_title:{en:"Production & Cultivation",fr:"Production & Culture"},manual_inventory_title:{en:"Logistics Flow",fr:"Flux logistique"},manual_finance_title:{en:"Finance & Payments",fr:"Finance & Paiements"},manual_monitoring_title:{en:"Monitoring & Quality Control",fr:"Suivi & Contrle qualit"},manual_reports_title:{en:"Data Reporting & Export",fr:"Rapports & Exportation"},status_legend_title:{en:"Status Color Codes",fr:"Lgende des codes couleurs"},manual_setup_desc:{en:"Before starting operations, ensure the base data is correctly configured.",fr:"Avant de commencer les oprations, assurez-vous que les donnes de base sont correctement configures."},step_desc_define_locations:{en:"Define Locations",fr:"Dfinir les lieux"},step_desc_create_infra:{en:"Create Infrastructure",fr:"Crer l'infrastructure"},step_desc_add_personnel:{en:"Add Personnel",fr:"Ajouter le personnel"},step_desc_link_farmers:{en:"Link Farmers to Modules",fr:"Lier fermiers aux modules"},step_desc_collection:{en:"Collection",fr:"Collecte"},step_desc_shipping_slip:{en:"Shipping Slip",fr:"Bon d'expdition"},step_desc_reception:{en:"Reception",fr:"Rception"},step_desc_processing:{en:"Processing",fr:"Traitement"},step_desc_shipping:{en:"Shipping",fr:"Expdition"},step_desc_weekly:{en:"Weekly",fr:"Hebdomadaire"},step_desc_ai:{en:"AI Diagnosis",fr:"Diagnostic IA"},step_desc_action:{en:"Action Plan",fr:"Plan d'action"},manual_inventory_note:{en:'Note: Site Transfers create "Shipping Slips". Pressing uses "Pressing Slips" to convert Bulk stock to Pressed Bales.',fr:`Note : Les transferts inter-sites crent des "Bons d'expdition". Le pressage utilise des "Bons de pressage" pour convertir le vrac en balles.`},desc_select_payment_type:{en:"Select Wet/Dry/Service/Payroll",fr:"Slectionner Humide/Sec/Prestation/Paie"},desc_filter_site:{en:"Filter by site (optional)",fr:"Filtrer par site (optionnel)"},manual_finance_formula_title:{en:"Net Payable Formula",fr:"Formule du net  payer"},manual_finance_formula_text:{en:`(Harvest Weight - Cuttings) * Price
- Credits (Rice, Cash)
= Net Payment`,fr:`(Poids Rcolt - Boutures) * Prix
- Crdits (Riz, Espces)
= Net  Payer`},manual_finance_reports_text:{en:"Generate PDF Payment Sheets and Individual Receipts automatically from the Document Payments page.",fr:"Gnrez automatiquement des feuilles de paiement PDF et des reus individuels depuis la page Documents de Paiement."},desc_select_period:{en:"Select growth period (Planting -> P5)",fr:"Slectionner priode de croissance (Plantation -> P5)"},desc_optional_api:{en:"Optional (can fetch from API)",fr:"Optionnel (via API)"},desc_manual_entry:{en:"Manual Entry",fr:"Saisie manuelle"},legend_module_desc:{en:"Green indicates active growth. Blue indicates post-harvest processing.",fr:"Vert indique une croissance active. Bleu indique le traitement post-rcolte."},legend_incident_desc:{en:"Critical incidents trigger immediate alerts on the Dashboard.",fr:"Les incidents critiques dclenchent des alertes immdiates sur le tableau de bord."},manual_finance_desc:{en:"Track farmer credits, record repayments, and generate payment sheets for wet/dry deliveries and services.",fr:"Suivez les crdits fermiers, enregistrez les remboursements et gnrez des feuilles de paiement pour les livraisons humides/sches et les services."},step_sites:{en:"Create Sites",fr:"Crer sites"},step_modules:{en:"Setup Modules",fr:"Config modules"},step_farmers:{en:"Register Farmers",fr:"Enr. fermiers"},step_assign:{en:"Assignation",fr:"Assignation"},step_log_test:{en:"Log Environmental Data",fr:"Saisie donnes environnement"},step_analyze_pest:{en:"Analyze Pests (AI)",fr:"Analyse parasites (IA)"},step_resolve_incident:{en:"Resolve & Close",fr:"Rsoudre & fermer"},field_site_name:{en:'The display name of the site (e.g., "Site A").',fr:`Le nom d'affichage du site (ex: "Site A").`},field_manager:{en:"The employee responsible for this site.",fr:"L'employ responsable de ce site."},field_zones:{en:"Geographical subdivisions drawn on the map.",fr:"Subdivisions gographiques dessines sur la carte."},field_module_code:{en:"Unique identifier (auto-generated or manual).",fr:"Identifiant unique (auto-gnr ou manuel)."},field_module_lines:{en:"Number of cultivation lines in this module.",fr:"Nombre de lignes de culture dans ce module."},field_harvest_weight:{en:"Wet weight of seaweed measured immediately after harvest.",fr:"Poids humide des algues mesur immdiatement aprs la rcolte."},field_cuttings_taken:{en:"Weight of seaweed kept for replanting (deducted from net production).",fr:"Poids des algues conserves pour la replantation (dduit de la production nette)."},field_water_temp:{en:"Water Temperature (C)",fr:"Temprature eau (C)"},field_salinity:{en:"Salinity ()",fr:"Salinit ()"},report_type_global:{en:"Global Farm Report: The master monthly document.",fr:"Rapport Global : Le document mensuel de rfrence."},report_type_farmer:{en:"Individual Farmer Report: For performance reviews.",fr:"Rapport Individuel : Pour les revues de performance."},report_type_payment:{en:"Payment Sheets: For payroll and cash distribution.",fr:"Feuilles de Paie : Pour la distribution."},legend_module_status:{en:"Module Statuses",fr:"Statuts des modules"},legend_incident_severity:{en:"Incident Severity",fr:"Gravit incident"},status_PLANTED:{en:"Planted",fr:"Plant"},status_GROWING:{en:"Growing",fr:"En croissance"},status_HARVESTED:{en:"Harvested",fr:"Rcolt"},status_DRYING:{en:"Drying",fr:"Schage"},status_BAGGING:{en:"Bagging",fr:"Ensachage"},status_BAGGED:{en:"Bagged",fr:"Ensach"},status_IN_STOCK:{en:"In Stock",fr:"En stock"},status_EXPORTED:{en:"Exported",fr:"Export"},status_MAINTENANCE:{en:"Maintenance",fr:"Maintenance"},status_STORED:{en:"Stored",fr:"Stock"},status_FREE:{en:"Free",fr:"Libre"},status_ASSIGNED:{en:"Assigned",fr:"Assign"},status_CREATED:{en:"Created",fr:"Cr"},status_CUTTING:{en:"Cutting",fr:"Bouturage"},flow_planting:{en:"Planting",fr:"Plantation"},flow_growing:{en:"Growth",fr:"Croissance"},flow_harvest:{en:"Harvest",fr:"Rcolte"},flow_drying:{en:"Drying",fr:"Schage"},flow_bagging:{en:"Bagging",fr:"Ensachage"},flow_stock:{en:"Stock",fr:"Stock"},flow_transfer:{en:"Transfer",fr:"Transfert"},flow_warehouse:{en:"Warehouse",fr:"Magasin"},flow_pressing:{en:"Pressing",fr:"Pressage"},flow_export:{en:"Export",fr:"Export"},tip_auto_growth:{en:"The system automatically calculates growth rates based on initial and harvest weights.",fr:"Le systme calcule automatiquement les taux de croissance bass sur les poids initiaux et rcolts."},tip_map_interaction:{en:"You can click on modules on the map to see their status and perform actions directly.",fr:"Vous pouvez cliquer sur les modules sur la carte pour voir leur statut et effectuer des actions directement."},tip_offline:{en:"The app works offline. Data syncs when connection is restored.",fr:"L'application fonctionne hors ligne. Les donnes se synchronisent au retour de la connexion."},tip_ai_pest:{en:"Use the camera icon in Incident Reporting to take a picture of diseased seaweed. The AI will identify the pest and suggest treatment.",fr:"Utilisez l'icne camra dans le signalement d'incident pour photographier une algue malade. L'IA identifiera le problme et suggrera un traitement."},guide_how_to_harvest:{en:"How to Record a Harvest",fr:"Comment enregistrer une rcolte"},guide_how_to_pay:{en:"How to Run Payments",fr:"Comment excuter les paiements"},guide_periodic_test:{en:"Recording a Periodic Test",fr:"Enregistrer un test priodique"},manual_desc_planting:{en:'Record a "Cutting Operation" to start a cycle.',fr:'Enregistrez une "Opration de coupe" pour dmarrer un cycle.'},manual_desc_harvest:{en:"Log harvested weight. Cycle moves to Drying.",fr:"Saisissez le poids rcolt. Le cycle passe en schage."},manual_desc_processing:{en:"Track dry weight and bag count. Inventory is updated.",fr:"Suivez le poids sec et le nombre de sacs. L'inventaire est mis  jour."},mon:{en:"Mon",fr:"Lun"},tue:{en:"Tue",fr:"Mar"},wed:{en:"Wed",fr:"Mer"},thu:{en:"Thu",fr:"Jeu"},fri:{en:"Fri",fr:"Ven"},sat:{en:"Sat",fr:"Sam"},sun:{en:"Sun",fr:"Dim"},january:{en:"January",fr:"Janvier"},february:{en:"February",fr:"Fvrier"},march:{en:"March",fr:"Mars"},april:{en:"April",fr:"Avril"},may:{en:"May",fr:"Mai"},june:{en:"June",fr:"Juin"},july:{en:"July",fr:"Juillet"},august:{en:"August",fr:"Aot"},september:{en:"September",fr:"Septembre"},october:{en:"October",fr:"Octobre"},november:{en:"November",fr:"Novembre"},december:{en:"December",fr:"Dcembre"},legend:{en:"Legend",fr:"Lgende"},assignedModule:{en:"Assigned Module",fr:"Module assign"},freeModule:{en:"Free Module",fr:"Module libre"}},aj={siteManagementTitle:{en:"Site Management",fr:"Gestion des sites"},addSite:{en:"Add Site",fr:"Ajouter un site"},sitePerformanceOverview:{en:"Site Performance Overview",fr:"Aperu des performances des sites"},geminiSiteAnalysis:{en:"Gemini Site Analysis",fr:"Analyse de Site par Gemini"},generateAnalysis:{en:"Generate Analysis",fr:"Gnrer l'analyse"},sites:{en:"Sites",fr:"Sites"},totalModules:{en:"Total Modules",fr:"Total des modules"},totalHarvestedWeightBySite:{en:"Total Harvested Weight by Site",fr:"Poids total rcolt par site"},avgHarvestPerModuleCurrentYear:{en:"Avg Yield/Module (Current Year)",fr:"Rendement moyen/module (Anne en cours)"},geoPoints:{en:"Geo Points",fr:"Points Gographiques"},addPoint:{en:"Add Point",fr:"Ajouter un point"},remove:{en:"Remove",fr:"Retirer"},latitude:{en:"Latitude",fr:"Latitude"},longitude:{en:"Longitude",fr:"Longitude"},latitudeDMS:{en:"Latitude (DMS)",fr:"Latitude (DMS)"},longitudeDMS:{en:"Longitude (DMS)",fr:"Longitude (DMS)"},siteLayout:{en:"Site Layout",fr:"Plan du Site"},siteName:{en:"Site Name",fr:"Nom du site"},siteCode:{en:"Site Code",fr:"Code du site"},manager:{en:"Manager",fr:"Responsable"},noManager:{en:"No Manager",fr:"Aucun responsable"},zones:{en:"Zones",fr:"Zones"},zoneName:{en:"Zone Name",fr:"Nom de la zone"},addZone:{en:"Add Zone",fr:"Ajouter une zone"},selectZone:{en:"Select Zone",fr:"Slectionner une zone"},noZonesDefined:{en:"No zones defined for this site.",fr:"Aucune zone dfinie pour ce site."},editSite:{en:"Edit Site",fr:"Modifier le site"},confirmDeleteSite:{en:"Are you sure you want to delete this site?",fr:"tes-vous sr de vouloir supprimer ce site ?"},invalidDMSFormat:{en:"Invalid DMS format",fr:"Format DMS invalide"},coordinateFormat_DMS:{en:"Degrees, Minutes, Seconds",fr:"Degrs, Minutes, Secondes"},coordinateFormat_DD:{en:"Decimal Degrees",fr:"Degrs Dcimaux"},noPoints:{en:"No geo points added yet.",fr:"Aucun point gographique ajout."},moduleManagementTitle:{en:"Module Management",fr:"Gestion des Modules"},addModule:{en:"Add Module",fr:"Ajouter un Module"},moduleCode:{en:"Module Code",fr:"Code Module"},farmer:{en:"Farmer",fr:"Fermier"},filtersTitle:{en:"Filters",fr:"Filtres"},allSites:{en:"All Sites",fr:"Tous les Sites"},allZones:{en:"All Zones",fr:"Toutes les Zones"},allFarmers:{en:"All Farmers",fr:"Tous les Fermiers"},allStatuses:{en:"All Statuses",fr:"Tous les Statuts"},clearFilters:{en:"Clear Filters",fr:"Effacer les Filtres"},status_FREE:{en:"Free",fr:"Libre"},status_ASSIGNED:{en:"Assigned",fr:"Assign"},alerts:{en:"Alerts",fr:"Alertes"},confirmDeleteModule:{en:"Are you sure you want to delete this module?",fr:"tes-vous sr de vouloir supprimer ce module ?"},editModule:{en:"Edit Module",fr:"Modifier le Module"},configuration:{en:"Configuration",fr:"Configuration"},lines:{en:"Lines",fr:"Lignes"},galvanizedPoles:{en:"Galvanized Poles",fr:"Piquets Galvaniss"},woodPoles:{en:"Wood Poles",fr:"Piquets en Bois"},plasticPoles:{en:"Plastic Poles",fr:"Piquets en Plastique"},moduleMoveActiveCycleWarning:{en:"Warning: This module has an active cultivation cycle. Moving it might affect data consistency.",fr:"Attention : Ce module a un cycle de culture actif. Le dplacer pourrait affecter la cohrence des donnes."},moduleStatusHistoryTitle:{en:"Module Status History",fr:"Historique du Statut du Module"},notes_moduleReadyForAssignment:{en:"Module is ready for assignment.",fr:"Le module est prt  tre assign."},notes_moduleAssignedToFarmer:{en:"Assigned to farmer {farmerName}",fr:"Assign au fermier {farmerName}"},notes_cycleCompletedModuleAvailable:{en:"Cycle completed. Module is available.",fr:"Cycle termin. Le module est disponible."},moduleDetails:{en:"Module Details",fr:"Dtails du Module"},generalInformation:{en:"General Information",fr:"Informations Gnrales"},cultivationCycleManagementTitle:{en:"Cultivation Cycles",fr:"Cycles de Culture"},cultivationCycle:{en:"Cultivation Cycle",fr:"Cycle de Culture"},addCycle:{en:"Add Cycle",fr:"Ajouter un Cycle"},ageInDays:{en:"Age (Days)",fr:"ge (Jours)"},harvestDate:{en:"Harvest Date",fr:"Date de Rcolte"},harvest:{en:"Harvest",fr:"Rcolter"},history:{en:"History",fr:"Historique"},performance:{en:"Performance",fr:"Performance"},initialWeight:{en:"Initial Weight",fr:"Poids Initial"},linesPlanted:{en:"Lines Planted",fr:"Lignes Plantes"},harvestedWeight:{en:"Harvested Weight",fr:"Poids Rcolt"},linesHarvested:{en:"Lines Harvested",fr:"Lignes Rcoltes"},aiPrediction:{en:"AI Prediction",fr:"Prdiction IA"},retry:{en:"Retry",fr:"Ressayer"},predictedHarvest:{en:"Predicted Harvest",fr:"Rcolte Prvue"},predictedYieldKg:{en:"Predicted Yield (Kg)",fr:"Rendement Prvu (Kg)"},confidence:{en:"Confidence",fr:"Confiance"},predict:{en:"Predict",fr:"Prdire"},predictionError:{en:"Prediction failed",fr:"chec de la prdiction"},editCycle:{en:"Edit Cycle",fr:"Modifier le Cycle"},module:{en:"Module",fr:"Module"},plantingDate:{en:"Planting Date",fr:"Date de Plantation"},confirmHarvestTitle:{en:"Confirm Harvest",fr:"Confirmer la Rcolte"},confirmHarvestMessage:{en:"Please enter the harvest details below.",fr:"Veuillez entrer les dtails de la rcolte ci-dessous."},wetProduction:{en:"Wet Production (Net)",fr:"Production Humide (Net)"},harvestReason:{en:"Harvest Reason",fr:"Motif de Rcolte"},harvestReason_maturity:{en:"Harvest for maturity",fr:"Rcolte pour maturit"},other:{en:"Other",fr:"Autre"},otherReasonPlaceholder:{en:"Specify reason...",fr:"Prcisez le motif..."},validationReasonRequired:{en:"Reason required",fr:"Motif requis"},exactAge:{en:"Exact Age: {days} days",fr:"ge exact : {days} jours"},confirmDeleteCycle:{en:"Are you sure you want to delete this cycle?",fr:"tes-vous sr de vouloir supprimer ce cycle ?"},harvestedWeightKg:{en:"Total Harvested Weight (Kg)",fr:"Poids total rcolt (Kg)"},cuttingsWeightKg:{en:"Cuttings Taken (Kg)",fr:"Boutures prleves (Kg)"},netHarvestedWeightKg:{en:"Net Weight (Kg)",fr:"Poids Net (Kg)"},cultivationCycleHistoryTitle:{en:"Cycle History",fr:"Historique du Cycle"},noCycleHistoryEvents:{en:"No history events found for this cycle.",fr:"Aucun vnement historique trouv pour ce cycle."},cuttingOperationsTitle:{en:"Cutting Operations",fr:"Oprations de Coupe"},newPlanting:{en:"New Planting (Cutting)",fr:"Nouvelle Plantation (Bouturage)"},addOperation:{en:"Add Operation",fr:"Ajouter une Opration"},beneficiaryFarmers:{en:"Beneficiary Farmers",fr:"Fermiers Bnficiaires"},modules_cutting:{en:"Modules",fr:"Modules"},isPaid:{en:"Is Paid",fr:"Est Pay"},paid:{en:"Paid",fr:"Pay"},unpaid:{en:"Unpaid",fr:"Impay"},paymentDate:{en:"Payment Date",fr:"Date de Paiement"},noBeneficiary:{en:"No Beneficiary",fr:"Aucun Bnficiaire"},editCuttingOperation:{en:"Edit Cutting Operation",fr:"Modifier l'Opration de Coupe"},confirmDeleteCuttingOperation:{en:"Are you sure you want to delete this operation? This will also remove the associated cultivation cycle and any related farmer credits. This action cannot be undone.",fr:"tes-vous sr de vouloir supprimer cette opration ? Cela supprimera galement le cycle de culture associ et tous les crdits fermiers lis. Cette action est irrversible."},selectProvider:{en:"Select Provider",fr:"Slectionner un Prestataire"},unitPricePerLine:{en:"Unit Price per Line",fr:"Prix Unitaire par Ligne"},totalLinesCut:{en:"Total Lines Cut",fr:"Total Lignes Coupes"},noFarmersAssignedToModules:{en:"No farmers assigned to selected modules.",fr:"Aucun fermier assign aux modules slectionns."},dateOperation:{en:"Operation Date",fr:"Date de l'Opration"},detailsModule:{en:"Module Details",fr:"Dtails du Module"},zonePlantation:{en:"Planting Zone",fr:"Zone de Plantation"},numModule:{en:"Module Number",fr:"Numro de Module"},selectAModule:{en:"Select a Module",fr:"Slectionner un Module"},nombreLignesCoupees:{en:"Number of Lines Cut",fr:"Nombre de Lignes Coupes"},poidsInitialLignes:{en:"Initial Weight (Total)",fr:"Poids Initial (Total)"},fermierBeneficiaire:{en:"Beneficiary Farmer",fr:"Fermier Bnficiaire"},valeurBouturage:{en:"Cutting Value",fr:"Valeur du Bouturage"},notes_plantingOperationForModule:{en:"Planting operation for module {code}",fr:"Opration de plantation pour le module {code}"},validationLinesCutPositive:{en:"Lines cut must be greater than 0",fr:"Le nombre de lignes coupes doit tre suprieur  0"},validationPlantingDateAfterOperation:{en:"Planting date must be on or after the operation date.",fr:"La date de plantation doit tre identique ou postrieure  la date de l'opration."},harvestProcessingTitle:{en:"Harvest & Processing",fr:"Rcolte et Traitement"},dryingManagementTitle:{en:"Drying Management",fr:"Gestion du Schage"},baggingManagementTitle:{en:"Bagging Management",fr:"Gestion de l'Ensachage"},startDrying:{en:"Start Drying",fr:"Dmarrer le Schage"},noHarvestedBatches:{en:"No harvested batches waiting for drying.",fr:"Aucun lot rcolt en attente de schage."},startDryingFor:{en:"Start Drying for",fr:"Dmarrer le schage pour"},growthRateUnit:{en:"% / day",fr:"% / jour"},dryingStartDate:{en:"Drying Start Date",fr:"Date de Dbut de Schage"},geminiSuggestion:{en:"Gemini Suggestion",fr:"Suggestion Gemini"},noSuggestion:{en:"No suggestion available.",fr:"Aucune suggestion disponible."},completeDrying:{en:"Complete Drying",fr:"Terminer le Schage"},noBatchesDrying:{en:"No batches currently drying.",fr:"Aucun lot en cours de schage."},completeDryingFor:{en:"Complete Drying for",fr:"Terminer le schage pour"},dryingCompletionDate:{en:"Drying Completion Date",fr:"Date de Fin de Schage"},baggingStartDate:{en:"Bagging Start Date",fr:"Date de Dbut d'Ensachage"},actualDryWeight:{en:"Actual Dry Weight (Kg)",fr:"Poids Sec Rel (Kg)"},dryWeightToBag:{en:"Dry Weight to Bag (Kg)",fr:"Poids Sec  Ensacher (Kg)"},completeBagging:{en:"Complete Bagging",fr:"Terminer l'Ensachage"},noBatchesBagging:{en:"No batches currently bagging.",fr:"Aucun lot en cours d'ensachage."},completeSelectedBatches:{en:"Complete Selected ({count})",fr:"Terminer la Slection ({count})"},confirmBatchBaggingTitle:{en:"Batch Bagging Completion",fr:"Terminaison d'Ensachage en Lot"},confirmBatchBaggingMessage:{en:"You are about to complete bagging for {count} batches. Default bagging date will be set to {date}. Proceed?",fr:"Vous tes sur le point de terminer l'ensachage pour {count} lots. La date par dfaut sera {date}. Continuer ?"},completeBaggingFor:{en:"Complete Bagging for",fr:"Terminer l'ensachage pour"},confirmAndMoveToStock:{en:"Confirm & Move to Stock",fr:"Confirmer & Mettre en Stock"},baggedDate:{en:"Bagged Date",fr:"Date d'Ensachage"},weightToBag:{en:"Weight to Bag",fr:"Poids  Ensacher"},bagWeights:{en:"Bag Weights (Kg)",fr:"Poids des Sacs (Kg)"},bag:{en:"Bag",fr:"Sac"},validationAtLeastOneRequired:{en:"At least one weight is required.",fr:"Au moins un poids est requis."},totalBaggedWeightKg:{en:"Total Bagged Weight",fr:"Poids Total Ensach"},batchBaggingCompleteSuccess:{en:"Batch bagging completed successfully.",fr:"Ensachage par lot termin avec succs."},selectBatch:{en:"Select batch {code}",fr:"Slectionner le lot {code}"},dryingDuration:{en:"Drying Duration (Days)",fr:"Dure de Schage (Jours)"},pricePerLine:{en:"Price per Line",fr:"Prix par Ligne"},baggedWeightKg:{en:"Bagged Weight (Kg)",fr:"Poids Ensach (Kg)"}},rj={clientDetails:{en:"Client / Debtor Details",fr:"Dtails Client / Dbiteur"},notifyPartyDetails:{en:"Notify Party / Consignee Details",fr:"Dtails Destinataire / Partie  notifier"},documentDetails:{en:"Document Details",fr:"Dtails du Document"},docType:{en:"Document Type",fr:"Type de document"},invoiceNo:{en:"Invoice No.",fr:"N Facture"},natureLabel:{en:"Nature of Goods",fr:"Nature de la Marchandise"},poNo:{en:"P.O. No.",fr:"N Bon de Commande"},domiciliationNo:{en:"Domiciliation No.",fr:"N Domiciliation"},rexReference:{en:"REX Reference",fr:"Rfrence REX"},destinationCountry:{en:"Destination Country",fr:"Pays de Destination"},city:{en:"City",fr:"Ville"},notifyParty:{en:"Notify Party",fr:"Destinataire ( notifier)"},debtor:{en:"Debtor / Client",fr:"Client / Dbiteur"},vessel:{en:"Vessel",fr:"Navire"},seaWaybill:{en:"Sea Waybill",fr:"Lettre de Transport Maritime"},voyageNo:{en:"Voyage No.",fr:"N de Voyage"},currency:{en:"Currency",fr:"Devise"},localExchangeRate:{en:"Local Exchange Rate",fr:"Taux de change local"},customsNomenclature:{en:"Customs Nomenclature (HS Code)",fr:"Nomenclature Douanire (Code SH)"},countryOfOrigin:{en:"Country of Origin",fr:"Pays d'Origine"},incoterms:{en:"Incoterms",fr:"Incoterms"},paymentTerms:{en:"Payment Terms",fr:"Conditions de Paiement"},swiftBank:{en:"SWIFT / Bank",fr:"Banque / SWIFT"},selectPressingSlips:{en:"Select Pressing Slips",fr:"Slectionner les Bons de Pressage"},availableSlips:{en:"Available Slips",fr:"Bons Disponibles"},selectedSlips:{en:"Selected Slips",fr:"Bons Slectionns"},totalSelectedWeight:{en:"Total Weight",fr:"Poids Total"},totalSelectedBales:{en:"Total Bales",fr:"Total Balles"},noSlipsAvailable:{en:"No slips available for the selected seaweed type.",fr:"Aucun bon disponible pour le type d'algue slectionn."},containerManagement:{en:"Container Management",fr:"Gestion des Conteneurs"},container:{en:"Container",fr:"Conteneur"},identification:{en:"Identification",fr:"Identification"},weights:{en:"Weights",fr:"Poids"},contentsAndValue:{en:"Contents & Value",fr:"Contenu & Valeur"},containerNo:{en:"Container No.",fr:"N Conteneur"},sealNo:{en:"Seal No.",fr:"N de Plomb"},containerType:{en:"Container Type",fr:"Type de Conteneur"},volumeM3:{en:"Volume (m)",fr:"Volume (m)"},tareKg:{en:"Tare Weight (Kg)",fr:"Poids  Vide (Tare) (Kg)"},packageWeightKg:{en:"Packaging Weight (Kg)",fr:"Poids de l'Emballage (Kg)"},seaweedWeightKg:{en:"Net Seaweed Weight (Kg)",fr:"Poids Net des Algues (Kg)"},grossWeightKg:{en:"Gross Weight (Kg)",fr:"Poids Brut (Kg)"},packagesCount:{en:"Bale Count",fr:"Nombre de Balles"},unitPrice:{en:"Unit Price",fr:"Prix Unitaire"},addContainer:{en:"Add Container",fr:"Ajouter un Conteneur"},totalContainerWeight:{en:"Total Container Weight",fr:"Poids Total des Conteneurs"},totalContainerBales:{en:"Total Container Bales",fr:"Total des Balles"},validationContainerWeights:{en:"Sum of container seaweed weights must match total selected slip weight.",fr:"La somme des poids d'algues des conteneurs doit correspondre au poids total des bons slectionns."},validationContainerBales:{en:"Sum of container bale counts must match total selected slip bales.",fr:"La somme du nombre de balles des conteneurs doit correspondre au total des balles des bons slectionns."},alert_noValidSlips:{en:"No valid pressing slips selected. Please select at least one.",fr:"Aucun bon de pressage valide slectionn. Veuillez en slectionner au moins un."},alert_cannotDetermineSourceSite:{en:"Could not determine the origin site for the selected slips. Please check the data consistency.",fr:"Impossible de dterminer le site d'origine pour les bons slectionns. Veuillez vrifier la cohrence des donnes."},COMMERCIAL_INVOICE:{en:"Commercial Invoice",fr:"Facture Commerciale"},PACKING_LIST:{en:"Packing List",fr:"Liste de Colisage"},CERTIFICATE_OF_ORIGIN:{en:"Certificate of Origin",fr:"Certificat d'Origine"},onSiteStorageTitle:{en:"On-Site Storage",fr:"Stockage sur site"},recordMovement:{en:"Record Movement",fr:"Enregistrer un mouvement"},stockStatus:{en:"Stock Status",fr:"tat du stock"},normalTransfer:{en:"Normal Transfer",fr:"Transfert normal"},movementHistory:{en:"Movement History",fr:"Historique des mouvements"},farmerDeliveriesTitle:{en:"Farmer Dry Deliveries",fr:"Livraisons sches des fermiers"},recordDelivery:{en:"Record Delivery",fr:"Enregistrer une livraison"},slipNo:{en:"Slip No.",fr:"N Bordereau"},farmerLabel:{en:"Farmer",fr:"Fermier"},totalBags:{en:"Total Bales",fr:"Total Balles"},noDeliveriesRecorded:{en:"No deliveries recorded yet.",fr:"Aucune livraison enregistre pour le moment."},confirmDeleteDelivery:{en:"Are you sure you want to delete this delivery? This will also reverse the stock movement.",fr:"tes-vous sr de vouloir supprimer cette livraison ? Cela annulera galement le mouvement de stock."},newDelivery:{en:"New Dry Seaweed Delivery",fr:"Nouvelle livraison d'algues sches"},receivedAtWarehouse:{en:"Record as Received",fr:"Enregistrer comme reu"},destination:{en:"Destination",fr:"Destination"},siteTransfersTitle:{en:"Shipping Slips (Inter-Site Transfers)",fr:"Bons d'expdition (Transferts inter-sites)"},pressedWarehouseTitle:{en:"Pressing Warehouse",fr:"Magasin de Presse"},summaryView:{en:"Summary",fr:"Rsum"},pressingSlips:{en:"Pressing Slips",fr:"Bons de Pressage"},recordPressingSlip:{en:"Record Pressing Slip",fr:"Saisir Bon de Pressage"},newPressingSlip:{en:"New Pressing Slip",fr:"Nouveau Bon de Pressage"},editPressingSlip:{en:"Edit Pressing Slip",fr:"Modifier Bon de Pressage"},bulkSeaweed:{en:"Bulk Seaweed",fr:"Algues en Vrac"},pressedSeaweed:{en:"Pressed Seaweed",fr:"Algues Presses"},forPressing:{en:"For Pressing",fr:"Pour Pressage"},bales:{en:"Bales",fr:"Balles"},linkedExport:{en:"Linked Export",fr:"Export Li"},cannotDeleteLinkedSlip:{en:"Cannot delete: Linked to Export",fr:"Suppression impossible: Li  un Export"},confirmDeletePressingSlip:{en:"Are you sure you want to delete this pressing slip? This will reverse the stock movements.",fr:"tes-vous sr de vouloir supprimer ce bon de pressage ? Cela annulera les mouvements de stock."},confirmDeletePressingSlipLinked:{en:"This slip cannot be deleted because it is linked to an export document.",fr:"Ce bon ne peut pas tre supprim car il est li  un document d'exportation."},exports:{en:"Exports",fr:"Exportations"},createExportDocument:{en:"Create Export Document",fr:"Crer Document Export"},editExportDocument:{en:"Edit Export Document",fr:"Modifier Document Export"},docNo:{en:"Doc No.",fr:"N Doc."},containers:{en:"Containers",fr:"Conteneurs"},documents:{en:"Documents",fr:"Documents"},confirmDeleteExport:{en:"Are you sure you want to delete this export document? This will reverse stock movements.",fr:"tes-vous sr de vouloir supprimer ce document ? Cela annulera les mouvements de stock."},totalStockKgHeader:{en:"Total Stock (Kg)",fr:"Stock total (Kg)"},totalWeightKgDelivery:{en:"Total Weight (Kg)",fr:"Poids total (Kg)"},balesCountLabel:{en:"Bale Count",fr:"Nombre de balles"},bags:{en:"Bags",fr:"Sacs"},sac:{en:"Bag",fr:"Sac"},baleSingular:{en:"Bale",fr:"Balle"},totalStockValue:{en:"Total Stock Value",fr:"Valeur totale du stock"},distinctStockItems:{en:"Distinct Items",fr:"Articles distincts"},stockSummaryBySiteAndType:{en:"Stock Summary by Site & Type",fr:"Rsum du stock par site et type"},stockKg:{en:"Stock (Kg)",fr:"Stock (Kg)"},stockBales:{en:"Stock (Bales)",fr:"Stock (Balles)"},stockBags:{en:"Stock (Bags)",fr:"Stock (Sacs)"},clickForHistory:{en:"Click to view history",fr:"Cliquez pour voir l'historique"},warehouse_totalBalesInStock:{en:"Total Bales in Stock",fr:"Total Balles en Stock"},warehouse_weightKg:{en:"Weight (Kg)",fr:"Poids (Kg)"},noStockData:{en:"No stock data available",fr:"Aucune donne de stock disponible"},stockHistory:{en:"Stock History",fr:"Historique du Stock"},availableBulkStock:{en:"Available Bulk Stock",fr:"Stock Vrac Disponible"},bulkWeightConsumed:{en:"Bulk Weight Consumed",fr:"Poids Vrac Consomm"},pressedBalesProduced:{en:"Pressed Bales Produced",fr:"Balles presses produites"},pressedWeightProduced:{en:"Pressed Weight Produced",fr:"Poids press produit"},pressedWeightObtained:{en:"Pressed Weight Obtained",fr:"Poids Press Obtenu"},bulkInputSection:{en:"Input (Bulk)",fr:"Entre (Vrac)"},pressedOutputSection:{en:"Output (Pressed)",fr:"Sortie (Press)"},recordStockAdjustment:{en:"Record Adjustment",fr:"Enregistrer un ajustement"},direction:{en:"Direction",fr:"Sens"},in:{en:"In",fr:"Entre"},out:{en:"Out",fr:"Sortie"},kg:{en:"Kg",fr:"Kg"},reasonForAdjustment:{en:"Reason for Adjustment",fr:"Motif de l'ajustement"},recordInitialPressedStock:{en:"Record Initial Stock (Bales)",fr:"Enregistrer le stock initial (Balles)"},sourceSite:{en:"Source Site",fr:"Site d'origine"},pendingTransfers:{en:"Pending Transfers",fr:"Transferts en attente"},transferToWarehouse:{en:"Transfer to Warehouse",fr:"Transfrer  l'entrept"},noPendingTransfers:{en:"No pending transfers.",fr:"Aucun transfert en attente."},confirmTransfer:{en:"Confirm Transfer",fr:"Confirmer le transfert"},confirmNormalTransferMessage:{en:"You are about to transfer {count} bagged batches to the warehouse stock. Proceed?",fr:"Vous tes sur le point de transfrer {count} lots ensachs vers le stock de l'entrept. Continuer ?"},createShippingSlip:{en:"Create Shipping Slip",fr:"Crer un bon d'expdition"},destinationSite:{en:"Destination Site",fr:"Site de destination"},transporter:{en:"Transporter",fr:"Transporteur"},currentStock:{en:"Current Stock",fr:"Stock actuel"},shippedWeightKg:{en:"Shipped Weight (Kg)",fr:"Poids expdi (Kg)"},shippedBags:{en:"Shipped Bags",fr:"Sacs expdis"},confirmCompleteTransferTitle:{en:"Complete Transfer",fr:"Terminer le transfert"},confirmCancelTransferTitle:{en:"Cancel Transfer",fr:"Annuler le transfert"},completionDate:{en:"Completion Date",fr:"Date de rception"},cancellationDate:{en:"Cancellation Date",fr:"Date d'annulation"},receivedWeightKg:{en:"Received Weight (Kg)",fr:"Poids reu (Kg)"},receivedBags:{en:"Received Bags",fr:"Sacs reus"},cancellationReason:{en:"Reason for Cancellation",fr:"Motif de l'annulation"},movementType:{en:"Movement Type",fr:"Type de mouvement"},designation:{en:"Designation",fr:"Dsignation"},balance:{en:"Balance",fr:"Solde"},bagWeights:{en:"Bag Weights",fr:"Poids des sacs"},weightKg:{en:"Weight (Kg)",fr:"Poids (Kg)"},baggedWeightKg:{en:"Bagged Weight (Kg)",fr:"Poids Ensach (Kg)"},moduleCode:{en:"Module Code",fr:"Code Module"},baggedDate:{en:"Bagged Date",fr:"Date d'Ensachage"},stockMovement_INITIAL_STOCK:{en:"Initial Stock",fr:"Stock initial"},stockMovement_BAGGING_TRANSFER:{en:"From Bagging",fr:"Depuis ensachage"},stockMovement_EXPORT_OUT:{en:"Export",fr:"Export"},stockMovement_FARMER_DELIVERY:{en:"Farmer Delivery",fr:"Livraison fermier"},stockMovement_PRESSING_OUT:{en:"Sent to Pressing",fr:"Envoy au pressage"},stockMovement_PRESSING_IN:{en:"Received from Pressing",fr:"Reu du pressage"},stockMovement_SITE_TRANSFER_IN:{en:"Transfer In",fr:"Transfert entrant"},stockMovement_SITE_TRANSFER_OUT:{en:"Transfer Out",fr:"Transfert sortant"},stockMovement_ADJUSTMENT_IN:{en:"Adjustment (+)",fr:"Ajustement (+)"},stockMovement_ADJUSTMENT_OUT:{en:"Adjustment (-)",fr:"Ajustement (-)"},pressedStockMovement_INITIAL_STOCK:{en:"Initial Stock",fr:"Stock Initial"},pressedStockMovement_PRESSING_IN:{en:"Pressing Production",fr:"Production Pressage"},pressedStockMovement_EXPORT_OUT:{en:"Export Shipment",fr:"Expdition Export"},pressedStockMovement_RETURN_TO_SITE:{en:"Return to Site",fr:"Retour au Site"},pressedStockMovement_BULK_IN_FROM_SITE:{en:"Bulk Transfer In",fr:"Transfert Vrac Entrant"},pressedStockMovement_PRESSING_CONSUMPTION:{en:"Pressing Consumption",fr:"Consommation Pressage"},pressedStockMovement_FARMER_DELIVERY:{en:"Farmer Delivery",fr:"Livraison Fermier"},pressedStockMovement_ADJUSTMENT_IN:{en:"Adjustment (+)",fr:"Ajustement (+)"},pressedStockMovement_ADJUSTMENT_OUT:{en:"Adjustment (-)",fr:"Ajustement (-)"},status_AWAITING_OUTBOUND:{en:"Awaiting Shipment",fr:"En attente d'expdition"},status_IN_TRANSIT:{en:"In Transit",fr:"En transit"},status_PENDING_RECEPTION:{en:"Pending Reception",fr:"En attente de rception"},status_COMPLETED:{en:"Completed",fr:"Termin"},status_CANCELLED:{en:"Cancelled",fr:"Annul"},transport:{en:"Means of Transport",fr:"Moyen de transport"},representative:{en:"Carrier Representative",fr:"Reprsentant du transporteur"},transport_Truck:{en:"Truck",fr:"Camion"},transport_Boat:{en:"Boat",fr:"Bateau"},validationSameSite:{en:"Source and Destination cannot be the same.",fr:"Le site d'origine et de destination ne peuvent pas tre les mmes."},validationStockUnavailableWeight:{en:"Insufficient weight in stock. Available: {availableStock} kg.",fr:"Poids insuffisant en stock. Disponible : {availableStock} kg."},validationStockUnavailableBags:{en:"Insufficient bags in stock. Available: {availableStock}.",fr:"Nombre de sacs insuffisant en stock. Disponible : {availableStock}."},validationStockUnavailableBulk:{en:"Insufficient bulk stock. Available: {availableStock} kg.",fr:"Stock vrac insuffisant. Disponible : {availableStock} kg."},transportDetails:{en:"Transport Details",fr:"Dtails du transport"},siteTransferHistoryTitle:{en:"Transfer History",fr:"Historique du transfert"},stockTransferDate:{en:"Stock Transfer Date",fr:"Date de transfert au stock"},aiStockAnalysis:{en:"AI Stock Analysis",fr:"Analyse de Stock par IA"}},ij={farmerManagementTitle:{en:"Farmer Management",fr:"Gestion des fermiers"},employeeManagementTitle:{en:"Employee Management",fr:"Gestion des employs"},addFarmer:{en:"Add Farmer",fr:"Ajouter un fermier"},addEmployee:{en:"Add Employee",fr:"Ajouter un employ"},firstName:{en:"First Name",fr:"Prnom"},lastName:{en:"Last Name",fr:"Nom"},code:{en:"Code",fr:"Code"},gender:{en:"Gender",fr:"Genre"},dob:{en:"Date of Birth",fr:"Date de naissance"},birthPlace:{en:"Birth Place",fr:"Lieu de naissance"},idNumber:{en:"ID Number",fr:"Numro CIN"},address:{en:"Address",fr:"Adresse"},maritalStatus:{en:"Marital Status",fr:"tat civil"},nationality:{en:"Nationality",fr:"Nationalit"},parentsInfo:{en:"Parents Info",fr:"Infos parents"},role:{en:"Role",fr:"Fonction"},team:{en:"Team",fr:"quipe"},hireDate:{en:"Hire Date",fr:"Date d'embauche"},grossWage:{en:"Gross Wage",fr:"Salaire brut"},category:{en:"Category",fr:"Catgorie"},noSpecificSite:{en:"No Specific Site",fr:"Aucun site spcifique"},itemsSelected:{en:"{count} items selected",fr:"{count} lments slectionns"},itemsSelected_count:{en:"{count} items selected",fr:"{count} lments slectionns"},deleteSelected:{en:"Delete Selected",fr:"Supprimer la slection"},assignSite:{en:"Assign Site",fr:"Assigner un site"},confirmBulkDeleteTitle:{en:"Delete Multiple Items",fr:"Supprimer plusieurs lments"},confirmBulkDeleteFarmers:{en:"Are you sure you want to delete {count} farmers? This action cannot be undone.",fr:"tes-vous sr de vouloir supprimer {count} fermiers ? Cette action est irrversible."},confirmBulkDeleteEmployees:{en:"Are you sure you want to delete {count} employees? This action cannot be undone.",fr:"tes-vous sr de vouloir supprimer {count} employs ? Cette action est irrversible."},editFarmer:{en:"Edit Farmer",fr:"Modifier le fermier"},editEmployee:{en:"Edit Employee",fr:"Modifier l'employ"},gender_Male:{en:"Male",fr:"Masculin"},gender_Female:{en:"Female",fr:"Fminin"},gender_Other:{en:"Other",fr:"Autre"},maritalStatus_Single:{en:"Single",fr:"Clibataire"},maritalStatus_Married:{en:"Married",fr:"Mari(e)"},maritalStatus_Divorced:{en:"Divorced",fr:"Divorc(e)"},maritalStatus_Widowed:{en:"Widowed",fr:"Veuf/Veuve"},employeeType:{en:"Employment Type",fr:"Type de contrat"},employeeType_PERMANENT:{en:"Permanent",fr:"Permanent"},employeeType_CASUAL:{en:"Casual/Daily",fr:"Journalier"},selectRole:{en:"Select Role",fr:"Slectionner une fonction"},farmerProfile:{en:"Farmer Profile",fr:"Profil fermier"},employeeProfile:{en:"Employee Profile",fr:"Profil employ"},assignSiteTitle:{en:"Assign Site to Selected Items",fr:"Assigner un site aux lments slectionns"},assign:{en:"Assign",fr:"Assigner"},assignFarmerTitle:{en:"Assign Farmer to Modules",fr:"Assigner un fermier aux modules"},multiSiteSelectionWarning:{en:"Selection contains modules from multiple sites. Please select modules from a single site to assign a farmer.",fr:"La slection contient des modules de plusieurs sites. Veuillez slectionner des modules d'un seul site pour assigner un fermier."},noFarmersForSiteWarning:{en:"No farmers found for the site of the selected modules.",fr:"Aucun fermier trouv pour le site des modules slectionns."},searchByNameOrCode:{en:"Search by Name or Code",fr:"Rechercher par nom ou code"},filterBySite:{en:"Filter by Site",fr:"Filtrer par site"},filterByRole:{en:"Filter by Role",fr:"Filtrer par rle"},noEmployeesMatchFilters:{en:"No employees match the current filters.",fr:"Aucun employ ne correspond aux filtres actuels."},selectEmployeeNamed:{en:"Select {name}",fr:"Slectionner {name}"},selectAllEmployees:{en:"Select All Employees",fr:"Slectionner tous les employs"},confirmDeleteEmployee:{en:"Are you sure you want to delete this employee?",fr:"tes-vous sr de vouloir supprimer cet employ ?"},serviceProvidersTitle:{en:"Service Providers",fr:"Prestataires de services"},addProvider:{en:"Add Provider",fr:"Ajouter un prestataire"},serviceType:{en:"Service Type",fr:"Type de service"},contactPerson:{en:"Contact Person",fr:"Personne de contact"},noProviders:{en:"No service providers recorded.",fr:"Aucun prestataire de services enregistr."},editProvider:{en:"Edit Provider",fr:"Modifier le prestataire"},confirmDeleteProvider:{en:"Are you sure you want to delete this provider?",fr:"tes-vous sr de vouloir supprimer ce prestataire ?"},broadcastMessage:{en:"Broadcast",fr:"Diffuser"},broadcastTitle:{en:"Farmer Communication Hub",fr:"Hub de communication fermiers"},composeMessage:{en:"Compose Message",fr:"Rdiger le message"},messageHistory:{en:"Message History",fr:"Historique des messages"},recipientScope:{en:"Recipient Scope",fr:"Porte des destinataires"},scope_ALL:{en:"All Farmers",fr:"Tous les fermiers"},scope_SITE:{en:"Specific Site",fr:"Site spcifique"},scope_SELECTED:{en:"Selected Farmers",fr:"Fermiers slectionns"},messageContent:{en:"Message Content",fr:"Contenu du message"},charCount:{en:"{count} characters",fr:"{count} caractres"},sendMessage:{en:"Send Message",fr:"Envoyer le message"},messageSentSuccess:{en:"Message broadcast initiated successfully.",fr:"Diffusion du message initie avec succs."},channel_SMS:{en:"SMS",fr:"SMS"},channel_WHATSAPP:{en:"WhatsApp",fr:"WhatsApp"},farmerCreditsTitle:{en:"Farmer Credits",fr:"Crdits fermiers"},creditStatus:{en:"Credit Status",fr:"Statut des crdits"},recordCredit:{en:"Record Credit",fr:"Enregistrer un crdit"},recordRepayment:{en:"Record Repayment",fr:"Enregistrer un remboursement"},creditTypeSettings:{en:"Credit Type Settings",fr:"Paramtres des types de crdit"},contractedCredits:{en:"Contracted Credits",fr:"Crdits contracts"},repayments:{en:"Repayments",fr:"Remboursements"},lastRepaymentDate:{en:"Last Repayment",fr:"Dernier remboursement"},remainingBalance:{en:"Remaining Balance",fr:"Solde restant"},selectAllFarmers:{en:"Select All Farmers",fr:"Slectionner tous les fermiers"},selectFarmerNamed:{en:"Select {name}",fr:"Slectionner {name}"},expand:{en:"Expand",fr:"Dvelopper"},collapse:{en:"Collapse",fr:"Rduire"},recordBulkCredit:{en:"Record Bulk Credit",fr:"Crdit group"},recordBulkRepayment:{en:"Record Bulk Repayment",fr:"Remboursement group"},creditsTaken:{en:"Credits Taken",fr:"Crdits pris"},creditType:{en:"Credit Type",fr:"Type de crdit"},creditTypes:{en:"Credit Types",fr:"Types de crdit"},totalAmount:{en:"Total Amount",fr:"Montant total"},noCredits:{en:"No credits recorded.",fr:"Aucun crdit enregistr."},repaymentsMade:{en:"Repayments Made",fr:"Remboursements effectus"},repaymentMethod:{en:"Repayment Method",fr:"Mthode de remboursement"},repaymentMethod_cash:{en:"Cash",fr:"Espces"},repaymentMethod_harvest_deduction:{en:"Harvest Deduction",fr:"Retenue sur rcolte"},noRepayments:{en:"No repayments recorded.",fr:"Aucun remboursement enregistr."},selectSite:{en:"Select Site",fr:"Slectionner un site"},selectFarmer:{en:"Select Farmer",fr:"Slectionner un fermier"},selectType:{en:"Select Type",fr:"Slectionner un type"},withQuantity:{en:"With Quantity",fr:"Avec quantit"},withUnitPrice:{en:"With Unit Price",fr:"Avec prix unitaire"},directAmount:{en:"Direct Amount",fr:"Montant direct"},unit:{en:"Unit",fr:"Unit"},addNewCreditType:{en:"Add New Credit Type",fr:"Ajouter un nouveau type de crdit"},confirmDeleteCreditType:{en:"Are you sure you want to delete this credit type?",fr:"tes-vous sr de vouloir supprimer ce type de crdit ?"},recordCreditForSelected:{en:"Record Credit for {count} Farmers",fr:"Enregistrer un crdit pour {count} fermiers"},bulkCreditMessage:{en:"This credit will be applied to all {count} selected farmers.",fr:"Ce crdit sera appliqu  tous les {count} fermiers slectionns."},recordRepaymentForSelected:{en:"Record Repayment for {count} Farmers",fr:"Enregistrer un remboursement pour {count} fermiers"},bulkRepaymentMessage:{en:"This repayment will be recorded for all {count} selected farmers.",fr:"Ce remboursement sera enregistr pour tous les {count} fermiers slectionns."},repaymentAmount:{en:"Repayment Amount",fr:"Montant du remboursement"},repaymentRecorded:{en:"Repayment recorded successfully.",fr:"Remboursement enregistr avec succs."},confirmDeleteFarmer:{en:"Are you sure you want to delete this farmer?",fr:"tes-vous sr de vouloir supprimer ce fermier ?"},editCreditType:{en:"Edit Credit Type",fr:"Modifier le type de crdit"},quantity:{en:"Quantity",fr:"Quantit"},farmerStatus:{en:"Status",fr:"Statut"},status_ACTIVE:{en:"Active",fr:"Actif"},status_INACTIVE:{en:"Inactive",fr:"Inactif"},joinDate:{en:"Hire Date",fr:"Date d'embauche"},exitDate:{en:"Exit Date",fr:"Date de dpart"},exitReason:{en:"Exit Reason",fr:"Motif du dpart"},fireFarmer:{en:"Fire/Deactivate",fr:"Dbaucher"},hireFarmer:{en:"Re-hire/Activate",fr:"R-embaucher"},confirmFire:{en:"Confirm Deactivation",fr:"Confirmer la dbauche"},confirmFireMessage:{en:"You are about to deactivate {name}. They will be marked as inactive but their data will be preserved.",fr:"Vous tes sur point de dbaucher {name}. Il sera marqu comme inactif mais ses donnes seront conserves."},fire:{en:"Deactivate",fr:"Dbaucher"},seaweedTypeManagementTitle:{en:"Seaweed Type Management",fr:"Gestion des types d'algues"},addSeaweedType:{en:"Add Seaweed Type",fr:"Ajouter un type d'algue"},name:{en:"Name",fr:"Nom"},scientificName:{en:"Scientific Name",fr:"Nom scientifique"},description:{en:"Description",fr:"Description"},wetPrice:{en:"Wet Price",fr:"Prix humide"},dryPrice:{en:"Dry Price",fr:"Prix sec"},cycles:{en:"Cycles",fr:"Cycles"},priceHistory:{en:"Price History",fr:"Historique des prix"},editSeaweedType:{en:"Edit Seaweed Type",fr:"Modifier le type d'algue"},confirmDeleteSeaweedType:{en:"Are you sure you want to delete this seaweed type?",fr:"tes-vous sr de vouloir supprimer ce type d'algue ?"},addNewPrice:{en:"Add New Price",fr:"Ajouter un nouveau prix"},effectiveDate:{en:"Effective Date",fr:"Date d'effet"},noPriceHistory:{en:"No price history available.",fr:"Aucun historique de prix disponible."},allSeaweedTypes:{en:"All Seaweed Types",fr:"Tous les types d'algues"},payrollCalculator:{en:"Payroll Calculator",fr:"Calculateur de paie"},selectEmployeesAndCalculate:{en:"Select employees and calculate payroll.",fr:"Slectionnez des employs et calculez la paie."},processPayrollFor:{en:"Process Payroll for {count} Employees",fr:"Traiter la paie pour {count} employs"},payrollResults:{en:"Payroll Results",fr:"Rsultats de paie"},payrollSummaryForPeriod:{en:"Payroll Summary for {period}",fr:"Rsum de paie pour {period}"},bulkConfigure:{en:"Bulk Configure",fr:"Configuration groupe"},totalAllDeductions:{en:"Total Deductions",fr:"Total des dductions"},totalNetPay:{en:"Total Net Pay",fr:"Total net  payer"},socialDeductions:{en:"Social Deductions",fr:"Dductions sociales"},otherDeductions:{en:"Other Deductions",fr:"Autres dductions"},payrollTotalDeductions:{en:"Total Deductions",fr:"Total dductions"},deductionDetails:{en:"Deduction Details",fr:"Dtails des dductions"},noStatutoryDeductions:{en:"No statutory deductions.",fr:"Aucune dduction statutaire."},applyTo:{en:"Apply To",fr:"Appliquer "},allSelectedEmployees:{en:"All Selected Employees",fr:"Tous les employs slectionns"},bySite:{en:"By Site",fr:"Par site"},byRole:{en:"By Role",fr:"Par rle"},setValue:{en:"Set Value",fr:"Dfinir la valeur"},addToExisting:{en:"Add to Existing",fr:"Ajouter  l'existant"},bonuses:{en:"Bonuses",fr:"Primes"},overtime:{en:"Overtime",fr:"Heures sup."},configureSocialDeductions:{en:"Configure Social Deductions",fr:"Configurer dductions sociales"},showAffectedEmployeesAfterUpdate:{en:"Show affected employees after update",fr:"Afficher les employs affects aprs mise  jour"},applyChanges:{en:"Apply Changes",fr:"Appliquer les changements"},bulkUpdateSummary:{en:"Bulk Update Summary",fr:"Rsum mise  jour groupe"},affectedEmployees:{en:"Affected Employees ({count})",fr:"Employs affects ({count})"},confirmSavePayroll:{en:"Save Payroll Run",fr:"Sauvegarder le cycle de paie"},confirmSavePayrollMessage:{en:"This will save the current payroll calculation as pending payments for all selected employees.",fr:"Cela enregistrera le calcul de paie actuel comme paiements en attente pour tous les employs slectionns."},payrollSavedSuccess:{en:"Payroll run saved successfully.",fr:"Cycle de paie enregistr avec succs."},paymentHistory:{en:"Payment History",fr:"Historique des paiements"},recipientType:{en:"Recipient Type",fr:"Type de bnficiaire"},payNow:{en:"Pay Now",fr:"Payer Maintenant"},paymentRunSetup:{en:"Payment Run Setup",fr:"Configuration cycle de paiement"},periodName:{en:"Period Name",fr:"Nom de la priode"},startDate:{en:"Start Date",fr:"Date de dbut"},endDate:{en:"End Date",fr:"Date de fin"},paymentType:{en:"Payment Type",fr:"Type de paiement"},wetDeliveryPayment:{en:"Wet Harvest Payment",fr:"Paiement Rcolte Humide"},dryDeliveryPayment:{en:"Dry Delivery Payment",fr:"Paiement Livraison Sche"},serviceProviderPayment:{en:"Service Provider Payment",fr:"Paiement Prestataire"},preparePaymentRun:{en:"Prepare Payment Run",fr:"Prparer le cycle de paiement"},reviewPaymentRun:{en:"Review Payment Run",fr:"Rviser le Cycle de Paiement"},configureDeductions:{en:"Configure Deductions",fr:"Configurer les Dductions"},confirmAndPay:{en:"Confirm & Pay",fr:"Confirmer et Payer"},totalPayees:{en:"Total Payees",fr:"Total des Bnficiaires"},totalBaseAmount:{en:"Total Base Amount",fr:"Total de Base"},errorGeneratingNarrative:{en:"Error generating narrative.",fr:"Erreur lors de la gnration du narratif."},totalDeductions:{en:"Total Deductions",fr:"Total des dductions"},totalAmountInWords:{en:"Total Amount in Words",fr:"Arrt la prsente fiche  la somme de"},totalNetPayable:{en:"Total Net Payable",fr:"Total Net  Payer"},newPayment:{en:"New Payment",fr:"Nouveau Paiement"},editPayment:{en:"Edit Payment",fr:"Modifier Paiement"},selectRecipientType:{en:"Select Recipient Type",fr:"Slectionner le Type de Bnficiaire"},recipient:{en:"Recipient",fr:"Destinataire"},selectRecipient:{en:"Select Recipient",fr:"Slectionner le destinataire"},amount:{en:"Amount",fr:"Montant"},paymentMethod:{en:"Payment Method",fr:"Mthode de paiement"},paymentMethod_cash:{en:"Cash",fr:"Espces"},paymentMethod_bank_transfer:{en:"Bank Transfer",fr:"Virement bancaire"},paymentMethod_mobile_money:{en:"Mobile Money",fr:"Mobile Money"},paymentStatus:{en:"Payment Status",fr:"Statut du paiement"},status_PENDING:{en:"Pending",fr:"En attente"},status_PROCESSING:{en:"Processing",fr:"En cours"},status_COMPLETED:{en:"Completed",fr:"Termin"},status_FAILED:{en:"Failed",fr:"chou"},transactionId:{en:"Transaction ID",fr:"ID transaction"},confirmPayment:{en:"Confirm Payment",fr:"Confirmer le paiement"},confirmPaymentMessage:{en:"You are about to record payments for {count} beneficiaries. Proceed?",fr:"Vous tes sur le point d'enregistrer les paiements pour {count} bnficiaires. Continuer ?"},paymentsRecordedSuccess:{en:"Payments recorded successfully.",fr:"Paiements enregistrs avec succs."},alert_noPayrollConfig:{en:"No payroll configuration found for this country.",fr:"Aucune configuration de paie trouve pour ce pays."},adjustment:{en:"Adjustment",fr:"Ajustement"},totalGrossPay:{en:"Total Gross Pay",fr:"Total salaire brut"},employeeSelection:{en:"Employee Selection",fr:"Slection des employs"},paymentDate:{en:"Payment Date",fr:"Date de Paiement"},farmerReceipt:{en:"Farmer Receipt",fr:"Reu fermier"},payslip:{en:"Payslip",fr:"Fiche de paie"},receiptNo:{en:"Receipt No.",fr:"N reu"},paymentDetails:{en:"Payment Details",fr:"Dtails du paiement"},grossAmount:{en:"Gross Amount",fr:"Montant brut"},netPaid:{en:"Net Paid",fr:"Net pay"},mobileMoneyRef:{en:"Mobile Money Ref",fr:"Rf. Mobile Money"},paidBy:{en:"Paid By",fr:"Pay par"},receivedBy:{en:"Received By",fr:"Reu par"},deductions:{en:"Deductions",fr:"Dductions"},recipientType_FARMER:{en:"Farmer",fr:"Fermier"},recipientType_EMPLOYEE:{en:"Employee",fr:"Employ"},recipientType_SERVICE_PROVIDER:{en:"Service Provider",fr:"Prestataire"},allRoles:{en:"All Roles",fr:"Toutes les fonctions"},documentPaymentsTitle:{en:"Payment Documents",fr:"Documents de Paiement"},cuttingPaymentSheetTitle:{en:"CUTTING SERVICE PAYMENT SHEET",fr:"FICHE DE PAIEMENT DE PRESTATION DE BOUTURAGE"},serviceProviderPaymentSheetTitle:{en:"Service Provider Payment",fr:"Paiement Prestataire"},wetDeliveryPaymentSheetTitle:{en:"Wet Seaweed Delivery Payment",fr:"Paiement de livraison d'algues humides"},dryDeliveryPaymentSheetTitle:{en:"Dry Seaweed Delivery Payment",fr:"Paiement de livraison d'algues sches"},employeePayroll:{en:"Employee Payroll",fr:"Paie des Employs"},printDocuments:{en:"Print Documents",fr:"Impression des Documents"},dateLabel:{en:"Date",fr:"Date"},exploitationSite:{en:"Exploitation Site",fr:"Site d'exploitation"},deliveryPeriod:{en:"Delivery Period",fr:"Priode de livraison"},checkNumber:{en:"Check No.",fr:"N du chque"},checkAmount:{en:"Check Amount",fr:"Montant du chque"},pricePerKg:{en:"Price per Kg",fr:"Prix par kg"},page:{en:"Page",fr:"Page"},totalPaymentAmount:{en:"Total Payment Amount",fr:"Montant total du paiement"},dateTrans:{en:"Trans. Date",fr:"Date trans."},poids:{en:"Weight",fr:"Poids"},valeur:{en:"Value",fr:"Valeur"},creditsHeader:{en:"Credits",fr:"Crdits"},creditDeduction:{en:"Credit Deduction",fr:"Dduction Crdit"},resteAPayer:{en:"Net Payable",fr:"Reste  payer"},responsibleSignature:{en:"Responsible Signature",fr:"Signature du responsable"},signature:{en:"Signature",fr:"Signature"},theResponsible:{en:"The Responsible",fr:"Le Responsable"},provider:{en:"Provider",fr:"Prestataire"},numberOfPages:{en:"Number of Pages",fr:"Nombre de pages"},checkAmountInWords:{en:"Check Amount in Words",fr:"Montant du chque en lettres"},totalToPay:{en:"TOTAL TO PAY",fr:"TOTAL  PAYER"},various:{en:"Various",fr:"Divers"},denominationBreakdown:{en:"Denomination Breakdown",fr:"Rpartition des coupures"},breakdownByBeneficiary:{en:"Breakdown by Beneficiary",fr:"Rpartition par bnficiaire"},beneficiary:{en:"Beneficiary",fr:"Bnficiaire"},denomination:{en:"Denomination",fr:"Coupure"},total:{en:"Total",fr:"Total"},period:{en:"Period",fr:"Priode"},unpaidOperations:{en:"Unpaid Ops.",fr:"Oprations Impayes"},serviceDate:{en:"Service Date",fr:"Date de prestation"},perProcurationem:{en:"Per Procurationem",fr:"Par Procuration"},theManager:{en:"The Manager",fr:"Le Grant"},numberOfLines:{en:"Number of Lines",fr:"Nombre de Lignes"},montantAPayer:{en:"Amount to Pay",fr:"Montant  Payer"},summaryTable:{en:"Summary Table",fr:"Tableau de Synthse"},commercialInvoice:{en:"Commercial Invoice",fr:"Facture Commerciale"},packingAndWeightList:{en:"Packing List",fr:"Liste de Colisage"},certificateOfOrigin:{en:"Certificate of Origin",fr:"Certificat d'Origine"},deliveryAddress:{en:"Delivery Address",fr:"Adresse de livraison"},orderRef:{en:"Order Ref.",fr:"Rf. Commande"},packages:{en:"Packages",fr:"Colis"},netWeight:{en:"Net Weight",fr:"Poids Net"},totalExclTax:{en:"TOTAL EXCL. TAX",fr:"TOTAL HT"},amountInWords:{en:"Amount in Words",fr:"Arrt la prsente facture  la somme de"},bankDetails:{en:"Bank Details",fr:"Coordonnes Bancaires"},senderLabel:{en:"Sender",fr:"Expditeur"},recipientLabel:{en:"Recipient",fr:"Destinataire"},signedAtLocation:{en:"Signed at {location}, on {date}",fr:"Fait  {location}, le {date}"},managePermissions:{en:"Manage Permissions",fr:"Grer les permissions"},managePermissionsFor:{en:"Manage Permissions for",fr:"Grer les permissions pour"},default:{en:"Default",fr:"Par dfaut"},cannotDeleteDefault:{en:"Cannot delete a default item.",fr:"Impossible de supprimer un lment par dfaut."},value:{en:"Value",fr:"Valeur"},totalValue:{en:"Total Value",fr:"Valeur Totale"},weightKg:{en:"Weight (Kg)",fr:"Poids (Kg)"},netWeightKg:{en:"Net Weight (Kg)",fr:"Poids Net (Kg)"},totalWeightKg:{en:"Total Weight (Kg)",fr:"Poids Total (Kg)"},harvestedWeightKg:{en:"Total Harvested Weight (Kg)",fr:"Poids total rcolt (Kg)"},cuttingsWeightKg:{en:"Cuttings Taken (Kg)",fr:"Boutures prleves (Kg)"},netPayable:{en:"Net Payable",fr:"Net  Payer"},baseAmount:{en:"Base Amount",fr:"Montant de Base"},grossSalary:{en:"Gross Salary",fr:"Salaire Brut"},totalGross:{en:"Total Gross",fr:"Total Brut"},netPay:{en:"Net Pay",fr:"Net  Payer"}},lj={incidentManagementTitle:{en:"Incident Management",fr:"Gestion des Incidents"},reportIncident:{en:"Report Incident",fr:"Signaler un Incident"},inProgressIncidents:{en:"In Progress",fr:"En Cours"},criticalIncidents:{en:"Critical",fr:"Critique"},incidentType:{en:"Incident Type",fr:"Type d'Incident"},severity:{en:"Severity",fr:"Gravit"},reportedBy:{en:"Reported By",fr:"Signal Par"},status_OPEN:{en:"Open",fr:"Ouvert"},status_IN_PROGRESS:{en:"In Progress",fr:"En Cours"},status_RESOLVED:{en:"Resolved",fr:"Rsolu"},status_CLOSED:{en:"Closed",fr:"Ferm"},severity_LOW:{en:"Low",fr:"Faible"},severity_MEDIUM:{en:"Medium",fr:"Moyenne"},severity_HIGH:{en:"High",fr:"Haute"},severity_CRITICAL:{en:"Critical",fr:"Critique"},confirmDeleteIncident:{en:"Are you sure you want to delete this incident?",fr:"tes-vous sr de vouloir supprimer cet incident ?"},editIncident:{en:"Edit Incident",fr:"Modifier l'Incident"},uploadPhoto:{en:"Upload Photo",fr:"Tlcharger une Photo"},uploadPhotoInstruction:{en:"Upload or take a photo to analyze with AI",fr:"Tlchargez ou prenez une photo pour analyser avec l'IA"},analyzeWithAI:{en:"Analyze with AI",fr:"Analyser avec l'IA"},analyzeInstructions:{en:"Describe the issue or upload an image...",fr:"Dcrivez le problme ou tlchargez une image..."},aiSuggestions:{en:"AI Suggestions",fr:"Suggestions IA"},suggestedType:{en:"Suggested Type",fr:"Type Suggr"},suggestedSeverity:{en:"Suggested Severity",fr:"Gravit Suggre"},suggestedModules:{en:"Suggested Modules",fr:"Modules Suggrs"},suggestedTreatment:{en:"Suggested Treatment",fr:"Traitement Suggr"},affectedModules:{en:"Affected Modules",fr:"Modules Affects"},resolvedDate:{en:"Resolved Date",fr:"Date de Rsolution"},resolutionNotes:{en:"Resolution Notes",fr:"Notes de Rsolution"},incidentTypeManagementTitle:{en:"Incident Types",fr:"Types d'Incidents"},addIncidentType:{en:"Add Incident Type",fr:"Ajouter un Type d'Incident"},typeName:{en:"Type Name",fr:"Nom du Type"},editIncidentType:{en:"Edit Incident Type",fr:"Modifier le Type d'Incident"},confirmDeleteIncidentType:{en:"Are you sure you want to delete this type?",fr:"tes-vous sr de vouloir supprimer ce type ?"},incidentSeverityManagementTitle:{en:"Incident Severities",fr:"Gravits d'Incidents"},addIncidentSeverity:{en:"Add Severity",fr:"Ajouter une Gravit"},severityName:{en:"Severity Name",fr:"Nom de la Gravit"},editIncidentSeverity:{en:"Edit Severity",fr:"Modifier la Gravit"},confirmDeleteIncidentSeverity:{en:"Are you sure you want to delete this severity?",fr:"tes-vous sr de vouloir supprimer cette gravit ?"},noMajorIncidents:{en:"No major incidents reported.",fr:"Aucun incident majeur signal."},descriptionPlaceholder:{en:"Describe the incident...",fr:"Dcrivez l'incident..."},periodicTestsTitle:{en:"Periodic Tests",fr:"Tests Priodiques"},addTest:{en:"Add Test",fr:"Ajouter un Test"},identity:{en:"Identity/Code",fr:"Identit/Code"},zoning:{en:"Zoning",fr:"Zonage"},conductor:{en:"Conductor",fr:"Conducteur"},sheetInfo:{en:"Sheet Info",fr:"Infos Fiche"},weatherData:{en:"Weather Data",fr:"Donnes Mto"},manualEntry:{en:"Manual Entry",fr:"Saisie Manuelle"},autoFill:{en:"Auto Fill (API)",fr:"Remplissage Auto (API)"},fetchWeather:{en:"Fetch Weather",fr:"Rcuprer Mto"},fetchingWeather:{en:"Fetching...",fr:"Rcupration..."},weatherFetchSuccess:{en:"Weather data fetched successfully.",fr:"Donnes mto rcupres avec succs."},weatherFetchError:{en:"Failed to fetch weather data.",fr:"chec de la rcupration des donnes mto."},weatherFetchMissingInfo:{en:"Missing site coordinates or date.",fr:"Coordonnes du site ou date manquantes."},temperature:{en:"Temperature",fr:"Temprature"},salinity:{en:"Salinity",fr:"Salinit"},precipitation:{en:"Precipitation",fr:"Prcipitations"},windSpeed:{en:"Wind Speed",fr:"Vitesse du Vent"},windDirection:{en:"Wind Direction",fr:"Direction du Vent"},waveHeight:{en:"Wave Height",fr:"Hauteur des Vagues"},editTest:{en:"Edit Test",fr:"Modifier le Test"},confirmDeleteTest:{en:"Are you sure you want to delete this test?",fr:"tes-vous sr de vouloir supprimer ce test ?"},period_PLANTING:{en:"Planting",fr:"Plantation"},period_PERIOD_1:{en:"Period 1",fr:"Priode 1"},period_PERIOD_2:{en:"Period 2",fr:"Priode 2"},period_PERIOD_3:{en:"Period 3",fr:"Priode 3"},period_PERIOD_4:{en:"Period 4",fr:"Priode 4"},period_PERIOD_5:{en:"Period 5",fr:"Priode 5"},userManagement:{en:"User Management",fr:"Gestion des Utilisateurs"},inviteUser:{en:"Invite User",fr:"Inviter un Utilisateur"},currentUsers:{en:"Current Users",fr:"Utilisateurs Actuels"},pendingInvitations:{en:"Pending Invitations",fr:"Invitations en Attente"},recipient:{en:"Recipient",fr:"Destinataire"},channel:{en:"Channel",fr:"Canal"},expiresAt:{en:"Expires At",fr:"Expire Le"},invitedBy:{en:"Invited By",fr:"Invit Par"},resend:{en:"Resend",fr:"Renvoyer"},revoke:{en:"Revoke",fr:"Rvoquer"},noPendingInvitations:{en:"No pending invitations.",fr:"Aucune invitation en attente."},revokeInvitation:{en:"Revoke Invitation",fr:"Rvoquer l'Invitation"},confirmRevokeInvitation:{en:"Are you sure you want to revoke this invitation?",fr:"tes-vous sr de vouloir rvoquer cette invitation ?"},invitationSent:{en:"Invitation Sent",fr:"Invitation Envoye"},invitationLinkMessage:{en:"Share this link with the user:",fr:"Partagez ce lien avec l'utilisateur :"},invitationWhatsAppMessage:{en:"Send this WhatsApp message:",fr:"Envoyez ce message WhatsApp :"},openWhatsApp:{en:"Open WhatsApp",fr:"Ouvrir WhatsApp"},resendWhatsAppMessage:{en:"You have been invited to AlgaManage. Click here to join: {link}",fr:"Vous avez t invit  AlgaManage. Cliquez ici pour rejoindre : {link}"},reportsTitle:{en:"Reports",fr:"Rapports"},selectReportType:{en:"Select Report Type",fr:"Slectionner le Type de Rapport"},globalFarmReport:{en:"Global Farm Report",fr:"Rapport Global de Ferme"},customReport:{en:"Custom Report",fr:"Rapport Personnalis"},farmerMonthlyReport:{en:"Farmer Monthly Report",fr:"Rapport Mensuel Fermier"},individualFarmerReport:{en:"Individual Farmer Report",fr:"Rapport Individuel Fermier"},month:{en:"Month",fr:"Mois"},year:{en:"Year",fr:"Anne"},generateReport:{en:"Generate Report",fr:"Gnrer le Rapport"},selectSections:{en:"Select Sections",fr:"Slectionner les Sections"},section_production:{en:"Production",fr:"Production"},section_finance:{en:"Finance",fr:"Finance"},section_inventory:{en:"Inventory",fr:"Inventaire"},section_hr:{en:"HR",fr:"RH"},section_incidents:{en:"Incidents",fr:"Incidents"},selectFiltersAndGenerate:{en:'Select report type and filters, then click "Generate Report".',fr:'Slectionnez un type de rapport et des filtres, puis cliquez sur "Gnrer le Rapport".'},pdfGenerationError:{en:"Error generating PDF.",fr:"Erreur lors de la gnration du PDF."},company_sarl:{en:"S.A.R.L Capital:",fr:"S.A.R.L au capital de"},narratif_explicatif_tableau:{en:"Narrative Explanation",fr:"Narratif explicatif du tableau"},apercuGeneralDeLaFerme:{en:"General Farm Overview",fr:"Aperu Gnral de la Ferme"},fermier_effectif:{en:"Farmers (Count)",fr:"Fermiers (Effectif)"},tranche_age_lignes:{en:"Line Age Brackets (Days)",fr:"Tranche d'ge des lignes (Jours)"},bilan_lignes:{en:"Line Summary",fr:"Bilan des Lignes"},total_lignes_eau:{en:"Total Lines in Water",fr:"Total lignes  l'eau"},total_lignes_recoltees:{en:"Total Harvested Lines",fr:"Total lignes rcoltes"},total_lignes_plantees:{en:"Total Planted Lines",fr:"Total lignes plantes"},production_periode_kg:{en:"Production for Period (Kg)",fr:"Production de la priode (Kg)"},taux_croissance_moyen:{en:"Average Growth Rate",fr:"Taux de croissance moyen"},prevision_production:{en:"Production Forecast (Kg)",fr:"Prvision de production (Kg)"},monitoringReport:{en:"Monitoring Report",fr:"Rapport de Suivi"},vent:{en:"Wind",fr:"Vent"},vitesse_kmh:{en:"Speed (km/h)",fr:"Vitesse (km/h)"},direction_deg:{en:"Direction ()",fr:"Direction ()"},autres_parametres:{en:"Other Parameters",fr:"Autres Paramtres"},temperature_c:{en:"Temperature (C)",fr:"Temprature (C)"},salinite_ppt:{en:"Salinity ()",fr:"Salinit ()"},pluviometrie_mm:{en:"Precipitation (mm)",fr:"Pluviomtrie (mm)"},averageShort:{en:"Avg",fr:"Moy"},repartition_salaries_site:{en:"Employee Distribution by Site",fr:"Rpartition des Salaris par Site"},effectif:{en:"Count",fr:"Effectif"},montant_du_mois:{en:"Monthly Amount",fr:"Montant du mois"},journalier:{en:"Daily Workers",fr:"Journaliers"},permanent:{en:"Permanent Staff",fr:"Permanents"},total_journalier:{en:"Total Daily",fr:"Total Journaliers"},total_permanent:{en:"Total Permanent",fr:"Total Permanents"},narratif_repartition_salaries:{en:"Narrative (HR)",fr:"Narratif (RH)"},stocks_sur_sites:{en:"Stocks on Sites",fr:"Stocks sur Sites"},stock_ouverture:{en:"Opening Stock",fr:"Stock Ouverture"},entrees:{en:"Entries",fr:"Entres"},sorties:{en:"Exits",fr:"Sorties"},stock_fermeture:{en:"Closing Stock",fr:"Stock Fermeture"},poids_kg:{en:"Weight (Kg)",fr:"Poids (Kg)"},narratif_stocks_sites:{en:"Narrative (Site Stocks)",fr:"Narratif (Stocks Sites)"},stock_magasin_presse:{en:"Pressing Warehouse Stock",fr:"Stock Magasin de Presse"},colis:{en:"Package",fr:"Colis"},algues_en_vrac:{en:"Bulk Seaweed",fr:"Algues en Vrac"},algues_pressees:{en:"Pressed Seaweed",fr:"Algues Presses"},narratif_stocks_magasin:{en:"Narrative (Warehouse)",fr:"Narratif (Magasin)"},liste_exportations_realisees:{en:"List of Realized Exports",fr:"Liste des Exportations Ralises"},quantite_expedie:{en:"Qty Shipped",fr:"Qte Expdie"},nombre_conteneur:{en:"Container Count",fr:"Nbr Conteneur"},valeur_totale:{en:"Total Value",fr:"Valeur Totale"},facture_n:{en:"Invoice N",fr:"Facture N"},po:{en:"PO",fr:"PO"},destinataire:{en:"Consignee",fr:"Destinataire"},de_la_periode:{en:"Of the Period",fr:"De la Priode"},de_annee:{en:"Of the Year",fr:"De l'Anne"},narratif_exportations_realisees:{en:"Narrative (Exports)",fr:"Narratif (Exportations)"},production_mensuelle_par_site:{en:"Monthly Production by Site",fr:"Production Mensuelle par Site"},narratif_production_mensuelle:{en:"Narrative (Production)",fr:"Narratif (Production)"},situation_credits:{en:"Credit Situation",fr:"Situation des Crdits"},effectif_fermiers_concernes:{en:"Farmers Concerned",fr:"Effectif fermiers concerns"},solde_credits:{en:"Credit Balance",fr:"Solde crdits"},total_remboursements:{en:"Total Repayments",fr:"Total remboursements"},narratif_situation_credits:{en:"Narrative (Credits)",fr:"Narratif (Crdits)"},statistique_individuelle_fermiers:{en:"Individual Farmer Statistics",fr:"Statistique Individuelle des Fermiers"},narratif_statistique_individuelle:{en:"Narrative (Farmers)",fr:"Narratif (Fermiers)"},report_narrative_note:{en:"Note: Narratives are generated by AI based on data.",fr:"Note : Les narratifs sont gnrs par IA sur la base des donnes."},customReportTitle:{en:"Custom Report",fr:"Rapport Personnalis"},totalCreditsIssued:{en:"Total Credits Issued",fr:"Total Crdits mis"},totalCreditAmount:{en:"Total Credit Amount",fr:"Montant Total Crdits"},aiAnalysis:{en:"AI Analysis",fr:"Analyse IA"},productionSummary:{en:"Production Summary",fr:"Rsum de la Production"},totalPlantedLines:{en:"Total Planted Lines",fr:"Total Lignes Plantes"},incidentsReported:{en:"Incidents Reported",fr:"Incidents Signals"},noIncidentsForFarmer:{en:"No incidents reported for this farmer.",fr:"Aucun incident signal pour ce fermier."},narrativeFarmerPerformance:{en:"Farmer Performance Review",fr:"Bilan Performance Fermier"},legendColorBlue:{en:"Blue:",fr:"Bleu :"},legendColorRed:{en:"Red:",fr:"Rouge :"},legendColorBlack:{en:"Black:",fr:"Noir :"},legendPlantedLines:{en:"Planted Lines",fr:"Lignes Plantes"},legendHarvestedLines:{en:"Harvested Lines",fr:"Lignes Rcoltes"},legendProductionKg:{en:"Production (Kg)",fr:"Production (Kg)"},pagination:{showing:{en:"Showing",fr:"Affichage de"},of:{en:"of",fr:"sur"},results:{en:"results",fr:"rsultats"},previous:{en:"Previous",fr:"Prcdent"},next:{en:"Next",fr:"Suivant"},itemsPerPage:{en:"Items per page",fr:"lments par page"}},manual_introduction:{en:"Introduction",fr:"Introduction"},manual_introduction_text:{en:"Welcome to AlgaManage, your comprehensive Seaweed Farm ERP system. This manual will guide you through the key features of the application.",fr:"Bienvenue sur AlgaManage, votre systme ERP complet pour la gestion de fermes d'algues. Ce manuel vous guidera  travers les principales fonctionnalits de l'application."},manual_user_management:{en:"User Management",fr:"Gestion des Utilisateurs"},manual_user_management_text:{en:'<ul><li><strong>Invite Users:</strong> Go to Settings > User Management. Click "Invite User", enter their email or phone number, and select a role.</li><li><strong>Manage Roles:</strong> Define custom roles with specific permissions in Settings > Roles.</li></ul>',fr:'<ul><li><strong>Inviter des Utilisateurs :</strong> Allez dans Paramtres > Gestion des Utilisateurs. Cliquez sur "Inviter un Utilisateur", entrez leur email ou numro de tlphone, et slectionnez un rle.</li><li><strong>Grer les Rles :</strong> Dfinissez des rles personnaliss avec des permissions spcifiques dans Paramtres > Rles.</li></ul>'},manual_dashboard:{en:"Dashboard",fr:"Tableau de Bord"},manual_dashboard_text:{en:"<p>The dashboard provides a real-time overview of your farm's performance, including active cycles, harvest forecasts, and key alerts.</p>",fr:"<p>Le tableau de bord offre un aperu en temps rel des performances de votre ferme, incluant les cycles actifs, les prvisions de rcolte et les alertes cls.</p>"},manual_operations:{en:"Operations",fr:"Oprations"},manual_operations_text:{en:"<ul><li><strong>Map:</strong> Visualize sites, zones, and modules geographically.</li><li><strong>Cycles:</strong> Track cultivation from planting to harvest.</li><li><strong>Harvesting:</strong> Record harvests and manage post-harvest processing (drying, bagging).</li></ul>",fr:"<ul><li><strong>Carte :</strong> Visualisez gographiquement les sites, zones et modules.</li><li><strong>Cycles :</strong> Suivez la culture de la plantation  la rcolte.</li><li><strong>Rcolte :</strong> Enregistrez les rcoltes et grez le traitement post-rcolte (schage, mise en sac).</li></ul>"},manual_inventory:{en:"Inventory",fr:"Inventaire"},manual_inventory_text:{en:"<p>Manage stock levels across sites and the central warehouse. Track movements, farmer deliveries, and prepare shipments for export.</p>",fr:"<p>Grez les niveaux de stock sur les sites et dans l'entrept central. Suivez les mouvements, les livraisons des fermiers et prparez les expditions pour l'export.</p>"},manual_stakeholders:{en:"Stakeholders",fr:"Acteurs"},manual_stakeholders_text:{en:"<p>Maintain records of farmers, employees, and service providers. Manage contracts and assignments.</p>",fr:"<p>Maintenez les registres des fermiers, employs et prestataires. Grez les contrats et les affectations.</p>"},manual_monitoring:{en:"Monitoring",fr:"Suivi"},manual_monitoring_text:{en:"<p>Log environmental data (periodic tests) and report incidents (pests, equipment failure) to ensure optimal farm health.</p>",fr:"<p>Enregistrez les donnes environnementales (tests priodiques) et signalez les incidents (parasites, pannes d'quipement) pour assurer la sant optimale de la ferme.</p>"},manual_reports:{en:"Reports",fr:"Rapports"},manual_reports_text:{en:"<p>Generate comprehensive PDF reports for production, financials, inventory, and more. Use the custom report builder for specific needs.</p>",fr:"<p>Gnrez des rapports PDF complets pour la production, les finances, l'inventaire et plus encore. Utilisez le gnrateur de rapports personnaliss pour des besoins spcifiques.</p>"},manual_settings:{en:"Settings",fr:"Paramtres"},manual_settings_text:{en:"<p>Configure global application settings, including company details, currency, language, and system data management.</p>",fr:"<p>Configurez les paramtres globaux de l'application, y compris les dtails de l'entreprise, la devise, la langue et la gestion des donnes systme.</p>"},manual_step_periodic_test_title:{en:"Tracking Growth Trends",fr:"Suivre les tendances de croissance"},manual_step_periodic_test_text:{en:'To track a specific line over time, use a consistent "Identity/Code" (e.g., "LINE-A1") for every period (Planting through P5). This allows the system to calculate the SGR between consecutive dates.',fr:`Pour suivre une ligne spcifique dans le temps, utilisez un "Identifiant/Code" cohrent (ex: "LINE-A1") pour chaque priode (de la plantation jusqu' P5). Cela permet au systme de calculer le SGR entre des dates conscutives.`},manual_incidents_guide_title:{en:"Incident Reporting",fr:"Signalement d'Incidents"},manual_incidents_guide_text:{en:"Log any issues affecting your farm, from pests to equipment failure. Uploading a photo enables AI-powered diagnosis and treatment suggestions.",fr:"Signalez tout problme affectant votre ferme, des parasites aux pannes d'quipement. Le tlchargement d'une photo permet un diagnostic et des suggestions de traitement par IA."},manual_storage_guide_title:{en:"On-Site Storage & Bagging Transfer",fr:"Stockage sur Site & Transfert aprs Ensachage"},manual_storage_guide_text:{en:"This section tracks seaweed that has been bagged but not yet transferred to a central warehouse. It represents the final stage of on-site production.",fr:"Cette section suit les algues qui ont t mises en sac mais pas encore transfres  un entrept central. Elle reprsente la dernire tape de la production sur site."},manual_step_normal_transfer_title:{en:"Normal Transfer Guide",fr:"Guide du Transfert Normal"},manual_step_normal_transfer_text:{en:`1. Harvest a batch.
2. Complete Drying & Bagging.
3. Navigate to On-Site Storage > Normal Transfer.
4. Select the bagged batches.
5. Click "Transfer to Warehouse" and confirm the date.`,fr:`1. Rcoltez un lot.
2. Terminez le schage et la mise en sac.
3. Allez dans Stockage sur site > Transfert normal.
4. Slectionnez les lots ensachs.
5. Cliquez sur "Transfrer  l'entrept" et confirmez la date.`},manual_deliveries_guide_title:{en:"Farmer Deliveries (Dry)",fr:"Livraisons Fermiers (Sec)"},manual_deliveries_guide_text:{en:"Record dry seaweed delivered directly by farmers to a site or the central warehouse.",fr:"Enregistrez les algues sches livres directement par les fermiers  un site ou  l'entrept central."},manual_transfers_guide_title:{en:"Inter-Site Transfers (Shipping Slips)",fr:"Transferts Inter-Sites (Bons d'expdition)"},manual_transfers_guide_text:{en:"Use this to move stock between different farm sites or from a farm site to the central pressing warehouse.",fr:"Utilisez cette fonction pour dplacer le stock entre diffrents sites de la ferme ou d'un site  l'entrept central de pressage."},manual_step_shipping_slip_title:{en:"Creating a Shipping Slip",fr:"Crer un bon d'expdition"},manual_step_shipping_slip_text:{en:`1. Select Source Site.
2. Select Destination (Warehouse or other Site).
3. Enter individual bag weights.
4. Save to initiate "Awaiting Shipment" status.`,fr:`1. Slectionnez le site d'origine.
2. Slectionnez la destination (Magasin ou autre site).
3. Saisissez les poids individuels des sacs.
4. Enregistrez pour initier le statut "En attente d'expdition".`},manual_pressing_guide_title:{en:"Pressing Warehouse",fr:"Entrept de Pressage"},manual_pressing_guide_text:{en:'This module manages two types of stock: "Bulk Seaweed" (raw material) and "Pressed Seaweed" (finished goods). A "Pressing Slip" consumes bulk stock to create pressed stock.',fr:'Ce module gre deux types de stock : "Algues en Vrac" (matire premire) et "Algues Presses" (produit fini). Un "Bon de Pressage" consomme du stock en vrac pour crer du stock press.'},manual_exports_guide_title:{en:"Exports",fr:"Exportations"},manual_exports_guide_text:{en:"Create export documents (Invoice, Packing List, C.O.) by linking one or more completed Pressing Slips. This deducts the final product from the warehouse stock.",fr:"Crez des documents d'exportation (Facture, Liste de Colisage, C.O.) en liant un ou plusieurs Bons de Pressage termins. Cela dduit le produit fini du stock de l'entrept."},manual_tests_guide_title:{en:"Periodic Tests",fr:"Tests Priodiques"},manual_tests_guide_text:{en:"Record environmental data (growth, salinity, temperature) to monitor site health.",fr:"Enregistrez les donnes environnementales (croissance, salinit, temprature) pour surveiller la sant du site."}},Rg={...sj,...aj,...rj,...ij,...lj},e0=N.createContext(void 0),oj=({children:t})=>{const{settings:n}=$e(),s=n.language,r=N.useCallback(l=>Rg[l]?Rg[l][s]:l,[s]);return e.jsx(e0.Provider,{value:{language:s,t:r},children:t})},je=()=>{const t=N.useContext(e0);if(t===void 0)throw new Error("useLocalization must be used within a LocalizationProvider");return t},Mg=[{id:"ENVIRONMENTAL",name:"Environmental",isDefault:!0},{id:"EQUIPMENT_FAILURE",name:"Equipment Failure",isDefault:!0},{id:"PEST_DISEASE",name:"Pest/Disease",isDefault:!0},{id:"SECURITY",name:"Security",isDefault:!0},{id:"OTHER",name:"Other",isDefault:!0}],Pg=[{id:"LOW",name:"Low",isDefault:!0},{id:"MEDIUM",name:"Medium",isDefault:!0},{id:"HIGH",name:"High",isDefault:!0},{id:"CRITICAL",name:"Critical",isDefault:!0}],Lg=[{id:"SITE_MANAGER",name:"Site Manager (Admin)",permissions:[Ce.DASHBOARD_VIEW,Ce.OPERATIONS_VIEW,Ce.INVENTORY_VIEW,Ce.STAKEHOLDERS_VIEW,Ce.MONITORING_VIEW,Ce.REPORTS_VIEW,Ce.SETTINGS_VIEW,Ce.USERS_VIEW,Ce.ROLES_VIEW,Ce.SITES_VIEW,Ce.MODULES_VIEW,Ce.SITES_MANAGE,Ce.MODULES_MANAGE,Ce.EMPLOYEES_MANAGE,Ce.FARMERS_MANAGE,Ce.INCIDENTS_MANAGE,Ce.SETTINGS_GENERAL_MANAGE,Ce.ROLES_MANAGE,Ce.USERS_INVITE,Ce.PAYMENTS_MANAGE,Ce.CREDITS_MANAGE,Ce.PAYROLL_MANAGE,Ce.INVENTORY_MANAGE_ON_SITE,Ce.EXPORTS_MANAGE,Ce.GALLERY_VIEW,Ce.GALLERY_MANAGE],isDefault:!0},{id:"OPERATIONS_LEAD",name:"Directeur des Oprations (Admin)",permissions:[Ce.DASHBOARD_VIEW,Ce.OPERATIONS_VIEW,Ce.INVENTORY_VIEW,Ce.STAKEHOLDERS_VIEW,Ce.MONITORING_VIEW,Ce.REPORTS_VIEW,Ce.SETTINGS_VIEW,Ce.USERS_VIEW,Ce.ROLES_VIEW,Ce.SITES_VIEW,Ce.MODULES_VIEW,Ce.SITES_MANAGE,Ce.MODULES_MANAGE,Ce.EMPLOYEES_MANAGE,Ce.FARMERS_MANAGE,Ce.INCIDENTS_MANAGE,Ce.SETTINGS_GENERAL_MANAGE,Ce.ROLES_MANAGE,Ce.USERS_INVITE,Ce.PAYMENTS_MANAGE,Ce.CREDITS_MANAGE,Ce.PAYROLL_MANAGE,Ce.INVENTORY_MANAGE_ON_SITE,Ce.EXPORTS_MANAGE,Ce.GALLERY_VIEW,Ce.GALLERY_MANAGE],isDefault:!0},{id:"ACCOUNTANT",name:"Accountant",permissions:[Ce.DASHBOARD_VIEW,Ce.STAKEHOLDERS_VIEW,Ce.PAYMENTS_VIEW,Ce.PAYMENTS_MANAGE,Ce.CREDITS_VIEW,Ce.CREDITS_MANAGE,Ce.PAYROLL_VIEW,Ce.PAYROLL_MANAGE,Ce.REPORTS_VIEW],isDefault:!0}],Og=[{id:"user-admin",email:"admin@seafarm.com",password:"password",firstName:"Admin",lastName:"User",roleId:"OPERATIONS_LEAD"}],Ug=[{id:"ct-1",name:"Rice",hasQuantity:!0,unit:"Kg",hasUnitPrice:!0,isDirectAmount:!1},{id:"ct-2",name:"Cash Advance",hasQuantity:!1,hasUnitPrice:!1,isDirectAmount:!0},{id:"ct-3",name:"Cutting Service Fee",hasQuantity:!1,unit:"",hasUnitPrice:!1,isDirectAmount:!0}];function Mt(t,n){try{const s=localStorage.getItem(t);if(s===null)return n;const r=JSON.parse(s);return r??n}catch(s){return console.error(`Error loading ${t} from localStorage`,s),n}}const t0=N.createContext(void 0),cj=({children:t})=>{const[n,s]=N.useState(()=>Mt("sites",[])),[r,l]=N.useState(()=>Mt("employees",[])),[c,d]=N.useState(()=>Mt("farmers",[])),[u,h]=N.useState(()=>Mt("serviceProviders",[])),[m,f]=N.useState(()=>Mt("creditTypes",Ug)),[v,x]=N.useState(()=>Mt("farmerCredits",[])),[S,w]=N.useState(()=>Mt("repayments",[])),[C,T]=N.useState(()=>Mt("monthlyPayments",[])),[E,R]=N.useState(()=>Mt("seaweedTypes",[])),[_,D]=N.useState(()=>Mt("modules",[])),[M,I]=N.useState(()=>Mt("cultivationCycles",[])),[O,A]=N.useState(()=>Mt("stockMovements",[])),[U,P]=N.useState(()=>Mt("pressingSlips",[])),[F,q]=N.useState(()=>Mt("pressedStockMovements",[])),[z,J]=N.useState(()=>Mt("exportDocuments",[])),[W,G]=N.useState(()=>Mt("siteTransfers",[])),[B,X]=N.useState(()=>Mt("cuttingOperations",[])),[$,ae]=N.useState(()=>Mt("farmerDeliveries",[])),[H,ie]=N.useState(()=>Mt("incidents",[])),[ue,Ne]=N.useState(()=>Mt("incidentTypes",Mg)),[oe,ne]=N.useState(()=>Mt("incidentSeverities",Pg)),[we,fe]=N.useState(()=>Mt("roles",Lg)),[Q,ee]=N.useState(()=>Mt("periodicTests",[])),[ye,Le]=N.useState(()=>Mt("pestObservations",[])),[ke,Re]=N.useState(()=>Mt("users",Og)),[Ke,ze]=N.useState(()=>Mt("invitations",[])),[Se,Oe]=N.useState(()=>Mt("messageLogs",[])),[be,xe]=N.useState(()=>Mt("galleryPhotos",[])),Ue=N.useRef(!1);N.useEffect(()=>{localStorage.setItem("sites",JSON.stringify(n))},[n]),N.useEffect(()=>{localStorage.setItem("employees",JSON.stringify(r))},[r]),N.useEffect(()=>{localStorage.setItem("farmers",JSON.stringify(c))},[c]),N.useEffect(()=>{localStorage.setItem("serviceProviders",JSON.stringify(u))},[u]),N.useEffect(()=>{localStorage.setItem("creditTypes",JSON.stringify(m))},[m]),N.useEffect(()=>{localStorage.setItem("farmerCredits",JSON.stringify(v))},[v]),N.useEffect(()=>{localStorage.setItem("repayments",JSON.stringify(S))},[S]),N.useEffect(()=>{localStorage.setItem("monthlyPayments",JSON.stringify(C))},[C]),N.useEffect(()=>{localStorage.setItem("seaweedTypes",JSON.stringify(E))},[E]),N.useEffect(()=>{localStorage.setItem("modules",JSON.stringify(_))},[_]),N.useEffect(()=>{localStorage.setItem("cultivationCycles",JSON.stringify(M))},[M]),N.useEffect(()=>{localStorage.setItem("stockMovements",JSON.stringify(O))},[O]),N.useEffect(()=>{localStorage.setItem("pressingSlips",JSON.stringify(U))},[U]),N.useEffect(()=>{localStorage.setItem("pressedStockMovements",JSON.stringify(F))},[F]),N.useEffect(()=>{localStorage.setItem("exportDocuments",JSON.stringify(z))},[z]),N.useEffect(()=>{localStorage.setItem("siteTransfers",JSON.stringify(W))},[W]),N.useEffect(()=>{localStorage.setItem("cuttingOperations",JSON.stringify(B))},[B]),N.useEffect(()=>{localStorage.setItem("farmerDeliveries",JSON.stringify($))},[$]),N.useEffect(()=>{localStorage.setItem("incidents",JSON.stringify(H))},[H]),N.useEffect(()=>{localStorage.setItem("incidentTypes",JSON.stringify(ue))},[ue]),N.useEffect(()=>{localStorage.setItem("incidentSeverities",JSON.stringify(oe))},[oe]),N.useEffect(()=>{localStorage.setItem("roles",JSON.stringify(we))},[we]),N.useEffect(()=>{localStorage.setItem("periodicTests",JSON.stringify(Q))},[Q]),N.useEffect(()=>{localStorage.setItem("pestObservations",JSON.stringify(ye))},[ye]),N.useEffect(()=>{localStorage.setItem("users",JSON.stringify(ke))},[ke]),N.useEffect(()=>{localStorage.setItem("invitations",JSON.stringify(Ke))},[Ke]),N.useEffect(()=>{localStorage.setItem("messageLogs",JSON.stringify(Se))},[Se]),N.useEffect(()=>{localStorage.setItem("galleryPhotos",JSON.stringify(be))},[be]),N.useEffect(()=>{if(Ue.current)return;Ue.current=!0;const K="ps-req-002";if(!U.some(Z=>Z.id===K)){let Z="seaweed-type-1";if(!E.find(mt=>mt.id===Z)){const mt={id:Z,name:"Spinosum (Type 1)",scientificName:"Eucheuma denticulatum",description:"Requested Seaweed Type",wetPrice:400,dryPrice:1800,priceHistory:[]};R(lt=>[...lt,mt])}const pe={id:`psm-init-${K}`,date:new Date().toISOString().split("T")[0],siteId:"pressing-warehouse",seaweedTypeId:Z,type:ut.BULK_IN_FROM_SITE,designation:"Initial Bulk Stock (Seed)",inKg:1e3,inBales:20},Me={id:K,slipNo:"PRESS-REQ-TODAY",date:new Date().toISOString().split("T")[0],sourceSiteId:"pressing-warehouse",seaweedTypeId:Z,consumedWeightKg:500,consumedBags:8,producedWeightKg:150,producedBalesCount:15},Pe={id:`psm-cons-${K}`,date:new Date().toISOString().split("T")[0],siteId:"pressing-warehouse",seaweedTypeId:Z,type:ut.PRESSING_CONSUMPTION,designation:`Consumed for Pressing Slip ${Me.slipNo}`,outKg:500,outBales:8,relatedId:K},Qe={id:`psm-prod-${K}`,date:new Date().toISOString().split("T")[0],siteId:"pressing-warehouse",seaweedTypeId:Z,type:ut.PRESSING_IN,designation:`Produced from Pressing Slip ${Me.slipNo}`,inKg:150,inBales:15,relatedId:K};q(mt=>[...mt,pe,Pe,Qe]),P(mt=>[...mt,Me])}},[U,E]);const Ze=K=>s(Z=>[...Z,{...K,id:`site-${Date.now()}`}]),Et=K=>s(Z=>Z.map(Y=>Y.id===K.id?K:Y)),ot=K=>s(Z=>Z.filter(Y=>Y.id!==K)),Pt=K=>c.filter(Z=>Z.siteId===K),wt=K=>{const Z={...K,id:`emp-${Date.now()}`,status:ym.ACTIVE,hireDate:K.hireDate||new Date().toISOString().split("T")[0]};l(Y=>[...Y,Z])},gt=K=>l(Z=>Z.map(Y=>Y.id===K.id?K:Y)),Kt=K=>{l(Z=>Z.filter(Y=>Y.id!==K)),s(Z=>Z.map(Y=>Y.managerId===K?{...Y,managerId:void 0}:Y))},bs=K=>{const Z=new Set(K);l(Y=>Y.filter(pe=>!Z.has(pe.id))),s(Y=>Y.map(pe=>pe.managerId&&Z.has(pe.managerId)?{...pe,managerId:void 0}:pe))},Ds=(K,Z)=>{const Y=new Set(K);l(pe=>pe.map(Me=>Y.has(Me.id)?{...Me,siteId:Z}:Me))},rr=K=>{const Z={...K,id:`farm-${Date.now()}`,status:K.status||_s.ACTIVE,joinDate:K.joinDate||new Date().toISOString().split("T")[0]};d(Y=>[...Y,Z])},Be=K=>d(Z=>Z.map(Y=>Y.id===K.id?K:Y)),Ye=K=>{d(Z=>Z.filter(Y=>Y.id!==K)),x(Z=>Z.filter(Y=>Y.farmerId!==K)),w(Z=>Z.filter(Y=>Y.farmerId!==K))},He=K=>{const Z=new Set(K);d(Y=>Y.filter(pe=>!Z.has(pe.id))),x(Y=>Y.filter(pe=>!Z.has(pe.farmerId))),w(Y=>Y.filter(pe=>!Z.has(pe.farmerId)))},bt=(K,Z)=>{const Y=new Set(K);d(pe=>pe.map(Me=>Y.has(Me.id)?{...Me,siteId:Z}:Me))},st=K=>{const Z={...K,id:`sp-${Date.now()}`,status:vm.ACTIVE,joinDate:K.joinDate||new Date().toISOString().split("T")[0]};h(Y=>[...Y,Z])},It=K=>h(Z=>Z.map(Y=>Y.id===K.id?K:Y)),xn=K=>h(Z=>Z.filter(Y=>Y.id!==K)),yn=K=>f(Z=>[...Z,{...K,id:`ct-${Date.now()}`}]),cn=K=>f(Z=>Z.map(Y=>Y.id===K.id?K:Y)),Ns=K=>{f(Z=>Z.filter(Y=>Y.id!==K)),x(Z=>Z.filter(Y=>Y.creditTypeId!==K))},$t=K=>x(Z=>[...Z,{...K,id:`fc-${Date.now()}`}]),Xn=K=>{const Z=K.map(Y=>({...Y,id:`fc-${Date.now()}-${Math.random()}`}));x(Y=>[...Y,...Z])},aa=K=>w(Z=>[...Z,{...K,id:`rep-${Date.now()}`}]),Ss=K=>{const Z=K.map(Y=>({...Y,id:`rep-${Date.now()}-${Math.random()}`}));w(Y=>[...Y,...Z])},uc=K=>{const Z={...K,id:`pay-${Date.now()}`};T(Y=>[...Y,Z])},ul=K=>{const Z=K.map(Y=>({...Y,id:`pay-${Date.now()}-${Math.random()}`}));T(Y=>[...Y,...Z])},Zr=K=>T(Z=>Z.map(Y=>Y.id===K.id?K:Y)),Pa=K=>T(Z=>Z.filter(Y=>Y.id!==K)),mc=K=>{const Z={...K,id:`st-${Date.now()}`,priceHistory:[{date:new Date().toISOString().split("T")[0],wetPrice:K.wetPrice,dryPrice:K.dryPrice}]};R(Y=>[...Y,Z])},ml=K=>R(Z=>Z.map(Y=>Y.id===K.id?K:Y)),fl=K=>R(Z=>Z.filter(Y=>Y.id!==K)),pl=(K,Z)=>{R(Y=>Y.map(pe=>pe.id===K?{...pe,wetPrice:Z.wetPrice,dryPrice:Z.dryPrice,priceHistory:[...pe.priceHistory,Z]}:pe))},ei=K=>{const Z={...K,id:`mod-${Date.now()}`,statusHistory:[{status:Je.CREATED,date:new Date().toISOString()},{status:Je.FREE,date:new Date().toISOString(),notes:"Module is ready for assignment."}]};D(Y=>[...Y,Z])},ti=K=>D(Z=>Z.map(Y=>Y.id===K.id?K:Y)),hl=K=>{D(Z=>Z.filter(Y=>Y.id!==K)),I(Z=>Z.filter(Y=>Y.moduleId!==K))},gl=K=>{const Z=new Set(K);D(Y=>Y.filter(pe=>!Z.has(pe.id))),I(Y=>Y.filter(pe=>pe.moduleId&&!Z.has(pe.moduleId)))},js=(K,Z)=>{const Y=new Set(K),pe=c.find(Me=>Me.id===Z);pe&&D(Me=>Me.map(Pe=>Y.has(Pe.id)?{...Pe,farmerId:Z,statusHistory:[...Pe.statusHistory,{status:Je.ASSIGNED,date:new Date().toISOString(),notes:`Assigned to farmer ${pe.firstName} ${pe.lastName}`}]}:Pe))},tn=(K,Z)=>{const Y=K.cuttingOperationId?B.find(Qe=>Qe.id===K.cuttingOperationId):void 0,pe=_.find(Qe=>Qe.id===K.moduleId);if(!pe)return;const Me={...K,id:`cyc-${Date.now()}`,linesPlanted:K.linesPlanted||pe.lines,cuttingOperationId:K.cuttingOperationId||(Y==null?void 0:Y.id)};I(Qe=>[...Qe,Me]);const Pe=c.find(Qe=>Qe.id===Z);D(Qe=>Qe.map(mt=>{if(mt.id===K.moduleId){const lt=[...mt.statusHistory];return Y&&lt.push({status:Je.CUTTING,date:Y.date}),lt.push({status:Je.ASSIGNED,date:K.plantingDate,notes:`Assigned to farmer ${Pe==null?void 0:Pe.firstName} ${Pe==null?void 0:Pe.lastName}`}),lt.push({status:Je.PLANTED,date:K.plantingDate}),{...mt,farmerId:Z,statusHistory:lt}}return mt}))},vn=K=>{let Z;I(Y=>(Z=Y.find(pe=>pe.id===K.id),Y.map(pe=>pe.id===K.id?K:pe))),K.cuttingOperationId&&X(Y=>Y.map(pe=>{if(pe.id===K.cuttingOperationId){const Me=pe.moduleCuts.map(Qe=>Qe.moduleId===K.moduleId?{...Qe,linesCut:K.linesPlanted||Qe.linesCut}:Qe),Pe=Me.reduce((Qe,mt)=>Qe+mt.linesCut*pe.unitPrice,0);return{...pe,seaweedTypeId:K.seaweedTypeId,moduleCuts:Me,totalAmount:Pe}}return pe})),Z&&Z.status!==K.status&&D(Y=>Y.map(pe=>{if(pe.id===K.moduleId){const Me=K.exportDate||K.stockDate||K.baggingStartDate||K.dryingStartDate||K.harvestDate||new Date().toISOString(),Pe=[...pe.statusHistory,{status:K.status,date:Me}];let Qe={...pe,statusHistory:Pe};return K.status===Je.IN_STOCK&&(Pe.push({status:Je.FREE,date:K.stockDate||new Date().toISOString(),notes:"Cycle completed. Module is available."}),Qe={...Qe,farmerId:void 0}),Qe}return pe}))},ks=K=>{const Z=new Map(K.map(pe=>[pe.id,pe]));I(pe=>pe.map(Me=>Z.get(Me.id)||Me));const Y=new Map;K.forEach(pe=>{pe.status===Je.IN_STOCK&&Y.set(pe.moduleId,pe)}),Y.size>0&&D(pe=>pe.map(Me=>{if(Y.has(Me.id)){const Pe=Y.get(Me.id),Qe=[...Me.statusHistory,{status:Je.IN_STOCK,date:Pe.stockDate||new Date().toISOString()},{status:Je.FREE,date:Pe.stockDate||new Date().toISOString(),notes:"Cycle completed. Module is available."}];return{...Me,farmerId:void 0,statusHistory:Qe}}return Me}))},ni=K=>I(Z=>Z.filter(Y=>Y.id!==K)),fc=(K,Z,Y)=>{const pe=`cut-${Date.now()}`,Me={...K,id:pe,beneficiaryFarmerId:Y};X(Qe=>[...Qe,Me]);const Pe=[];K.moduleCuts.forEach(Qe=>{const mt=_.find(lt=>lt.id===Qe.moduleId);if(Y){const lt=Qe.linesCut*K.unitPrice;lt>0&&Pe.push({id:`fc-${Date.now()}-${Math.random()}`,date:K.date,siteId:K.siteId,farmerId:Y,creditTypeId:"ct-3",totalAmount:lt,relatedOperationId:pe,notes:`Cutting/Planting service for module ${(mt==null?void 0:mt.code)||Qe.moduleId}`})}}),Pe.length>0&&x(Qe=>[...Qe,...Pe]),tn({...Z,cuttingOperationId:pe},Y)},Rs=K=>A(Z=>[...Z,{...K,id:`sm-${Date.now()}`}]),si=K=>A(Z=>[...Z,...K.map(Y=>({...Y,id:`sm-${Date.now()}-${Math.random()}`}))]),ia={sites:n,addSite:Ze,updateSite:Et,deleteSite:ot,employees:r,addEmployee:wt,updateEmployee:gt,deleteEmployee:Kt,deleteMultipleEmployees:bs,updateEmployeesSite:Ds,farmers:c,addFarmer:rr,updateFarmer:Be,getFarmersBySite:Pt,deleteFarmer:Ye,deleteMultipleFarmers:He,updateFarmersSite:bt,serviceProviders:u,addServiceProvider:st,updateServiceProvider:It,deleteServiceProvider:xn,creditTypes:m,addCreditType:yn,updateCreditType:cn,deleteCreditType:Ns,farmerCredits:v,addFarmerCredit:$t,addMultipleFarmerCredits:Xn,repayments:S,addRepayment:aa,addMultipleRepayments:Ss,monthlyPayments:C,addMonthlyPayment:uc,addMultipleMonthlyPayments:ul,updateMonthlyPayment:Zr,deleteMonthlyPayment:Pa,seaweedTypes:E,addSeaweedType:mc,updateSeaweedType:ml,deleteSeaweedType:fl,updateSeaweedPrices:pl,modules:_,cultivationCycles:M,addModule:ei,updateModule:ti,deleteModule:hl,deleteMultipleModules:gl,updateModulesFarmer:js,addCultivationCycle:tn,updateCultivationCycle:vn,updateMultipleCultivationCycles:ks,deleteCultivationCycle:ni,startCultivationFromCuttings:fc,stockMovements:O,addStockMovement:Rs,addMultipleStockMovements:si,recordReturnFromPressing:K=>{Rs({date:K.date,siteId:K.siteId,seaweedTypeId:K.seaweedTypeId,type:Kn.PRESSING_IN,designation:K.designation,inKg:K.kg,inBags:K.bags,relatedId:K.pressingSlipId}),q(Z=>{var Y;return[...Z,{id:`psm-${Date.now()}`,date:K.date,siteId:"pressing-warehouse",seaweedTypeId:K.seaweedTypeId,type:ut.RETURN_TO_SITE,designation:`Return to site: ${((Y=n.find(pe=>pe.id===K.siteId))==null?void 0:Y.name)||K.siteId}`,outBales:K.bags,outKg:K.kg,relatedId:K.pressingSlipId}]})},farmerDeliveries:$,addFarmerDelivery:K=>{const Z=`DEL-${new Date().getFullYear()}-${String($.length+1).padStart(3,"0")}`,Y={...K,id:`fd-${Date.now()}`,slipNo:Z};ae(Pe=>[...Pe,Y]);const pe=c.find(Pe=>Pe.id===K.farmerId),Me=`Delivery from ${(pe==null?void 0:pe.firstName)||""} ${(pe==null?void 0:pe.lastName)||""} (${Z})`;K.destination==="PRESSING_WAREHOUSE_BULK"?q(Pe=>[...Pe,{id:`psm-${Date.now()}`,date:K.date,siteId:"pressing-warehouse",seaweedTypeId:K.seaweedTypeId,type:ut.FARMER_DELIVERY,designation:Me,inKg:K.totalWeightKg,inBales:K.totalBags,relatedId:Y.id}]):Rs({date:K.date,siteId:K.siteId,seaweedTypeId:K.seaweedTypeId,type:Kn.FARMER_DELIVERY,designation:Me,inKg:K.totalWeightKg,inBags:K.totalBags,relatedId:Y.id})},deleteFarmerDelivery:K=>{ae(Z=>Z.filter(Y=>Y.id!==K)),A(Z=>Z.filter(Y=>Y.relatedId!==K||Y.type!==Kn.FARMER_DELIVERY)),q(Z=>Z.filter(Y=>Y.relatedId!==K||Y.type!==ut.FARMER_DELIVERY))},addInitialStock:K=>A(Z=>[...Z,{...K,id:`sm-${Date.now()}`,type:Kn.INITIAL_STOCK}]),transferBaggedToStock:(K,Z)=>{const Y=Z||new Date().toISOString().split("T")[0],pe=M.filter(Pe=>K.includes(Pe.id)&&Pe.status===Je.BAGGED).map(Pe=>({...Pe,status:Je.IN_STOCK,stockDate:Y})),Me=pe.map(Pe=>{const Qe=_.find(mt=>mt.id===Pe.moduleId);return!Qe||!Pe.baggedWeightKg||!Pe.baggedBagsCount?null:{date:Y,siteId:Qe.siteId,seaweedTypeId:Pe.seaweedTypeId,type:Kn.BAGGING_TRANSFER,designation:`From Bagging (Module ${Qe.code})`,inKg:Pe.baggedWeightKg,inBags:Pe.baggedBagsCount,relatedId:Pe.id}}).filter(Pe=>Pe!==null);pe.length>0&&ks(pe),Me.length>0&&si(Me)},exportStockBatch:K=>{const Z=M.find(pe=>pe.id===K);if(!Z)return;vn({...Z,status:Je.EXPORTED,exportDate:new Date().toISOString().split("T")[0]});const Y=_.find(pe=>pe.id===Z.moduleId);Y&&Z.harvestedWeight&&Rs({date:new Date().toISOString().split("T")[0],siteId:Y.siteId,seaweedTypeId:Z.seaweedTypeId,type:Kn.EXPORT_OUT,designation:`Export from Batch (Module ${Y.code})`,outKg:Z.harvestedWeight,outBags:Math.ceil(Z.harvestedWeight/50),relatedId:Z.id})},pressingSlips:U,pressedStockMovements:F,...{addPressingSlip:K=>{const Z=`PRESS-${new Date().getFullYear()}-${String(U.length+1).padStart(3,"0")}`,Y={...K,id:`ps-${Date.now()}`,slipNo:Z};P(pe=>[...pe,Y]),q(pe=>[...pe,{id:`psm-cons-${Date.now()}`,date:Y.date,siteId:"pressing-warehouse",seaweedTypeId:Y.seaweedTypeId,type:ut.PRESSING_CONSUMPTION,designation:`Consumed for Pressing Slip ${Y.slipNo}`,outKg:Y.consumedWeightKg,outBales:Y.consumedBags,relatedId:Y.id},{id:`psm-prod-${Date.now()}`,date:Y.date,siteId:"pressing-warehouse",seaweedTypeId:Y.seaweedTypeId,type:ut.PRESSING_IN,designation:`Produced from Pressing Slip ${Y.slipNo}`,inBales:Y.producedBalesCount,inKg:Y.producedWeightKg,relatedId:Y.id}])},updatePressingSlip:K=>{P(Z=>Z.map(Y=>Y.id===K.id?K:Y)),q(Z=>[...Z.filter(pe=>pe.relatedId!==K.id),{id:`psm-upd-cons-${Date.now()}`,date:K.date,siteId:"pressing-warehouse",seaweedTypeId:K.seaweedTypeId,type:ut.PRESSING_CONSUMPTION,designation:`Consumed for Pressing Slip ${K.slipNo}`,outKg:K.consumedWeightKg,outBales:K.consumedBags,relatedId:K.id},{id:`psm-upd-prod-${Date.now()}`,date:K.date,siteId:"pressing-warehouse",seaweedTypeId:K.seaweedTypeId,type:ut.PRESSING_IN,designation:`Produced from Pressing Slip ${K.slipNo}`,inBales:K.producedBalesCount,inKg:K.producedWeightKg,relatedId:K.id}])},deletePressingSlip:K=>{P(Z=>Z.filter(Y=>Y.id!==K)),q(Z=>Z.filter(Y=>Y.relatedId!==K))},addInitialPressedStock:K=>q(Z=>[...Z,{...K,id:`psm-${Date.now()}`,type:ut.INITIAL_STOCK}]),addPressedStockAdjustment:K=>q(Z=>[...Z,{...K,id:`psm-adj-${Date.now()}`,relatedId:`adj-${Date.now()}`}])},exportDocuments:z,...{addExportDocument:(K,Z)=>{const Y=`EXP-${new Date().getFullYear()}-${String(z.length+1).padStart(3,"0")}`,pe={...K,id:`ed-${Date.now()}`,docNo:Y,containers:K.containers.map(mt=>({...mt,id:`ec-${Date.now()}-${Math.random()}`}))};J(mt=>[...mt,pe]),P(mt=>mt.map(lt=>pe.pressingSlipIds.includes(lt.id)?{...lt,exportDocId:pe.id}:lt));const Me=U.filter(mt=>pe.pressingSlipIds.includes(mt.id)),Pe=Me.reduce((mt,lt)=>mt+lt.producedBalesCount,0),Qe=Me.reduce((mt,lt)=>mt+lt.producedWeightKg,0);Pe>0&&q(mt=>[...mt,{id:`psm-${Date.now()}`,date:pe.date,siteId:"pressing-warehouse",seaweedTypeId:pe.seaweedTypeId,type:ut.EXPORT_OUT,designation:`Export Shipment ${pe.docNo}`,outBales:Pe,outKg:Qe,relatedId:pe.id}])},updateExportDocument:K=>{J(Pe=>Pe.map(Qe=>Qe.id===K.id?K:Qe)),P(Pe=>Pe.map(Qe=>K.pressingSlipIds.includes(Qe.id)?{...Qe,exportDocId:K.id}:Qe.exportDocId===K.id?{...Qe,exportDocId:void 0}:Qe));const Z=F.filter(Pe=>Pe.relatedId!==K.id),Y=U.filter(Pe=>K.pressingSlipIds.includes(Pe.id)),pe=Y.reduce((Pe,Qe)=>Pe+Qe.producedBalesCount,0),Me=Y.reduce((Pe,Qe)=>Pe+Qe.producedWeightKg,0);pe>0&&Z.push({id:`psm-${Date.now()}`,date:K.date,siteId:"pressing-warehouse",seaweedTypeId:K.seaweedTypeId,type:ut.EXPORT_OUT,designation:`Export Shipment ${K.docNo}`,outBales:pe,outKg:Me,relatedId:K.id}),q(Z)},deleteExportDocument:K=>{P(Z=>Z.map(Y=>Y.exportDocId===K?{...Y,exportDocId:void 0}:Y)),J(Z=>Z.filter(Y=>Y.id!==K)),q(Z=>Z.filter(Y=>Y.relatedId!==K))}},siteTransfers:W,...{addSiteTransfer:K=>{var Y;const Z={...K,id:`st-${Date.now()}`,status:Ot.AWAITING_OUTBOUND,history:[{status:Ot.AWAITING_OUTBOUND,date:new Date().toISOString(),notes:"Transfer initiated."}]};G(pe=>[...pe,Z]),Rs({date:Z.date,siteId:Z.sourceSiteId,seaweedTypeId:Z.seaweedTypeId,type:Kn.SITE_TRANSFER_OUT,designation:`Transfer to ${(Y=n.find(pe=>pe.id===Z.destinationSiteId))==null?void 0:Y.name} (${Z.id})`,outKg:Z.weightKg,outBags:Z.bags,relatedId:Z.id})},updateSiteTransfer:K=>{var pe;const Z=W.find(Me=>Me.id===K.id);if(!Z)return;const Y={...K};if(Z.status!==Y.status){let Me="";Y.status===Ot.IN_TRANSIT?Me="Marked as in transit.":Y.status===Ot.PENDING_RECEPTION?Me="Marked as arrived at destination, pending checks.":Y.status===Ot.COMPLETED?Me=`Completed. Received ${Y.receivedWeightKg}kg in ${Y.receivedBags} bags.`:Y.status===Ot.CANCELLED&&(Me=`Cancelled. Reason: ${Y.notes}`),Y.history=[...Z.history||[],{status:Y.status,date:new Date().toISOString(),notes:Me}]}G(Me=>Me.map(Pe=>Pe.id===Y.id?Y:Pe)),Z.status!==Ot.COMPLETED&&Y.status===Ot.COMPLETED&&(Y.destinationSiteId==="pressing-warehouse"?q(Me=>{var Pe;return[...Me,{id:`psm-${Date.now()}`,date:Y.completionDate||new Date().toISOString().split("T")[0],siteId:"pressing-warehouse",seaweedTypeId:Y.seaweedTypeId,type:ut.BULK_IN_FROM_SITE,designation:`Transfer from ${(Pe=n.find(Qe=>Qe.id===Y.sourceSiteId))==null?void 0:Pe.name} (${Y.id})`,inKg:Y.receivedWeightKg,inBales:Y.receivedBags,relatedId:Y.id}]}):Rs({date:Y.completionDate||new Date().toISOString().split("T")[0],siteId:Y.destinationSiteId,seaweedTypeId:Y.seaweedTypeId,type:Kn.SITE_TRANSFER_IN,designation:`Transfer from ${(pe=n.find(Me=>Me.id===Y.sourceSiteId))==null?void 0:pe.name} (${Y.id})`,inKg:Y.receivedWeightKg,inBags:Y.receivedBags,relatedId:Y.id})),Z.status!==Ot.CANCELLED&&Y.status===Ot.CANCELLED&&Rs({date:Y.completionDate||new Date().toISOString().split("T")[0],siteId:Y.sourceSiteId,seaweedTypeId:Y.seaweedTypeId,type:Kn.SITE_TRANSFER_IN,designation:`Cancelled Transfer ${Y.id}: ${Y.notes||""}`.trim(),inKg:Y.weightKg,inBags:Y.bags,relatedId:Y.id})}},cuttingOperations:B,...{addCuttingOperation:K=>{const Z={...K,id:`cut-${Date.now()}`},Y=[];K.moduleCuts.forEach(pe=>{const Me=_.find(Pe=>Pe.id===pe.moduleId);if(Me&&Me.farmerId){const Pe=pe.linesCut*K.unitPrice;Pe>0&&Y.push({id:`fc-${Date.now()}-${Math.random()}`,date:K.date,siteId:K.siteId,farmerId:Me.farmerId,creditTypeId:"ct-3",totalAmount:Pe,relatedOperationId:Z.id,notes:`Cutting service for module ${Me.code}`})}}),X(pe=>[...pe,Z]),Y.length>0&&x(pe=>[...pe,...Y])},updateCuttingOperation:(K,Z,Y)=>{var Qe,mt;const pe=B.find(lt=>lt.id===K.id);if(!pe){console.error("Original operation not found for update:",K.id);return}const Me=(Qe=pe.moduleCuts[0])==null?void 0:Qe.moduleId,Pe=(mt=K.moduleCuts[0])==null?void 0:mt.moduleId;if(X(lt=>lt.map(Wt=>Wt.id===K.id?K:Wt)),I(lt=>lt.map(Wt=>{var Ht;if(Wt.cuttingOperationId===K.id){const Yt=(Z==null?void 0:Z[Pe])??Wt.initialWeight;return{...Wt,moduleId:Pe,seaweedTypeId:K.seaweedTypeId,plantingDate:Y||K.date,linesPlanted:(Ht=K.moduleCuts[0])==null?void 0:Ht.linesCut,initialWeight:Yt}}return Wt})),x(lt=>{const Wt=lt.filter(Cn=>Cn.relatedOperationId!==K.id),Ht=[],Yt=K.beneficiaryFarmerId;if(Yt){const Cn=K.moduleCuts.reduce((fn,Jt)=>fn+Jt.linesCut*K.unitPrice,0);if(Cn>0){const fn=_.find(Jt=>Jt.id===Pe);Ht.push({id:`fc-edit-${Date.now()}`,date:K.date,siteId:K.siteId,farmerId:Yt,creditTypeId:"ct-3",totalAmount:Cn,relatedOperationId:K.id,notes:`Cutting service for module ${(fn==null?void 0:fn.code)||Pe}`})}}return[...Wt,...Ht]}),Me&&Pe&&Me!==Pe){const lt=c.find(Ht=>Ht.id===K.beneficiaryFarmerId),Wt=Y||K.date;D(Ht=>Ht.map(Yt=>{var Cn;if(Yt.id===Me){const fn=((Cn=_.find(Jt=>Jt.id===Pe))==null?void 0:Cn.code)||Pe;return{...Yt,farmerId:void 0,statusHistory:[...Yt.statusHistory,{status:Je.FREE,date:new Date().toISOString(),notes:`Operation moved to module ${fn}`}]}}return Yt.id===Pe?{...Yt,farmerId:K.beneficiaryFarmerId,statusHistory:[...Yt.statusHistory,{status:Je.ASSIGNED,date:Wt,notes:`Assigned to farmer ${lt==null?void 0:lt.firstName} ${lt==null?void 0:lt.lastName}`},{status:Je.PLANTED,date:Wt}]}:Yt}))}else if(Pe){const lt=c.find(Ht=>Ht.id===K.beneficiaryFarmerId),Wt=Y||K.date;D(Ht=>Ht.map(Yt=>{if(Yt.id===Pe){let Cn=!1,fn={...Yt};const Jt=[...Yt.statusHistory];Yt.farmerId!==K.beneficiaryFarmerId&&(fn.farmerId=K.beneficiaryFarmerId,Jt.push({status:Je.ASSIGNED,date:Wt,notes:`Re-assigned to farmer ${lt==null?void 0:lt.firstName} ${lt==null?void 0:lt.lastName}`}),Cn=!0);const la=Jt.map(Ms=>Ms.status).lastIndexOf(Je.PLANTED);if(la>-1&&Jt[la].date!==Wt){Jt[la]={...Jt[la],date:Wt};const Ms=Jt.map(Nl=>Nl.status).lastIndexOf(Je.ASSIGNED,la);Ms>-1&&(Jt[Ms]={...Jt[Ms],date:Wt}),Cn=!0}if(Cn)return fn.statusHistory=Jt,fn}return Yt}))}},updateMultipleCuttingOperations:(K,Z)=>{const Y=new Set(K);X(pe=>pe.map(Me=>Y.has(Me.id)?{...Me,isPaid:!0,paymentDate:Z}:Me))},deleteCuttingOperation:K=>{var pe;const Z=B.find(Me=>Me.id===K);if(!Z){console.error("Operation to delete not found:",K);return}const Y=(pe=Z.moduleCuts[0])==null?void 0:pe.moduleId;Y&&D(Me=>Me.map(Pe=>Pe.id===Y?{...Pe,farmerId:void 0,statusHistory:[...Pe.statusHistory,{status:Je.FREE,date:new Date().toISOString(),notes:"Cutting operation deleted, module freed."}]}:Pe)),I(Me=>Me.filter(Pe=>Pe.cuttingOperationId!==K)),x(Me=>Me.filter(Pe=>Pe.relatedOperationId!==K)),X(Me=>Me.filter(Pe=>Pe.id!==K))}},incidents:H,...{addIncident:K=>ie(Z=>[...Z,{...K,id:`inc-${Date.now()}`}]),updateIncident:K=>ie(Z=>Z.map(Y=>Y.id===K.id?K:Y)),deleteIncident:K=>ie(Z=>Z.filter(Y=>Y.id!==K)),addIncidentType:K=>{const Z=K.name.toUpperCase().replace(/\s/g,"_");ue.some(Y=>Y.id===Z)||Ne(Y=>[...Y,{...K,id:Z,isDefault:!1}])},updateIncidentType:K=>Ne(Z=>Z.map(Y=>Y.id===K.id?{...Y,name:K.name}:Y)),deleteIncidentType:K=>{Ne(Y=>Y.filter(pe=>pe.id!==K&&!pe.isDefault));const Z=ue.find(Y=>Y.id==="OTHER");Z&&ie(Y=>Y.map(pe=>pe.type===K?{...pe,type:Z.id}:pe))},addIncidentSeverity:K=>{const Z=K.name.toUpperCase().replace(/\s/g,"_");oe.some(Y=>Y.id===Z)||ne(Y=>[...Y,{...K,id:Z,isDefault:!1}])},updateIncidentSeverity:K=>ne(Z=>Z.map(Y=>Y.id===K.id?{...Y,name:K.name}:Y)),deleteIncidentSeverity:K=>{ne(Y=>Y.filter(pe=>pe.id!==K&&!pe.isDefault));const Z=oe.find(Y=>Y.id==="LOW");Z&&ie(Y=>Y.map(pe=>pe.severity===K?{...pe,severity:Z.id}:pe))}},incidentTypes:ue,incidentSeverities:oe,roles:we,...{addRole:K=>{const Z=K.name.toUpperCase().replace(/\s/g,"_");if(we.some(pe=>pe.id===Z))return;const Y={...K,id:Z,isDefault:!1};return fe(pe=>[...pe,Y]),Y},updateRole:K=>fe(Z=>Z.map(Y=>Y.id===K.id?K:Y)),deleteRole:K=>fe(Z=>Z.filter(Y=>Y.id!==K&&!Y.isDefault))},periodicTests:Q,...{addPeriodicTest:K=>ee(Z=>[...Z,{...K,id:`pt-${Date.now()}`}]),updatePeriodicTest:K=>ee(Z=>Z.map(Y=>Y.id===K.id?K:Y)),deletePeriodicTest:K=>ee(Z=>Z.filter(Y=>Y.id!==K))},pestObservations:ye,users:ke,findUserByEmail:K=>ke.find(Z=>Z.email.toLowerCase()===K.toLowerCase()),addUser:(K,Z)=>{if(ke.some(pe=>pe.email.toLowerCase()===K.email.toLowerCase()))return;Z&&ze(pe=>pe.map(Me=>Me.token===Z?{...Me,status:rl.ACCEPTED}:Me));const Y={id:`user-${Date.now()}`,...K};return Re(pe=>[...pe,Y]),Y},setUserPasswordResetToken:(K,Z,Y)=>{let pe=!1;return Re(Me=>Me.map(Pe=>Pe.email.toLowerCase()===K.toLowerCase()?(pe=!0,{...Pe,passwordResetToken:Z,passwordResetExpires:Y}):Pe)),pe},findUserByPasswordResetToken:K=>{const Z=ke.find(Y=>Y.passwordResetToken===K);return Z&&Z.passwordResetExpires&&new Date<new Date(Z.passwordResetExpires)?Z:void 0},updateUserPassword:(K,Z)=>{let Y=!1;return Re(pe=>pe.map(Me=>Me.id===K?(Y=!0,{...Me,password:Z,passwordResetToken:void 0,passwordResetExpires:void 0}):Me)),Y},updateUser:K=>Re(Z=>Z.map(Y=>Y.id===K.id?K:Y)),markCyclesAsPaid:(K,Z)=>{const Y=new Set(K);I(pe=>pe.map(Me=>Y.has(Me.id)?{...Me,paymentRunId:Z}:Me))},markDeliveriesAsPaid:(K,Z)=>{const Y=new Set(K);ae(pe=>pe.map(Me=>Y.has(Me.id)?{...Me,paymentRunId:Z}:Me))},invitations:Ke,addInvitation:K=>{const Z={...K,id:`inv-${Date.now()}`,token:`inv-token-${Date.now()}-${Math.random()}`,createdAt:new Date().toISOString()};return ze(Y=>[...Y,Z]),Z},deleteInvitation:K=>ze(Z=>Z.filter(Y=>Y.id!==K)),findInvitationByToken:K=>{const Z=Ke.find(Y=>Y.token===K&&Y.status===rl.PENDING);return Z&&new Date(Z.expiresAt)>new Date?Z:void 0},addMessageLog:K=>Oe(Z=>[{...K,id:`msg-${Date.now()}`},...Z]),messageLogs:Se,galleryPhotos:be,addGalleryPhoto:K=>xe(Z=>[{...K,id:`photo-${Date.now()}`},...Z]),updateGalleryPhotoComment:(K,Z)=>xe(Y=>Y.map(pe=>pe.id===K?{...pe,comment:Z}:pe)),deleteGalleryPhoto:K=>xe(Z=>Z.filter(Y=>Y.id!==K)),clearAllData:()=>{localStorage.clear(),s([]),l([]),d([]),h([]),f(Ug),x([]),w([]),T([]),R([]),D([]),I([]),A([]),P([]),q([]),J([]),G([]),X([]),ae([]),ie([]),Ne(Mg),ne(Pg),fe(Lg),ee([]),Le([]),Re(Og),ze([]),Oe([]),xe([])}};return e.jsx(t0.Provider,{value:ia,children:t})},qe=()=>{const t=N.useContext(t0);if(t===void 0)throw new Error("useData must be used within a DataProvider");return t},n0=N.createContext(void 0),dj=({children:t})=>{const{modules:n,cultivationCycles:s}=qe(),[r,l]=N.useState([]);return N.useEffect(()=>{const c=new Date;c.setHours(0,0,0,0);const d=[];n.forEach(u=>{if(!u.farmerId){const h=s.filter(m=>m.moduleId===u.id&&m.harvestDate).sort((m,f)=>new Date(f.harvestDate).getTime()-new Date(m.harvestDate).getTime());if(h.length>0){const m=new Date(h[0].harvestDate);Math.floor((c.getTime()-m.getTime())/(1e3*3600*24))>qu&&d.push({id:`unassigned-${u.id}`,type:"MODULE_UNASSIGNED",messageKey:"notification_unassigned",messageParams:{code:u.code,days:qu},date:c.toISOString(),relatedId:u.id,path:`/modules?highlight=${u.id}`})}}}),s.forEach(u=>{if(u.status===Je.PLANTED||u.status===Je.GROWING){const h=new Date(u.plantingDate);h.setHours(0,0,0,0);const m=Math.floor((c.getTime()-h.getTime())/(1e3*3600*24)),f=n.find(v=>v.id===u.moduleId);m>Zs?d.push({id:`overdue-${u.id}`,type:"HARVEST_OVERDUE",messageKey:"notification_overdue",messageParams:{code:(f==null?void 0:f.code)||"N/A",days:m},date:c.toISOString(),relatedId:u.id,path:`/cultivation?highlight=${u.id}`}):m>Zs-bm&&d.push({id:`nearing-${u.id}`,type:"HARVEST_NEARING",messageKey:"notification_nearing",messageParams:{code:(f==null?void 0:f.code)||"N/A",days:m},date:c.toISOString(),relatedId:u.id,path:`/cultivation?highlight=${u.id}`})}}),d.sort((u,h)=>new Date(h.date).getTime()-new Date(u.date).getTime()),l(d)},[n,s]),e.jsx(n0.Provider,{value:{notifications:r},children:t})},uj=()=>{const t=N.useContext(n0);if(t===void 0)throw new Error("useNotifications must be used within a NotificationProvider");return t},s0=N.createContext(void 0),mj=({children:t})=>{const[n,s]=N.useState(null),[r,l]=N.useState(new Set),[c,d]=N.useState(!0),{findUserByEmail:u,addUser:h,setUserPasswordResetToken:m,findUserByPasswordResetToken:f,updateUserPassword:v,roles:x,updateUser:S}=qe(),w=N.useCallback(I=>r.has(I),[r]);N.useEffect(()=>{try{const I=localStorage.getItem("seafarm_monitor_user");if(I){const O=JSON.parse(I);if(s(O),x.length>0){const A=x.find(P=>P.id===O.roleId),U=A?A.permissions:[];l(new Set(U))}}}catch(I){console.error("Failed to parse user from localStorage",I),localStorage.removeItem("seafarm_monitor_user")}finally{d(!1)}},[x]);const C=N.useCallback(async(I,O)=>{const A=u(I);if(A&&A.password===O){const U=x.find(z=>z.id===A.roleId),P=U?U.permissions:[];l(new Set(P));const{password:F,...q}=A;return localStorage.setItem("seafarm_monitor_user",JSON.stringify(q)),s(q),!0}return!1},[u,x]),T=N.useCallback(async(I,O)=>{const A=h(I,O);if(A){const U=x.find(z=>z.id===A.roleId),P=U?U.permissions:[];l(new Set(P));const{password:F,...q}=A;return localStorage.setItem("seafarm_monitor_user",JSON.stringify(q)),s(q),!0}return!1},[h,x]),E=N.useCallback(()=>{s(null),l(new Set),localStorage.removeItem("seafarm_monitor_user")},[]),R=N.useCallback(async I=>{if(u(I)){const A=`mock-token-${Date.now()}`,U=new Date(Date.now()+36e5);m(I,A,U);const P=`${window.location.origin}${window.location.pathname}#/reset-password?token=${A}`;return console.log("--- PASSWORD RESET (FOR TESTING) ---"),console.log(`Reset link for ${I}: ${P}`),console.log("------------------------------------"),P}return null},[u,m]),_=N.useCallback(async(I,O)=>{const A=f(I);if(!A)return!1;const U=v(A.id,O);return U&&E(),U},[f,v,E]),D=N.useCallback(I=>{if(!n)return;const O={...n,...I};S(O),s(O),localStorage.setItem("seafarm_monitor_user",JSON.stringify(O))},[n,S]),M={currentUser:n,loading:c,login:C,signup:T,logout:E,sendPasswordResetLink:R,resetPassword:_,can:w,updateProfile:D};return e.jsx(s0.Provider,{value:M,children:!c&&t})},ys=()=>{const t=N.useContext(s0);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},fj={Activity:e.jsx("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"}),AlertTriangle:e.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),Archive:e.jsxs(e.Fragment,{children:[e.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),e.jsx("rect",{width:"22",height:"5",x:"1",y:"3"}),e.jsx("line",{x1:"10",x2:"14",y1:"12",y2:"12"})]}),ArrowRightLeft:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"m16 3 4 4-4 4"}),e.jsx("path",{d:"M20 7H4"}),e.jsx("path",{d:"m8 21-4-4 4-4"}),e.jsx("path",{d:"M4 17h16"})]}),ArrowUp:e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),e.jsx("polyline",{points:"5 12 12 5 19 12"})]}),ArrowDown:e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("polyline",{points:"19 12 12 19 5 12"})]}),Beaker:e.jsx("path",{d:"M4.5 3h15M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3M6 14h12"}),Bell:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),e.jsx("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"})]}),BookOpen:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),e.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),Bot:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"18",height:"10",x:"3",y:"11",rx:"2"}),e.jsx("circle",{cx:"12",cy:"5",r:"2"}),e.jsx("path",{d:"M12 7v4"}),e.jsx("line",{x1:"8",x2:"8",y1:"16",y2:"16"}),e.jsx("line",{x1:"16",x2:"16",y1:"16",y2:"16"})]}),Briefcase:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2"}),e.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]}),Building:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2"}),e.jsx("path",{d:"M9 22v-4h6v4"}),e.jsx("path",{d:"M8 6h.01"}),e.jsx("path",{d:"M16 6h.01"}),e.jsx("path",{d:"M12 6h.01"}),e.jsx("path",{d:"M12 10h.01"}),e.jsx("path",{d:"M12 14h.01"}),e.jsx("path",{d:"M16 10h.01"}),e.jsx("path",{d:"M16 14h.01"}),e.jsx("path",{d:"M8 10h.01"}),e.jsx("path",{d:"M8 14h.01"})]}),Calculator:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2"}),e.jsx("line",{x1:"8",x2:"16",y1:"6",y2:"6"}),e.jsx("line",{x1:"16",x2:"16",y1:"14",y2:"18"}),e.jsx("path",{d:"M16 10h.01"}),e.jsx("path",{d:"M12 10h.01"}),e.jsx("path",{d:"M8 10h.01"}),e.jsx("path",{d:"M12 14h.01"}),e.jsx("path",{d:"M8 14h.01"}),e.jsx("path",{d:"M12 18h.01"}),e.jsx("path",{d:"M8 18h.01"})]}),Calendar:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),e.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),Check:e.jsx("polyline",{points:"20 6 9 17 4 12"}),ChevronDown:e.jsx("polyline",{points:"6 9 12 15 18 9"}),ChevronLeft:e.jsx("polyline",{points:"15 18 9 12 15 6"}),ChevronRight:e.jsx("polyline",{points:"9 18 15 12 9 6"}),CreditCard:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"20",height:"14",x:"2",y:"5",rx:"2"}),e.jsx("line",{x1:"2",x2:"22",y1:"10",y2:"10"})]}),DollarSign:e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:"12",x2:"12",y1:"2",y2:"22"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),Download:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",x2:"12",y1:"15",y2:"3"})]}),Edit:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),Edit2:e.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}),Eye:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),FileSpreadsheet:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}),e.jsx("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),e.jsx("path",{d:"M8 13h2"}),e.jsx("path",{d:"M8 17h2"}),e.jsx("path",{d:"M14 13h2"}),e.jsx("path",{d:"M14 17h2"})]}),FileText:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}),e.jsx("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),e.jsx("path",{d:"M10 9H8"}),e.jsx("path",{d:"M16 13H8"}),e.jsx("path",{d:"M16 17H8"})]}),Filter:e.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}),GitBranch:e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:"6",x2:"6",y1:"3",y2:"15"}),e.jsx("circle",{cx:"18",cy:"6",r:"3"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("path",{d:"M18 9a9 9 0 0 1-9 9"})]}),Globe:e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"2",x2:"22",y1:"12",y2:"12"}),e.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),Grid:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),Home:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),Image:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),e.jsx("circle",{cx:"9",cy:"9",r:"2"}),e.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),Layers:e.jsxs(e.Fragment,{children:[e.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),e.jsx("polyline",{points:"2 17 12 22 22 17"}),e.jsx("polyline",{points:"2 12 12 17 22 12"})]}),Lock:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),LogOut:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),Map:e.jsxs(e.Fragment,{children:[e.jsx("polygon",{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"18"}),e.jsx("line",{x1:"16",x2:"16",y1:"6",y2:"22"})]}),MapPin:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),Menu:e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),e.jsx("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),e.jsx("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]}),Moon:e.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"}),Package:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"m16.5 9.4-9-5.19"}),e.jsx("path",{d:"m21 16-9 5.19-9-5.19"}),e.jsx("path",{d:"m3 11.1 9 5.19 9-5.19"}),e.jsx("line",{x1:"12",x2:"12",y1:"5.9",y2:"21.19"}),e.jsx("path",{d:"M12 2 3 7l9 5.19L21 7Z"})]}),PlusCircle:e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",x2:"12",y1:"8",y2:"16"}),e.jsx("line",{x1:"8",x2:"16",y1:"12",y2:"12"})]}),Printer:e.jsxs(e.Fragment,{children:[e.jsx("polyline",{points:"6 9 6 2 18 2 18 9"}),e.jsx("path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}),e.jsx("rect",{width:"12",height:"8",x:"6",y:"14"})]}),QrCode:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}),e.jsx("rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}),e.jsx("path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}),e.jsx("path",{d:"M21 21v.01"}),e.jsx("path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}),e.jsx("path",{d:"M3 12h.01"}),e.jsx("path",{d:"M12 3h.01"}),e.jsx("path",{d:"M12 16v.01"}),e.jsx("path",{d:"M16 12h1"}),e.jsx("path",{d:"M21 12v.01"}),e.jsx("path",{d:"M12 21v-1"})]}),Save:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]}),Scissors:e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"6",cy:"6",r:"3"}),e.jsx("circle",{cx:"6",cy:"18",r:"3"}),e.jsx("line",{x1:"20",x2:"8.12",y1:"4",y2:"15.88"}),e.jsx("line",{x1:"14.47",x2:"20",y1:"14.48",y2:"20"}),e.jsx("line",{x1:"8.12",x2:"12",y1:"8.12",y2:"12"})]}),Search:e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"})]}),Settings:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.35a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),SlidersHorizontal:e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:"21",x2:"14",y1:"4",y2:"4"}),e.jsx("line",{x1:"10",x2:"3",y1:"4",y2:"4"}),e.jsx("line",{x1:"21",x2:"12",y1:"12",y2:"12"}),e.jsx("line",{x1:"8",x2:"3",y1:"12",y2:"12"}),e.jsx("line",{x1:"21",x2:"16",y1:"20",y2:"20"}),e.jsx("line",{x1:"12",x2:"3",y1:"20",y2:"20"}),e.jsx("line",{x1:"14",x2:"14",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"10",y2:"14"}),e.jsx("line",{x1:"16",x2:"16",y1:"18",y2:"22"})]}),Sun:e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"12",r:"4"}),e.jsx("path",{d:"M12 2v2"}),e.jsx("path",{d:"M12 20v2"}),e.jsx("path",{d:"m4.93 4.93 1.41 1.41"}),e.jsx("path",{d:"m17.66 17.66 1.41 1.41"}),e.jsx("path",{d:"M2 12h2"}),e.jsx("path",{d:"M20 12h2"}),e.jsx("path",{d:"m6.34 17.66-1.41 1.41"}),e.jsx("path",{d:"m19.07 4.93-1.41 1.41"})]}),Trash2:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),e.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),e.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]}),TrendingUp:e.jsxs(e.Fragment,{children:[e.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),e.jsx("polyline",{points:"17 6 23 6 23 12"})]}),Truck:e.jsxs(e.Fragment,{children:[e.jsx("rect",{width:"16",height:"13",x:"1",y:"5",rx:"2"}),e.jsx("polygon",{points:"16 8 20 8 23 11 23 16 16 16 16 8"}),e.jsx("circle",{cx:"5.5",cy:"18.5",r:"2.5"}),e.jsx("circle",{cx:"18.5",cy:"18.5",r:"2.5"})]}),User:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),UserCog:e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"18",cy:"15",r:"3"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M10 15H6a4 4 0 0 0-4 4v2"}),e.jsx("path",{d:"m21.7 16.4.9-.9"}),e.jsx("path",{d:"m15.2 13.9-.9-.9"}),e.jsx("path",{d:"m16.6 18.7.3 1.2"}),e.jsx("path",{d:"m19.1 12.2.3-1.2"}),e.jsx("path",{d:"m19.6 18.7-.4-1"}),e.jsx("path",{d:"m16.8 12.3-.4-1"}),e.jsx("path",{d:"m14.3 16.6 1-.4"}),e.jsx("path",{d:"m20.7 13.8 1-.4"})]}),Users:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Warehouse:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z"}),e.jsx("path",{d:"M6 18h12"}),e.jsx("path",{d:"M6 14h12"}),e.jsx("rect",{width:"12",height:"12",x:"6",y:"10"})]}),Wind:e.jsxs(e.Fragment,{children:[e.jsx("path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2"}),e.jsx("path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2"}),e.jsx("path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2"})]}),X:e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),e.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]})},te=({name:t,className:n="w-6 h-6",...s})=>{const r=fj[t];return r?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,...s,children:r}):(console.warn(`Icon "${t}" not found`),null)},Fg=({text:t})=>e.jsxs("div",{className:"absolute left-full ml-3 top-1/2 -translate-y-1/2 px-3 py-1.5 bg-gray-900/90 dark:bg-black/90 backdrop-blur text-white text-sm font-medium rounded-md shadow-lg whitespace-nowrap z-50 invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-opacity delay-150 pointer-events-none",children:[t,e.jsx("div",{className:"absolute top-1/2 -left-1 -translate-y-1/2 w-0 h-0 border-y-4 border-y-transparent border-r-4 border-r-gray-900/90 dark:border-r-black/90"})]}),pj=({isOpen:t,setOpen:n})=>{const{language:s,t:r}=je(),{can:l}=ys(),{pathname:c}=As(),[d,u]=N.useState({}),h=N.useMemo(()=>ej.map(x=>{if(!x.permission||l(x.permission))if(x.children){const S=x.children.filter(w=>!w.permission||l(w.permission));if(S.length>0)return{...x,children:S};if(x.path)return{...x,children:[]}}else return x;return null}).filter(x=>x!==null),[l]);N.useEffect(()=>{const x={};h.forEach(S=>{S.children&&S.children.some(C=>C.path&&c.startsWith(C.path))&&(x[S.label.en]=!0)}),u(x)},[c,h]);const m=x=>{u(S=>({...S,[x]:!S[x]}))},f=({item:x})=>e.jsxs("div",{className:"relative group",children:[e.jsxs(Yy,{to:x.path,onClick:()=>{window.innerWidth<768&&n(!1)},className:({isActive:S})=>`flex items-center p-2 my-1 rounded-md transition-all duration-200 w-full ${S?"bg-blue-600/90 text-white shadow-lg shadow-blue-500/30 backdrop-blur-sm":"text-gray-700 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-white/10"}`,children:[e.jsx(te,{name:x.icon,className:"w-5 h-5 flex-shrink-0"}),t&&e.jsx("span",{className:"ml-3 whitespace-nowrap",children:x.label[s]})]}),!t&&e.jsx(Fg,{text:x.label[s]})]}),v=({item:x})=>{var C,T;const S=((C=x.children)==null?void 0:C.some(E=>E.path&&c.startsWith(E.path)))||!1,w=d[x.label.en]||!1;return e.jsxs("div",{children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{onClick:()=>m(x.label.en),className:`flex items-center justify-between p-2 my-1 rounded-md cursor-pointer transition-all duration-200 ${S?"bg-blue-100/80 dark:bg-blue-900/40 font-semibold text-blue-800 dark:text-blue-200 backdrop-blur-sm":"text-gray-700 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-white/10"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:x.icon,className:"w-5 h-5 flex-shrink-0"}),t&&e.jsx("span",{className:"ml-3 whitespace-nowrap",children:x.label[s]})]}),t&&e.jsx(te,{name:"ChevronDown",className:`w-5 h-5 transition-transform ${w?"rotate-180":""}`})]}),!t&&e.jsx(Fg,{text:x.label[s]})]}),w&&t&&e.jsx("div",{className:"pl-6 ml-4 border-l-2 border-blue-200/50 dark:border-blue-800/50",children:(T=x.children)==null?void 0:T.map(E=>e.jsx(f,{item:E},E.path))})]})};return e.jsxs("aside",{className:`fixed top-0 left-0 h-full bg-white/70 dark:bg-black/40 backdrop-blur-xl border-r border-white/20 dark:border-gray-700/50 transition-all duration-300 z-50 ${t?"w-64":"w-16"} ${t?"translate-x-0":"-translate-x-full md:translate-x-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 h-[73px]",children:[t&&e.jsx("span",{className:"text-xl font-bold ml-1 text-gray-800 dark:text-white",children:r("appName")}),e.jsx("button",{onClick:()=>n(!t),className:"p-2 rounded-md hover:bg-white/50 dark:hover:bg-white/10 hidden md:inline-flex text-gray-600 dark:text-gray-300",children:e.jsx(te,{name:"Menu",className:"w-6 h-6"})})]}),e.jsx("nav",{className:"p-2 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-700",style:{height:"calc(100vh - 73px)"},children:h.map(x=>x.children&&x.children.length>0?e.jsx(v,{item:x},x.label.en):e.jsx(f,{item:x},x.path))})]})},se=({children:t,variant:n="primary",className:s="",type:r="button",...l})=>{const c="px-4 py-2 rounded-lg font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-900 transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",d={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"bg-transparent text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 focus:ring-gray-500"};return e.jsx("button",{type:r,className:`${c} ${d[n]} ${s}`,...l,children:t})},hj=()=>{const{notifications:t}=uj(),{t:n}=je(),[s,r]=N.useState(!1),l=N.useRef(null);N.useEffect(()=>{const u=h=>{l.current&&!l.current.contains(h.target)&&r(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);const c=u=>{switch(u){case"MODULE_UNASSIGNED":return e.jsx(te,{name:"Grid",className:"w-5 h-5 text-yellow-500 flex-shrink-0"});case"HARVEST_NEARING":return e.jsx(te,{name:"AlertTriangle",className:"w-5 h-5 text-yellow-500 flex-shrink-0"});case"HARVEST_OVERDUE":return e.jsx(te,{name:"AlertTriangle",className:"w-5 h-5 text-red-500 flex-shrink-0"});default:return e.jsx(te,{name:"Bell",className:"w-5 h-5 text-gray-500 flex-shrink-0"})}},d=(u,h)=>{let m=n(u);for(const f in h)m=m.replace(`{${f}}`,String(h[f]));return m};return e.jsxs("div",{className:"relative",ref:l,children:[e.jsxs("button",{onClick:()=>r(!s),className:"relative p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-700/50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-900","aria-label":n("notifications_count").replace("{count}",String(t.length)),children:[e.jsx(te,{name:"Bell",className:"w-6 h-6"}),t.length>0&&e.jsxs("span",{className:"absolute top-0 right-0 flex h-5 w-5",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-5 w-5 bg-red-500 text-white text-xs items-center justify-center",children:t.length})]})]}),s&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 max-w-xs sm:max-w-sm bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl border border-gray-200 dark:border-gray-700/50 rounded-lg shadow-2xl z-50",children:[e.jsx("div",{className:"p-3 font-semibold border-b border-gray-200 dark:border-gray-700",children:n("notifications")}),e.jsx("ul",{className:"max-h-96 overflow-y-auto divide-y divide-gray-200 dark:divide-gray-700",children:t.length>0?t.map(u=>e.jsx("li",{children:e.jsxs(os,{to:u.path,onClick:()=>r(!1),className:"flex items-start gap-3 p-3 hover:bg-gray-100 dark:hover:bg-gray-700/50",children:[c(u.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm",children:d(u.messageKey,u.messageParams)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(u.date).toLocaleDateString()})]})]})},u.id)):e.jsx("li",{className:"p-4 text-center text-sm text-gray-500 dark:text-gray-400",children:n("noNotifications")})})]})]})},at=({isOpen:t,onClose:n,title:s,children:r,footer:l,widthClass:c="max-w-4xl"})=>{const{t:d}=je(),[u,h]=N.useState(!1);return N.useEffect(()=>(h(!0),()=>h(!1)),[]),N.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),N.useEffect(()=>{const m=f=>{f.key==="Escape"&&n()};return window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}},[n]),!t||!u?null:QS.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex justify-center items-center z-[1050]",onClick:n,children:e.jsxs("div",{className:`bg-white/90 dark:bg-gray-900/90 backdrop-blur-xl border border-gray-200 dark:border-gray-700/50 rounded-xl shadow-2xl flex flex-col w-full m-4 ${c} max-h-[90vh] animate-in fade-in zoom-in-95 duration-200`,onClick:m=>m.stopPropagation(),children:[e.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100",children:s}),e.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(te,{name:"X",className:"w-6 h-6"})})]}),e.jsx("main",{className:"p-6 overflow-y-auto flex-grow custom-scrollbar",children:r}),l&&e.jsx("footer",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:l})]})}),document.body)},gj=({isOpen:t,onClose:n,onScan:s})=>{const{t:r}=je(),l=N.useRef(null),[c,d]=N.useState("");return N.useEffect(()=>(t&&!l.current&&setTimeout(()=>{try{const u=new Html5QrcodeScanner("qr-reader",{fps:10,qrbox:{width:250,height:250}},!1);u.render(h=>{u.clear().then(()=>{s(h)})},h=>{}),l.current=u}catch{d("Camera access needed or library missing.")}},100),()=>{l.current&&(l.current.clear().catch(u=>console.error(u)),l.current=null)}),[t,s]),e.jsx(at,{isOpen:t,onClose:n,title:r("scanQRCode"),widthClass:"max-w-md",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{id:"qr-reader",className:"w-full"}),c&&e.jsx("p",{className:"text-red-500 mt-2",children:c}),e.jsx("p",{className:"text-sm text-gray-500 mt-4 text-center",children:r("scanInstruction")})]})})},mn=({status:t})=>{const{t:n}=je();if(!t)return null;const s={FREE:{textKey:"status_FREE",color:"gray"},ASSIGNED:{textKey:"status_ASSIGNED",color:"green"},CREATED:{textKey:"status_CREATED",color:"indigo"},CUTTING:{textKey:"status_CUTTING",color:"orange"},PLANTED:{textKey:"status_PLANTED",color:"blue"},GROWING:{textKey:"status_GROWING",color:"cyan"},HARVESTED:{textKey:"status_HARVESTED",color:"yellow"},DRYING:{textKey:"status_DRYING",color:"orange"},BAGGING:{textKey:"status_BAGGING",color:"purple"},IN_STOCK:{textKey:"status_IN_STOCK",color:"pink"},EXPORTED:{textKey:"status_EXPORTED",color:"red"},MAINTENANCE:{textKey:"status_MAINTENANCE",color:"gray"},STORED:{textKey:"status_STORED",color:"gray"},[Ot.AWAITING_OUTBOUND]:{textKey:"status_AWAITING_OUTBOUND",color:"yellow"},[Ot.IN_TRANSIT]:{textKey:"status_IN_TRANSIT",color:"blue"},[Ot.COMPLETED]:{textKey:"status_COMPLETED",color:"green"},[Ot.CANCELLED]:{textKey:"status_CANCELLED",color:"red"},LOW:{textKey:"severity_LOW",color:"cyan"},MEDIUM:{textKey:"severity_MEDIUM",color:"yellow"},HIGH:{textKey:"severity_HIGH",color:"orange"},CRITICAL:{textKey:"severity_CRITICAL",color:"red"},OPEN:{textKey:"status_OPEN",color:"blue"},IN_PROGRESS:{textKey:"status_IN_PROGRESS",color:"purple"},RESOLVED:{textKey:"status_RESOLVED",color:"green"},CLOSED:{textKey:"status_CLOSED",color:"gray"},PERMANENT:{textKey:"employeeType_PERMANENT",color:"blue"},CASUAL:{textKey:"employeeType_CASUAL",color:"green"},ACTIVE:{textKey:"status_ACTIVE",color:"green"},INACTIVE:{textKey:"status_INACTIVE",color:"red"}},{textKey:r,color:l}=s[t]||{textKey:t,color:"gray"},c=n(r)||t,d={green:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",gray:"bg-gray-100 text-gray-800 dark:bg-gray-700/50 dark:text-gray-300",indigo:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/50 dark:text-indigo-300",blue:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",cyan:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/50 dark:text-cyan-300",yellow:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",orange:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300",purple:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-300",pink:"bg-pink-100 text-pink-800 dark:bg-pink-900/50 dark:text-pink-300",red:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${d[l]}`,children:c})},Ge=({children:t,className:n="",title:s,onClick:r})=>{const l=`
    bg-white/80 dark:bg-gray-800/60
    backdrop-blur-xl
    border border-white/20 dark:border-gray-700/50
    rounded-xl shadow-xl p-6 
    ${r?"cursor-pointer hover:bg-white/90 dark:hover:bg-gray-800/70 transition-all":""} 
    ${n}
  `;return e.jsxs("div",{className:l.trim(),onClick:r,children:[s&&e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4",children:s}),t]})},xj=({isOpen:t,onClose:n,scannedData:s})=>{var x,S,w,C;const{t:r,language:l}=je(),{modules:c,cultivationCycles:d,sites:u,farmers:h,seaweedTypes:m}=qe(),f=N.useMemo(()=>{if(!s)return null;let T,E;if(s.type==="module"?(T=c.find(I=>I.id===s.id),T&&(E=d.filter(I=>I.moduleId===T.id).sort((I,O)=>new Date(O.plantingDate).getTime()-new Date(I.plantingDate).getTime())[0])):s.type==="batch"&&(E=d.find(I=>I.id===s.id),E&&(T=c.find(I=>I.id===E.moduleId))),!T)return null;const R=u.find(I=>I.id===T.siteId),_=R==null?void 0:R.zones.find(I=>I.id===T.zoneId),D=T.farmerId?h.find(I=>I.id===T.farmerId):void 0,M=E?m.find(I=>I.id===E.seaweedTypeId):void 0;return{module:T,cycle:E,site:R,zone:_,farmer:D,seaweedType:M}},[s,c,d,u,h,m]);if(!f)return null;const v=(s==null?void 0:s.type)==="module"?f.module.code:f.cycle?`${((x=f.seaweedType)==null?void 0:x.name)||r("batch")} - ${new Date(f.cycle.plantingDate).toLocaleDateString()}`:r("unknown_batch");return e.jsx(at,{isOpen:t,onClose:n,title:r("traceabilityReport"),widthClass:"max-w-3xl",footer:e.jsx("button",{onClick:n,className:"px-4 py-2 bg-blue-600 text-white rounded",children:r("close")}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-800 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-blue-900 dark:text-blue-100 uppercase",children:v}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 uppercase tracking-wide",children:(s==null?void 0:s.type)==="module"?r("moduleTraceability"):r("batchTraceability")})]})]}),e.jsx(Ge,{title:r("originInformation"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:r("site")}),e.jsx("p",{className:"font-semibold",children:(S=f.site)==null?void 0:S.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:r("zone")}),e.jsx("p",{className:"font-semibold",children:(w=f.zone)==null?void 0:w.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:r("module")}),e.jsx("p",{className:"font-semibold font-mono",children:f.module.code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:r("farmer")}),e.jsx("p",{className:"font-semibold",children:f.farmer?`${f.farmer.firstName} ${f.farmer.lastName}`:r("unassigned")})]})]})}),f.cycle?e.jsxs(Ge,{title:r("batchHistory"),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:r("seaweedType")}),e.jsx("p",{className:"font-semibold",children:(C=f.seaweedType)==null?void 0:C.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:r("status")}),e.jsx("div",{className:"mt-1",children:e.jsx(mn,{status:f.cycle.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase",children:r("initialWeight")}),e.jsxs("p",{className:"font-semibold",children:[f.cycle.initialWeight," kg"]})]})]}),e.jsxs("div",{className:"mt-4 relative border-l-2 border-gray-200 dark:border-gray-700 ml-3 space-y-6 pl-6 pb-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[31px] mt-1.5 h-3 w-3 rounded-full border-2 border-blue-500 bg-white dark:bg-gray-900"}),e.jsx("p",{className:"text-sm text-gray-500",children:r("plantingDate")}),e.jsx("p",{className:"font-semibold",children:new Date(f.cycle.plantingDate).toLocaleDateString(l,{dateStyle:"medium"})})]}),f.cycle.harvestDate&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[31px] mt-1.5 h-3 w-3 rounded-full border-2 border-green-500 bg-white dark:bg-gray-900"}),e.jsx("p",{className:"text-sm text-gray-500",children:r("harvestDate")}),e.jsxs("p",{className:"font-semibold",children:[new Date(f.cycle.harvestDate).toLocaleDateString(l,{dateStyle:"medium"}),e.jsxs("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded text-gray-600",children:[f.cycle.harvestedWeight," kg"]})]})]}),f.cycle.dryingStartDate&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[31px] mt-1.5 h-3 w-3 rounded-full border-2 border-yellow-500 bg-white dark:bg-gray-900"}),e.jsx("p",{className:"text-sm text-gray-500",children:r("dryingProcess")}),e.jsxs("p",{className:"font-semibold",children:[new Date(f.cycle.dryingStartDate).toLocaleDateString(l,{dateStyle:"medium"}),f.cycle.dryingCompletionDate&&` - ${new Date(f.cycle.dryingCompletionDate).toLocaleDateString(l,{dateStyle:"medium"})}`]})]}),f.cycle.baggedDate&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[31px] mt-1.5 h-3 w-3 rounded-full border-2 border-purple-500 bg-white dark:bg-gray-900"}),e.jsx("p",{className:"text-sm text-gray-500",children:r("baggedDate")}),e.jsxs("p",{className:"font-semibold",children:[new Date(f.cycle.baggedDate).toLocaleDateString(l,{dateStyle:"medium"}),e.jsxs("span",{className:"ml-2 text-xs bg-gray-100 px-2 py-1 rounded text-gray-600",children:[f.cycle.baggedWeightKg," kg / ",f.cycle.baggedBagsCount," ",r("bales")]})]})]})]})]}):e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded text-yellow-800",children:r("noActiveCycleFoundForModule")})]})})},yj=({onMenuClick:t})=>{const{settings:n,updateSettings:s}=$e(),{t:r}=je(),{currentUser:l,logout:c}=ys(),d=xs(),[u,h]=N.useState(!1),m=N.useRef(null),[f,v]=N.useState(!1),[x,S]=N.useState(null),[w,C]=N.useState(!1),[T,E]=N.useState(navigator.onLine),R=n.theme.className.includes("dark");N.useEffect(()=>{const I=()=>E(!0),O=()=>E(!1);return window.addEventListener("online",I),window.addEventListener("offline",O),()=>{window.removeEventListener("online",I),window.removeEventListener("offline",O)}},[]);const _=()=>{const I=n.theme.id.includes("glass");let O;R?O=I?"light-glass":"light-formal":O=I?"dark-glass":"dark-formal";const A=Ko.find(U=>U.id===O);A&&s({...n,theme:A})},D=()=>{c(),d("/login")},M=I=>{v(!1);try{const O=JSON.parse(I);if(O.t&&O.id){const A=O.t==="m"?"module":"batch";S({type:A,id:O.id}),C(!0)}else alert(r("invalidQRCode"))}catch{alert(r("invalidQRCode"))}};return N.useEffect(()=>{const I=O=>{m.current&&!m.current.contains(O.target)&&h(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"bg-white/70 dark:bg-black/40 backdrop-blur-md shadow-sm p-2 sm:p-4 flex items-center justify-between sticky top-0 z-40 border-b border-white/20 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center min-w-0",children:[" ",e.jsx("button",{onClick:t,className:"p-2 -ml-2 mr-2 rounded-md text-gray-600 dark:text-gray-300 md:hidden hover:bg-gray-200 dark:hover:bg-gray-700",children:e.jsx(te,{name:"Menu",className:"w-6 h-6"})}),e.jsx("img",{src:n.company.logoUrl,alt:"Company Logo",className:"h-8 sm:h-10 mr-3 sm:mr-4 flex-shrink-0"}),e.jsx("h1",{className:"hidden sm:block text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 truncate",children:n.company.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center px-2 py-1 rounded-full text-xs font-medium ${T?"bg-green-100/80 text-green-800":"bg-red-100/80 text-red-800"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${T?"bg-green-500":"bg-red-500"}`}),T?"Online":"Offline"]}),e.jsxs(se,{variant:"secondary",onClick:()=>v(!0),className:"hidden sm:flex !py-1.5 !px-3",children:[e.jsx(te,{name:"QrCode",className:"w-5 h-5 mr-1"}),r("scan")]}),e.jsx(se,{variant:"ghost",onClick:()=>v(!0),className:"sm:hidden p-2 !rounded-full",children:e.jsx(te,{name:"QrCode",className:"w-6 h-6"})}),e.jsx(hj,{}),e.jsx(se,{variant:"ghost",onClick:_,className:"p-2 !rounded-full","aria-label":r("toggleTheme"),children:e.jsx(te,{name:R?"Sun":"Moon",className:"w-6 h-6"})}),l&&e.jsxs("div",{className:"relative",ref:m,children:[e.jsxs("button",{onClick:()=>h(!u),className:"flex items-center gap-2 p-1 rounded-full hover:bg-gray-200/50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("span",{className:"font-semibold hidden sm:inline text-gray-700 dark:text-gray-200",children:[l.firstName," ",l.lastName]}),e.jsxs("div",{className:"w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold shadow-sm",children:[l.firstName.charAt(0),l.lastName.charAt(0)]})]}),u&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl border border-gray-200 dark:border-gray-700/50 rounded-lg shadow-xl z-50 p-1",children:[e.jsxs("button",{onClick:()=>{h(!1),d("/profile")},className:"w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md flex items-center gap-2",children:[e.jsx(te,{name:"User",className:"w-4 h-4"}),r("profile")]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),e.jsxs("button",{onClick:D,className:"w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md flex items-center gap-2",children:[e.jsx(te,{name:"LogOut",className:"w-4 h-4"}),r("logout")]})]})]})]})]}),e.jsx(gj,{isOpen:f,onClose:()=>v(!1),onScan:M}),e.jsx(xj,{isOpen:w,onClose:()=>C(!1),scannedData:x})]})},vj=()=>{const{settings:t}=$e(),[n,s]=N.useState(!0);return e.jsxs("div",{className:`${t.theme.className} ${t.theme.font} min-h-screen flex transition-colors duration-500 relative bg-[url('https://images.unsplash.com/photo-1518837695005-2083093ee35b?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center bg-fixed text-gray-800 dark:text-gray-200`,children:[e.jsx("div",{className:"absolute inset-0 bg-gray-100/80 dark:bg-black/70 backdrop-blur-sm z-0 pointer-events-none"}),e.jsxs("div",{className:"flex flex-1 z-10 relative h-full",children:[n&&e.jsx("div",{onClick:()=>s(!1),className:"fixed inset-0 bg-black/50 z-40 md:hidden"}),e.jsx(pj,{isOpen:n,setOpen:s}),e.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${n?"md:ml-64":"md:ml-16"}`,children:[e.jsx(yj,{onMenuClick:()=>s(r=>!r)}),e.jsx("main",{className:"p-4 sm:p-6 overflow-y-auto flex-grow scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-transparent",children:e.jsx(Vy,{})})]})]})]})},Xs=({permission:t})=>{const{currentUser:n,can:s}=ys();return n?t&&!s(t)?e.jsx(tl,{to:"/dashboard",replace:!0}):e.jsx(Vy,{}):e.jsx(tl,{to:"/login",replace:!0})},bj=()=>{const{t}=je(),{settings:n}=$e(),s=xs(),{login:r}=ys(),[l,c]=N.useState("admin@seafarm.com"),[d,u]=N.useState("password"),[h,m]=N.useState(""),[f,v]=N.useState(!1),x=async S=>{S.preventDefault(),m(""),v(!0),await r(l,d)?s("/dashboard"):(m(t("invalidCredentials")),v(!1))};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 p-4 font-sans bg-[url('https://images.unsplash.com/photo-1518837695005-2083093ee35b?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs("div",{className:"w-full max-w-4xl z-10 grid grid-cols-1 md:grid-cols-2 rounded-2xl overflow-hidden shadow-2xl border border-gray-700",children:[e.jsxs("div",{className:"hidden md:flex flex-col justify-center items-center p-8 bg-gradient-to-br from-blue-900/80 to-black/80 text-white relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full opacity-20 bg-[radial-gradient(circle_at_50%_50%,rgba(59,130,246,0.5),transparent_70%)]"}),e.jsx("h1",{className:"text-4xl font-bold mb-4 relative z-10",children:t("welcomeBack")}),e.jsx("p",{className:"text-center text-gray-300 relative z-10",children:"Efficiently manage your seaweed farm operations, inventory, and payments in one place."}),e.jsxs("div",{className:"mt-8 p-4 bg-white/10 backdrop-blur-md rounded-xl border border-white/20 text-sm text-gray-300 relative z-10",children:[e.jsx("p",{className:"font-semibold text-blue-400 mb-1",children:"Default Access:"}),e.jsx("p",{children:"Email: admin@seafarm.com"}),e.jsx("p",{children:"Pass: password"})]})]}),e.jsxs("div",{className:"p-8 md:p-12 bg-black/80 backdrop-blur-md flex flex-col justify-center",children:[e.jsx("div",{className:"flex justify-center mb-8",children:n.company.logoUrl?e.jsx("img",{src:n.company.logoUrl,alt:"Logo",className:"h-16 object-contain drop-shadow-lg"}):e.jsx("div",{className:"h-16 w-16 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx(te,{name:"Activity",className:"w-8 h-8 text-white"})})}),e.jsx("h2",{className:"text-2xl font-bold text-white text-center mb-2",children:"Login"}),e.jsx("p",{className:"text-gray-400 text-center mb-8",children:"Enter your credentials to access your account"}),e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[h&&e.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/50 text-red-300 rounded-md text-sm text-center",children:h}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:t("email")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(te,{name:"User",className:"h-5 w-5 text-gray-500"})}),e.jsx("input",{type:"email",value:l,onChange:S=>c(S.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-500 transition-all",placeholder:"name@company.com"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:t("password")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(te,{name:"Lock",className:"h-5 w-5 text-gray-500"})}),e.jsx("input",{type:"password",value:d,onChange:S=>u(S.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-white placeholder-gray-500 transition-all",placeholder:""})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"flex items-center text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600 bg-gray-800 border-gray-600 rounded"}),e.jsx("span",{className:"ml-2",children:"Remember me"})]}),e.jsx(os,{to:"/forgot-password",className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:t("forgotPassword")})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full py-3 px-4 bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 text-white font-bold rounded-lg shadow-lg transform transition-all hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center",children:f?e.jsx(te,{name:"Activity",className:"animate-spin h-5 w-5"}):"Login"})]}),e.jsxs("div",{className:"mt-6 flex flex-col gap-2 text-center text-sm text-gray-400",children:[e.jsxs("p",{children:["Don't have an account?"," ",e.jsx(os,{to:"/signup",className:"text-blue-400 hover:text-blue-300 font-bold transition-colors",children:"Sign Up"})]}),e.jsx(os,{to:"/terms",className:"text-xs text-gray-500 hover:text-gray-400 hover:underline mt-2",children:t("termsOfUse")})]})]})]})]})},Nj="pk_test_TYooMQauvdEDq54NiTphI7jx",Sj=({amount:t,currency:n,onSuccess:s,onProcessing:r,buttonText:l="Pay Now"})=>{const c=N.useRef(null),d=N.useRef(null),u=N.useRef(null),h=N.useRef(null),[m,f]=N.useState(null),[v,x]=N.useState(!1);N.useEffect(()=>{if(window.Stripe&&c.current&&!d.current)try{const w=window.Stripe(Nj);d.current=w;const C=w.elements();u.current=C;const T={base:{color:"#ffffff",fontFamily:'"Segoe UI", "Roboto", "Helvetica Neue", sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#9ca3af"},backgroundColor:"transparent"},invalid:{color:"#ef4444",iconColor:"#ef4444"}},E=C.create("card",{style:T,hidePostalCode:!0});E.mount(c.current),h.current=E,E.on("change",R=>{x(R.complete),f(R.error?R.error.message:null)})}catch(w){console.error("Stripe initialization error:",w),f("Failed to load payment system.")}return()=>{h.current}},[]);const S=async w=>{if(w.preventDefault(),!d.current||!h.current)return;r(!0);const C=await d.current.createPaymentMethod({type:"card",card:h.current});C.error?(f(C.error.message),r(!1)):setTimeout(()=>{s(C.paymentMethod.id),r(!1)},1e3)};return e.jsxs("form",{onSubmit:S,className:"w-full",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wide text-gray-400 mb-2",children:"Card Details (Secure via Stripe)"}),e.jsx("div",{ref:c,className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg p-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-transparent transition-all min-h-[46px]"}),m&&e.jsxs("div",{className:"mt-2 text-sm text-red-400 flex items-center",children:[e.jsx(te,{name:"AlertTriangle",className:"w-4 h-4 mr-1"}),m]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(te,{name:"Lock",className:"w-3 h-3"})," SSL Secure Payment"]}),e.jsx("span",{children:"Powered by Stripe"})]}),e.jsxs("button",{type:"submit",disabled:!d.current||!v,className:"w-full py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 rounded-lg font-bold shadow-lg transition-all flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(te,{name:"CreditCard",className:"w-4 h-4"})," ",l]})]})},jj=()=>{const{t}=je(),n=xs(),{signup:s}=ys(),[r,l]=N.useState("account"),[c,d]=N.useState(!1),[u,h]=N.useState(""),[m,f]=N.useState({firstName:"",lastName:"",email:"",password:"",organizationName:""}),[v,x]=N.useState("starter"),[S,w]=N.useState(""),C=[{id:"starter",name:"Starter Plan",price:20,limit:5,description:"Perfect for small farms getting started.",features:["Up to 5 Users","Basic Reporting","Map View","Inventory Management"]},{id:"pro",name:"Pro Plan",price:35,limit:10,description:"Advanced features for growing operations.",features:["Up to 10 Users","Advanced AI Analytics","Priority Support","Multiple Sites"]}],T=D=>{if(D.preventDefault(),m.password.length<6){h("Password must be at least 6 characters");return}h(""),l("plan")},E=D=>{x(D),l("payment")},R=async D=>{d(!0),h("");try{console.log("Payment Method ID received:",D),await s({firstName:m.firstName,lastName:m.lastName,email:m.email,password:m.password,organizationName:m.organizationName,planId:v,roleId:"SITE_MANAGER",paymentMethodId:D})?n("/dashboard"):(h(t("emailExists")),d(!1))}catch{h("Registration failed. Please try again."),d(!1)}},_=C.find(D=>D.id===v);return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 p-4 font-sans bg-[url('https://images.unsplash.com/photo-1518837695005-2083093ee35b?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center text-white",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm"}),e.jsxs("div",{className:"w-full max-w-5xl z-10 grid grid-cols-1 md:grid-cols-12 rounded-2xl overflow-hidden shadow-2xl border border-gray-700 bg-black/40 backdrop-blur-xl min-h-[600px]",children:[e.jsxs("div",{className:"md:col-span-5 bg-gradient-to-b from-blue-900/90 to-black/90 p-8 flex flex-col justify-between relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-cyan-500/20 rounded-full filter blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Get Started"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Join the future of seaweed farming management."}),e.jsxs("div",{className:"mt-10 space-y-6",children:[e.jsxs("div",{className:`flex items-center gap-4 ${r==="account"?"opacity-100":"opacity-50"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border ${r==="account"?"bg-blue-600 border-blue-600":"border-gray-400"} font-bold`,children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Account"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Your details & organization"})]})]}),e.jsxs("div",{className:`flex items-center gap-4 ${r==="plan"?"opacity-100":"opacity-50"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border ${r==="plan"?"bg-blue-600 border-blue-600":"border-gray-400"} font-bold`,children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Plan"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Choose your capacity"})]})]}),e.jsxs("div",{className:`flex items-center gap-4 ${r==="payment"?"opacity-100":"opacity-50"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border ${r==="payment"?"bg-blue-600 border-blue-600":"border-gray-400"} font-bold`,children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Payment"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Secure credit card checkout"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-8",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:["Already have an account? ",e.jsx(os,{to:"/login",className:"text-cyan-400 hover:underline",children:"Log In"})]}),e.jsx(os,{to:"/terms",className:"text-xs text-gray-500 hover:text-gray-400 hover:underline",children:t("termsOfUse")})]})]}),e.jsxs("div",{className:"md:col-span-7 p-8 md:p-12 flex flex-col justify-center relative",children:[u&&e.jsx("div",{className:"absolute top-4 left-8 right-8 p-3 bg-red-500/20 border border-red-500/50 text-red-300 rounded-md text-sm text-center z-20",children:u}),r==="account"&&e.jsxs("form",{onSubmit:T,className:"space-y-5 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Create Account"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-gray-400",children:"First Name"}),e.jsx("input",{required:!0,className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",value:m.firstName,onChange:D=>f({...m,firstName:D.target.value}),placeholder:"John"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Last Name"}),e.jsx("input",{required:!0,className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",value:m.lastName,onChange:D=>f({...m,lastName:D.target.value}),placeholder:"Doe"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Email Address"}),e.jsx("input",{type:"email",required:!0,className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",value:m.email,onChange:D=>f({...m,email:D.target.value}),placeholder:"john@example.com"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Organization Name"}),e.jsx("input",{required:!0,className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",value:m.organizationName,onChange:D=>f({...m,organizationName:D.target.value}),placeholder:"Ocean Harvest Ltd."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Password"}),e.jsx("input",{type:"password",required:!0,className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg p-3 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",value:m.password,onChange:D=>f({...m,password:D.target.value}),placeholder:""})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[t("agreeToTerms")," ",e.jsx(os,{to:"/terms",className:"text-cyan-400 hover:underline",children:t("termsOfUse")})]}),e.jsx("button",{type:"submit",className:"w-full py-3 mt-4 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 rounded-lg font-bold shadow-lg transition-all",children:"Next: Select Plan"})]}),r==="plan"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Select Plan"}),e.jsx("button",{onClick:()=>l("account"),className:"text-sm text-gray-400 hover:text-white",children:"Back"})]}),e.jsx("div",{className:"grid gap-4",children:C.map(D=>e.jsxs("div",{onClick:()=>E(D.id),className:`p-4 rounded-xl border-2 cursor-pointer transition-all flex justify-between items-center group
                                         ${v===D.id?"border-blue-500 bg-blue-900/20":"border-gray-700 bg-gray-800/30 hover:border-gray-500"}`,children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-white group-hover:text-blue-400 transition-colors",children:D.name}),e.jsx("p",{className:"text-sm text-gray-400",children:D.description}),e.jsx("ul",{className:"mt-2 text-xs text-gray-300 space-y-1",children:D.features.slice(0,2).map(M=>e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(te,{name:"Check",className:"w-3 h-3 text-green-400"})," ",M]},M))})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",D.price,e.jsx("span",{className:"text-sm font-normal text-gray-400",children:"/mo"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Up to ",D.limit," users"]})]})]},D.id))})]}),r==="payment"&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Secure Payment"}),e.jsx("button",{type:"button",onClick:()=>l("plan"),className:"text-sm text-gray-400 hover:text-white",children:"Change Plan"})]}),e.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-4 rounded-lg flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white",children:_==null?void 0:_.name}),e.jsx("p",{className:"text-xs text-gray-400",children:"Billed monthly"})]}),e.jsxs("p",{className:"text-xl font-bold text-white",children:["$",_==null?void 0:_.price]})]}),e.jsxs("div",{className:"space-y-1 mb-4",children:[e.jsx("label",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Cardholder Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{name:"User",className:"absolute left-3 top-3.5 w-5 h-5 text-gray-500"}),e.jsx("input",{required:!0,className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg p-3 pl-10 text-white focus:ring-2 focus:ring-blue-500 outline-none",value:S,onChange:D=>w(D.target.value),placeholder:"JOHN DOE"})]})]}),c?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[e.jsx(te,{name:"Activity",className:"w-10 h-10 text-blue-500 animate-spin"}),e.jsx("p",{className:"text-gray-300",children:"Processing Payment..."})]}):e.jsx(Sj,{amount:(_==null?void 0:_.price)||20,currency:"USD",onSuccess:R,onProcessing:d,buttonText:`Pay $${_==null?void 0:_.price} & Join`})]})]})]})]})},de=({label:t,id:n,containerClassName:s="",error:r,type:l,className:c="",...d})=>{const{required:u}=d,h=r?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-blue-500 focus:ring-blue-500";return e.jsxs("div",{className:`w-full ${s}`,children:[t&&e.jsxs("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t,u&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:n,type:l,className:`
            w-full px-3 py-2 
            bg-white dark:bg-gray-700 
            text-gray-900 dark:text-white 
            placeholder-gray-400
            border rounded-lg shadow-sm 
            focus:outline-none focus:ring-2 focus:ring-offset-0 
            transition-all duration-200
            disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-60
            ${h} 
            ${l==="date"?"pr-10":""}
            ${c}
          `,...d}),l==="date"&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx(te,{name:"Calendar",className:"w-5 h-5 text-gray-400"})})]}),r&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:r})]})},Tj=()=>{const{t}=je(),{settings:n}=$e(),{sendPasswordResetLink:s}=ys(),[r,l]=N.useState(""),[c,d]=N.useState(!1),[u,h]=N.useState(!1),[m,f]=N.useState(null),v=async x=>{x.preventDefault(),d(!0);const S=await s(r);f(S),d(!1),h(!0)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:n.company.logoUrl,alt:"Company Logo",className:"h-12"})}),e.jsx(Ge,{title:t("forgotPasswordTitle"),children:u?e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("resetLinkSentTitle")}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:t("resetLinkSentInstructions")}),m&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg text-left",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(te,{name:"Bot",className:"w-4 h-4 text-blue-600"}),e.jsx("p",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 uppercase",children:"Demo Email Simulator"})]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-3",children:["In a production environment, the following link would be sent to ",e.jsx("strong",{children:r}),". For this demo, click the link below to proceed:"]}),e.jsx(os,{to:m.substring(m.indexOf("#")+1),className:"text-sm font-medium text-blue-600 hover:text-blue-500 underline break-all",children:m})]}),e.jsx(os,{to:"/login",children:e.jsx(se,{className:"w-full mt-6",children:t("backToLogin")})})]}):e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("forgotPasswordInstructions")}),e.jsx(de,{label:t("email"),id:"email",type:"email",value:r,onChange:x=>l(x.target.value),required:!0,autoComplete:"email",autoFocus:!0}),e.jsx(se,{type:"submit",className:"w-full",disabled:c||!r,children:c?e.jsx(te,{name:"Activity",className:"animate-spin"}):t("sendResetLink")}),e.jsx("p",{className:"mt-6 text-center text-sm",children:e.jsx(os,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:t("backToLogin")})})]})})]})})},wj=()=>{const{t}=je(),{settings:n}=$e(),s=xs(),[r]=xm(),{resetPassword:l}=ys(),[c,d]=N.useState(""),[u,h]=N.useState(""),[m,f]=N.useState(""),[v,x]=N.useState(""),[S,w]=N.useState(!1),[C,T]=N.useState(null);N.useEffect(()=>{const R=r.get("token");R||f(t("invalidOrExpiredToken")),T(R)},[r,t]);const E=async R=>{if(R.preventDefault(),c!==u){f(t("passwordMismatch"));return}if(!C){f(t("invalidOrExpiredToken"));return}f(""),x(""),w(!0),await l(C,c)?(x(t("passwordResetSuccess")),setTimeout(()=>{s("/login")},3e3)):f(t("invalidOrExpiredToken")),w(!1)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:n.company.logoUrl,alt:"Company Logo",className:"h-12"})}),e.jsx(Ge,{title:t("resetPasswordTitle"),children:v?e.jsx("div",{className:"p-3 text-center bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 rounded-md text-sm",children:v}):e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[m&&e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 rounded-md text-sm",children:m}),e.jsx(de,{label:t("newPassword"),id:"password",type:"password",value:c,onChange:R=>d(R.target.value),required:!0,autoComplete:"new-password",autoFocus:!0,disabled:!C||S}),e.jsx(de,{label:t("confirmNewPassword"),id:"confirmPassword",type:"password",value:u,onChange:R=>h(R.target.value),required:!0,autoComplete:"new-password",disabled:!C||S}),e.jsx(se,{type:"submit",className:"w-full",disabled:S||!C||!c||!u,children:S?e.jsx(te,{name:"Activity",className:"animate-spin"}):t("resetPassword")})]})})]})})};function a0(t,n){if(isNaN(t)||t===null)return"";const s=Math.abs(t),r=Math.floor(s),l=(s-r)*60,c=Math.floor(l),d=((l-c)*60).toFixed(2);let u="";return n?u=t>=0?"N":"S":u=t>=0?"E":"W",`${r} ${c}' ${d}" ${u}`}function on(t){if(!t)throw new Error("Empty input");const n=t.trim();if(/^-?\d+(\.\d+)?$/.test(n)){const m=parseFloat(n);if(!isNaN(m))return m}const s=/(-?\d+(\.\d+)?)\s*(?:\s*(\d+(\.\d+)?)\s*')?(?:\s*(\d+(\.\d+)?)\s*")?\s*([NSEW])/i,r=n.match(s);if(!r){const m=n.match(/(-?\d+(\.\d+)?)\s*([NSEW])/i);if(m){const f=parseFloat(m[1]),v=m[3].toUpperCase();return(v==="S"||v==="W")&&f>0?-f:f}throw new Error(`Invalid coordinate format: "${t}"`)}const l=parseFloat(r[1]),c=parseFloat(r[3]||"0"),d=parseFloat(r[5]||"0"),u=r[7].toUpperCase();if(isNaN(l)||c<0||d<0)throw new Error(`Invalid numbers in DMS string: "${t}"`);let h=Math.abs(l)+c/60+d/3600;if((u==="S"||u==="W")&&(h=h*-1),(u==="N"||u==="S")&&Math.abs(h)>90)throw new Error(`Latitude out of range (-90 to 90): "${t}"`);if((u==="E"||u==="W")&&Math.abs(h)>180)throw new Error(`Longitude out of range (-180 to 180): "${t}"`);return h}function Vu(t){const n=[];for(const s of t)if(!(!s||!s.trim()))try{const r=s.split(",");if(r.length!==2)throw new Error("Invalid geo-point format, expected 'lat, lon'");const l=r[0].trim(),c=r[1].trim();if(!l||!c)continue;const d=on(l),u=on(c);n.push({x:u,y:d})}catch{}return n}function Bg(t,n,s){if(!t)return"";let r;try{r=on(t)}catch{return t}return n==="DD"?r.toFixed(6):a0(r,s)}function sc(t,n,s){if(t<=0||n<=0||s<=0)return null;const r=(Math.log(n)-Math.log(t))/s*100;return parseFloat(r.toFixed(2))}const Cj=()=>{const t=N.useRef(null),n=N.useRef(null),{cultivationCycles:s}=qe(),{settings:r}=$e(),{t:l,language:c}=je(),d=N.useMemo(()=>{const u=[],h=[],m=new Date;for(let f=5;f>=0;f--){const v=new Date(m.getFullYear(),m.getMonth()-f,1);u.push(v.toLocaleDateString(c,{month:"short",year:"2-digit"})),h.push(0)}return s.forEach(f=>{if(f.harvestDate&&f.harvestedWeight){const v=new Date(f.harvestDate),x=(m.getFullYear()-v.getFullYear())*12+(m.getMonth()-v.getMonth());if(x>=0&&x<6){const S=(f.harvestedWeight||0)-(f.cuttingsTakenAtHarvestKg||0);h[5-x]+=S}}}),{labels:u,data:h}},[s,c]);return N.useEffect(()=>{if(!t.current)return;const u=r.theme.className.includes("dark"),h=u?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",m=u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)";n.current&&n.current.destroy();const f=t.current.getContext("2d");f&&window.Chart&&(n.current=new window.Chart(f,{type:"line",data:{labels:d.labels,datasets:[{label:l("netHarvestedWeightKg"),data:d.data,fill:!0,backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"rgba(59, 130, 246, 1)",tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{color:h},grid:{color:m}},x:{ticks:{color:h},grid:{color:m}}}}}))},[d,r.theme,l]),e.jsx("div",{className:"w-full h-64",children:e.jsx("canvas",{ref:t})})},Ej=()=>{const t=N.useRef(null),n=N.useRef(null),{cultivationCycles:s,seaweedTypes:r}=qe(),{settings:l}=$e(),{t:c}=je(),d=N.useMemo(()=>{const u={};s.forEach(m=>{if(m.harvestDate&&m.harvestedWeight&&m.initialWeight&&m.plantingDate){const f=(new Date(m.harvestDate).getTime()-new Date(m.plantingDate).getTime())/864e5,v=sc(m.initialWeight,m.harvestedWeight,f);v!==null&&(u[m.seaweedTypeId]||(u[m.seaweedTypeId]={sgrSum:0,count:0}),u[m.seaweedTypeId].sgrSum+=v,u[m.seaweedTypeId].count++)}});const h=new Map(r.map(m=>[m.id,m.name]));return Object.entries(u).map(([m,{sgrSum:f,count:v}])=>({label:h.get(m)||c("unknown"),avgSGR:f/v}))},[s,r,c]);return N.useEffect(()=>{if(!t.current)return;const u=l.theme.className.includes("dark"),h=u?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",m=u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)";n.current&&n.current.destroy();const f=t.current.getContext("2d");f&&window.Chart&&(n.current=new window.Chart(f,{type:"bar",data:{labels:d.map(v=>v.label),datasets:[{label:c("growthRate")+" (%)",data:d.map(v=>v.avgSGR),backgroundColor:"rgba(16, 185, 129, 0.6)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"% / day",color:h},ticks:{color:h},grid:{color:m}},x:{ticks:{color:h},grid:{color:m}}}}}))},[d,l.theme,c]),e.jsx("div",{className:"w-full h-64",children:e.jsx("canvas",{ref:t})})},Gg=()=>{const t=N.useRef(null),n=N.useRef(null),{sites:s,modules:r,cultivationCycles:l}=qe(),{t:c}=je(),d=N.useMemo(()=>{const u=new Map;return l.forEach(h=>{if(h.harvestedWeight){const m=r.find(f=>f.id===h.moduleId);if(m){const f=(h.harvestedWeight||0)-(h.cuttingsTakenAtHarvestKg||0);u.set(m.siteId,(u.get(m.siteId)||0)+f)}}}),u},[l,r]);return N.useEffect(()=>{t.current&&!n.current&&(n.current=L.map(t.current,{center:[-18.76,46.86],zoom:6,zoomControl:!1}),L.tileLayer("https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'}).addTo(n.current));const u=n.current;if(!u)return;setTimeout(()=>{u.invalidateSize()},100),u.eachLayer(m=>{(m instanceof L.Marker||m instanceof L.CircleMarker)&&u.removeLayer(m)});const h=Math.max(...Array.from(d.values()),1);s.forEach(m=>{if(m.location)try{const[f,v]=m.location.split(","),x=on(f.trim()),S=on(v.trim()),w=d.get(m.id)||0,C=5+w/h*20;L.circleMarker([x,S],{radius:C,fillColor:"#2563eb",color:"#1d4ed8",weight:1,opacity:1,fillOpacity:.6}).addTo(u).bindPopup(`<b>${m.name}</b><br>${c("netProduction")}: ${w.toFixed(0)} kg`)}catch{console.error("Failed to parse site location",m.location)}})},[s,d,c]),e.jsx("div",{ref:t,className:"w-full h-full min-h-[600px] rounded-lg z-0"})},Ij=()=>{const{farmers:t,cultivationCycles:n,modules:s}=qe(),{t:r}=je(),l=N.useMemo(()=>{const T={};return n.forEach(E=>{if(E.harvestedWeight){const R=s.find(_=>_.id===E.moduleId);if(R!=null&&R.farmerId){T[R.farmerId]||(T[R.farmerId]={yield:0,cycles:0});const _=(E.harvestedWeight||0)-(E.cuttingsTakenAtHarvestKg||0);T[R.farmerId].yield+=_,T[R.farmerId].cycles++}}}),Object.entries(T).map(([E,R])=>{const _=t.find(D=>D.id===E);return{name:_?`${_.firstName} ${_.lastName}`:r("unknown"),yield:R.yield,cycles:R.cycles}})},[t,n,s,r]);if(l.length===0)return e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:r("noDataForReport")});const c=window.Recharts;if(!c)return e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"Loading chart library..."});const{ResponsiveContainer:d,BubbleChart:u,XAxis:h,YAxis:m,ZAxis:f,Tooltip:v,CartesianGrid:x,Legend:S,Bubble:w}=c,C=({active:T,payload:E,label:R})=>{if(T&&E&&E.length){const _=E[0].payload;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded shadow-lg text-xs z-50",children:[e.jsx("p",{className:"font-bold text-gray-900 dark:text-white mb-1",children:_.name}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:[r("totalYield"),": ",e.jsxs("span",{className:"font-semibold",children:[_.yield.toFixed(1)," kg"]})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:[r("numberOfCyclesAxis"),": ",e.jsx("span",{className:"font-semibold",children:_.cycles})]})]})}return null};return e.jsx("div",{className:"w-full h-64",children:e.jsx(d,{width:"100%",height:"100%",children:e.jsxs(u,{data:l,children:[e.jsx(x,{strokeDasharray:"3 3"}),e.jsx(h,{dataKey:"yield",name:r("totalYieldKgAxis"),type:"number"}),e.jsx(m,{dataKey:"cycles",name:r("numberOfCyclesAxis"),type:"number"}),e.jsx(f,{dataKey:"yield",range:[10,100],name:r("totalYield")}),e.jsx(v,{content:e.jsx(C,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(S,{}),e.jsx(w,{name:`${r("totalYield")} (${r("netWeight")})`,dataKey:"yield",fill:"#8884d8"})]})})})},_j=()=>{const t=N.useRef(null),n=N.useRef(null),{cultivationCycles:s,seaweedTypes:r}=qe(),{settings:l}=$e(),{t:c}=je(),d=N.useMemo(()=>{const u={};s.forEach(m=>{if(m.harvestedWeight){u[m.seaweedTypeId]||(u[m.seaweedTypeId]={yield:0,count:0});const f=(m.harvestedWeight||0)-(m.cuttingsTakenAtHarvestKg||0);u[m.seaweedTypeId].yield+=f,u[m.seaweedTypeId].count++}});const h=new Map(r.map(m=>[m.id,m.name]));return Object.entries(u).map(([m,{yield:f,count:v}])=>({label:h.get(m)||c("unknown"),avgYield:f/v}))},[s,r,c]);return N.useEffect(()=>{if(!t.current)return;const u=l.theme.className.includes("dark"),h=u?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",m=u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)";n.current&&n.current.destroy();const f=t.current.getContext("2d");f&&window.Chart&&(n.current=new window.Chart(f,{type:"bar",data:{labels:d.map(v=>v.label),datasets:[{label:c("averageYieldKg"),data:d.map(v=>v.avgYield),backgroundColor:"rgba(139, 92, 246, 0.6)",borderColor:"rgba(139, 92, 246, 1)",borderWidth:1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{ticks:{color:h},grid:{color:m}},x:{ticks:{color:h},grid:{color:m}}}}}))},[d,l.theme,c]),e.jsx("div",{className:"w-full h-64",children:e.jsx("canvas",{ref:t})})},Aj=()=>{const{t}=je(),{incidents:n,incidentTypes:s}=qe(),r=xs(),l=N.useMemo(()=>[...n].sort((d,u)=>new Date(u.date).getTime()-new Date(d.date).getTime()).slice(0,5),[n]),c=N.useMemo(()=>new Map(s.map(d=>[d.id,d.name])),[s]);return e.jsxs("div",{className:"space-y-3 h-full overflow-y-auto",children:[l.map(d=>e.jsxs("div",{className:"flex items-start gap-4 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900/50 cursor-pointer",onClick:()=>r("/monitoring/incidents"),children:[e.jsx(te,{name:"AlertTriangle",className:"w-5 h-5 text-yellow-500 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-semibold text-sm",children:c.get(d.type)||d.type}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:d.date})]}),e.jsx(mn,{status:d.status})]},d.id)),l.length===0&&e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-gray-500",children:t("noIncidents")})})]})},Dj=()=>{const{t}=je();return e.jsxs("div",{className:"flex justify-between items-center h-full px-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"Sun",className:"w-12 h-12 text-yellow-400 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:"28C"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Sunny"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Wind: 12 km/h NE"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Humidity: 65%"})]})]})},kj=()=>{const{t}=je(),n=xs(),[s,r]=N.useState("director");return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold tracking-tight text-gray-900 dark:text-white",children:t("analyticalDashboard")}),e.jsxs("div",{className:"bg-gray-200 dark:bg-gray-700 p-1 rounded-lg flex",children:[e.jsx("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${s==="director"?"bg-white dark:bg-gray-600 shadow-sm":"text-gray-500 dark:text-gray-400"}`,onClick:()=>r("director"),children:"Director"}),e.jsx("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${s==="field"?"bg-white dark:bg-gray-600 shadow-sm":"text-gray-500 dark:text-gray-400"}`,onClick:()=>r("field"),children:"Field"})]})]}),s==="director"?e.jsxs("div",{className:"flex-grow grid grid-cols-12 gap-6 animate-fade-in",children:[e.jsx(Ge,{className:"col-span-12 md:col-span-6 lg:col-span-4",title:t("productionTrend"),children:e.jsx(Cj,{})}),e.jsx(Ge,{className:"col-span-12 md:col-span-6 lg:col-span-4",title:t("growthRate"),children:e.jsx(Ej,{})}),e.jsx(Ge,{className:"col-span-12 md:col-span-6 lg:col-span-4",title:t("yieldBySeaweedType"),children:e.jsx(_j,{})}),e.jsx(Ge,{className:"col-span-12 md:col-span-6 lg:col-span-6 row-span-2",title:t("sitePerformance"),children:e.jsx(Gg,{})}),e.jsx(Ge,{className:"col-span-12 md:col-span-6 lg:col-span-6",title:t("farmerSegmentation"),children:e.jsx(Ij,{})})]}):e.jsxs("div",{className:"flex-grow grid grid-cols-12 gap-6 animate-fade-in",children:[e.jsx(Ge,{className:"col-span-12 lg:col-span-8 row-span-2 p-0 overflow-hidden",title:t("farmMapTitle"),children:e.jsx(Gg,{})}),e.jsx(Ge,{className:"col-span-12 lg:col-span-4 h-48",title:"Current Weather",children:e.jsx(Dj,{})}),e.jsx(Ge,{className:"col-span-12 lg:col-span-4 flex-grow flex flex-col",title:t("recentIncidents"),children:e.jsx(Aj,{})}),e.jsx(Ge,{className:"col-span-12",title:"Quick Actions",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(se,{className:"flex-1 py-8 flex-col gap-2",onClick:()=>n("/monitoring/incidents"),children:[e.jsx(te,{name:"PlusCircle",className:"w-8 h-8"}),t("reportIncident")]}),e.jsxs(se,{className:"flex-1 py-8 flex-col gap-2",variant:"secondary",onClick:()=>n("/harvesting"),children:[e.jsx(te,{name:"Scissors",className:"w-8 h-8"}),t("harvest")]})]})})]})]})},De=({label:t,id:n,containerClassName:s="",children:r,error:l,className:c="",...d})=>{const u=l?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:border-blue-500 focus:ring-blue-500";return e.jsxs("div",{className:`w-full ${s}`,children:[t&&e.jsx("label",{htmlFor:n,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{id:n,className:`
            w-full px-3 py-2 
            bg-white dark:bg-gray-700 
            text-gray-900 dark:text-white 
            border rounded-lg shadow-sm 
            focus:outline-none focus:ring-2 focus:ring-offset-0
            transition-all duration-200
            disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-60
            appearance-none pr-8
            ${u}
            ${c}
          `,...d,children:r}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-gray-500"})})]}),l&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:l})]})},jt=N.forwardRef(({className:t="",...n},s)=>e.jsx("input",{ref:s,type:"checkbox",className:`
        h-4 w-4 rounded 
        border-gray-300 dark:border-gray-600 
        text-blue-600 focus:ring-blue-500 
        bg-white dark:bg-gray-700 
        cursor-pointer 
        transition-all duration-200 
        focus:ring-offset-2 dark:focus:ring-offset-gray-900
        ${t}
      `,...n}));jt.displayName="Checkbox";const Ut=({isOpen:t,onClose:n,onConfirm:s,title:r,message:l,confirmText:c,cancelText:d,confirmDisabled:u=!1})=>{const{t:h}=je(),m=e.jsx(e.Fragment,{children:u?e.jsx(se,{variant:"secondary",onClick:n,children:h("close")}):e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:d||h("cancel")}),e.jsx(se,{variant:"danger",onClick:s,children:c||h("delete")})]})});return e.jsx(at,{isOpen:t,onClose:n,title:r,widthClass:"max-w-md",footer:m,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center justify-center h-10 w-10 rounded-full bg-red-100 dark:bg-red-900/50 mr-4",children:e.jsx(te,{name:"AlertTriangle",className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:l})})]})})},r0=(t,n)=>n===""?t:t.replace(/\B(?=(\d{3})+(?!\d))/g,n),Ae=(t,n)=>{const{currencySymbol:s,thousandsSeparator:r,decimalSeparator:l,monetaryDecimals:c}=n;(isNaN(t)||t===null)&&(t=0);const d=t.toFixed(c),[u,h]=d.split("."),m=r0(u,r),f=h!==void 0?`${m}${l}${h}`:m;return`${s} ${f}`},Fe=(t,n)=>{const{thousandsSeparator:s,decimalSeparator:r,nonMonetaryDecimals:l}=n;(isNaN(t)||t===null)&&(t=0);const c=t.toFixed(l),[d,u]=c.split("."),h=r0(d,s);return u!==void 0?`${h}${r}${u}`:h},Ku=(t,n)=>{const{decimalSeparator:s,thousandsSeparator:r}=n,d=t.replace(new RegExp(`\\${r}`,"g"),"").replace(new RegExp(`\\${s}`,"g"),".").replace(/[^0-9.-]/g,""),u=parseFloat(d);return isNaN(u)?0:u},Rj=()=>{const{settings:t,updateSettings:n}=$e(),{t:s}=je(),{clearAllData:r}=qe(),[l,c]=N.useState(t),[d,u]=N.useState({}),h=N.useRef(null),[m,f]=N.useState(!1),v=N.useCallback(I=>{const O={},{company:A,localization:U}=I;return A.name.trim()||(O.companyName=s("validationRequired")),A.phone.trim()||(O.companyPhone=s("validationRequired")),A.nif.trim()||(O.companyNif=s("validationRequired")),A.rc.trim()||(O.companyRc=s("validationRequired")),A.stat.trim()||(O.companyStat=s("validationRequired")),A.email.trim()?/\S+@\S+\.\S+/.test(A.email)||(O.companyEmail=s("validationEmail")):O.companyEmail=s("validationRequired"),(isNaN(A.capital)||A.capital<=0)&&(O.companyCapital=s("validationPositiveNumber")),(isNaN(U.monetaryDecimals)||U.monetaryDecimals<0)&&(O.monetaryDecimals=s("validationNonNegative")),(isNaN(U.nonMonetaryDecimals)||U.nonMonetaryDecimals<0)&&(O.nonMonetaryDecimals=s("validationNonNegative")),O},[s]);N.useEffect(()=>{const I=v(l);u(I)},[l,v]);const x=(I,O,A)=>{c(U=>{const P={...U,[I]:{...U[I],[O]:A}};return(I==="localization"&&(O==="thousandsSeparator"||O==="decimalSeparator"||O==="monetaryDecimals"||O==="nonMonetaryDecimals"||O==="coordinateFormat")||I==="company"&&O==="capital")&&n(P),P})},S=I=>{const O=Vt.find(A=>A.code===I);O&&c(A=>{const U={...A,localization:{...A.localization,country:O.code,currency:O.currency,currencySymbol:O.symbol,thousandsSeparator:O.thousandsSeparator,decimalSeparator:O.decimalSeparator,denominations:O.denominations.map(P=>({id:`d-${P.value}-${P.type}`,...P}))}};return n(U),U})},w=()=>{Object.keys(d).length===0&&(n(l),alert(s("configurationSaved")))};N.useEffect(()=>{c(t)},[t]);const C=N.useMemo(()=>{const I=Vt.find(O=>O.code===l.localization.country);return(I==null?void 0:I.denominations)||[]},[l.localization.country]),T=(I,O,A)=>{let U=[...l.localization.denominations];A?U.some(P=>P.value===I&&P.type===O)||U.push({id:`d-${I}-${O}`,value:I,type:O}):U=U.filter(P=>!(P.value===I&&P.type===O)),U.sort((P,F)=>P.value-F.value),x("localization","denominations",U)},E=()=>{var I;(I=h.current)==null||I.click()},R=I=>{var A;const O=(A=I.target.files)==null?void 0:A[0];if(O){const U=new FileReader;U.onloadend=()=>{x("company","logoUrl",U.result)},U.readAsDataURL(O)}},_=()=>{x("company","logoUrl","")},D=()=>{r(),alert(s("dataResetSuccess")),f(!1)},M=Object.keys(d).length>0;return e.jsxs("div",{className:"pb-12",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s("settingsTitle")}),e.jsx(se,{onClick:w,disabled:M,children:s("saveConfiguration")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ge,{title:s("companySection"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(de,{label:s("companyName"),value:l.company.name,onChange:I=>x("company","name",I.target.value),error:d.companyName}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{label:s("email"),type:"email",value:l.company.email,onChange:I=>x("company","email",I.target.value),error:d.companyEmail}),e.jsx(de,{label:s("phone"),value:l.company.phone,onChange:I=>x("company","phone",I.target.value),error:d.companyPhone})]}),e.jsx(de,{label:s("address"),value:l.company.address,onChange:I=>x("company","address",I.target.value)}),e.jsx(de,{label:s("capital"),type:"text",value:Ae(l.company.capital,l.localization),onChange:I=>x("company","capital",Ku(I.target.value,l.localization)),error:d.companyCapital})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"Legal Identifiers"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx(de,{label:s("nif"),value:l.company.nif,onChange:I=>x("company","nif",I.target.value),error:d.companyNif}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(de,{label:s("rc"),value:l.company.rc,onChange:I=>x("company","rc",I.target.value),error:d.companyRc}),e.jsx(de,{label:s("stat"),value:l.company.stat,onChange:I=>x("company","stat",I.target.value),error:d.companyStat})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:s("logo")}),e.jsxs("div",{className:"flex items-center gap-4 p-3 border border-dashed border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-800/30",children:[e.jsx("div",{className:"w-24 h-24 bg-white dark:bg-gray-700 rounded-md flex items-center justify-center border shadow-sm overflow-hidden",children:l.company.logoUrl?e.jsx("img",{src:l.company.logoUrl,alt:s("logoPreview"),className:"w-full h-full object-contain p-1"}):e.jsx(te,{name:"Image",className:"w-10 h-10 text-gray-300"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(se,{type:"button",variant:"secondary",onClick:E,className:"text-sm",children:[e.jsx(te,{name:"Image",className:"w-4 h-4 mr-2"}),s("changeLogo")]}),l.company.logoUrl&&e.jsxs(se,{type:"button",variant:"ghost",onClick:_,className:"text-sm text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(te,{name:"Trash2",className:"w-4 h-4 mr-2"}),s("removeLogo")]}),e.jsx("input",{type:"file",ref:h,onChange:R,className:"hidden",accept:"image/png, image/jpeg, image/svg+xml"})]})]})]})]})]})}),e.jsx(Ge,{title:s("localizationSection"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(De,{label:s("country"),value:l.localization.country,onChange:I=>S(I.target.value),children:Vt.map(I=>e.jsx("option",{value:I.code,children:I.name},I.code))}),e.jsx(de,{label:s("currencyFormat"),value:`${l.localization.currency} (${l.localization.currencySymbol})`,disabled:!0}),e.jsxs(De,{label:s("coordinateFormat"),value:l.localization.coordinateFormat,onChange:I=>x("localization","coordinateFormat",I.target.value),children:[e.jsx("option",{value:"DMS",children:s("coordinateFormat_DMS")}),e.jsx("option",{value:"DD",children:s("coordinateFormat_DD")})]}),e.jsxs(De,{label:s("thousandsSeparator"),value:l.localization.thousandsSeparator,onChange:I=>x("localization","thousandsSeparator",I.target.value),children:[e.jsx("option",{value:",",children:s("separator_comma")}),e.jsx("option",{value:".",children:s("separator_dot")}),e.jsx("option",{value:" ",children:s("separator_space")})]}),e.jsxs(De,{label:s("decimalSeparator"),value:l.localization.decimalSeparator,onChange:I=>x("localization","decimalSeparator",I.target.value),children:[e.jsx("option",{value:".",children:s("separator_dot")}),e.jsx("option",{value:",",children:s("separator_comma")})]}),e.jsx(de,{label:s("monetaryDecimals"),type:"number",value:l.localization.monetaryDecimals,onChange:I=>x("localization","monetaryDecimals",parseInt(I.target.value)),error:d.monetaryDecimals})]})}),e.jsxs(Ge,{title:s("denominationsSection"),children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:s("denominationsDescriptionNew")}),C.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-300 mb-2 text-sm uppercase tracking-wide",children:s("coins")}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:C.filter(I=>I.type==="coin").map(I=>e.jsxs("label",{className:"flex items-center p-2 rounded-lg bg-gray-100 dark:bg-gray-700/50 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(jt,{checked:l.localization.denominations.some(O=>O.value===I.value&&O.type===I.type),onChange:O=>T(I.value,I.type,O.target.checked)}),e.jsx("span",{className:"ml-2 font-medium text-sm",children:Ae(I.value,l.localization)})]},`${I.type}-${I.value}`))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-300 mb-2 text-sm uppercase tracking-wide",children:s("banknotes")}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:C.filter(I=>I.type==="banknote").map(I=>e.jsxs("label",{className:"flex items-center p-2 rounded-lg bg-gray-100 dark:bg-gray-700/50 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(jt,{checked:l.localization.denominations.some(O=>O.value===I.value&&O.type===I.type),onChange:O=>T(I.value,I.type,O.target.checked)}),e.jsx("span",{className:"ml-2 font-medium text-sm",children:Ae(I.value,l.localization)})]},`${I.type}-${I.value}`))})]})]}):e.jsx("p",{className:"text-gray-500 italic",children:s("noDenominationsForCountry")})]}),e.jsx(Ge,{title:s("interfaceSection"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(De,{label:s("language"),value:l.language,onChange:I=>{const O=I.target.value;n({...l,language:O})},children:[e.jsx("option",{value:Vo.EN,children:s("language_en")}),e.jsx("option",{value:Vo.FR,children:s("language_fr")})]}),e.jsx(De,{label:s("visualAppearance"),value:l.theme.id,onChange:I=>{const O=Ko.find(A=>A.id===I.target.value);O&&n({...l,theme:O})},children:Ko.map(I=>e.jsx("option",{value:I.id,children:I.name},I.id))})]})}),e.jsxs("div",{className:"mt-8 border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-800 dark:text-gray-100",children:s("dataManagementSection")}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-900/30 rounded-lg p-4 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-300 mb-1",children:s("resetData")}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:s("resetDataWarning")})]}),e.jsxs(se,{variant:"danger",onClick:()=>f(!0),className:"ml-4",children:[e.jsx(te,{name:"Trash2",className:"w-4 h-4 mr-2"}),s("resetData")]})]})]}),m&&e.jsx(Ut,{isOpen:m,onClose:()=>f(!1),onConfirm:D,title:s("confirmDeleteTitle"),message:s("confirmResetData"),confirmText:s("delete")})]})]})},Mj=t=>{if(!t||!t.trim())return{deg:"",min:"",sec:"",dir:""};const n=/(-?\d+(?:\.\d+)?)\s*(?:\s*(\d+(?:\.\d+)?)\s*')?(?:\s*(\d+(?:\.\d+)?)\s*")?\s*([NSEW])?/i,s=t.trim().match(n);if(!s){const r=t.trim().match(/(-?\d+(?:\.\d+)?)\s*([NSEW])?/i);return r?{deg:r[1]||"",min:"",sec:"",dir:(r[2]||"").toUpperCase()}:{deg:t,min:"",sec:"",dir:""}}return{deg:s[1]||"",min:s[2]||"",sec:s[3]||"",dir:(s[4]||"").toUpperCase()}},Pj=({label:t,value:n,onChange:s,directions:r,error:l})=>{const c=N.useMemo(()=>{const u=Mj(n),h=r.includes(u.dir)?u.dir:r[0];return{...u,dir:h}},[n,r]),d=N.useCallback((u,h)=>{const m={deg:c.deg,min:c.min,sec:c.sec,dir:c.dir,[u]:h},{deg:f,min:v,sec:x,dir:S}=m;if(!f.trim()&&!v.trim()&&!x.trim()){s("");return}const w=`${f} ${v}' ${x}" ${S}`;s(w)},[c,s]);return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(de,{type:"number",value:c.deg,onChange:u=>d("deg",u.target.value),placeholder:"","aria-label":`${t} degrees`,containerClassName:"min-w-0",min:"-180",max:"180"}),e.jsx(de,{type:"number",value:c.min,onChange:u=>d("min",u.target.value),placeholder:"'","aria-label":`${t} minutes`,containerClassName:"min-w-0",min:"0",max:"59"}),e.jsx(de,{type:"number",step:"any",value:c.sec,onChange:u=>d("sec",u.target.value),placeholder:'"',"aria-label":`${t} seconds`,containerClassName:"min-w-0",min:"0",max:"59.999"}),e.jsxs(De,{value:c.dir,onChange:u=>d("dir",u.target.value),"aria-label":`${t} direction`,containerClassName:"min-w-fit",children:[e.jsx("option",{value:r[0],children:r[0]}),e.jsx("option",{value:r[1],children:r[1]})]})]}),l&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:l})]})},Ur=({label:t,value:n,onChange:s,axis:r,error:l})=>{const{settings:c}=$e(),{t:d}=je(),u=c.localization.coordinateFormat,h=r==="lat",[m,f]=N.useState(n);N.useEffect(()=>{if(u==="DD")try{const x=on(n);f(String(x))}catch{f(n)}else try{/^-?\d+(\.\d+)?$/.test(n)?f(a0(parseFloat(n),h)):f(n)}catch{f(n)}},[n,u,h]);const v=x=>{const S=x.target.value;f(S),s(S)};if(u==="DMS"){const x=h?["N","S"]:["E","W"];return e.jsx(Pj,{label:t,value:m,onChange:s,directions:x,error:l})}return e.jsx(de,{label:`${t} (DD)`,type:"number",step:"any",value:m,onChange:v,error:l,placeholder:h?"-18.1234":"46.5678"})},ko=["#e11d48","#2563eb","#16a34a","#f97316","#9333ea","#ca8a04"],Lj=({site:t,modules:n})=>{const{t:s}=je(),{farmers:r}=qe(),l=N.useRef(null),c=N.useRef(null),d=N.useRef(null),u=N.useRef(null),h=N.useMemo(()=>new Map(r.map(m=>[m.id,`${m.firstName} ${m.lastName}`])),[r]);return N.useEffect(()=>(l.current&&!c.current&&(c.current=L.map(l.current).setView([-18.76,46.86],6),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(c.current),d.current=L.featureGroup().addTo(c.current),u.current=L.featureGroup().addTo(c.current)),()=>{c.current&&(c.current.remove(),c.current=null,d.current=null,u.current=null)}),[]),N.useEffect(()=>{const m=c.current;if(!m||!d.current||!u.current)return;const f=d.current,v=u.current;f.clearLayers(),v.clearLayers(),t.zones&&t.zones.length>0&&t.zones.forEach((w,C)=>{const T=Vu(w.geoPoints);if(T.length>=3){const E=T.reduce((M,I)=>({x:M.x+I.x,y:M.y+I.y}),{x:0,y:0});E.x/=T.length,E.y/=T.length,T.sort((M,I)=>{const O=Math.atan2(M.y-E.y,M.x-E.x),A=Math.atan2(I.y-E.y,I.x-E.x);return O-A});const R=T.map(M=>[M.y,M.x]),_=ko[C%ko.length],D=L.polygon(R,{color:_,weight:2,fillColor:_,fillOpacity:.1});D.bindPopup(`<b>${w.name}</b>`),f.addLayer(D)}}),n.forEach(w=>{if(w.siteId===t.id&&w.latitude&&w.longitude)try{const C=on(w.latitude),T=on(w.longitude),E=!!w.farmerId,R=E?"#22c55e":"#9ca3af",_=L.divIcon({className:"",html:`<div style="background-color: ${R}; width: 8px; height: 8px; border: 1px solid white; box-shadow: 0 0 2px rgba(0,0,0,0.3);"></div>`,iconSize:[8,8],iconAnchor:[4,4]}),D=L.marker([C,T],{icon:_});D.bindPopup(`<b>${w.code}</b><br>${s(E?"status_ASSIGNED":"status_FREE")}`),v.addLayer(D)}catch{}});const x=L.featureGroup([f,v]),S=x.getBounds();if(x.getLayers().length>0&&S.isValid())m.fitBounds(S.pad(.1));else try{if(t.location){const[w,C]=t.location.split(",");if(w&&C){const T=on(w.trim()),E=on(C.trim());!isNaN(T)&&!isNaN(E)&&m.setView([T,E],13)}}}catch{}},[t.zones,t.location,n,t.id,s]),e.jsxs(Ge,{className:"bg-white/30 dark:bg-gray-800/30",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200",children:[s("siteLayout"),": ",t.name]}),e.jsx("div",{ref:l,style:{height:"400px"},className:"rounded-lg mb-4 border border-gray-200 dark:border-gray-700 shadow-inner z-0"}),e.jsx("div",{className:"flex flex-wrap gap-4 p-4 rounded-lg bg-gray-100 dark:bg-gray-900/50",children:t.zones.length>0?t.zones.map((m,f)=>{const v=n.filter(S=>S.zoneId===m.id),x=ko[f%ko.length];return e.jsxs("div",{className:"flex-1 min-w-[250px] p-3 border-l-4 rounded-lg",style:{borderColor:x},children:[e.jsxs("h4",{className:"font-bold mb-3 text-gray-700 dark:text-gray-300",children:[m.name," (",v.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(S=>{const w=!!S.farmerId,C=w?h.get(S.farmerId):null,T=[`${s("code")}: ${S.code}`,`${s("status")}: ${s(w?"status_ASSIGNED":"status_FREE")}`,w&&C?`${s("farmer")}: ${C}`:null].filter(Boolean).join(`
`);return e.jsx("div",{title:T,className:`h-8 w-8 flex items-center justify-center text-[10px] font-mono border border-white/20 shadow-sm
                        ${w?"bg-green-500 text-white":"bg-gray-400 text-white"}
                        transition-transform hover:scale-110 cursor-help`,children:S.code.split("-").pop()},S.id)})})]},m.id)}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 w-full text-center py-4",children:s("noZonesDefined")})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:s("legend")}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 border border-white shadow-sm"}),e.jsx("span",{children:s("assignedModule")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-400 border border-white shadow-sm"}),e.jsx("span",{children:s("freeModule")})]})]})]})]})},Oj=()=>{const{t}=je(),{sites:n,deleteSite:s,addSite:r,updateSite:l,employees:c,modules:d}=qe(),[u,h]=N.useState(!1),[m,f]=N.useState(null),[v,x]=N.useState(!1),[S,w]=N.useState(null),C=(_=null)=>{f(_),h(!0)},T=_=>{w(_),x(!0)},E=()=>{S&&s(S),x(!1),w(null)},R=_=>{"id"in _?l(_):r(_),h(!1)};return e.jsxs("div",{className:"pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("siteManagementTitle")}),e.jsxs(se,{onClick:()=>C(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("addSite")]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:n.map(_=>{const D=c.find(M=>M.id===_.managerId);return e.jsxs(Ge,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[_.name,e.jsx("span",{className:"text-sm font-normal text-gray-500 bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded",children:_.code})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[t("manager"),": ",D?`${D.firstName} ${D.lastName}`:t("noManager")]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t("coordinates"),": ",_.location||"-"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{variant:"ghost",onClick:()=>C(_),children:e.jsx(te,{name:"Edit2",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",onClick:()=>T(_.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})]}),e.jsx(Lj,{site:_,modules:d}),e.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:t("zones")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.zones.length>0?_.zones.map(M=>e.jsx("span",{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 px-2 py-1 rounded text-sm border border-blue-200 dark:border-blue-800",children:M.name},M.id)):e.jsx("span",{className:"text-gray-500 text-sm italic",children:t("noZonesDefined")})})]})]},_.id)})}),u&&e.jsx(Uj,{isOpen:u,onClose:()=>h(!1),site:m,onSave:R}),v&&e.jsx(Ut,{isOpen:v,onClose:()=>x(!1),onConfirm:E,title:t("confirmDeleteTitle"),message:t("confirmDeleteSite")})]})},Uj=({isOpen:t,onClose:n,site:s,onSave:r})=>{const{t:l}=je(),{employees:c,sites:d}=qe(),{settings:u}=$e(),[h,m]=N.useState({name:"",code:"",location:"",managerId:"",zones:[]}),[f,v]=N.useState(""),[x,S]=N.useState(""),[w,C]=N.useState({}),[T,E]=N.useState([]),R=N.useCallback(()=>{const z={};h.name.trim()||(z.name=l("validationRequired")),h.code.trim()||(z.code=l("validationRequired"));const J=u.localization.coordinateFormat;if(f.trim())try{if(J==="DD"){const W=parseFloat(f);if(isNaN(W)||W<-90||W>90)throw new Error(l("validationDDLatitudeRange"))}else on(f)}catch(W){z.latitude=W.message}if(x.trim())try{if(J==="DD"){const W=parseFloat(x);if(isNaN(W)||W<-180||W>180)throw new Error(l("validationDDLongitudeRange"))}else on(x)}catch(W){z.longitude=W.message}return z},[h.name,h.code,f,x,l,u.localization.coordinateFormat]);N.useEffect(()=>{C(R())},[R]),N.useEffect(()=>{if(s){if(m({name:s.name,code:s.code,location:s.location,managerId:s.managerId||"",zones:s.zones}),E(s.zones),s.location){const z=s.location.split(",");z.length===2&&(v(z[0].trim()),S(z[1].trim()))}}else m({name:"",code:"",location:"",managerId:"",zones:[]}),E([]),v(""),S("")},[s,t]);const _=z=>{const J=z.replace(/[^a-zA-Z]/g,"").toUpperCase();if(J.length<3){const G=J.padEnd(3,"X");return d.some(B=>B.code===G)?"":G}const W=new Set(d.map(G=>G.code));for(let G=0;G<J.length-2;G++)for(let B=G+1;B<J.length-1;B++)for(let X=B+1;X<J.length;X++){const $=J[G]+J[B]+J[X];if(!W.has($))return $}return""},D=z=>{const J=z.target.value;let W=h.code;if(!s)if(J.trim().length>0){const G=_(J);G&&(W=G)}else W="";m(G=>({...G,name:J,code:W}))},M=()=>{const z={id:`zone-${Date.now()}`,name:`Zone ${T.length+1}`,geoPoints:[]};E([...T,z])},I=(z,J,W)=>{E(G=>{const B=[...G];return B[z]={...B[z],[J]:W},B})},O=z=>{E(T.filter((J,W)=>W!==z))},A=z=>{E(J=>{const W=[...J],G={...W[z]};return G.geoPoints=[...G.geoPoints,""],W[z]=G,W})},U=(z,J,W)=>{E(G=>{const B=[...G],X={...B[z]},$=[...X.geoPoints];return $[J]=W,X.geoPoints=$,B[z]=X,B})},P=(z,J)=>{E(W=>{const G=[...W],B={...G[z]};return B.geoPoints=B.geoPoints.filter((X,$)=>$!==J),G[z]=B,G})},F=()=>{const z=R();if(Object.keys(z).length>0){C(z);return}const J=f&&x?`${f}, ${x}`:"",W={...h,location:J,zones:T};r(s?{...s,...W}:W)},q=Object.keys(w).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l(s?"editSite":"addSite"),widthClass:"max-w-4xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:l("siteName"),value:h.name,onChange:D,required:!0,error:w.name}),e.jsx(de,{label:l("siteCode"),value:h.code,onChange:z=>m({...h,code:z.target.value.toUpperCase()}),required:!0,error:w.code}),e.jsxs(De,{label:l("manager"),value:h.managerId,onChange:z=>m({...h,managerId:z.target.value}),children:[e.jsx("option",{value:"",children:l("noManager")}),c.map(z=>e.jsxs("option",{value:z.id,children:[z.firstName," ",z.lastName]},z.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Ur,{label:l("latitude"),value:f,onChange:v,axis:"lat",error:w.latitude}),e.jsx(Ur,{label:l("longitude"),value:x,onChange:S,axis:"lon",error:w.longitude})]}),e.jsxs("div",{className:"border-t pt-4 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold",children:l("zones")}),e.jsxs(se,{variant:"secondary",onClick:M,className:"text-xs",children:[e.jsx(te,{name:"PlusCircle",className:"w-4 h-4 mr-1"}),l("addZone")]})]}),e.jsx("div",{className:"space-y-4 max-h-[40vh] overflow-y-auto pr-2",children:T.map((z,J)=>e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 dark:bg-gray-800/50 dark:border-gray-700 relative",children:[e.jsx(se,{variant:"danger",className:"absolute top-2 right-2 p-1",onClick:()=>O(J),children:e.jsx(te,{name:"X",className:"w-4 h-4"})}),e.jsx("div",{className:"mb-3 pr-8",children:e.jsx(de,{label:l("zoneName"),value:z.name,onChange:W=>I(J,"name",W.target.value)})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:l("geoPoints")}),e.jsxs(se,{variant:"ghost",className:"text-xs py-0 h-6",onClick:()=>A(J),children:[e.jsx(te,{name:"PlusCircle",className:"w-3 h-3 mr-1"}),l("addPoint")]})]}),e.jsxs("div",{className:"space-y-2 pl-2 border-l-2 border-gray-200 dark:border-gray-700",children:[z.geoPoints.length>0&&e.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr_40px] gap-2 text-xs text-gray-500 font-semibold mb-1",children:[e.jsx("div",{className:"flex items-center justify-center",children:"#"}),e.jsx("div",{children:l("latitude")}),e.jsx("div",{children:l("longitude")}),e.jsx("div",{})]}),z.geoPoints.map((W,G)=>{const B=W.split(",").map(ae=>ae.trim()),X=B[0]||"",$=B[1]||"";return e.jsxs("div",{className:"grid grid-cols-[30px_1fr_1fr_40px] gap-2 items-center",children:[e.jsx("span",{className:"text-xs text-gray-500 text-center",children:G+1}),e.jsx(Ur,{label:"",value:X,onChange:ae=>{U(J,G,`${ae}, ${$}`)},axis:"lat"}),e.jsx(Ur,{label:"",value:$,onChange:ae=>{U(J,G,`${X}, ${ae}`)},axis:"lon"}),e.jsx(se,{variant:"ghost",className:"p-1 text-red-500 hover:text-red-700",onClick:()=>P(J,G),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]},G)}),z.geoPoints.length===0&&e.jsx("p",{className:"text-xs text-gray-400 italic",children:l("noPoints")||"No points"})]})]})]},z.id))})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{onClick:F,disabled:q,children:l("save")})]})]})})},Fj=({isOpen:t,onClose:n,creditType:s,onSave:r})=>{const{t:l}=je(),[c,d]=N.useState(s),[u,h]=N.useState({}),m=N.useCallback(S=>{var C;const w={};return S.name.trim()||(w.name=l("validationRequired")),S.hasQuantity&&!((C=S.unit)!=null&&C.trim())&&(w.unit=l("validationRequired")),w},[l]);N.useEffect(()=>{d(s)},[s,t]),N.useEffect(()=>{h(m(c))},[c,m]);const f=(S,w)=>{d(S==="hasQuantity"&&w===!1?C=>({...C,hasQuantity:!1,unit:""}):C=>({...C,[S]:w}))},v=S=>{S.preventDefault(),Object.keys(u).length===0&&r(c)},x=Object.keys(u).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l("editCreditType"),children:e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx(de,{label:l("creditType"),value:c.name,onChange:S=>f("name",S.target.value),error:u.name}),c.hasQuantity&&e.jsx(de,{label:l("unit"),value:c.unit||"",onChange:S=>f("unit",S.target.value),error:u.unit}),e.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"mr-2 h-4 w-4 rounded text-blue-600 focus:ring-blue-500 border-gray-300",checked:c.hasQuantity,onChange:S=>f("hasQuantity",S.target.checked)}),l("withQuantity")]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"mr-2 h-4 w-4 rounded text-blue-600 focus:ring-blue-500 border-gray-300",checked:c.hasUnitPrice,onChange:S=>f("hasUnitPrice",S.target.checked)}),l("withUnitPrice")]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"mr-2 h-4 w-4 rounded text-blue-600 focus:ring-blue-500 border-gray-300",checked:c.isDirectAmount,onChange:S=>f("isDirectAmount",S.target.checked)}),l("directAmount")]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{type:"submit",disabled:x,children:l("save")})]})]})})},Bj=()=>{const{t}=je(),[n,s]=N.useState("status"),r=[{id:"status",label:t("creditStatus")},{id:"record",label:t("recordCredit")},{id:"repayment",label:t("recordRepayment")},{id:"settings",label:t("creditTypeSettings")}];return e.jsxs("div",{className:"pb-20",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6",children:t("farmerCreditsTitle")}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8 overflow-x-auto","aria-label":"Tabs",children:r.map(l=>e.jsx("button",{onClick:()=>s(l.id),className:`${n===l.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-500"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:l.label},l.id))})}),e.jsxs("div",{children:[n==="status"&&e.jsx(Gj,{}),n==="record"&&e.jsx(zj,{}),n==="repayment"&&e.jsx(Hj,{}),n==="settings"&&e.jsx(qj,{})]})]})},Gj=()=>{const{t,language:n}=je(),{farmers:s,farmerCredits:r,deleteFarmer:l,repayments:c,addMultipleFarmerCredits:d,addMultipleRepayments:u,creditTypes:h}=qe(),{settings:m}=$e(),[f,v]=N.useState(null),[x,S]=N.useState({key:"farmerName",direction:"ascending"}),[w,C]=N.useState(null),[T,E]=N.useState([]),R=N.useRef(null),_=N.useMemo(()=>new Map(h.map(F=>[F.id,F.name])),[h]),D=N.useMemo(()=>{let F=s.map(q=>{const z=r.filter($=>$.farmerId===q.id),J=c.filter($=>$.farmerId===q.id),W=z.reduce(($,ae)=>$+ae.totalAmount,0),G=J.reduce(($,ae)=>$+ae.amount,0),B=W-G;let X=null;return J.length>0&&(X=[...J].sort(($,ae)=>new Date(ae.date).getTime()-new Date($.date).getTime())[0].date),{farmer:q,farmerName:`${q.firstName} ${q.lastName}`,totalContracted:W,totalRepayments:G,balance:B,lastRepaymentDate:X}});return x.key&&F.sort((q,z)=>{const J=q[x.key],W=z[x.key];return J===null?1:W===null?-1:J<W?x.direction==="ascending"?-1:1:J>W?x.direction==="ascending"?1:-1:0}),F},[s,r,c,x]);N.useEffect(()=>{if(R.current){const F=T.length,q=D.length;R.current.checked=F===q&&q>0,R.current.indeterminate=F>0&&F<q}},[T,D]);const M=F=>{let q="ascending";x.key===F&&x.direction==="ascending"&&(q="descending"),S({key:F,direction:q})},I=F=>x.key!==F?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):x.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),O=({sortKey:F,label:q,className:z})=>e.jsx("th",{className:`p-3 ${z}`,children:e.jsxs("button",{onClick:()=>M(F),className:`group flex items-center gap-2 w-full ${z!=null&&z.includes("text-right")?"justify-end":""}`,children:[q,I(F)]})}),A=F=>{F.target.checked?E(D.map(q=>q.farmer.id)):E([])},U=(F,q)=>{F.target.checked?E(z=>[...z,q]):E(z=>z.filter(J=>J!==q))},P=F=>{C(w===F?null:F)};return e.jsxs(Ge,{children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:t("creditStatus")})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-4",children:e.jsx(jt,{ref:R,onChange:A,"aria-label":t("selectAllFarmers")})}),e.jsx("th",{className:"p-3 w-8"}),e.jsx(O,{sortKey:"farmerName",label:t("farmer")}),e.jsx(O,{sortKey:"totalContracted",label:t("contractedCredits"),className:"text-right"}),e.jsx(O,{sortKey:"totalRepayments",label:t("repayments"),className:"text-right"}),e.jsx(O,{sortKey:"balance",label:t("remainingBalance"),className:"text-right"}),e.jsx(O,{sortKey:"lastRepaymentDate",label:t("lastRepaymentDate")})]})}),e.jsx("tbody",{children:D.map(F=>e.jsxs(ft.Fragment,{children:[e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:T.includes(F.farmer.id),onChange:q=>U(q,F.farmer.id),"aria-label":t("selectFarmerNamed").replace("{name}",F.farmerName)})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>P(F.farmer.id),className:"text-gray-500 hover:text-gray-700",children:e.jsx(te,{name:w===F.farmer.id?"ChevronDown":"ChevronRight",className:"w-4 h-4"})})}),e.jsx("td",{className:"p-3 font-medium",children:F.farmerName}),e.jsx("td",{className:"p-3 text-right",children:Ae(F.totalContracted,m.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(F.totalRepayments,m.localization)}),e.jsx("td",{className:`p-3 text-right font-bold ${F.balance>0?"text-red-600":"text-green-600"}`,children:Ae(F.balance,m.localization)}),e.jsx("td",{className:"p-3",children:F.lastRepaymentDate||"-"})]}),w===F.farmer.id&&e.jsx("tr",{className:"bg-gray-50 dark:bg-gray-900/30",children:e.jsx("td",{colSpan:7,className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:t("creditsTaken")}),e.jsx("ul",{className:"space-y-2 text-sm",children:r.filter(q=>q.farmerId===F.farmer.id).length>0?r.filter(q=>q.farmerId===F.farmer.id).map(q=>e.jsxs("li",{className:"flex justify-between border-b border-gray-200 dark:border-gray-700 pb-1",children:[e.jsxs("span",{children:[q.date," - ",_.get(q.creditTypeId)||q.creditTypeId]}),e.jsx("span",{children:Ae(q.totalAmount,m.localization)})]},q.id)):e.jsx("p",{className:"text-gray-500 italic",children:t("noCredits")})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:t("repaymentsMade")}),e.jsx("ul",{className:"space-y-2 text-sm",children:c.filter(q=>q.farmerId===F.farmer.id).length>0?c.filter(q=>q.farmerId===F.farmer.id).map(q=>e.jsxs("li",{className:"flex justify-between border-b border-gray-200 dark:border-gray-700 pb-1",children:[e.jsxs("span",{children:[q.date," - ",t(`repaymentMethod_${q.method}`)]}),e.jsx("span",{children:Ae(q.amount,m.localization)})]},q.id)):e.jsx("p",{className:"text-gray-500 italic",children:t("noRepayments")})})]})]})})})]},F.farmer.id))})]})})]})},zj=()=>{const{t}=je(),{sites:n,farmers:s,creditTypes:r,addFarmerCredit:l,getFarmersBySite:c}=qe(),{settings:d}=$e(),[u,h]=N.useState({date:new Date().toISOString().split("T")[0],siteId:"",farmerId:"",creditTypeId:"",quantity:"",unitPrice:"",totalAmount:"",notes:""}),[m,f]=N.useState({}),v=N.useMemo(()=>u.siteId?c(u.siteId):[],[u.siteId,c]),x=N.useMemo(()=>r.find(w=>w.id===u.creditTypeId),[r,u.creditTypeId]);N.useEffect(()=>{if(x&&!(!x.hasQuantity&&!x.hasUnitPrice)){const w=parseFloat(u.quantity),C=parseFloat(u.unitPrice);!isNaN(w)&&!isNaN(C)&&h(T=>({...T,totalAmount:(w*C).toFixed(2)}))}},[u.quantity,u.unitPrice,x]);const S=w=>{w.preventDefault();const C={};if(u.date||(C.date=t("validationRequired")),u.siteId||(C.siteId=t("validationRequired")),u.farmerId||(C.farmerId=t("validationRequired")),u.creditTypeId||(C.creditTypeId=t("validationRequired")),x!=null&&x.hasQuantity&&(!u.quantity||parseFloat(u.quantity)<=0)&&(C.quantity=t("validationPositiveNumber")),x!=null&&x.hasUnitPrice&&(!u.unitPrice||parseFloat(u.unitPrice)<=0)&&(C.unitPrice=t("validationPositiveNumber")),(!u.totalAmount||parseFloat(u.totalAmount)<=0)&&(C.totalAmount=t("validationPositiveNumber")),Object.keys(C).length>0){f(C);return}l({date:u.date,siteId:u.siteId,farmerId:u.farmerId,creditTypeId:u.creditTypeId,quantity:x!=null&&x.hasQuantity?parseFloat(u.quantity):void 0,unitPrice:x!=null&&x.hasUnitPrice?parseFloat(u.unitPrice):void 0,totalAmount:parseFloat(u.totalAmount),notes:u.notes}),alert("Credit recorded successfully"),h(T=>({...T,quantity:"",unitPrice:"",totalAmount:"",notes:""}))};return e.jsx(Ge,{title:t("recordCredit"),children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(de,{label:t("date"),type:"date",value:u.date,onChange:w=>h({...u,date:w.target.value}),error:m.date,required:!0}),e.jsxs(De,{label:t("site"),value:u.siteId,onChange:w=>h({...u,siteId:w.target.value,farmerId:""}),error:m.siteId,required:!0,children:[e.jsx("option",{value:"",children:t("selectSite")}),n.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]}),e.jsxs(De,{label:t("farmer"),value:u.farmerId,onChange:w=>h({...u,farmerId:w.target.value}),disabled:!u.siteId,error:m.farmerId,required:!0,children:[e.jsx("option",{value:"",children:t("selectFarmer")}),v.map(w=>e.jsxs("option",{value:w.id,children:[w.firstName," ",w.lastName]},w.id))]}),e.jsxs(De,{label:t("creditType"),value:u.creditTypeId,onChange:w=>h({...u,creditTypeId:w.target.value}),error:m.creditTypeId,required:!0,children:[e.jsx("option",{value:"",children:t("selectType")}),r.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]}),(x==null?void 0:x.hasQuantity)&&e.jsx(de,{label:`${t("quantity")} (${x.unit})`,type:"number",step:"any",value:u.quantity,onChange:w=>h({...u,quantity:w.target.value}),error:m.quantity,required:!0}),(x==null?void 0:x.hasUnitPrice)&&e.jsx(de,{label:t("unitPrice"),type:"number",step:"any",value:u.unitPrice,onChange:w=>h({...u,unitPrice:w.target.value}),error:m.unitPrice,required:!0}),e.jsx(de,{label:t("totalAmount"),type:"number",step:"any",value:u.totalAmount,onChange:w=>h({...u,totalAmount:w.target.value}),error:m.totalAmount,required:!0,disabled:!!(x!=null&&x.hasQuantity&&(x!=null&&x.hasUnitPrice))}),e.jsx(de,{label:t("notes"),value:u.notes,onChange:w=>h({...u,notes:w.target.value}),containerClassName:"md:col-span-2 lg:col-span-3"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(se,{type:"submit",children:t("save")})})]})})},Hj=()=>{const{t}=je(),{sites:n,farmers:s,addRepayment:r,getFarmersBySite:l}=qe(),{settings:c}=$e(),[d,u]=N.useState({date:new Date().toISOString().split("T")[0],siteId:"",farmerId:"",amount:"",method:"cash",notes:""}),[h,m]=N.useState({}),f=N.useMemo(()=>d.siteId?l(d.siteId):[],[d.siteId,l]),v=x=>{x.preventDefault();const S={};if(d.date||(S.date=t("validationRequired")),d.siteId||(S.siteId=t("validationRequired")),d.farmerId||(S.farmerId=t("validationRequired")),(!d.amount||parseFloat(d.amount)<=0)&&(S.amount=t("validationPositiveNumber")),Object.keys(S).length>0){m(S);return}r({date:d.date,farmerId:d.farmerId,amount:parseFloat(d.amount),method:d.method,notes:d.notes}),alert(t("repaymentRecorded")),u(w=>({...w,amount:"",notes:""}))};return e.jsx(Ge,{title:t("recordRepayment"),children:e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(de,{label:t("date"),type:"date",value:d.date,onChange:x=>u({...d,date:x.target.value}),error:h.date,required:!0}),e.jsxs(De,{label:t("site"),value:d.siteId,onChange:x=>u({...d,siteId:x.target.value,farmerId:""}),error:h.siteId,required:!0,children:[e.jsx("option",{value:"",children:t("selectSite")}),n.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]}),e.jsxs(De,{label:t("farmer"),value:d.farmerId,onChange:x=>u({...d,farmerId:x.target.value}),disabled:!d.siteId,error:h.farmerId,required:!0,children:[e.jsx("option",{value:"",children:t("selectFarmer")}),f.map(x=>e.jsxs("option",{value:x.id,children:[x.firstName," ",x.lastName]},x.id))]}),e.jsx(de,{label:t("repaymentAmount"),type:"number",step:"any",value:d.amount,onChange:x=>u({...d,amount:x.target.value}),error:h.amount,required:!0}),e.jsxs(De,{label:t("repaymentMethod"),value:d.method,onChange:x=>u({...d,method:x.target.value}),children:[e.jsx("option",{value:"cash",children:t("repaymentMethod_cash")}),e.jsx("option",{value:"harvest_deduction",children:t("repaymentMethod_harvest_deduction")})]}),e.jsx(de,{label:t("notes"),value:d.notes,onChange:x=>u({...d,notes:x.target.value})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(se,{type:"submit",children:t("save")})})]})})},qj=()=>{const{t}=je(),{creditTypes:n,addCreditType:s,updateCreditType:r,deleteCreditType:l}=qe(),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,f]=N.useState(""),[v,x]=N.useState(!1),[S,w]=N.useState(null),C=()=>{m.trim()&&(s({name:m.trim(),hasQuantity:!1,hasUnitPrice:!1,isDirectAmount:!0}),f(""))},T=_=>{w(_),x(!0)},E=()=>{S&&l(S),x(!1),w(null)},R=_=>{h(_),d(!0)};return e.jsxs(Ge,{title:t("creditTypes"),children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsx(de,{placeholder:t("addNewCreditType"),value:m,onChange:_=>f(_.target.value),containerClassName:"flex-grow"}),e.jsxs(se,{onClick:C,disabled:!m.trim(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("add")]})]}),e.jsx("div",{className:"space-y-2",children:n.map(_=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-800 rounded border dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:_.name}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:_.isDirectAmount?t("directAmount"):`${t("withQuantity")} (${_.unit})`})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{variant:"ghost",onClick:()=>R(_),children:e.jsx(te,{name:"Edit2",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",onClick:()=>T(_.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})]},_.id))}),c&&u&&e.jsx(Fj,{isOpen:c,onClose:()=>d(!1),creditType:u,onSave:_=>{r(_),d(!1)}}),v&&e.jsx(Ut,{isOpen:v,onClose:()=>x(!1),onConfirm:E,title:t("confirmDeleteTitle"),message:t("confirmDeleteCreditType")})]})},Vj=({isOpen:t,onClose:n,seaweedType:s})=>{const{t:r,language:l}=je(),{settings:c}=$e(),{updateSeaweedPrices:d}=qe(),[u,h]=N.useState({wetPrice:"",dryPrice:"",date:new Date().toISOString().split("T")[0]}),[m,f]=N.useState({}),v=N.useMemo(()=>[...s.priceHistory].sort((T,E)=>new Date(E.date).getTime()-new Date(T.date).getTime()),[s.priceHistory]),x=N.useCallback(()=>{const T={};return(isNaN(parseFloat(u.wetPrice))||parseFloat(u.wetPrice)<=0)&&(T.wetPrice=r("validationPositiveNumber")),(isNaN(parseFloat(u.dryPrice))||parseFloat(u.dryPrice)<=0)&&(T.dryPrice=r("validationPositiveNumber")),u.date?new Date(u.date)>new Date&&(T.date=r("validationFutureDate")):T.date=r("validationRequired"),T},[u,r]);N.useEffect(()=>{t&&(h({wetPrice:String(s.wetPrice),dryPrice:String(s.dryPrice),date:new Date().toISOString().split("T")[0]}),f({}))},[t,s]),N.useEffect(()=>{f(x())},[u,x]);const S=(T,E)=>{h(R=>({...R,[T]:E}))},w=()=>{const T=x();if(Object.keys(T).length>0){f(T);return}const E={date:u.date,wetPrice:parseFloat(u.wetPrice),dryPrice:parseFloat(u.dryPrice)};d(s.id,E),h({wetPrice:String(E.wetPrice),dryPrice:String(E.dryPrice),date:new Date().toISOString().split("T")[0]})},C=Object.keys(m).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:`${r("priceHistory")}: ${s.name}`,widthClass:"max-w-3xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:r("addNewPrice")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end p-4 bg-gray-100 dark:bg-gray-900/50 rounded-lg",children:[e.jsx(de,{label:r("wetPrice"),type:"number",step:"any",value:u.wetPrice,onChange:T=>S("wetPrice",T.target.value),error:m.wetPrice}),e.jsx(de,{label:r("dryPrice"),type:"number",step:"any",value:u.dryPrice,onChange:T=>S("dryPrice",T.target.value),error:m.dryPrice}),e.jsx(de,{label:r("effectiveDate"),type:"date",value:u.date,onChange:T=>S("date",T.target.value),error:m.date}),e.jsxs(se,{onClick:w,disabled:C,className:"h-10",children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),r("add")]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:r("history")}),e.jsx("div",{className:"max-h-60 overflow-y-auto border dark:border-gray-700 rounded-lg",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 sticky top-0",children:[e.jsx("th",{className:"p-2",children:r("effectiveDate")}),e.jsx("th",{className:"p-2 text-right",children:r("wetPrice")}),e.jsx("th",{className:"p-2 text-right",children:r("dryPrice")})]})}),e.jsxs("tbody",{children:[v.map((T,E)=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-2",children:new Date(T.date).toLocaleDateString(l)}),e.jsx("td",{className:"p-2 text-right",children:Ae(T.wetPrice,c.localization)}),e.jsx("td",{className:"p-2 text-right",children:Ae(T.dryPrice,c.localization)})]},E)),v.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"p-4 text-center text-gray-500",children:r("noPriceHistory")})})]})]})})]})]})})},Kj=()=>{const{t}=je(),{seaweedTypes:n,addSeaweedType:s,updateSeaweedType:r,deleteSeaweedType:l}=qe(),{settings:c}=$e(),d=xs(),[u,h]=N.useState(!1),[m,f]=N.useState(null),[v,x]=N.useState(!1),[S,w]=N.useState(null),[C,T]=N.useState(!1),[E,R]=N.useState(null),_=(U=null)=>{f(U),h(!0)},D=()=>{f(null),h(!1)},M=U=>{w(U),x(!0)},I=()=>{S&&l(S),x(!1),w(null)},O=U=>{m?r({...m,...U}):s(U),D()},A=U=>{R(U),T(!0)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("seaweedTypeManagementTitle")}),e.jsxs(se,{onClick:()=>_(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("addSeaweedType")]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(U=>e.jsxs(Ge,{children:[e.jsx("h2",{className:"text-xl font-bold",children:U.name}),e.jsx("p",{className:"italic text-gray-500 dark:text-gray-400",children:U.scientificName}),e.jsx("p",{className:"mt-2 text-sm",children:U.description}),e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-gray-700 space-y-2",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("wetPrice"),":"]})," ",Ae(U.wetPrice,c.localization)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("dryPrice"),":"]})," ",Ae(U.dryPrice,c.localization)]})]}),e.jsxs("div",{className:"mt-4 flex gap-2 flex-wrap",children:[e.jsxs(se,{variant:"secondary",onClick:()=>d(`/seaweed-types/${U.id}/cultivation`),children:[e.jsx(te,{name:"GitBranch",className:"w-4 h-4"}),t("cycles")]}),e.jsxs(se,{variant:"ghost",onClick:()=>A(U),children:[e.jsx(te,{name:"FileText",className:"w-4 h-4"}),t("priceHistory")]}),e.jsx(se,{variant:"secondary",onClick:()=>_(U),children:t("edit")}),e.jsx(se,{variant:"danger",onClick:()=>M(U.id),children:t("delete")})]})]},U.id))}),u&&e.jsx($j,{isOpen:u,onClose:D,seaweedType:m,onSave:O}),v&&e.jsx(Ut,{isOpen:v,onClose:()=>x(!1),onConfirm:I,title:t("confirmDeleteTitle"),message:t("confirmDeleteSeaweedType")}),C&&E&&e.jsx(Vj,{isOpen:C,onClose:()=>T(!1),seaweedType:E})]})},$j=({isOpen:t,onClose:n,seaweedType:s,onSave:r})=>{const{t:l}=je(),[c,d]=N.useState({name:"",scientificName:"",description:"",wetPrice:0,dryPrice:0}),[u,h]=N.useState({});N.useEffect(()=>{d(s||{name:"",scientificName:"",description:"",wetPrice:0,dryPrice:0})},[s,t]);const m=N.useCallback(()=>{const S={};return c.name.trim()||(S.name=l("validationRequired")),(isNaN(c.wetPrice)||c.wetPrice<=0)&&(S.wetPrice=l("validationPositiveNumber")),(isNaN(c.dryPrice)||c.dryPrice<=0)&&(S.dryPrice=l("validationPositiveNumber")),S},[c,l]);N.useEffect(()=>{h(m())},[c,m]);const f=(S,w)=>{d(C=>({...C,[S]:w}))},v=S=>{S.preventDefault(),!(Object.keys(u).length>0)&&r({...c,wetPrice:Number(c.wetPrice),dryPrice:Number(c.dryPrice)})},x=Object.keys(u).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l(s?"editSeaweedType":"addSeaweedType"),children:e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx(de,{label:l("name"),value:c.name,onChange:S=>f("name",S.target.value),error:u.name,required:!0}),e.jsx(de,{label:l("scientificName"),value:c.scientificName,onChange:S=>f("scientificName",S.target.value)}),e.jsx(de,{label:l("description"),value:c.description,onChange:S=>f("description",S.target.value)}),e.jsx(de,{label:l("wetPrice"),type:"number",value:c.wetPrice,onChange:S=>f("wetPrice",parseFloat(S.target.value)),error:u.wetPrice,required:!0}),e.jsx(de,{label:l("dryPrice"),type:"number",value:c.dryPrice,onChange:S=>f("dryPrice",parseFloat(S.target.value)),error:u.dryPrice,required:!0}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{type:"submit",disabled:x,children:l("save")})]})]})})},Wj=({isOpen:t,onClose:n,data:s,onSave:r})=>{var A,U,P;const{t:l}=je(),{sites:c,modules:d,cultivationCycles:u}=qe(),[h,m]=N.useState(""),[f,v]=N.useState({siteId:"",zoneId:"",lines:100,poles:{galvanized:4,wood:21,plastic:0},latitude:"",longitude:""}),[x,S]=N.useState([]),[w,C]=N.useState({}),[T,E]=N.useState(null);N.useEffect(()=>{var F;s?(v({siteId:s.module.siteId,zoneId:s.module.zoneId,lines:s.module.lines,poles:s.module.poles,latitude:s.module.latitude||"",longitude:s.module.longitude||""}),m(s.module.code)):(v({siteId:((F=c[0])==null?void 0:F.id)||"",zoneId:"",lines:100,poles:{galvanized:4,wood:21,plastic:0},latitude:"",longitude:""}),m("")),E(null)},[s,t,c]),N.useEffect(()=>{if(s&&(s.module.siteId!==f.siteId||s.module.zoneId!==f.zoneId)){const F=u.find(q=>q.moduleId===s.module.id&&(q.status===Je.PLANTED||q.status===Je.GROWING));E(F?l("moduleMoveActiveCycleWarning"):null)}else E(null)},[s,f.siteId,f.zoneId,u,l]);const R=N.useCallback(()=>{const F={poles:{}};if(f.siteId||(F.siteId=l("validationRequired")),f.zoneId||(F.zoneId=l("validationRequired")),(isNaN(f.lines)||f.lines<=0)&&(F.lines=l("validationPositiveNumber")),f.latitude.trim())try{on(f.latitude)}catch{F.latitude=l("invalidDMSFormat")}if(f.longitude.trim())try{on(f.longitude)}catch{F.longitude=l("invalidDMSFormat")}let q=!1;for(const z of["galvanized","wood","plastic"])(isNaN(f.poles[z])||f.poles[z]<0)&&(F.poles[z]=l("validationNonNegative"),q=!0);return q||delete F.poles,F},[f,l]);N.useEffect(()=>{const F=c.find(q=>q.id===f.siteId);S((F==null?void 0:F.zones)||[])},[f.siteId,c]),N.useEffect(()=>{if(f.siteId&&f.zoneId){const F=c.find(z=>z.id===f.siteId),q=F==null?void 0:F.zones.find(z=>z.id===f.zoneId);if(F&&q){const z=F.code||"SITE",J=q.name.replace(/zone/i,"").trim().replace(/[^A-Z0-9]/ig,"").toUpperCase()||"Z";let W;const G=!!s,B=G&&(s.module.siteId!==f.siteId||s.module.zoneId!==f.zoneId);if(!G||B){const ae=d.filter(ue=>ue.zoneId===f.zoneId).map(ue=>{const Ne=ue.code.split("-"),oe=Ne[Ne.length-1];return oe&&/^\d+$/.test(oe)?parseInt(oe,10):NaN}).filter(ue=>!isNaN(ue)),ie=(ae.length>0?Math.max(...ae):0)+1;W=String(ie).padStart(2,"0")}else{const $=s.module.code.split("-");W=$[$.length-1]||"01"}const X=`${z}-${J}-${W}`;m(X)}}else s||m("")},[s,f.siteId,f.zoneId,c,d]),N.useEffect(()=>{C(R())},[f,R]);const _=(F,q)=>{v(z=>({...z,[F]:q}))},D=(F,q)=>{v(z=>({...z,poles:{...z.poles,[F]:q}}))},M=F=>{const q=c.find(J=>J.id===F),z=(q==null?void 0:q.zones)||[];v(J=>{var W;return{...J,siteId:F,zoneId:((W=z[0])==null?void 0:W.id)||""}})},I=F=>{F.preventDefault();const q=R();if(Object.keys(q).length>0){C(q);return}if(s){const z={...s.module,code:h,siteId:f.siteId,zoneId:f.zoneId,lines:Number(f.lines),poles:{galvanized:Number(f.poles.galvanized),wood:Number(f.poles.wood),plastic:Number(f.poles.plastic)},latitude:f.latitude.trim()||void 0,longitude:f.longitude.trim()||void 0};r(z)}else{const z={code:h,siteId:f.siteId,zoneId:f.zoneId,lines:Number(f.lines),poles:{galvanized:Number(f.poles.galvanized),wood:Number(f.poles.wood),plastic:Number(f.poles.plastic)},latitude:f.latitude.trim()||void 0,longitude:f.longitude.trim()||void 0};r(z)}},O=Object.keys(w).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l(s?"editModule":"addModule"),widthClass:"max-w-4xl",children:e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(de,{label:l("moduleCode"),value:h,disabled:!0}),e.jsx(De,{label:l("site"),value:f.siteId,onChange:F=>M(F.target.value),error:w.siteId,children:c.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))}),e.jsxs(De,{label:l("zoneName"),value:f.zoneId,onChange:F=>_("zoneId",F.target.value),error:w.zoneId,disabled:!f.siteId,children:[e.jsx("option",{value:"",children:l("selectZone")}),x.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Ur,{label:`${l("latitudeDMS")} (${l("optional")})`,value:f.latitude,onChange:F=>_("latitude",F),axis:"lat",error:w.latitude}),e.jsx(Ur,{label:`${l("longitudeDMS")} (${l("optional")})`,value:f.longitude,onChange:F=>_("longitude",F),axis:"lon",error:w.longitude})]}),T&&e.jsxs("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200 border border-yellow-300 dark:border-yellow-700 rounded-md text-sm flex items-center gap-2",children:[e.jsx(te,{name:"AlertTriangle",className:"w-5 h-5 flex-shrink-0"}),T]}),e.jsxs("div",{className:"border-t dark:border-gray-700 pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:l("configuration")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(de,{label:l("lines"),type:"number",value:f.lines,onChange:F=>_("lines",Number(F.target.value)),error:w.lines,required:!0}),e.jsx(de,{label:l("galvanizedPoles"),type:"number",value:f.poles.galvanized,onChange:F=>D("galvanized",Number(F.target.value)),error:(A=w.poles)==null?void 0:A.galvanized,required:!0}),e.jsx(de,{label:l("woodPoles"),type:"number",value:f.poles.wood,onChange:F=>D("wood",Number(F.target.value)),error:(U=w.poles)==null?void 0:U.wood,required:!0}),e.jsx(de,{label:l("plasticPoles"),type:"number",value:f.poles.plastic,onChange:F=>D("plastic",Number(F.target.value)),error:(P=w.poles)==null?void 0:P.plastic,required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{type:"submit",disabled:O,children:l("save")})]})]})})},i0=({isOpen:t,onClose:n,history:s,moduleCode:r})=>{const{t:l,language:c}=je(),d=[...s].sort((u,h)=>new Date(h.date).getTime()-new Date(u.date).getTime());return e.jsx(at,{isOpen:t,onClose:n,title:`${l("moduleStatusHistoryTitle")}: ${r}`,widthClass:"max-w-2xl",children:e.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-4",children:e.jsx("ol",{className:"relative border-l border-gray-200 dark:border-gray-700 ml-4",children:d.map((u,h)=>e.jsxs("li",{className:"mb-8 ml-8",children:[e.jsx("span",{className:"absolute flex items-center justify-center w-6 h-6 bg-blue-100 rounded-full -left-3 ring-8 ring-white dark:ring-gray-800/70 dark:bg-blue-900",children:e.jsxs("svg",{className:"w-2.5 h-2.5 text-blue-800 dark:text-blue-300","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4Z"}),e.jsx("path",{d:"M0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})]})}),e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(mn,{status:u.status}),e.jsx("time",{className:"block ml-4 text-sm font-normal leading-none text-gray-400 dark:text-gray-500",children:new Date(u.date).toLocaleString(c,{dateStyle:"long",timeStyle:"short"})})]}),u.notes&&e.jsxs("p",{className:"text-base font-normal text-gray-600 dark:text-gray-300 mt-2",children:[l("notes"),": ",u.notes]})]},h))})})})},l0=({qrData:t,title:n,subtitle:s,detail:r,onClose:l})=>{const{settings:c}=$e(),d=N.useRef(null);N.useEffect(()=>{d.current&&(d.current.innerHTML="",new QRCode(d.current,{text:JSON.stringify(t),width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H}))},[t]);const u=()=>{window.print()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[1100] flex items-center justify-center backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-2xl max-w-sm w-full mx-4",children:[e.jsxs("div",{id:"printable-qr-label",className:"border-2 border-black p-4 flex flex-col items-center text-center bg-white w-[300px] h-[200px] mx-auto mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full border-b border-gray-300 pb-2 mb-2",children:[e.jsx("img",{src:c.company.logoUrl,className:"h-8 object-contain"}),e.jsx("span",{className:"text-xs font-bold uppercase truncate",children:c.company.name})]}),e.jsxs("div",{className:"flex-grow flex flex-row items-center gap-4 w-full",children:[e.jsx("div",{ref:d,className:"w-[96px] h-[96px]"}),e.jsxs("div",{className:"text-left flex-1 overflow-hidden",children:[e.jsx("h2",{className:"text-lg font-bold leading-tight uppercase break-words",children:n}),s&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:s}),r&&e.jsx("p",{className:"text-[10px] font-mono mt-2",children:r})]})]}),e.jsx("div",{className:"text-[8px] text-gray-400 w-full text-right mt-1",children:new Date().toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-end gap-2 no-print",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 rounded bg-gray-200 text-gray-800 hover:bg-gray-300",children:"Close"}),e.jsxs("button",{onClick:u,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Label"]})]})]})})},Yj=()=>{const{t}=je(),{settings:n}=$e(),{modules:s,cultivationCycles:r,sites:l,seaweedTypes:c,deleteModule:d,addModule:u,updateModule:h,farmers:m,deleteMultipleModules:f,updateModulesFarmer:v}=qe(),[x,S]=N.useState(!1),[w,C]=N.useState(null),[T,E]=N.useState(!1),[R,_]=N.useState(null),[D,M]=N.useState(!1),[I,O]=N.useState(null),[A,U]=N.useState(""),[P,F]=N.useState([]),[q,z]=N.useState(!1),[J,W]=N.useState(null),[G,B]=N.useState(!1),[X,$]=xm(),ae=X.get("highlight"),[H,ie]=N.useState("table"),[ue,Ne]=N.useState(null),[oe,ne]=N.useState({code:"",siteId:"all",zoneId:"all",farmerId:"all",status:"all"}),[we,fe]=N.useState([]);N.useEffect(()=>{if(oe.siteId==="all")fe([]);else{const xe=l.find(Ue=>Ue.id===oe.siteId);fe((xe==null?void 0:xe.zones)||[])}},[oe.siteId,l]);const Q=(xe,Ue)=>{ne(xe==="siteId"?Ze=>({...Ze,siteId:Ue,zoneId:"all"}):Ze=>({...Ze,[xe]:Ue}))},ee=N.useCallback(()=>{ne({code:"",siteId:"all",zoneId:"all",farmerId:"all",status:"all"}),F([])},[]),ye=N.useMemo(()=>s.map(xe=>{const Ue=[...r].filter(gt=>gt.moduleId===xe.id).sort((gt,Kt)=>new Date(Kt.plantingDate).getTime()-new Date(gt.plantingDate).getTime())[0],Ze=l.find(gt=>gt.id===xe.siteId),Et=Ze==null?void 0:Ze.zones.find(gt=>gt.id===xe.zoneId),ot=Ue?c.find(gt=>gt.id===Ue.seaweedTypeId):void 0,Pt=xe.farmerId?m.find(gt=>gt.id===xe.farmerId):void 0;let wt;if(!xe.farmerId){const gt=r.filter(Kt=>Kt.moduleId===xe.id&&Kt.harvestDate).sort((Kt,bs)=>new Date(bs.harvestDate).getTime()-new Date(Kt.harvestDate).getTime());if(gt.length>0){const Kt=new Date(gt[0].harvestDate),Ds=Math.floor((new Date().getTime()-Kt.getTime())/(1e3*60*60*24));Ds>qu&&(wt={type:"unassigned_long",message:t("notification_unassigned").replace("{code}",xe.code).replace("{days}",String(Ds))})}}return{module:xe,cycle:Ue,site:Ze,zone:Et,seaweedType:ot,farmer:Pt,alert:wt}}).filter(xe=>{const{module:Ue}=xe;if(!Ue)return!1;const Ze=oe.code?Ue.code.toLowerCase().includes(oe.code.toLowerCase()):!0,Et=oe.siteId!=="all"?Ue.siteId===oe.siteId:!0,ot=oe.zoneId!=="all"?Ue.zoneId===oe.zoneId:!0,Pt=oe.farmerId!=="all"?Ue.farmerId===oe.farmerId:!0,wt=(()=>{switch(oe.status){case"free":return!Ue.farmerId;case"assigned":return!!Ue.farmerId;case"with_alerts":return!!xe.alert;case"all":default:return!0}})();return Ze&&Et&&ot&&Pt&&wt}),[s,r,l,c,m,t,oe]);N.useMemo(()=>{if(P.length===0)return{farmers:[],isMultiSite:!1};const xe=s.filter(Ze=>P.includes(Ze.id)),Ue=new Set(xe.map(Ze=>Ze.siteId));if(Ue.size===1){const[Ze]=Ue;return{farmers:m.filter(Et=>Et.siteId===Ze),isMultiSite:!1}}return{farmers:[],isMultiSite:Ue.size>1}},[P,s,m]),N.useEffect(()=>{if(ae){const xe=ye.find(Ue=>Ue.module.id===ae);xe&&(W(xe),$({},{replace:!0}))}},[ae,ye,$]),N.useEffect(()=>{const xe=new Set(ye.map(Ue=>Ue.module.id));F(Ue=>Ue.filter(Ze=>xe.has(Ze)))},[ye]),N.useMemo(()=>s.length,[s]),N.useMemo(()=>r.filter(xe=>xe.status===Je.PLANTED||xe.status===Je.GROWING).length,[r]),N.useMemo(()=>{const xe=new Date;xe.setHours(0,0,0,0);const Ue=45;return r.filter(Ze=>{if(Ze.status===Je.PLANTED||Ze.status===Je.GROWING){const Et=new Date(Ze.plantingDate);return Et.setHours(0,0,0,0),(xe.getTime()-Et.getTime())/(1e3*60*60*24)>Ue}return!1}).length},[r]),N.useMemo(()=>s.reduce((xe,Ue)=>xe+Ue.lines,0),[s]);const Le=N.useMemo(()=>[...m].sort((xe,Ue)=>`${xe.firstName} ${xe.lastName}`.localeCompare(`${Ue.firstName} ${Ue.lastName}`)),[m]),ke=(xe=null)=>{C(xe),S(!0)},Re=()=>{C(null),S(!1)},Ke=xe=>{_(xe),E(!0)},ze=()=>{R&&d(R),E(!1),_(null)},Se=xe=>{"id"in xe?h(xe):u(xe),Re()},Oe=(xe,Ue)=>{O(xe),U(Ue),M(!0)},be=xe=>{var Ue;Ne({data:{t:"m",id:xe.id},title:xe.code,subtitle:((Ue=l.find(Ze=>Ze.id===xe.siteId))==null?void 0:Ue.name)||""})};return e.jsxs("div",{className:"pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:t("moduleManagementTitle")}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(se,{onClick:()=>ke(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("addModule")]})})]}),e.jsxs(Ge,{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:t("filtersTitle")}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 items-end",children:[e.jsx(de,{label:t("moduleCode"),value:oe.code,onChange:xe=>Q("code",xe.target.value)}),e.jsxs(De,{label:t("site"),value:oe.siteId,onChange:xe=>Q("siteId",xe.target.value),children:[e.jsx("option",{value:"all",children:t("allSites")}),l.map(xe=>e.jsx("option",{value:xe.id,children:xe.name},xe.id))]}),e.jsxs(De,{label:t("zoneName"),value:oe.zoneId,onChange:xe=>Q("zoneId",xe.target.value),disabled:oe.siteId==="all",children:[e.jsx("option",{value:"all",children:t("allZones")}),we.map(xe=>e.jsx("option",{value:xe.id,children:xe.name},xe.id))]}),e.jsxs(De,{label:t("farmer"),value:oe.farmerId,onChange:xe=>Q("farmerId",xe.target.value),children:[e.jsx("option",{value:"all",children:t("allFarmers")}),Le.map(xe=>e.jsxs("option",{value:xe.id,children:[xe.firstName," ",xe.lastName]},xe.id))]}),e.jsxs(De,{label:t("status"),value:oe.status,onChange:xe=>Q("status",xe.target.value),children:[e.jsx("option",{value:"all",children:t("allStatuses")}),e.jsx("option",{value:"free",children:t("status_FREE")}),e.jsx("option",{value:"assigned",children:t("status_ASSIGNED")}),e.jsx("option",{value:"with_alerts",children:t("alerts")})]}),e.jsx(se,{variant:"secondary",onClick:ee,className:"h-[42px] w-full",children:t("clearFilters")})]})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-16",children:t("status")}),e.jsx("th",{className:"p-3",children:t("moduleCode")}),e.jsx("th",{className:"p-3",children:t("site")}),e.jsx("th",{className:"p-3",children:t("zoneName")}),e.jsx("th",{className:"p-3",children:t("farmer")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsx("tbody",{children:ye.map(xe=>{var Ue,Ze;return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3",children:e.jsx(mn,{status:xe.module.farmerId?"ASSIGNED":"FREE"})}),e.jsx("td",{className:"p-3 font-mono font-bold",children:xe.module.code}),e.jsx("td",{className:"p-3",children:(Ue=xe.site)==null?void 0:Ue.name}),e.jsx("td",{className:"p-3",children:(Ze=xe.zone)==null?void 0:Ze.name}),e.jsx("td",{className:"p-3",children:xe.farmer?`${xe.farmer.firstName} ${xe.farmer.lastName}`:"-"}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(se,{variant:"ghost",onClick:()=>be(xe.module),title:t("print"),children:e.jsx(te,{name:"QrCode",className:"w-4 h-4"})}),e.jsx(se,{variant:"ghost",onClick:()=>ke(xe),children:e.jsx(te,{name:"Settings",className:"w-4 h-4"})}),e.jsx(se,{variant:"ghost",onClick:()=>Oe(xe.module.statusHistory,xe.module.code),children:e.jsx(te,{name:"FileText",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",onClick:()=>Ke(xe.module.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]},xe.module.id)})})]})})}),x&&e.jsx(Wj,{isOpen:x,onClose:Re,data:w,onSave:Se}),T&&e.jsx(Ut,{isOpen:T,onClose:()=>E(!1),onConfirm:ze,title:t("confirmDeleteTitle"),message:t("confirmDeleteModule")}),D&&I&&e.jsx(i0,{isOpen:D,onClose:()=>M(!1),history:I,moduleCode:A}),ue&&e.jsx(l0,{qrData:ue.data,title:ue.title,subtitle:ue.subtitle,detail:"SCAN FOR TRACEABILITY",onClose:()=>Ne(null)})]})},Jj=({isOpen:t,onClose:n,cycle:s,module:r})=>{const{t:l,language:c}=je(),{cuttingOperations:d,serviceProviders:u}=qe(),h=N.useMemo(()=>new Map(u.map(f=>[f.id,f.name])),[u]),m=N.useMemo(()=>{const f=[];if(!s)return[];if(s.cuttingOperationId){const v=d.find(x=>x.id===s.cuttingOperationId);if(v){const x=h.get(v.serviceProviderId),S=x?`Provider: ${x}`:`Operation ID: ${v.id}`;f.push({status:"CUTTING",date:v.date,notes:S})}}if(s.plantingDate&&(f.push({status:"PLANTED",date:s.plantingDate}),!s.harvestDate)){const v=new Date(s.plantingDate);v.setDate(v.getDate()+1),f.push({status:"GROWING",date:v.toISOString().split("T")[0]})}return s.harvestDate&&f.push({status:"HARVESTED",date:s.harvestDate}),s.dryingStartDate&&f.push({status:"DRYING",date:s.dryingStartDate}),s.baggingStartDate&&f.push({status:"BAGGING",date:s.baggingStartDate}),s.stockDate&&f.push({status:"IN_STOCK",date:s.stockDate}),s.exportDate&&f.push({status:"EXPORTED",date:s.exportDate}),f.filter(v=>v.date).sort((v,x)=>new Date(x.date).getTime()-new Date(v.date).getTime())},[s,d,h]);return e.jsx(at,{isOpen:t,onClose:n,title:`${l("cultivationCycleHistoryTitle")}: ${r.code}`,widthClass:"max-w-2xl",children:e.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-4",children:e.jsxs("ol",{className:"relative border-l border-gray-200 dark:border-gray-700 ml-4",children:[m.map((f,v)=>e.jsxs("li",{className:"mb-8 ml-8",children:[e.jsx("span",{className:"absolute flex items-center justify-center w-6 h-6 bg-blue-100 rounded-full -left-3 ring-8 ring-white dark:ring-gray-800/70 dark:bg-blue-900",children:e.jsxs("svg",{className:"w-2.5 h-2.5 text-blue-800 dark:text-blue-300","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4Z"}),e.jsx("path",{d:"M0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"})]})}),e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(mn,{status:f.status}),e.jsx("time",{className:"block ml-4 text-sm font-normal leading-none text-gray-400 dark:text-gray-500",children:new Date(f.date).toLocaleString(c,{dateStyle:"long",timeStyle:"short"})})]}),f.notes&&e.jsxs("p",{className:"text-base font-normal text-gray-600 dark:text-gray-300 mt-2",children:[l("notes"),": ",f.notes]})]},v)),m.length===0&&e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:l("noCycleHistoryEvents")})]})})})};var Xi={exports:{}},Au={},Du,zg;function Xj(){if(zg)return Du;zg=1;function t(n,s){typeof s=="boolean"&&(s={forever:s}),this._originalTimeouts=JSON.parse(JSON.stringify(n)),this._timeouts=n,this._options=s||{},this._maxRetryTime=s&&s.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return Du=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(n){if(this._timeout&&clearTimeout(this._timeout),!n)return!1;var s=new Date().getTime();if(n&&s-this._operationStart>=this._maxRetryTime)return this._errors.push(n),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(n);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var l=this;return this._timer=setTimeout(function(){l._attempts++,l._operationTimeoutCb&&(l._timeout=setTimeout(function(){l._operationTimeoutCb(l._attempts)},l._operationTimeout),l._options.unref&&l._timeout.unref()),l._fn(l._attempts)},r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(n,s){this._fn=n,s&&(s.timeout&&(this._operationTimeout=s.timeout),s.cb&&(this._operationTimeoutCb=s.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},t.prototype.try=function(n){console.log("Using RetryOperation.try() is deprecated"),this.attempt(n)},t.prototype.start=function(n){console.log("Using RetryOperation.start() is deprecated"),this.attempt(n)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(this._errors.length===0)return null;for(var n={},s=null,r=0,l=0;l<this._errors.length;l++){var c=this._errors[l],d=c.message,u=(n[d]||0)+1;n[d]=u,u>=r&&(s=c,r=u)}return s},Du}var Hg;function Qj(){return Hg||(Hg=1,(function(t){var n=Xj();t.operation=function(s){var r=t.timeouts(s);return new n(r,{forever:s&&(s.forever||s.retries===1/0),unref:s&&s.unref,maxRetryTime:s&&s.maxRetryTime})},t.timeouts=function(s){if(s instanceof Array)return[].concat(s);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var l in s)r[l]=s[l];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var c=[],d=0;d<r.retries;d++)c.push(this.createTimeout(d,r));return s&&s.forever&&!c.length&&c.push(this.createTimeout(d,r)),c.sort(function(u,h){return u-h}),c},t.createTimeout=function(s,r){var l=r.randomize?Math.random()+1:1,c=Math.round(l*Math.max(r.minTimeout,1)*Math.pow(r.factor,s));return c=Math.min(c,r.maxTimeout),c},t.wrap=function(s,r,l){if(r instanceof Array&&(l=r,r=null),!l){l=[];for(var c in s)typeof s[c]=="function"&&l.push(c)}for(var d=0;d<l.length;d++){var u=l[d],h=s[u];s[u]=(function(f){var v=t.operation(r),x=Array.prototype.slice.call(arguments,1),S=x.pop();x.push(function(w){v.retry(w)||(w&&(arguments[0]=v.mainError()),S.apply(this,arguments))}),v.attempt(function(){f.apply(s,x)})}).bind(s,h),s[u].options=r}}})(Au)),Au}var ku,qg;function Zj(){return qg||(qg=1,ku=Qj()),ku}var Vg;function eT(){if(Vg)return Xi.exports;Vg=1;const t=Zj(),n=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class s extends Error{constructor(u){super(),u instanceof Error?(this.originalError=u,{message:u}=u):(this.originalError=new Error(u),this.originalError.stack=this.stack),this.name="AbortError",this.message=u}}const r=(d,u,h)=>{const m=h.retries-(u-1);return d.attemptNumber=u,d.retriesLeft=m,d},l=d=>n.includes(d),c=(d,u)=>new Promise((h,m)=>{u={onFailedAttempt:()=>{},retries:10,...u};const f=t.operation(u);f.attempt(async v=>{try{h(await d(v))}catch(x){if(!(x instanceof Error)){m(new TypeError(`Non-error was thrown: "${x}". You should only throw errors.`));return}if(x instanceof s)f.stop(),m(x.originalError);else if(x instanceof TypeError&&!l(x.message))f.stop(),m(x);else{r(x,v,u);try{await u.onFailedAttempt(x)}catch(S){m(S);return}f.retry(x)||m(f.mainError())}}})});return Xi.exports=c,Xi.exports.default=c,Xi.exports.AbortError=s,Xi.exports}var o0=eT();const tT=om(o0);var nT={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let sT,aT;function rT(){return{geminiUrl:sT,vertexUrl:aT}}function iT(t,n,s,r){var l,c;if(!(t!=null&&t.baseUrl)){const d=rT();return n?(l=d.vertexUrl)!==null&&l!==void 0?l:s:(c=d.geminiUrl)!==null&&c!==void 0?c:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class na{}function Ve(t,n){const s=/\{([^}]+)\}/g;return t.replace(s,(r,l)=>{if(Object.prototype.hasOwnProperty.call(n,l)){const c=n[l];return c!=null?String(c):""}else throw new Error(`Key '${l}' not found in valueMap.`)})}function y(t,n,s){for(let c=0;c<n.length-1;c++){const d=n[c];if(d.endsWith("[]")){const u=d.slice(0,-2);if(!(u in t))if(Array.isArray(s))t[u]=Array.from({length:s.length},()=>({}));else throw new Error(`Value must be a list given an array path ${d}`);if(Array.isArray(t[u])){const h=t[u];if(Array.isArray(s))for(let m=0;m<h.length;m++){const f=h[m];y(f,n.slice(c+1),s[m])}else for(const m of h)y(m,n.slice(c+1),s)}return}else if(d.endsWith("[0]")){const u=d.slice(0,-3);u in t||(t[u]=[{}]);const h=t[u];y(h[0],n.slice(c+1),s);return}(!t[d]||typeof t[d]!="object")&&(t[d]={}),t=t[d]}const r=n[n.length-1],l=t[r];if(l!==void 0){if(!s||typeof s=="object"&&Object.keys(s).length===0||s===l)return;if(typeof l=="object"&&typeof s=="object"&&l!==null&&s!==null)Object.assign(l,s);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof s=="object"&&s!==null&&!Array.isArray(s)?Object.assign(t,s):t[r]=s}function g(t,n,s=void 0){try{if(n.length===1&&n[0]==="_self")return t;for(let r=0;r<n.length;r++){if(typeof t!="object"||t===null)return s;const l=n[r];if(l.endsWith("[]")){const c=l.slice(0,-2);if(c in t){const d=t[c];return Array.isArray(d)?d.map(u=>g(u,n.slice(r+1),s)):s}else return s}else t=t[l]}return t}catch(r){if(r instanceof TypeError)return s;throw r}}function lT(t,n){for(const[s,r]of Object.entries(n)){const l=s.split("."),c=r.split("."),d=new Set;let u=-1;for(let h=0;h<l.length;h++)if(l[h]==="*"){u=h;break}if(u!==-1&&c.length>u)for(let h=u;h<c.length;h++){const m=c[h];m!=="*"&&!m.endsWith("[]")&&!m.endsWith("[0]")&&d.add(m)}$u(t,l,c,0,d)}}function $u(t,n,s,r,l){if(r>=n.length||typeof t!="object"||t===null)return;const c=n[r];if(c.endsWith("[]")){const d=c.slice(0,-2),u=t;if(d in u&&Array.isArray(u[d]))for(const h of u[d])$u(h,n,s,r+1,l)}else if(c==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const d=t,u=Object.keys(d).filter(m=>!m.startsWith("_")&&!l.has(m)),h={};for(const m of u)h[m]=d[m];for(const[m,f]of Object.entries(h)){const v=[];for(const x of s.slice(r))x==="*"?v.push(m):v.push(x);y(d,v,f)}for(const m of u)delete d[m]}}else{const d=t;c in d&&$u(d[c],n,s,r+1,l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nm(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oT(t){const n={},s=g(t,["operationName"]);s!=null&&y(n,["operationName"],s);const r=g(t,["resourceName"]);return r!=null&&y(n,["_url","resourceName"],r),n}function cT(t){const n={},s=g(t,["name"]);s!=null&&y(n,["name"],s);const r=g(t,["metadata"]);r!=null&&y(n,["metadata"],r);const l=g(t,["done"]);l!=null&&y(n,["done"],l);const c=g(t,["error"]);c!=null&&y(n,["error"],c);const d=g(t,["response","generateVideoResponse"]);return d!=null&&y(n,["response"],uT(d)),n}function dT(t){const n={},s=g(t,["name"]);s!=null&&y(n,["name"],s);const r=g(t,["metadata"]);r!=null&&y(n,["metadata"],r);const l=g(t,["done"]);l!=null&&y(n,["done"],l);const c=g(t,["error"]);c!=null&&y(n,["error"],c);const d=g(t,["response"]);return d!=null&&y(n,["response"],mT(d)),n}function uT(t){const n={},s=g(t,["generatedSamples"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>fT(d))),y(n,["generatedVideos"],c)}const r=g(t,["raiMediaFilteredCount"]);r!=null&&y(n,["raiMediaFilteredCount"],r);const l=g(t,["raiMediaFilteredReasons"]);return l!=null&&y(n,["raiMediaFilteredReasons"],l),n}function mT(t){const n={},s=g(t,["videos"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>pT(d))),y(n,["generatedVideos"],c)}const r=g(t,["raiMediaFilteredCount"]);r!=null&&y(n,["raiMediaFilteredCount"],r);const l=g(t,["raiMediaFilteredReasons"]);return l!=null&&y(n,["raiMediaFilteredReasons"],l),n}function fT(t){const n={},s=g(t,["video"]);return s!=null&&y(n,["video"],bT(s)),n}function pT(t){const n={},s=g(t,["_self"]);return s!=null&&y(n,["video"],NT(s)),n}function hT(t){const n={},s=g(t,["operationName"]);return s!=null&&y(n,["_url","operationName"],s),n}function gT(t){const n={},s=g(t,["operationName"]);return s!=null&&y(n,["_url","operationName"],s),n}function xT(t){const n={},s=g(t,["name"]);s!=null&&y(n,["name"],s);const r=g(t,["metadata"]);r!=null&&y(n,["metadata"],r);const l=g(t,["done"]);l!=null&&y(n,["done"],l);const c=g(t,["error"]);c!=null&&y(n,["error"],c);const d=g(t,["response"]);return d!=null&&y(n,["response"],yT(d)),n}function yT(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["parent"]);r!=null&&y(n,["parent"],r);const l=g(t,["documentName"]);return l!=null&&y(n,["documentName"],l),n}function c0(t){const n={},s=g(t,["name"]);s!=null&&y(n,["name"],s);const r=g(t,["metadata"]);r!=null&&y(n,["metadata"],r);const l=g(t,["done"]);l!=null&&y(n,["done"],l);const c=g(t,["error"]);c!=null&&y(n,["error"],c);const d=g(t,["response"]);return d!=null&&y(n,["response"],vT(d)),n}function vT(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["parent"]);r!=null&&y(n,["parent"],r);const l=g(t,["documentName"]);return l!=null&&y(n,["documentName"],l),n}function bT(t){const n={},s=g(t,["uri"]);s!=null&&y(n,["uri"],s);const r=g(t,["encodedVideo"]);r!=null&&y(n,["videoBytes"],Nm(r));const l=g(t,["encoding"]);return l!=null&&y(n,["mimeType"],l),n}function NT(t){const n={},s=g(t,["gcsUri"]);s!=null&&y(n,["uri"],s);const r=g(t,["bytesBase64Encoded"]);r!=null&&y(n,["videoBytes"],Nm(r));const l=g(t,["mimeType"]);return l!=null&&y(n,["mimeType"],l),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Kg;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Kg||(Kg={}));var $g;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})($g||($g={}));var Wg;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Wg||(Wg={}));var ln;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(ln||(ln={}));var Yg;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Yg||(Yg={}));var Jg;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Jg||(Jg={}));var Xg;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Xg||(Xg={}));var Qg;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Qg||(Qg={}));var Zg;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Zg||(Zg={}));var ex;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ex||(ex={}));var tx;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(tx||(tx={}));var nx;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(nx||(nx={}));var sx;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(sx||(sx={}));var ax;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(ax||(ax={}));var rx;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(rx||(rx={}));var ix;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(ix||(ix={}));var lx;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(lx||(lx={}));var ox;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ox||(ox={}));var cx;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(cx||(cx={}));var dx;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(dx||(dx={}));var ux;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ux||(ux={}));var $o;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})($o||($o={}));var mx;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(mx||(mx={}));var fx;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(fx||(fx={}));var px;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(px||(px={}));var Wu;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Wu||(Wu={}));var hx;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(hx||(hx={}));var gx;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(gx||(gx={}));var Yu;(function(t){t.COLLECTION="COLLECTION"})(Yu||(Yu={}));var xx;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(xx||(xx={}));var yx;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(yx||(yx={}));var Wo;(function(t){t.PREDICT="PREDICT",t.EMBED_CONTENT="EMBED_CONTENT"})(Wo||(Wo={}));var vx;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(vx||(vx={}));var bx;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(bx||(bx={}));var Nx;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Nx||(Nx={}));var Sx;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Sx||(Sx={}));var jx;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(jx||(jx={}));var Tx;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Tx||(Tx={}));var wx;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(wx||(wx={}));var Cx;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Cx||(Cx={}));var Ex;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Ex||(Ex={}));var Ix;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Ix||(Ix={}));var _x;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(_x||(_x={}));var Ax;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING",t.DISTILLATION="DISTILLATION"})(Ax||(Ax={}));var Dx;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(Dx||(Dx={}));var kx;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(kx||(kx={}));var Rx;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(Rx||(Rx={}));var Mx;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Mx||(Mx={}));var Px;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Px||(Px={}));var Lx;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Lx||(Lx={}));var Ox;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.ACTIVITY_START="ACTIVITY_START",t.ACTIVITY_END="ACTIVITY_END"})(Ox||(Ox={}));var Ux;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ux||(Ux={}));var Fx;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Fx||(Fx={}));var Bx;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Bx||(Bx={}));var Gx;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Gx||(Gx={}));var zx;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(zx||(zx={}));var Hx;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Hx||(Hx={}));var Fr;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Fr||(Fr={}));class Ju{constructor(n){const s={};for(const r of n.headers.entries())s[r[0]]=r[1];this.headers=s,this.responseInternal=n}json(){return this.responseInternal.json()}}class Qi{get text(){var n,s,r,l,c,d,u,h;if(((l=(r=(s=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content)===null||r===void 0?void 0:r.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",f=!1;const v=[];for(const x of(h=(u=(d=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&h!==void 0?h:[]){for(const[S,w]of Object.entries(x))S!=="text"&&S!=="thought"&&S!=="thoughtSignature"&&(w!==null||w!==void 0)&&v.push(S);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;f=!0,m+=x.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?m:void 0}get data(){var n,s,r,l,c,d,u,h;if(((l=(r=(s=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content)===null||r===void 0?void 0:r.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const f=[];for(const v of(h=(u=(d=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)!==null&&h!==void 0?h:[]){for(const[x,S]of Object.entries(v))x!=="inlineData"&&(S!==null||S!==void 0)&&f.push(x);v.inlineData&&typeof v.inlineData.data=="string"&&(m+=atob(v.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var n,s,r,l,c,d,u,h;if(((l=(r=(s=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content)===null||r===void 0?void 0:r.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(h=(u=(d=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||h===void 0?void 0:h.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var n,s,r,l,c,d,u,h,m;if(((l=(r=(s=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content)===null||r===void 0?void 0:r.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(h=(u=(d=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||h===void 0?void 0:h.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((f==null?void 0:f.length)!==0)return(m=f==null?void 0:f[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var n,s,r,l,c,d,u,h,m;if(((l=(r=(s=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content)===null||r===void 0?void 0:r.parts)===null||l===void 0?void 0:l.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(h=(u=(d=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content)===null||u===void 0?void 0:u.parts)===null||h===void 0?void 0:h.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((f==null?void 0:f.length)!==0)return(m=f==null?void 0:f[0])===null||m===void 0?void 0:m.output}}class qx{}class Vx{}class ST{}class jT{}class TT{}class wT{}class Kx{}class $x{}class Wx{}class CT{}class Yo{_fromAPIResponse({apiResponse:n,_isVertexAI:s}){const r=new Yo;let l;const c=n;return s?l=dT(c):l=cT(c),Object.assign(r,l),r}}class Yx{}class Jx{}class Xx{}class Qx{}class ET{}class IT{}class _T{}class Sm{_fromAPIResponse({apiResponse:n,_isVertexAI:s}){const r=new Sm,c=xT(n);return Object.assign(r,c),r}}class AT{}class DT{}class kT{}class RT{}class Zx{}class MT{get text(){var n,s,r;let l="",c=!1;const d=[];for(const u of(r=(s=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&r!==void 0?r:[]){for(const[h,m]of Object.entries(u))h!=="text"&&h!=="thought"&&m!==null&&d.push(h);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;c=!0,l+=u.text}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?l:void 0}get data(){var n,s,r;let l="";const c=[];for(const d of(r=(s=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&r!==void 0?r:[]){for(const[u,h]of Object.entries(d))u!=="inlineData"&&h!==null&&c.push(u);d.inlineData&&typeof d.inlineData.data=="string"&&(l+=atob(d.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}}class PT{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class jm{_fromAPIResponse({apiResponse:n,_isVertexAI:s}){const r=new jm,c=c0(n);return Object.assign(r,c),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tt(t,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(n.includes("..")||n.includes("?")||n.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const s=n.split("/",2);return`publishers/${s[0]}/models/${s[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function d0(t,n){const s=Tt(t,n);return s?s.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${s}`:s.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${s}`:s:""}function u0(t){return Array.isArray(t)?t.map(n=>Jo(n)):[Jo(t)]}function Jo(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function m0(t){const n=Jo(t);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function f0(t){const n=Jo(t);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function ey(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function p0(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(n=>ey(n)):[ey(t)]}function Xu(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function ty(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function ny(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function hn(t){if(t==null)throw new Error("ContentUnion is required");return Xu(t)?t:{role:"user",parts:p0(t)}}function Tm(t,n){if(!n)return[];if(t.isVertexAI()&&Array.isArray(n))return n.flatMap(s=>{const r=hn(s);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const s=hn(n);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]}return Array.isArray(n)?n.map(s=>hn(s)):[hn(n)]}function $n(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(ty(t)||ny(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[hn(t)]}const n=[],s=[],r=Xu(t[0]);for(const l of t){const c=Xu(l);if(c!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(c)n.push(l);else{if(ty(l)||ny(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");s.push(l)}}return r||n.push({role:"user",parts:p0(s)}),n}function LT(t,n){t.includes("null")&&(n.nullable=!0);const s=t.filter(r=>r!=="null");if(s.length===1)n.type=Object.values(ln).includes(s[0].toUpperCase())?s[0].toUpperCase():ln.TYPE_UNSPECIFIED;else{n.anyOf=[];for(const r of s)n.anyOf.push({type:Object.values(ln).includes(r.toUpperCase())?r.toUpperCase():ln.TYPE_UNSPECIFIED})}}function Gr(t){const n={},s=["items"],r=["anyOf"],l=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const c=t.anyOf;c!=null&&c.length==2&&(c[0].type==="null"?(n.nullable=!0,t=c[1]):c[1].type==="null"&&(n.nullable=!0,t=c[0])),t.type instanceof Array&&LT(t.type,n);for(const[d,u]of Object.entries(t))if(u!=null)if(d=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;n.type=Object.values(ln).includes(u.toUpperCase())?u.toUpperCase():ln.TYPE_UNSPECIFIED}else if(s.includes(d))n[d]=Gr(u);else if(r.includes(d)){const h=[];for(const m of u){if(m.type=="null"){n.nullable=!0;continue}h.push(Gr(m))}n[d]=h}else if(l.includes(d)){const h={};for(const[m,f]of Object.entries(u))h[m]=Gr(f);n[d]=h}else{if(d==="additionalProperties")continue;n[d]=u}return n}function wm(t){return Gr(t)}function Cm(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Em(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Kr(t){if(t.functionDeclarations)for(const n of t.functionDeclarations)n.parameters&&(Object.keys(n.parameters).includes("$schema")?n.parametersJsonSchema||(n.parametersJsonSchema=n.parameters,delete n.parameters):n.parameters=Gr(n.parameters)),n.response&&(Object.keys(n.response).includes("$schema")?n.responseJsonSchema||(n.responseJsonSchema=n.response,delete n.response):n.response=Gr(n.response));return t}function $r(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const n=[];for(const s of t)n.push(s);return n}function OT(t,n,s,r=1){const l=!n.startsWith(`${s}/`)&&n.split("/").length===r;return t.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${t.getProject()}/${n}`:n.startsWith(`${s}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:l?`projects/${t.getProject()}/locations/${t.getLocation()}/${s}/${n}`:n:l?`${s}/${n}`:n}function sa(t,n){if(typeof n!="string")throw new Error("name must be a string");return OT(t,n,"cachedContents")}function h0(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Ma(t){return Nm(t)}function UT(t){return t!=null&&typeof t=="object"&&"name"in t}function FT(t){return t!=null&&typeof t=="object"&&"video"in t}function BT(t){return t!=null&&typeof t=="object"&&"uri"in t}function g0(t){var n;let s;if(UT(t)&&(s=t.name),!(BT(t)&&(s=t.uri,s===void 0))&&!(FT(t)&&(s=(n=t.video)===null||n===void 0?void 0:n.uri,s===void 0))){if(typeof t=="string"&&(s=t),s===void 0)throw new Error("Could not extract file name from the provided input.");if(s.startsWith("https://")){const l=s.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${s}`);s=l[0]}else s.startsWith("files/")&&(s=s.split("files/")[1]);return s}}function x0(t,n){let s;return t.isVertexAI()?s=n?"publishers/google/models":"models":s=n?"models":"tunedModels",s}function y0(t){for(const n of["models","tunedModels","publisherModels"])if(GT(t,n))return t[n];return[]}function GT(t,n){return t!==null&&typeof t=="object"&&n in t}function zT(t,n={}){const s=t,r={name:s.name,description:s.description,parametersJsonSchema:s.inputSchema};return s.outputSchema&&(r.responseJsonSchema=s.outputSchema),n.behavior&&(r.behavior=n.behavior),{functionDeclarations:[r]}}function HT(t,n={}){const s=[],r=new Set;for(const l of t){const c=l.name;if(r.has(c))throw new Error(`Duplicate function name ${c} found in MCP tools. Please ensure function names are unique.`);r.add(c);const d=zT(l,n);d.functionDeclarations&&s.push(...d.functionDeclarations)}return{functionDeclarations:s}}function v0(t,n){let s;if(typeof n=="string")if(t.isVertexAI())if(n.startsWith("gs://"))s={format:"jsonl",gcsUri:[n]};else if(n.startsWith("bq://"))s={format:"bigquery",bigqueryUri:n};else throw new Error(`Unsupported string source for Vertex AI: ${n}`);else if(n.startsWith("files/"))s={fileName:n};else throw new Error(`Unsupported string source for Gemini API: ${n}`);else if(Array.isArray(n)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");s={inlinedRequests:n}}else s=n;const r=[s.gcsUri,s.bigqueryUri].filter(Boolean).length,l=[s.inlinedRequests,s.fileName].filter(Boolean).length;if(t.isVertexAI()){if(l>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||l!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return s}function qT(t){if(typeof t!="string")return t;const n=t;if(n.startsWith("gs://"))return{format:"jsonl",gcsUri:n};if(n.startsWith("bq://"))return{format:"bigquery",bigqueryUri:n};throw new Error(`Unsupported destination: ${n}`)}function b0(t){if(typeof t!="object"||t===null)return{};const n=t,s=n.inlinedResponses;if(typeof s!="object"||s===null)return t;const l=s.inlinedResponses;if(!Array.isArray(l)||l.length===0)return t;let c=!1;for(const d of l){if(typeof d!="object"||d===null)continue;const h=d.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){c=!0;break}}return c&&(n.inlinedEmbedContentResponses=n.inlinedResponses,delete n.inlinedResponses),t}function Wr(t,n){const s=n;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(s))return s.split("/").pop();throw new Error(`Invalid batch job name: ${s}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(s))return s.split("/").pop();if(/^\d+$/.test(s))return s;throw new Error(`Invalid batch job name: ${s}.`)}function N0(t){const n=t;return n==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":n==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":n==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":n==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":n==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":n==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":n==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":n}function VT(t){return t.includes("gemini")&&t!=="gemini-embedding-001"||t.includes("maas")}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KT(t){const n={},s=g(t,["responsesFile"]);s!=null&&y(n,["fileName"],s);const r=g(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Cw(d))),y(n,["inlinedResponses"],c)}const l=g(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(n,["inlinedEmbedContentResponses"],c)}return n}function $T(t){const n={},s=g(t,["predictionsFormat"]);s!=null&&y(n,["format"],s);const r=g(t,["gcsDestination","outputUriPrefix"]);r!=null&&y(n,["gcsUri"],r);const l=g(t,["bigqueryDestination","outputUri"]);return l!=null&&y(n,["bigqueryUri"],l),n}function WT(t){const n={},s=g(t,["format"]);s!=null&&y(n,["predictionsFormat"],s);const r=g(t,["gcsUri"]);r!=null&&y(n,["gcsDestination","outputUriPrefix"],r);const l=g(t,["bigqueryUri"]);if(l!=null&&y(n,["bigqueryDestination","outputUri"],l),g(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return n}function zo(t){const n={},s=g(t,["name"]);s!=null&&y(n,["name"],s);const r=g(t,["metadata","displayName"]);r!=null&&y(n,["displayName"],r);const l=g(t,["metadata","state"]);l!=null&&y(n,["state"],N0(l));const c=g(t,["metadata","createTime"]);c!=null&&y(n,["createTime"],c);const d=g(t,["metadata","endTime"]);d!=null&&y(n,["endTime"],d);const u=g(t,["metadata","updateTime"]);u!=null&&y(n,["updateTime"],u);const h=g(t,["metadata","model"]);h!=null&&y(n,["model"],h);const m=g(t,["metadata","output"]);return m!=null&&y(n,["dest"],KT(b0(m))),n}function Qu(t){const n={},s=g(t,["name"]);s!=null&&y(n,["name"],s);const r=g(t,["displayName"]);r!=null&&y(n,["displayName"],r);const l=g(t,["state"]);l!=null&&y(n,["state"],N0(l));const c=g(t,["error"]);c!=null&&y(n,["error"],c);const d=g(t,["createTime"]);d!=null&&y(n,["createTime"],d);const u=g(t,["startTime"]);u!=null&&y(n,["startTime"],u);const h=g(t,["endTime"]);h!=null&&y(n,["endTime"],h);const m=g(t,["updateTime"]);m!=null&&y(n,["updateTime"],m);const f=g(t,["model"]);f!=null&&y(n,["model"],f);const v=g(t,["inputConfig"]);v!=null&&y(n,["src"],YT(v));const x=g(t,["outputConfig"]);x!=null&&y(n,["dest"],$T(b0(x)));const S=g(t,["completionStats"]);return S!=null&&y(n,["completionStats"],S),n}function YT(t){const n={},s=g(t,["instancesFormat"]);s!=null&&y(n,["format"],s);const r=g(t,["gcsSource","uris"]);r!=null&&y(n,["gcsUri"],r);const l=g(t,["bigquerySource","inputUri"]);return l!=null&&y(n,["bigqueryUri"],l),n}function JT(t,n){const s={};if(g(n,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(n,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=g(n,["fileName"]);r!=null&&y(s,["fileName"],r);const l=g(n,["inlinedRequests"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>ww(t,d))),y(s,["requests","requests"],c)}return s}function XT(t){const n={},s=g(t,["format"]);s!=null&&y(n,["instancesFormat"],s);const r=g(t,["gcsUri"]);r!=null&&y(n,["gcsSource","uris"],r);const l=g(t,["bigqueryUri"]);if(l!=null&&y(n,["bigquerySource","inputUri"],l),g(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return n}function QT(t){const n={},s=g(t,["data"]);if(s!=null&&y(n,["data"],s),g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function ZT(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],Wr(t,r)),s}function ew(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],Wr(t,r)),s}function tw(t){const n={},s=g(t,["content"]);s!=null&&y(n,["content"],s);const r=g(t,["citationMetadata"]);r!=null&&y(n,["citationMetadata"],nw(r));const l=g(t,["tokenCount"]);l!=null&&y(n,["tokenCount"],l);const c=g(t,["finishReason"]);c!=null&&y(n,["finishReason"],c);const d=g(t,["avgLogprobs"]);d!=null&&y(n,["avgLogprobs"],d);const u=g(t,["groundingMetadata"]);u!=null&&y(n,["groundingMetadata"],u);const h=g(t,["index"]);h!=null&&y(n,["index"],h);const m=g(t,["logprobsResult"]);m!=null&&y(n,["logprobsResult"],m);const f=g(t,["safetyRatings"]);if(f!=null){let x=f;Array.isArray(x)&&(x=x.map(S=>S)),y(n,["safetyRatings"],x)}const v=g(t,["urlContextMetadata"]);return v!=null&&y(n,["urlContextMetadata"],v),n}function nw(t){const n={},s=g(t,["citationSources"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>l)),y(n,["citations"],r)}return n}function S0(t){const n={},s=g(t,["parts"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>Rw(c))),y(n,["parts"],l)}const r=g(t,["role"]);return r!=null&&y(n,["role"],r),n}function sw(t,n){const s={},r=g(t,["displayName"]);if(n!==void 0&&r!=null&&y(n,["batch","displayName"],r),g(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return s}function aw(t,n){const s={},r=g(t,["displayName"]);n!==void 0&&r!=null&&y(n,["displayName"],r);const l=g(t,["dest"]);return n!==void 0&&l!=null&&y(n,["outputConfig"],WT(qT(l))),s}function sy(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["_url","model"],Tt(t,r));const l=g(n,["src"]);l!=null&&y(s,["batch","inputConfig"],JT(t,v0(t,l)));const c=g(n,["config"]);return c!=null&&sw(c,s),s}function rw(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["model"],Tt(t,r));const l=g(n,["src"]);l!=null&&y(s,["inputConfig"],XT(v0(t,l)));const c=g(n,["config"]);return c!=null&&aw(c,s),s}function iw(t,n){const s={},r=g(t,["displayName"]);return n!==void 0&&r!=null&&y(n,["batch","displayName"],r),s}function lw(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["_url","model"],Tt(t,r));const l=g(n,["src"]);l!=null&&y(s,["batch","inputConfig"],pw(t,l));const c=g(n,["config"]);return c!=null&&iw(c,s),s}function ow(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],Wr(t,r)),s}function cw(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],Wr(t,r)),s}function dw(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["name"]);r!=null&&y(n,["name"],r);const l=g(t,["done"]);l!=null&&y(n,["done"],l);const c=g(t,["error"]);return c!=null&&y(n,["error"],c),n}function uw(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["name"]);r!=null&&y(n,["name"],r);const l=g(t,["done"]);l!=null&&y(n,["done"],l);const c=g(t,["error"]);return c!=null&&y(n,["error"],c),n}function mw(t,n){const s={},r=g(n,["contents"]);if(r!=null){let c=Tm(t,r);Array.isArray(c)&&(c=c.map(d=>d)),y(s,["requests[]","request","content"],c)}const l=g(n,["config"]);return l!=null&&(y(s,["_self"],fw(l,s)),lT(s,{"requests[].*":"requests[].request.*"})),s}function fw(t,n){const s={},r=g(t,["taskType"]);n!==void 0&&r!=null&&y(n,["requests[]","taskType"],r);const l=g(t,["title"]);n!==void 0&&l!=null&&y(n,["requests[]","title"],l);const c=g(t,["outputDimensionality"]);if(n!==void 0&&c!=null&&y(n,["requests[]","outputDimensionality"],c),g(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return s}function pw(t,n){const s={},r=g(n,["fileName"]);r!=null&&y(s,["file_name"],r);const l=g(n,["inlinedRequests"]);return l!=null&&y(s,["requests"],mw(t,l)),s}function hw(t){const n={};if(g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=g(t,["fileUri"]);s!=null&&y(n,["fileUri"],s);const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function gw(t){const n={},s=g(t,["id"]);s!=null&&y(n,["id"],s);const r=g(t,["args"]);r!=null&&y(n,["args"],r);const l=g(t,["name"]);if(l!=null&&y(n,["name"],l),g(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function xw(t){const n={},s=g(t,["allowedFunctionNames"]);s!=null&&y(n,["allowedFunctionNames"],s);const r=g(t,["mode"]);if(r!=null&&y(n,["mode"],r),g(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return n}function yw(t,n,s){const r={},l=g(n,["systemInstruction"]);s!==void 0&&l!=null&&y(s,["systemInstruction"],S0(hn(l)));const c=g(n,["temperature"]);c!=null&&y(r,["temperature"],c);const d=g(n,["topP"]);d!=null&&y(r,["topP"],d);const u=g(n,["topK"]);u!=null&&y(r,["topK"],u);const h=g(n,["candidateCount"]);h!=null&&y(r,["candidateCount"],h);const m=g(n,["maxOutputTokens"]);m!=null&&y(r,["maxOutputTokens"],m);const f=g(n,["stopSequences"]);f!=null&&y(r,["stopSequences"],f);const v=g(n,["responseLogprobs"]);v!=null&&y(r,["responseLogprobs"],v);const x=g(n,["logprobs"]);x!=null&&y(r,["logprobs"],x);const S=g(n,["presencePenalty"]);S!=null&&y(r,["presencePenalty"],S);const w=g(n,["frequencyPenalty"]);w!=null&&y(r,["frequencyPenalty"],w);const C=g(n,["seed"]);C!=null&&y(r,["seed"],C);const T=g(n,["responseMimeType"]);T!=null&&y(r,["responseMimeType"],T);const E=g(n,["responseSchema"]);E!=null&&y(r,["responseSchema"],wm(E));const R=g(n,["responseJsonSchema"]);if(R!=null&&y(r,["responseJsonSchema"],R),g(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=g(n,["safetySettings"]);if(s!==void 0&&_!=null){let z=_;Array.isArray(z)&&(z=z.map(J=>Mw(J))),y(s,["safetySettings"],z)}const D=g(n,["tools"]);if(s!==void 0&&D!=null){let z=$r(D);Array.isArray(z)&&(z=z.map(J=>Lw(Kr(J)))),y(s,["tools"],z)}const M=g(n,["toolConfig"]);if(s!==void 0&&M!=null&&y(s,["toolConfig"],Pw(M)),g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=g(n,["cachedContent"]);s!==void 0&&I!=null&&y(s,["cachedContent"],sa(t,I));const O=g(n,["responseModalities"]);O!=null&&y(r,["responseModalities"],O);const A=g(n,["mediaResolution"]);A!=null&&y(r,["mediaResolution"],A);const U=g(n,["speechConfig"]);if(U!=null&&y(r,["speechConfig"],Cm(U)),g(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=g(n,["thinkingConfig"]);P!=null&&y(r,["thinkingConfig"],P);const F=g(n,["imageConfig"]);F!=null&&y(r,["imageConfig"],Tw(F));const q=g(n,["enableEnhancedCivicAnswers"]);if(q!=null&&y(r,["enableEnhancedCivicAnswers"],q),g(n,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function vw(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["candidates"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(m=>tw(m))),y(n,["candidates"],h)}const l=g(t,["modelVersion"]);l!=null&&y(n,["modelVersion"],l);const c=g(t,["promptFeedback"]);c!=null&&y(n,["promptFeedback"],c);const d=g(t,["responseId"]);d!=null&&y(n,["responseId"],d);const u=g(t,["usageMetadata"]);return u!=null&&y(n,["usageMetadata"],u),n}function bw(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],Wr(t,r)),s}function Nw(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],Wr(t,r)),s}function Sw(t){const n={};if(g(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=g(t,["enableWidget"]);return s!=null&&y(n,["enableWidget"],s),n}function jw(t){const n={};if(g(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=g(t,["timeRangeFilter"]);return s!=null&&y(n,["timeRangeFilter"],s),n}function Tw(t){const n={},s=g(t,["aspectRatio"]);s!=null&&y(n,["aspectRatio"],s);const r=g(t,["imageSize"]);if(r!=null&&y(n,["imageSize"],r),g(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return n}function ww(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["request","model"],Tt(t,r));const l=g(n,["contents"]);if(l!=null){let u=$n(l);Array.isArray(u)&&(u=u.map(h=>S0(h))),y(s,["request","contents"],u)}const c=g(n,["metadata"]);c!=null&&y(s,["metadata"],c);const d=g(n,["config"]);return d!=null&&y(s,["request","generationConfig"],yw(t,d,g(s,["request"],{}))),s}function Cw(t){const n={},s=g(t,["response"]);s!=null&&y(n,["response"],vw(s));const r=g(t,["metadata"]);r!=null&&y(n,["metadata"],r);const l=g(t,["error"]);return l!=null&&y(n,["error"],l),n}function Ew(t,n){const s={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&y(n,["_query","pageSize"],r);const l=g(t,["pageToken"]);if(n!==void 0&&l!=null&&y(n,["_query","pageToken"],l),g(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return s}function Iw(t,n){const s={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&y(n,["_query","pageSize"],r);const l=g(t,["pageToken"]);n!==void 0&&l!=null&&y(n,["_query","pageToken"],l);const c=g(t,["filter"]);return n!==void 0&&c!=null&&y(n,["_query","filter"],c),s}function _w(t){const n={},s=g(t,["config"]);return s!=null&&Ew(s,n),n}function Aw(t){const n={},s=g(t,["config"]);return s!=null&&Iw(s,n),n}function Dw(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["nextPageToken"]);r!=null&&y(n,["nextPageToken"],r);const l=g(t,["operations"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>zo(d))),y(n,["batchJobs"],c)}return n}function kw(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["nextPageToken"]);r!=null&&y(n,["nextPageToken"],r);const l=g(t,["batchPredictionJobs"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>Qu(d))),y(n,["batchJobs"],c)}return n}function Rw(t){const n={},s=g(t,["mediaResolution"]);s!=null&&y(n,["mediaResolution"],s);const r=g(t,["codeExecutionResult"]);r!=null&&y(n,["codeExecutionResult"],r);const l=g(t,["executableCode"]);l!=null&&y(n,["executableCode"],l);const c=g(t,["fileData"]);c!=null&&y(n,["fileData"],hw(c));const d=g(t,["functionCall"]);d!=null&&y(n,["functionCall"],gw(d));const u=g(t,["functionResponse"]);u!=null&&y(n,["functionResponse"],u);const h=g(t,["inlineData"]);h!=null&&y(n,["inlineData"],QT(h));const m=g(t,["text"]);m!=null&&y(n,["text"],m);const f=g(t,["thought"]);f!=null&&y(n,["thought"],f);const v=g(t,["thoughtSignature"]);v!=null&&y(n,["thoughtSignature"],v);const x=g(t,["videoMetadata"]);return x!=null&&y(n,["videoMetadata"],x),n}function Mw(t){const n={},s=g(t,["category"]);if(s!=null&&y(n,["category"],s),g(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=g(t,["threshold"]);return r!=null&&y(n,["threshold"],r),n}function Pw(t){const n={},s=g(t,["retrievalConfig"]);s!=null&&y(n,["retrievalConfig"],s);const r=g(t,["functionCallingConfig"]);return r!=null&&y(n,["functionCallingConfig"],xw(r)),n}function Lw(t){const n={};if(g(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=g(t,["computerUse"]);s!=null&&y(n,["computerUse"],s);const r=g(t,["fileSearch"]);r!=null&&y(n,["fileSearch"],r);const l=g(t,["codeExecution"]);if(l!=null&&y(n,["codeExecution"],l),g(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const c=g(t,["functionDeclarations"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(v=>v)),y(n,["functionDeclarations"],f)}const d=g(t,["googleMaps"]);d!=null&&y(n,["googleMaps"],Sw(d));const u=g(t,["googleSearch"]);u!=null&&y(n,["googleSearch"],jw(u));const h=g(t,["googleSearchRetrieval"]);h!=null&&y(n,["googleSearchRetrieval"],h);const m=g(t,["urlContext"]);return m!=null&&y(n,["urlContext"],m),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ta;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(ta||(ta={}));class ar{constructor(n,s,r,l){this.pageInternal=[],this.paramsInternal={},this.requestInternal=s,this.init(n,r,l)}init(n,s,r){var l,c;this.nameInternal=n,this.pageInternal=s[this.nameInternal]||[],this.sdkHttpResponseInternal=s==null?void 0:s.sdkHttpResponse,this.idxInternal=0;let d={config:{}};!r||Object.keys(r).length===0?d={config:{}}:typeof r=="object"?d=Object.assign({},r):d=r,d.config&&(d.config.pageToken=s.nextPageToken),this.paramsInternal=d,this.pageInternalSize=(c=(l=d.config)===null||l===void 0?void 0:l.pageSize)!==null&&c!==void 0?c:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ow extends na{constructor(n){super(),this.apiClient=n,this.list=async(s={})=>new ar(ta.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(s),s),this.create=async s=>(this.apiClient.isVertexAI()&&(s.config=this.formatDestination(s.src,s.config)),this.createInternal(s)),this.createEmbeddings=async s=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(s)}}createInlinedGenerateContentRequest(n){const s=sy(this.apiClient,n),r=s._url,l=Ve("{model}:batchGenerateContent",r),u=s.batch.inputConfig.requests,h=u.requests,m=[];for(const f of h){const v=Object.assign({},f);if(v.systemInstruction){const x=v.systemInstruction;delete v.systemInstruction;const S=v.request;S.systemInstruction=x,v.request=S}m.push(v)}return u.requests=m,delete s.config,delete s._url,delete s._query,{path:l,body:s}}getGcsUri(n){if(typeof n=="string")return n.startsWith("gs://")?n:void 0;if(!Array.isArray(n)&&n.gcsUri&&n.gcsUri.length>0)return n.gcsUri[0]}getBigqueryUri(n){if(typeof n=="string")return n.startsWith("bq://")?n:void 0;if(!Array.isArray(n))return n.bigqueryUri}formatDestination(n,s){const r=s?Object.assign({},s):{},l=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${l}`),r.dest===void 0){const c=this.getGcsUri(n),d=this.getBigqueryUri(n);if(c)c.endsWith(".jsonl")?r.dest=`${c.slice(0,-6)}/dest`:r.dest=`${c}_dest_${l}`;else if(d)r.dest=`${d}_dest_${l}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=rw(this.apiClient,n);return u=Ve("batchPredictionJobs",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>Qu(f))}else{const m=sy(this.apiClient,n);return u=Ve("{model}:batchGenerateContent",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>zo(f))}}async createEmbeddingsInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=lw(this.apiClient,n);return c=Ve("{model}:asyncBatchEmbedContent",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>zo(h))}}async get(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=Nw(this.apiClient,n);return u=Ve("batchPredictionJobs/{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>Qu(f))}else{const m=bw(this.apiClient,n);return u=Ve("batches/{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>zo(f))}}async cancel(n){var s,r,l,c;let d="",u={};if(this.apiClient.isVertexAI()){const h=ew(this.apiClient,n);d=Ve("batchPredictionJobs/{name}:cancel",h._url),u=h._query,delete h._url,delete h._query,await this.apiClient.request({path:d,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal})}else{const h=ZT(this.apiClient,n);d=Ve("batches/{name}:cancel",h._url),u=h._query,delete h._url,delete h._query,await this.apiClient.request({path:d,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal})}}async listInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=Aw(n);return u=Ve("batchPredictionJobs",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=kw(f),x=new Zx;return Object.assign(x,v),x})}else{const m=_w(n);return u=Ve("batches",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=Dw(f),x=new Zx;return Object.assign(x,v),x})}}async delete(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=cw(this.apiClient,n);return u=Ve("batchPredictionJobs/{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>uw(f))}else{const m=ow(this.apiClient,n);return u=Ve("batches/{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>dw(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uw(t){const n={},s=g(t,["data"]);if(s!=null&&y(n,["data"],s),g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function ay(t){const n={},s=g(t,["parts"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>lC(c))),y(n,["parts"],l)}const r=g(t,["role"]);return r!=null&&y(n,["role"],r),n}function Fw(t,n){const s={},r=g(t,["ttl"]);n!==void 0&&r!=null&&y(n,["ttl"],r);const l=g(t,["expireTime"]);n!==void 0&&l!=null&&y(n,["expireTime"],l);const c=g(t,["displayName"]);n!==void 0&&c!=null&&y(n,["displayName"],c);const d=g(t,["contents"]);if(n!==void 0&&d!=null){let f=$n(d);Array.isArray(f)&&(f=f.map(v=>ay(v))),y(n,["contents"],f)}const u=g(t,["systemInstruction"]);n!==void 0&&u!=null&&y(n,["systemInstruction"],ay(hn(u)));const h=g(t,["tools"]);if(n!==void 0&&h!=null){let f=h;Array.isArray(f)&&(f=f.map(v=>cC(v))),y(n,["tools"],f)}const m=g(t,["toolConfig"]);if(n!==void 0&&m!=null&&y(n,["toolConfig"],oC(m)),g(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return s}function Bw(t,n){const s={},r=g(t,["ttl"]);n!==void 0&&r!=null&&y(n,["ttl"],r);const l=g(t,["expireTime"]);n!==void 0&&l!=null&&y(n,["expireTime"],l);const c=g(t,["displayName"]);n!==void 0&&c!=null&&y(n,["displayName"],c);const d=g(t,["contents"]);if(n!==void 0&&d!=null){let v=$n(d);Array.isArray(v)&&(v=v.map(x=>x)),y(n,["contents"],v)}const u=g(t,["systemInstruction"]);n!==void 0&&u!=null&&y(n,["systemInstruction"],hn(u));const h=g(t,["tools"]);if(n!==void 0&&h!=null){let v=h;Array.isArray(v)&&(v=v.map(x=>dC(x))),y(n,["tools"],v)}const m=g(t,["toolConfig"]);n!==void 0&&m!=null&&y(n,["toolConfig"],m);const f=g(t,["kmsKeyName"]);return n!==void 0&&f!=null&&y(n,["encryption_spec","kmsKeyName"],f),s}function Gw(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["model"],d0(t,r));const l=g(n,["config"]);return l!=null&&Fw(l,s),s}function zw(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["model"],d0(t,r));const l=g(n,["config"]);return l!=null&&Bw(l,s),s}function Hw(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],sa(t,r)),s}function qw(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],sa(t,r)),s}function Vw(t){const n={},s=g(t,["sdkHttpResponse"]);return s!=null&&y(n,["sdkHttpResponse"],s),n}function Kw(t){const n={},s=g(t,["sdkHttpResponse"]);return s!=null&&y(n,["sdkHttpResponse"],s),n}function $w(t){const n={};if(g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=g(t,["fileUri"]);s!=null&&y(n,["fileUri"],s);const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function Ww(t){const n={},s=g(t,["id"]);s!=null&&y(n,["id"],s);const r=g(t,["args"]);r!=null&&y(n,["args"],r);const l=g(t,["name"]);if(l!=null&&y(n,["name"],l),g(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function Yw(t){const n={},s=g(t,["allowedFunctionNames"]);s!=null&&y(n,["allowedFunctionNames"],s);const r=g(t,["mode"]);if(r!=null&&y(n,["mode"],r),g(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return n}function Jw(t){const n={},s=g(t,["description"]);s!=null&&y(n,["description"],s);const r=g(t,["name"]);r!=null&&y(n,["name"],r);const l=g(t,["parameters"]);l!=null&&y(n,["parameters"],l);const c=g(t,["parametersJsonSchema"]);c!=null&&y(n,["parametersJsonSchema"],c);const d=g(t,["response"]);d!=null&&y(n,["response"],d);const u=g(t,["responseJsonSchema"]);if(u!=null&&y(n,["responseJsonSchema"],u),g(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return n}function Xw(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],sa(t,r)),s}function Qw(t,n){const s={},r=g(n,["name"]);return r!=null&&y(s,["_url","name"],sa(t,r)),s}function Zw(t){const n={};if(g(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=g(t,["enableWidget"]);return s!=null&&y(n,["enableWidget"],s),n}function eC(t){const n={};if(g(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=g(t,["timeRangeFilter"]);return s!=null&&y(n,["timeRangeFilter"],s),n}function tC(t,n){const s={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&y(n,["_query","pageSize"],r);const l=g(t,["pageToken"]);return n!==void 0&&l!=null&&y(n,["_query","pageToken"],l),s}function nC(t,n){const s={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&y(n,["_query","pageSize"],r);const l=g(t,["pageToken"]);return n!==void 0&&l!=null&&y(n,["_query","pageToken"],l),s}function sC(t){const n={},s=g(t,["config"]);return s!=null&&tC(s,n),n}function aC(t){const n={},s=g(t,["config"]);return s!=null&&nC(s,n),n}function rC(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["nextPageToken"]);r!=null&&y(n,["nextPageToken"],r);const l=g(t,["cachedContents"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(n,["cachedContents"],c)}return n}function iC(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["nextPageToken"]);r!=null&&y(n,["nextPageToken"],r);const l=g(t,["cachedContents"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(n,["cachedContents"],c)}return n}function lC(t){const n={},s=g(t,["mediaResolution"]);s!=null&&y(n,["mediaResolution"],s);const r=g(t,["codeExecutionResult"]);r!=null&&y(n,["codeExecutionResult"],r);const l=g(t,["executableCode"]);l!=null&&y(n,["executableCode"],l);const c=g(t,["fileData"]);c!=null&&y(n,["fileData"],$w(c));const d=g(t,["functionCall"]);d!=null&&y(n,["functionCall"],Ww(d));const u=g(t,["functionResponse"]);u!=null&&y(n,["functionResponse"],u);const h=g(t,["inlineData"]);h!=null&&y(n,["inlineData"],Uw(h));const m=g(t,["text"]);m!=null&&y(n,["text"],m);const f=g(t,["thought"]);f!=null&&y(n,["thought"],f);const v=g(t,["thoughtSignature"]);v!=null&&y(n,["thoughtSignature"],v);const x=g(t,["videoMetadata"]);return x!=null&&y(n,["videoMetadata"],x),n}function oC(t){const n={},s=g(t,["retrievalConfig"]);s!=null&&y(n,["retrievalConfig"],s);const r=g(t,["functionCallingConfig"]);return r!=null&&y(n,["functionCallingConfig"],Yw(r)),n}function cC(t){const n={};if(g(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=g(t,["computerUse"]);s!=null&&y(n,["computerUse"],s);const r=g(t,["fileSearch"]);r!=null&&y(n,["fileSearch"],r);const l=g(t,["codeExecution"]);if(l!=null&&y(n,["codeExecution"],l),g(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const c=g(t,["functionDeclarations"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(v=>v)),y(n,["functionDeclarations"],f)}const d=g(t,["googleMaps"]);d!=null&&y(n,["googleMaps"],Zw(d));const u=g(t,["googleSearch"]);u!=null&&y(n,["googleSearch"],eC(u));const h=g(t,["googleSearchRetrieval"]);h!=null&&y(n,["googleSearchRetrieval"],h);const m=g(t,["urlContext"]);return m!=null&&y(n,["urlContext"],m),n}function dC(t){const n={},s=g(t,["retrieval"]);s!=null&&y(n,["retrieval"],s);const r=g(t,["computerUse"]);if(r!=null&&y(n,["computerUse"],r),g(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=g(t,["codeExecution"]);l!=null&&y(n,["codeExecution"],l);const c=g(t,["enterpriseWebSearch"]);c!=null&&y(n,["enterpriseWebSearch"],c);const d=g(t,["functionDeclarations"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(x=>Jw(x))),y(n,["functionDeclarations"],v)}const u=g(t,["googleMaps"]);u!=null&&y(n,["googleMaps"],u);const h=g(t,["googleSearch"]);h!=null&&y(n,["googleSearch"],h);const m=g(t,["googleSearchRetrieval"]);m!=null&&y(n,["googleSearchRetrieval"],m);const f=g(t,["urlContext"]);return f!=null&&y(n,["urlContext"],f),n}function uC(t,n){const s={},r=g(t,["ttl"]);n!==void 0&&r!=null&&y(n,["ttl"],r);const l=g(t,["expireTime"]);return n!==void 0&&l!=null&&y(n,["expireTime"],l),s}function mC(t,n){const s={},r=g(t,["ttl"]);n!==void 0&&r!=null&&y(n,["ttl"],r);const l=g(t,["expireTime"]);return n!==void 0&&l!=null&&y(n,["expireTime"],l),s}function fC(t,n){const s={},r=g(n,["name"]);r!=null&&y(s,["_url","name"],sa(t,r));const l=g(n,["config"]);return l!=null&&uC(l,s),s}function pC(t,n){const s={},r=g(n,["name"]);r!=null&&y(s,["_url","name"],sa(t,r));const l=g(n,["config"]);return l!=null&&mC(l,s),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hC extends na{constructor(n){super(),this.apiClient=n,this.list=async(s={})=>new ar(ta.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(s),s)}async create(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=zw(this.apiClient,n);return u=Ve("cachedContents",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>f)}else{const m=Gw(this.apiClient,n);return u=Ve("cachedContents",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>f)}}async get(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=Qw(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>f)}else{const m=Xw(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>f)}}async delete(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=qw(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=Kw(f),x=new Xx;return Object.assign(x,v),x})}else{const m=Hw(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=Vw(f),x=new Xx;return Object.assign(x,v),x})}}async update(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=pC(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>f)}else{const m=fC(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>f)}}async listInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=aC(n);return u=Ve("cachedContents",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=iC(f),x=new Qx;return Object.assign(x,v),x})}else{const m=sC(n);return u=Ve("cachedContents",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=rC(f),x=new Qx;return Object.assign(x,v),x})}}}function Xo(t,n){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(t);l<r.length;l++)n.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(t,r[l])&&(s[r[l]]=t[r[l]]);return s}function ry(t){var n=typeof Symbol=="function"&&Symbol.iterator,s=n&&t[n],r=0;if(s)return s.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function rt(t){return this instanceof rt?(this.v=t,this):new rt(t)}function ps(t,n,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=s.apply(t,n||[]),l,c=[];return l=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",d),l[Symbol.asyncIterator]=function(){return this},l;function d(S){return function(w){return Promise.resolve(w).then(S,v)}}function u(S,w){r[S]&&(l[S]=function(C){return new Promise(function(T,E){c.push([S,C,T,E])>1||h(S,C)})},w&&(l[S]=w(l[S])))}function h(S,w){try{m(r[S](w))}catch(C){x(c[0][3],C)}}function m(S){S.value instanceof rt?Promise.resolve(S.value.v).then(f,v):x(c[0][2],S)}function f(S){h("next",S)}function v(S){h("throw",S)}function x(S,w){S(w),c.shift(),c.length&&h(c[0][0],c[0][1])}}function hs(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],s;return n?n.call(t):(t=typeof ry=="function"?ry(t):t[Symbol.iterator](),s={},r("next"),r("throw"),r("return"),s[Symbol.asyncIterator]=function(){return this},s);function r(c){s[c]=t[c]&&function(d){return new Promise(function(u,h){d=t[c](d),l(u,h,d.done,d.value)})}}function l(c,d,u,h){Promise.resolve(h).then(function(m){c({value:m,done:u})},d)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gC(t){var n;if(t.candidates==null||t.candidates.length===0)return!1;const s=(n=t.candidates[0])===null||n===void 0?void 0:n.content;return s===void 0?!1:j0(s)}function j0(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const n of t.parts)if(n===void 0||Object.keys(n).length===0)return!1;return!0}function xC(t){if(t.length!==0){for(const n of t)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function iy(t){if(t===void 0||t.length===0)return[];const n=[],s=t.length;let r=0;for(;r<s;)if(t[r].role==="user")n.push(t[r]),r++;else{const l=[];let c=!0;for(;r<s&&t[r].role==="model";)l.push(t[r]),c&&!j0(t[r])&&(c=!1),r++;c?n.push(...l):n.pop()}return n}class yC{constructor(n,s){this.modelsModule=n,this.apiClient=s}create(n){return new vC(this.apiClient,this.modelsModule,n.model,n.config,structuredClone(n.history))}}class vC{constructor(n,s,r,l={},c=[]){this.apiClient=n,this.modelsModule=s,this.model=r,this.config=l,this.history=c,this.sendPromise=Promise.resolve(),xC(c)}async sendMessage(n){var s;await this.sendPromise;const r=hn(n.message),l=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(s=n.config)!==null&&s!==void 0?s:this.config});return this.sendPromise=(async()=>{var c,d,u;const h=await l,m=(d=(c=h.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content,f=h.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let x=[];f!=null&&(x=(u=f.slice(v))!==null&&u!==void 0?u:[]);const S=m?[m]:[];this.recordHistory(r,S,x)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),l}async sendMessageStream(n){var s;await this.sendPromise;const r=hn(n.message),l=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(s=n.config)!==null&&s!==void 0?s:this.config});this.sendPromise=l.then(()=>{}).catch(()=>{});const c=await l;return this.processStreamResponse(c,r)}getHistory(n=!1){const s=n?iy(this.history):this.history;return structuredClone(s)}processStreamResponse(n,s){return ps(this,arguments,function*(){var l,c,d,u,h,m;const f=[];try{for(var v=!0,x=hs(n),S;S=yield rt(x.next()),l=S.done,!l;v=!0){u=S.value,v=!1;const w=u;if(gC(w)){const C=(m=(h=w.candidates)===null||h===void 0?void 0:h[0])===null||m===void 0?void 0:m.content;C!==void 0&&f.push(C)}yield yield rt(w)}}catch(w){c={error:w}}finally{try{!v&&!l&&(d=x.return)&&(yield rt(d.call(x)))}finally{if(c)throw c.error}}this.recordHistory(s,f)})}recordHistory(n,s,r){let l=[];s.length>0&&s.every(c=>c.role!==void 0)?l=s:l.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...iy(r)):this.history.push(n),this.history.push(...l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class il extends Error{constructor(n){super(n.message),this.name="ApiError",this.status=n.status,Object.setPrototypeOf(this,il.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bC(t){const n={},s=g(t,["file"]);return s!=null&&y(n,["file"],s),n}function NC(t){const n={},s=g(t,["sdkHttpResponse"]);return s!=null&&y(n,["sdkHttpResponse"],s),n}function SC(t){const n={},s=g(t,["name"]);return s!=null&&y(n,["_url","file"],g0(s)),n}function jC(t){const n={},s=g(t,["sdkHttpResponse"]);return s!=null&&y(n,["sdkHttpResponse"],s),n}function TC(t){const n={},s=g(t,["name"]);return s!=null&&y(n,["_url","file"],g0(s)),n}function wC(t){const n={},s=g(t,["uris"]);return s!=null&&y(n,["uris"],s),n}function CC(t,n){const s={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&y(n,["_query","pageSize"],r);const l=g(t,["pageToken"]);return n!==void 0&&l!=null&&y(n,["_query","pageToken"],l),s}function EC(t){const n={},s=g(t,["config"]);return s!=null&&CC(s,n),n}function IC(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["nextPageToken"]);r!=null&&y(n,["nextPageToken"],r);const l=g(t,["files"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(n,["files"],c)}return n}function _C(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["files"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),y(n,["files"],l)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AC extends na{constructor(n){super(),this.apiClient=n,this.list=async(s={})=>new ar(ta.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(s),s)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(s=>s)}async download(n){await this.apiClient.downloadFile(n)}async registerFiles(n){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(n){return this.registerFilesInternal(n)}async listInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=EC(n);return c=Ve("files",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const f=m;return f.sdkHttpResponse={headers:h.headers},f})),l.then(h=>{const m=IC(h),f=new AT;return Object.assign(f,m),f})}}async createInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=bC(n);return c=Ve("upload/v1beta/files",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=NC(h),f=new DT;return Object.assign(f,m),f})}}async get(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=TC(n);return c=Ve("files/{file}",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>h)}}async delete(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=SC(n);return c=Ve("files/{file}",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const f=m;return f.sdkHttpResponse={headers:h.headers},f})),l.then(h=>{const m=jC(h),f=new kT;return Object.assign(f,m),f})}}async registerFilesInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=wC(n);return c=Ve("files:register",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=_C(h),f=new RT;return Object.assign(f,m),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ho(t){const n={},s=g(t,["data"]);if(s!=null&&y(n,["data"],s),g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function DC(t){const n={},s=g(t,["parts"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>$C(c))),y(n,["parts"],l)}const r=g(t,["role"]);return r!=null&&y(n,["role"],r),n}function kC(t){const n={};if(g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=g(t,["fileUri"]);s!=null&&y(n,["fileUri"],s);const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function RC(t){const n={},s=g(t,["id"]);s!=null&&y(n,["id"],s);const r=g(t,["args"]);r!=null&&y(n,["args"],r);const l=g(t,["name"]);if(l!=null&&y(n,["name"],l),g(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function MC(t){const n={},s=g(t,["description"]);s!=null&&y(n,["description"],s);const r=g(t,["name"]);r!=null&&y(n,["name"],r);const l=g(t,["parameters"]);l!=null&&y(n,["parameters"],l);const c=g(t,["parametersJsonSchema"]);c!=null&&y(n,["parametersJsonSchema"],c);const d=g(t,["response"]);d!=null&&y(n,["response"],d);const u=g(t,["responseJsonSchema"]);if(u!=null&&y(n,["responseJsonSchema"],u),g(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return n}function PC(t){const n={},s=g(t,["modelSelectionConfig"]);s!=null&&y(n,["modelConfig"],s);const r=g(t,["responseJsonSchema"]);r!=null&&y(n,["responseJsonSchema"],r);const l=g(t,["audioTimestamp"]);l!=null&&y(n,["audioTimestamp"],l);const c=g(t,["candidateCount"]);c!=null&&y(n,["candidateCount"],c);const d=g(t,["enableAffectiveDialog"]);d!=null&&y(n,["enableAffectiveDialog"],d);const u=g(t,["frequencyPenalty"]);u!=null&&y(n,["frequencyPenalty"],u);const h=g(t,["logprobs"]);h!=null&&y(n,["logprobs"],h);const m=g(t,["maxOutputTokens"]);m!=null&&y(n,["maxOutputTokens"],m);const f=g(t,["mediaResolution"]);f!=null&&y(n,["mediaResolution"],f);const v=g(t,["presencePenalty"]);v!=null&&y(n,["presencePenalty"],v);const x=g(t,["responseLogprobs"]);x!=null&&y(n,["responseLogprobs"],x);const S=g(t,["responseMimeType"]);S!=null&&y(n,["responseMimeType"],S);const w=g(t,["responseModalities"]);w!=null&&y(n,["responseModalities"],w);const C=g(t,["responseSchema"]);C!=null&&y(n,["responseSchema"],C);const T=g(t,["routingConfig"]);T!=null&&y(n,["routingConfig"],T);const E=g(t,["seed"]);E!=null&&y(n,["seed"],E);const R=g(t,["speechConfig"]);R!=null&&y(n,["speechConfig"],R);const _=g(t,["stopSequences"]);_!=null&&y(n,["stopSequences"],_);const D=g(t,["temperature"]);D!=null&&y(n,["temperature"],D);const M=g(t,["thinkingConfig"]);M!=null&&y(n,["thinkingConfig"],M);const I=g(t,["topK"]);I!=null&&y(n,["topK"],I);const O=g(t,["topP"]);if(O!=null&&y(n,["topP"],O),g(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function LC(t){const n={};if(g(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=g(t,["enableWidget"]);return s!=null&&y(n,["enableWidget"],s),n}function OC(t){const n={};if(g(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=g(t,["timeRangeFilter"]);return s!=null&&y(n,["timeRangeFilter"],s),n}function UC(t,n){const s={},r=g(t,["generationConfig"]);n!==void 0&&r!=null&&y(n,["setup","generationConfig"],r);const l=g(t,["responseModalities"]);n!==void 0&&l!=null&&y(n,["setup","generationConfig","responseModalities"],l);const c=g(t,["temperature"]);n!==void 0&&c!=null&&y(n,["setup","generationConfig","temperature"],c);const d=g(t,["topP"]);n!==void 0&&d!=null&&y(n,["setup","generationConfig","topP"],d);const u=g(t,["topK"]);n!==void 0&&u!=null&&y(n,["setup","generationConfig","topK"],u);const h=g(t,["maxOutputTokens"]);n!==void 0&&h!=null&&y(n,["setup","generationConfig","maxOutputTokens"],h);const m=g(t,["mediaResolution"]);n!==void 0&&m!=null&&y(n,["setup","generationConfig","mediaResolution"],m);const f=g(t,["seed"]);n!==void 0&&f!=null&&y(n,["setup","generationConfig","seed"],f);const v=g(t,["speechConfig"]);n!==void 0&&v!=null&&y(n,["setup","generationConfig","speechConfig"],Em(v));const x=g(t,["thinkingConfig"]);n!==void 0&&x!=null&&y(n,["setup","generationConfig","thinkingConfig"],x);const S=g(t,["enableAffectiveDialog"]);n!==void 0&&S!=null&&y(n,["setup","generationConfig","enableAffectiveDialog"],S);const w=g(t,["systemInstruction"]);n!==void 0&&w!=null&&y(n,["setup","systemInstruction"],DC(hn(w)));const C=g(t,["tools"]);if(n!==void 0&&C!=null){let I=$r(C);Array.isArray(I)&&(I=I.map(O=>YC(Kr(O)))),y(n,["setup","tools"],I)}const T=g(t,["sessionResumption"]);n!==void 0&&T!=null&&y(n,["setup","sessionResumption"],WC(T));const E=g(t,["inputAudioTranscription"]);n!==void 0&&E!=null&&y(n,["setup","inputAudioTranscription"],E);const R=g(t,["outputAudioTranscription"]);n!==void 0&&R!=null&&y(n,["setup","outputAudioTranscription"],R);const _=g(t,["realtimeInputConfig"]);n!==void 0&&_!=null&&y(n,["setup","realtimeInputConfig"],_);const D=g(t,["contextWindowCompression"]);n!==void 0&&D!=null&&y(n,["setup","contextWindowCompression"],D);const M=g(t,["proactivity"]);if(n!==void 0&&M!=null&&y(n,["setup","proactivity"],M),g(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return s}function FC(t,n){const s={},r=g(t,["generationConfig"]);n!==void 0&&r!=null&&y(n,["setup","generationConfig"],PC(r));const l=g(t,["responseModalities"]);n!==void 0&&l!=null&&y(n,["setup","generationConfig","responseModalities"],l);const c=g(t,["temperature"]);n!==void 0&&c!=null&&y(n,["setup","generationConfig","temperature"],c);const d=g(t,["topP"]);n!==void 0&&d!=null&&y(n,["setup","generationConfig","topP"],d);const u=g(t,["topK"]);n!==void 0&&u!=null&&y(n,["setup","generationConfig","topK"],u);const h=g(t,["maxOutputTokens"]);n!==void 0&&h!=null&&y(n,["setup","generationConfig","maxOutputTokens"],h);const m=g(t,["mediaResolution"]);n!==void 0&&m!=null&&y(n,["setup","generationConfig","mediaResolution"],m);const f=g(t,["seed"]);n!==void 0&&f!=null&&y(n,["setup","generationConfig","seed"],f);const v=g(t,["speechConfig"]);n!==void 0&&v!=null&&y(n,["setup","generationConfig","speechConfig"],Em(v));const x=g(t,["thinkingConfig"]);n!==void 0&&x!=null&&y(n,["setup","generationConfig","thinkingConfig"],x);const S=g(t,["enableAffectiveDialog"]);n!==void 0&&S!=null&&y(n,["setup","generationConfig","enableAffectiveDialog"],S);const w=g(t,["systemInstruction"]);n!==void 0&&w!=null&&y(n,["setup","systemInstruction"],hn(w));const C=g(t,["tools"]);if(n!==void 0&&C!=null){let O=$r(C);Array.isArray(O)&&(O=O.map(A=>JC(Kr(A)))),y(n,["setup","tools"],O)}const T=g(t,["sessionResumption"]);n!==void 0&&T!=null&&y(n,["setup","sessionResumption"],T);const E=g(t,["inputAudioTranscription"]);n!==void 0&&E!=null&&y(n,["setup","inputAudioTranscription"],E);const R=g(t,["outputAudioTranscription"]);n!==void 0&&R!=null&&y(n,["setup","outputAudioTranscription"],R);const _=g(t,["realtimeInputConfig"]);n!==void 0&&_!=null&&y(n,["setup","realtimeInputConfig"],_);const D=g(t,["contextWindowCompression"]);n!==void 0&&D!=null&&y(n,["setup","contextWindowCompression"],D);const M=g(t,["proactivity"]);n!==void 0&&M!=null&&y(n,["setup","proactivity"],M);const I=g(t,["explicitVadSignal"]);return n!==void 0&&I!=null&&y(n,["setup","explicitVadSignal"],I),s}function BC(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["setup","model"],Tt(t,r));const l=g(n,["config"]);return l!=null&&y(s,["config"],UC(l,s)),s}function GC(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["setup","model"],Tt(t,r));const l=g(n,["config"]);return l!=null&&y(s,["config"],FC(l,s)),s}function zC(t){const n={},s=g(t,["musicGenerationConfig"]);return s!=null&&y(n,["musicGenerationConfig"],s),n}function HC(t){const n={},s=g(t,["weightedPrompts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(l=>l)),y(n,["weightedPrompts"],r)}return n}function qC(t){const n={},s=g(t,["media"]);if(s!=null){let m=u0(s);Array.isArray(m)&&(m=m.map(f=>Ho(f))),y(n,["mediaChunks"],m)}const r=g(t,["audio"]);r!=null&&y(n,["audio"],Ho(f0(r)));const l=g(t,["audioStreamEnd"]);l!=null&&y(n,["audioStreamEnd"],l);const c=g(t,["video"]);c!=null&&y(n,["video"],Ho(m0(c)));const d=g(t,["text"]);d!=null&&y(n,["text"],d);const u=g(t,["activityStart"]);u!=null&&y(n,["activityStart"],u);const h=g(t,["activityEnd"]);return h!=null&&y(n,["activityEnd"],h),n}function VC(t){const n={},s=g(t,["media"]);if(s!=null){let m=u0(s);Array.isArray(m)&&(m=m.map(f=>f)),y(n,["mediaChunks"],m)}const r=g(t,["audio"]);r!=null&&y(n,["audio"],f0(r));const l=g(t,["audioStreamEnd"]);l!=null&&y(n,["audioStreamEnd"],l);const c=g(t,["video"]);c!=null&&y(n,["video"],m0(c));const d=g(t,["text"]);d!=null&&y(n,["text"],d);const u=g(t,["activityStart"]);u!=null&&y(n,["activityStart"],u);const h=g(t,["activityEnd"]);return h!=null&&y(n,["activityEnd"],h),n}function KC(t){const n={},s=g(t,["setupComplete"]);s!=null&&y(n,["setupComplete"],s);const r=g(t,["serverContent"]);r!=null&&y(n,["serverContent"],r);const l=g(t,["toolCall"]);l!=null&&y(n,["toolCall"],l);const c=g(t,["toolCallCancellation"]);c!=null&&y(n,["toolCallCancellation"],c);const d=g(t,["usageMetadata"]);d!=null&&y(n,["usageMetadata"],XC(d));const u=g(t,["goAway"]);u!=null&&y(n,["goAway"],u);const h=g(t,["sessionResumptionUpdate"]);h!=null&&y(n,["sessionResumptionUpdate"],h);const m=g(t,["voiceActivityDetectionSignal"]);m!=null&&y(n,["voiceActivityDetectionSignal"],m);const f=g(t,["voiceActivity"]);return f!=null&&y(n,["voiceActivity"],QC(f)),n}function $C(t){const n={},s=g(t,["mediaResolution"]);s!=null&&y(n,["mediaResolution"],s);const r=g(t,["codeExecutionResult"]);r!=null&&y(n,["codeExecutionResult"],r);const l=g(t,["executableCode"]);l!=null&&y(n,["executableCode"],l);const c=g(t,["fileData"]);c!=null&&y(n,["fileData"],kC(c));const d=g(t,["functionCall"]);d!=null&&y(n,["functionCall"],RC(d));const u=g(t,["functionResponse"]);u!=null&&y(n,["functionResponse"],u);const h=g(t,["inlineData"]);h!=null&&y(n,["inlineData"],Ho(h));const m=g(t,["text"]);m!=null&&y(n,["text"],m);const f=g(t,["thought"]);f!=null&&y(n,["thought"],f);const v=g(t,["thoughtSignature"]);v!=null&&y(n,["thoughtSignature"],v);const x=g(t,["videoMetadata"]);return x!=null&&y(n,["videoMetadata"],x),n}function WC(t){const n={},s=g(t,["handle"]);if(s!=null&&y(n,["handle"],s),g(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function YC(t){const n={};if(g(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=g(t,["computerUse"]);s!=null&&y(n,["computerUse"],s);const r=g(t,["fileSearch"]);r!=null&&y(n,["fileSearch"],r);const l=g(t,["codeExecution"]);if(l!=null&&y(n,["codeExecution"],l),g(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const c=g(t,["functionDeclarations"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(v=>v)),y(n,["functionDeclarations"],f)}const d=g(t,["googleMaps"]);d!=null&&y(n,["googleMaps"],LC(d));const u=g(t,["googleSearch"]);u!=null&&y(n,["googleSearch"],OC(u));const h=g(t,["googleSearchRetrieval"]);h!=null&&y(n,["googleSearchRetrieval"],h);const m=g(t,["urlContext"]);return m!=null&&y(n,["urlContext"],m),n}function JC(t){const n={},s=g(t,["retrieval"]);s!=null&&y(n,["retrieval"],s);const r=g(t,["computerUse"]);if(r!=null&&y(n,["computerUse"],r),g(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=g(t,["codeExecution"]);l!=null&&y(n,["codeExecution"],l);const c=g(t,["enterpriseWebSearch"]);c!=null&&y(n,["enterpriseWebSearch"],c);const d=g(t,["functionDeclarations"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(x=>MC(x))),y(n,["functionDeclarations"],v)}const u=g(t,["googleMaps"]);u!=null&&y(n,["googleMaps"],u);const h=g(t,["googleSearch"]);h!=null&&y(n,["googleSearch"],h);const m=g(t,["googleSearchRetrieval"]);m!=null&&y(n,["googleSearchRetrieval"],m);const f=g(t,["urlContext"]);return f!=null&&y(n,["urlContext"],f),n}function XC(t){const n={},s=g(t,["promptTokenCount"]);s!=null&&y(n,["promptTokenCount"],s);const r=g(t,["cachedContentTokenCount"]);r!=null&&y(n,["cachedContentTokenCount"],r);const l=g(t,["candidatesTokenCount"]);l!=null&&y(n,["responseTokenCount"],l);const c=g(t,["toolUsePromptTokenCount"]);c!=null&&y(n,["toolUsePromptTokenCount"],c);const d=g(t,["thoughtsTokenCount"]);d!=null&&y(n,["thoughtsTokenCount"],d);const u=g(t,["totalTokenCount"]);u!=null&&y(n,["totalTokenCount"],u);const h=g(t,["promptTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(w=>w)),y(n,["promptTokensDetails"],S)}const m=g(t,["cacheTokensDetails"]);if(m!=null){let S=m;Array.isArray(S)&&(S=S.map(w=>w)),y(n,["cacheTokensDetails"],S)}const f=g(t,["candidatesTokensDetails"]);if(f!=null){let S=f;Array.isArray(S)&&(S=S.map(w=>w)),y(n,["responseTokensDetails"],S)}const v=g(t,["toolUsePromptTokensDetails"]);if(v!=null){let S=v;Array.isArray(S)&&(S=S.map(w=>w)),y(n,["toolUsePromptTokensDetails"],S)}const x=g(t,["trafficType"]);return x!=null&&y(n,["trafficType"],x),n}function QC(t){const n={},s=g(t,["type"]);return s!=null&&y(n,["voiceActivityType"],s),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZC(t,n){const s={},r=g(t,["data"]);if(r!=null&&y(s,["data"],r),g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const l=g(t,["mimeType"]);return l!=null&&y(s,["mimeType"],l),s}function eE(t,n){const s={},r=g(t,["content"]);r!=null&&y(s,["content"],r);const l=g(t,["citationMetadata"]);l!=null&&y(s,["citationMetadata"],tE(l));const c=g(t,["tokenCount"]);c!=null&&y(s,["tokenCount"],c);const d=g(t,["finishReason"]);d!=null&&y(s,["finishReason"],d);const u=g(t,["avgLogprobs"]);u!=null&&y(s,["avgLogprobs"],u);const h=g(t,["groundingMetadata"]);h!=null&&y(s,["groundingMetadata"],h);const m=g(t,["index"]);m!=null&&y(s,["index"],m);const f=g(t,["logprobsResult"]);f!=null&&y(s,["logprobsResult"],f);const v=g(t,["safetyRatings"]);if(v!=null){let S=v;Array.isArray(S)&&(S=S.map(w=>w)),y(s,["safetyRatings"],S)}const x=g(t,["urlContextMetadata"]);return x!=null&&y(s,["urlContextMetadata"],x),s}function tE(t,n){const s={},r=g(t,["citationSources"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),y(s,["citations"],l)}return s}function nE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["contents"]);if(c!=null){let d=$n(c);Array.isArray(d)&&(d=d.map(u=>u)),y(r,["contents"],d)}return r}function sE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["tokensInfo"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(s,["tokensInfo"],c)}return s}function aE(t,n){const s={},r=g(t,["values"]);r!=null&&y(s,["values"],r);const l=g(t,["statistics"]);return l!=null&&y(s,["statistics"],rE(l)),s}function rE(t,n){const s={},r=g(t,["truncated"]);r!=null&&y(s,["truncated"],r);const l=g(t,["token_count"]);return l!=null&&y(s,["tokenCount"],l),s}function cl(t,n){const s={},r=g(t,["parts"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>pI(d))),y(s,["parts"],c)}const l=g(t,["role"]);return l!=null&&y(s,["role"],l),s}function iE(t,n){const s={},r=g(t,["controlType"]);r!=null&&y(s,["controlType"],r);const l=g(t,["enableControlImageComputation"]);return l!=null&&y(s,["computeControl"],l),s}function lE(t,n){const s={};if(g(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return s}function oE(t,n,s){const r={},l=g(t,["systemInstruction"]);n!==void 0&&l!=null&&y(n,["systemInstruction"],hn(l));const c=g(t,["tools"]);if(n!==void 0&&c!=null){let u=c;Array.isArray(u)&&(u=u.map(h=>E0(h))),y(n,["tools"],u)}const d=g(t,["generationConfig"]);return n!==void 0&&d!=null&&y(n,["generationConfig"],ZE(d)),r}function cE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["contents"]);if(c!=null){let u=$n(c);Array.isArray(u)&&(u=u.map(h=>cl(h))),y(r,["contents"],u)}const d=g(n,["config"]);return d!=null&&lE(d),r}function dE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["contents"]);if(c!=null){let u=$n(c);Array.isArray(u)&&(u=u.map(h=>h)),y(r,["contents"],u)}const d=g(n,["config"]);return d!=null&&oE(d,r),r}function uE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["totalTokens"]);l!=null&&y(s,["totalTokens"],l);const c=g(t,["cachedContentTokenCount"]);return c!=null&&y(s,["cachedContentTokenCount"],c),s}function mE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["totalTokens"]);return l!=null&&y(s,["totalTokens"],l),s}function fE(t,n,s){const r={},l=g(n,["model"]);return l!=null&&y(r,["_url","name"],Tt(t,l)),r}function pE(t,n,s){const r={},l=g(n,["model"]);return l!=null&&y(r,["_url","name"],Tt(t,l)),r}function hE(t,n){const s={},r=g(t,["sdkHttpResponse"]);return r!=null&&y(s,["sdkHttpResponse"],r),s}function gE(t,n){const s={},r=g(t,["sdkHttpResponse"]);return r!=null&&y(s,["sdkHttpResponse"],r),s}function xE(t,n,s){const r={},l=g(t,["outputGcsUri"]);n!==void 0&&l!=null&&y(n,["parameters","storageUri"],l);const c=g(t,["negativePrompt"]);n!==void 0&&c!=null&&y(n,["parameters","negativePrompt"],c);const d=g(t,["numberOfImages"]);n!==void 0&&d!=null&&y(n,["parameters","sampleCount"],d);const u=g(t,["aspectRatio"]);n!==void 0&&u!=null&&y(n,["parameters","aspectRatio"],u);const h=g(t,["guidanceScale"]);n!==void 0&&h!=null&&y(n,["parameters","guidanceScale"],h);const m=g(t,["seed"]);n!==void 0&&m!=null&&y(n,["parameters","seed"],m);const f=g(t,["safetyFilterLevel"]);n!==void 0&&f!=null&&y(n,["parameters","safetySetting"],f);const v=g(t,["personGeneration"]);n!==void 0&&v!=null&&y(n,["parameters","personGeneration"],v);const x=g(t,["includeSafetyAttributes"]);n!==void 0&&x!=null&&y(n,["parameters","includeSafetyAttributes"],x);const S=g(t,["includeRaiReason"]);n!==void 0&&S!=null&&y(n,["parameters","includeRaiReason"],S);const w=g(t,["language"]);n!==void 0&&w!=null&&y(n,["parameters","language"],w);const C=g(t,["outputMimeType"]);n!==void 0&&C!=null&&y(n,["parameters","outputOptions","mimeType"],C);const T=g(t,["outputCompressionQuality"]);n!==void 0&&T!=null&&y(n,["parameters","outputOptions","compressionQuality"],T);const E=g(t,["addWatermark"]);n!==void 0&&E!=null&&y(n,["parameters","addWatermark"],E);const R=g(t,["labels"]);n!==void 0&&R!=null&&y(n,["labels"],R);const _=g(t,["editMode"]);n!==void 0&&_!=null&&y(n,["parameters","editMode"],_);const D=g(t,["baseSteps"]);return n!==void 0&&D!=null&&y(n,["parameters","editConfig","baseSteps"],D),r}function yE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["prompt"]);c!=null&&y(r,["instances[0]","prompt"],c);const d=g(n,["referenceImages"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(m=>bI(m))),y(r,["instances[0]","referenceImages"],h)}const u=g(n,["config"]);return u!=null&&xE(u,r),r}function vE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["predictions"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>ac(d))),y(s,["generatedImages"],c)}return s}function bE(t,n,s){const r={},l=g(t,["taskType"]);n!==void 0&&l!=null&&y(n,["requests[]","taskType"],l);const c=g(t,["title"]);n!==void 0&&c!=null&&y(n,["requests[]","title"],c);const d=g(t,["outputDimensionality"]);if(n!==void 0&&d!=null&&y(n,["requests[]","outputDimensionality"],d),g(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function NE(t,n,s){const r={};let l=g(s,["embeddingApiType"]);if(l===void 0&&(l="PREDICT"),l==="PREDICT"){const m=g(t,["taskType"]);n!==void 0&&m!=null&&y(n,["instances[]","task_type"],m)}else if(l==="EMBED_CONTENT"){const m=g(t,["taskType"]);n!==void 0&&m!=null&&y(n,["taskType"],m)}let c=g(s,["embeddingApiType"]);if(c===void 0&&(c="PREDICT"),c==="PREDICT"){const m=g(t,["title"]);n!==void 0&&m!=null&&y(n,["instances[]","title"],m)}else if(c==="EMBED_CONTENT"){const m=g(t,["title"]);n!==void 0&&m!=null&&y(n,["title"],m)}let d=g(s,["embeddingApiType"]);if(d===void 0&&(d="PREDICT"),d==="PREDICT"){const m=g(t,["outputDimensionality"]);n!==void 0&&m!=null&&y(n,["parameters","outputDimensionality"],m)}else if(d==="EMBED_CONTENT"){const m=g(t,["outputDimensionality"]);n!==void 0&&m!=null&&y(n,["outputDimensionality"],m)}let u=g(s,["embeddingApiType"]);if(u===void 0&&(u="PREDICT"),u==="PREDICT"){const m=g(t,["mimeType"]);n!==void 0&&m!=null&&y(n,["instances[]","mimeType"],m)}let h=g(s,["embeddingApiType"]);if(h===void 0&&(h="PREDICT"),h==="PREDICT"){const m=g(t,["autoTruncate"]);n!==void 0&&m!=null&&y(n,["parameters","autoTruncate"],m)}else if(h==="EMBED_CONTENT"){const m=g(t,["autoTruncate"]);n!==void 0&&m!=null&&y(n,["autoTruncate"],m)}return r}function SE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["contents"]);if(c!=null){let m=Tm(t,c);Array.isArray(m)&&(m=m.map(f=>f)),y(r,["requests[]","content"],m)}const d=g(n,["content"]);d!=null&&cl(hn(d));const u=g(n,["config"]);u!=null&&bE(u,r);const h=g(n,["model"]);return h!==void 0&&y(r,["requests[]","model"],Tt(t,h)),r}function jE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));let c=g(s,["embeddingApiType"]);if(c===void 0&&(c="PREDICT"),c==="PREDICT"){const h=g(n,["contents"]);if(h!=null){let m=Tm(t,h);Array.isArray(m)&&(m=m.map(f=>f)),y(r,["instances[]","content"],m)}}let d=g(s,["embeddingApiType"]);if(d===void 0&&(d="PREDICT"),d==="EMBED_CONTENT"){const h=g(n,["content"]);h!=null&&y(r,["content"],hn(h))}const u=g(n,["config"]);return u!=null&&NE(u,r,s),r}function TE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["embeddings"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(u=>u)),y(s,["embeddings"],d)}const c=g(t,["metadata"]);return c!=null&&y(s,["metadata"],c),s}function wE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["predictions[]","embeddings"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(u=>aE(u))),y(s,["embeddings"],d)}const c=g(t,["metadata"]);if(c!=null&&y(s,["metadata"],c),n&&g(n,["embeddingApiType"])==="EMBED_CONTENT"){const d=g(t,["embedding"]),u=g(t,["usageMetadata"]),h=g(t,["truncated"]);if(d){const m={};u&&u.promptTokenCount&&(m.tokenCount=u.promptTokenCount),h&&(m.truncated=h),d.statistics=m,y(s,["embeddings"],[d])}}return s}function CE(t,n){const s={},r=g(t,["endpoint"]);r!=null&&y(s,["name"],r);const l=g(t,["deployedModelId"]);return l!=null&&y(s,["deployedModelId"],l),s}function EE(t,n){const s={};if(g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(t,["fileUri"]);r!=null&&y(s,["fileUri"],r);const l=g(t,["mimeType"]);return l!=null&&y(s,["mimeType"],l),s}function IE(t,n){const s={},r=g(t,["id"]);r!=null&&y(s,["id"],r);const l=g(t,["args"]);l!=null&&y(s,["args"],l);const c=g(t,["name"]);if(c!=null&&y(s,["name"],c),g(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return s}function _E(t,n){const s={},r=g(t,["allowedFunctionNames"]);r!=null&&y(s,["allowedFunctionNames"],r);const l=g(t,["mode"]);if(l!=null&&y(s,["mode"],l),g(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return s}function AE(t,n){const s={},r=g(t,["description"]);r!=null&&y(s,["description"],r);const l=g(t,["name"]);l!=null&&y(s,["name"],l);const c=g(t,["parameters"]);c!=null&&y(s,["parameters"],c);const d=g(t,["parametersJsonSchema"]);d!=null&&y(s,["parametersJsonSchema"],d);const u=g(t,["response"]);u!=null&&y(s,["response"],u);const h=g(t,["responseJsonSchema"]);if(h!=null&&y(s,["responseJsonSchema"],h),g(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return s}function DE(t,n,s,r){const l={},c=g(n,["systemInstruction"]);s!==void 0&&c!=null&&y(s,["systemInstruction"],cl(hn(c)));const d=g(n,["temperature"]);d!=null&&y(l,["temperature"],d);const u=g(n,["topP"]);u!=null&&y(l,["topP"],u);const h=g(n,["topK"]);h!=null&&y(l,["topK"],h);const m=g(n,["candidateCount"]);m!=null&&y(l,["candidateCount"],m);const f=g(n,["maxOutputTokens"]);f!=null&&y(l,["maxOutputTokens"],f);const v=g(n,["stopSequences"]);v!=null&&y(l,["stopSequences"],v);const x=g(n,["responseLogprobs"]);x!=null&&y(l,["responseLogprobs"],x);const S=g(n,["logprobs"]);S!=null&&y(l,["logprobs"],S);const w=g(n,["presencePenalty"]);w!=null&&y(l,["presencePenalty"],w);const C=g(n,["frequencyPenalty"]);C!=null&&y(l,["frequencyPenalty"],C);const T=g(n,["seed"]);T!=null&&y(l,["seed"],T);const E=g(n,["responseMimeType"]);E!=null&&y(l,["responseMimeType"],E);const R=g(n,["responseSchema"]);R!=null&&y(l,["responseSchema"],wm(R));const _=g(n,["responseJsonSchema"]);if(_!=null&&y(l,["responseJsonSchema"],_),g(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const D=g(n,["safetySettings"]);if(s!==void 0&&D!=null){let J=D;Array.isArray(J)&&(J=J.map(W=>NI(W))),y(s,["safetySettings"],J)}const M=g(n,["tools"]);if(s!==void 0&&M!=null){let J=$r(M);Array.isArray(J)&&(J=J.map(W=>II(Kr(W)))),y(s,["tools"],J)}const I=g(n,["toolConfig"]);if(s!==void 0&&I!=null&&y(s,["toolConfig"],EI(I)),g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const O=g(n,["cachedContent"]);s!==void 0&&O!=null&&y(s,["cachedContent"],sa(t,O));const A=g(n,["responseModalities"]);A!=null&&y(l,["responseModalities"],A);const U=g(n,["mediaResolution"]);U!=null&&y(l,["mediaResolution"],U);const P=g(n,["speechConfig"]);if(P!=null&&y(l,["speechConfig"],Cm(P)),g(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const F=g(n,["thinkingConfig"]);F!=null&&y(l,["thinkingConfig"],F);const q=g(n,["imageConfig"]);q!=null&&y(l,["imageConfig"],aI(q));const z=g(n,["enableEnhancedCivicAnswers"]);if(z!=null&&y(l,["enableEnhancedCivicAnswers"],z),g(n,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return l}function kE(t,n,s,r){const l={},c=g(n,["systemInstruction"]);s!==void 0&&c!=null&&y(s,["systemInstruction"],hn(c));const d=g(n,["temperature"]);d!=null&&y(l,["temperature"],d);const u=g(n,["topP"]);u!=null&&y(l,["topP"],u);const h=g(n,["topK"]);h!=null&&y(l,["topK"],h);const m=g(n,["candidateCount"]);m!=null&&y(l,["candidateCount"],m);const f=g(n,["maxOutputTokens"]);f!=null&&y(l,["maxOutputTokens"],f);const v=g(n,["stopSequences"]);v!=null&&y(l,["stopSequences"],v);const x=g(n,["responseLogprobs"]);x!=null&&y(l,["responseLogprobs"],x);const S=g(n,["logprobs"]);S!=null&&y(l,["logprobs"],S);const w=g(n,["presencePenalty"]);w!=null&&y(l,["presencePenalty"],w);const C=g(n,["frequencyPenalty"]);C!=null&&y(l,["frequencyPenalty"],C);const T=g(n,["seed"]);T!=null&&y(l,["seed"],T);const E=g(n,["responseMimeType"]);E!=null&&y(l,["responseMimeType"],E);const R=g(n,["responseSchema"]);R!=null&&y(l,["responseSchema"],wm(R));const _=g(n,["responseJsonSchema"]);_!=null&&y(l,["responseJsonSchema"],_);const D=g(n,["routingConfig"]);D!=null&&y(l,["routingConfig"],D);const M=g(n,["modelSelectionConfig"]);M!=null&&y(l,["modelConfig"],M);const I=g(n,["safetySettings"]);if(s!==void 0&&I!=null){let X=I;Array.isArray(X)&&(X=X.map($=>$)),y(s,["safetySettings"],X)}const O=g(n,["tools"]);if(s!==void 0&&O!=null){let X=$r(O);Array.isArray(X)&&(X=X.map($=>E0(Kr($)))),y(s,["tools"],X)}const A=g(n,["toolConfig"]);s!==void 0&&A!=null&&y(s,["toolConfig"],A);const U=g(n,["labels"]);s!==void 0&&U!=null&&y(s,["labels"],U);const P=g(n,["cachedContent"]);s!==void 0&&P!=null&&y(s,["cachedContent"],sa(t,P));const F=g(n,["responseModalities"]);F!=null&&y(l,["responseModalities"],F);const q=g(n,["mediaResolution"]);q!=null&&y(l,["mediaResolution"],q);const z=g(n,["speechConfig"]);z!=null&&y(l,["speechConfig"],Cm(z));const J=g(n,["audioTimestamp"]);J!=null&&y(l,["audioTimestamp"],J);const W=g(n,["thinkingConfig"]);W!=null&&y(l,["thinkingConfig"],W);const G=g(n,["imageConfig"]);if(G!=null&&y(l,["imageConfig"],rI(G)),g(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const B=g(n,["modelArmorConfig"]);return s!==void 0&&B!=null&&y(s,["modelArmorConfig"],B),l}function ly(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["contents"]);if(c!=null){let u=$n(c);Array.isArray(u)&&(u=u.map(h=>cl(h))),y(r,["contents"],u)}const d=g(n,["config"]);return d!=null&&y(r,["generationConfig"],DE(t,d,r)),r}function oy(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["contents"]);if(c!=null){let u=$n(c);Array.isArray(u)&&(u=u.map(h=>h)),y(r,["contents"],u)}const d=g(n,["config"]);return d!=null&&y(r,["generationConfig"],kE(t,d,r)),r}function cy(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["candidates"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(f=>eE(f))),y(s,["candidates"],m)}const c=g(t,["modelVersion"]);c!=null&&y(s,["modelVersion"],c);const d=g(t,["promptFeedback"]);d!=null&&y(s,["promptFeedback"],d);const u=g(t,["responseId"]);u!=null&&y(s,["responseId"],u);const h=g(t,["usageMetadata"]);return h!=null&&y(s,["usageMetadata"],h),s}function dy(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["candidates"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(v=>v)),y(s,["candidates"],f)}const c=g(t,["createTime"]);c!=null&&y(s,["createTime"],c);const d=g(t,["modelVersion"]);d!=null&&y(s,["modelVersion"],d);const u=g(t,["promptFeedback"]);u!=null&&y(s,["promptFeedback"],u);const h=g(t,["responseId"]);h!=null&&y(s,["responseId"],h);const m=g(t,["usageMetadata"]);return m!=null&&y(s,["usageMetadata"],m),s}function RE(t,n,s){const r={};if(g(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const l=g(t,["numberOfImages"]);n!==void 0&&l!=null&&y(n,["parameters","sampleCount"],l);const c=g(t,["aspectRatio"]);n!==void 0&&c!=null&&y(n,["parameters","aspectRatio"],c);const d=g(t,["guidanceScale"]);if(n!==void 0&&d!=null&&y(n,["parameters","guidanceScale"],d),g(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=g(t,["safetyFilterLevel"]);n!==void 0&&u!=null&&y(n,["parameters","safetySetting"],u);const h=g(t,["personGeneration"]);n!==void 0&&h!=null&&y(n,["parameters","personGeneration"],h);const m=g(t,["includeSafetyAttributes"]);n!==void 0&&m!=null&&y(n,["parameters","includeSafetyAttributes"],m);const f=g(t,["includeRaiReason"]);n!==void 0&&f!=null&&y(n,["parameters","includeRaiReason"],f);const v=g(t,["language"]);n!==void 0&&v!=null&&y(n,["parameters","language"],v);const x=g(t,["outputMimeType"]);n!==void 0&&x!=null&&y(n,["parameters","outputOptions","mimeType"],x);const S=g(t,["outputCompressionQuality"]);if(n!==void 0&&S!=null&&y(n,["parameters","outputOptions","compressionQuality"],S),g(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=g(t,["imageSize"]);if(n!==void 0&&w!=null&&y(n,["parameters","sampleImageSize"],w),g(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function ME(t,n,s){const r={},l=g(t,["outputGcsUri"]);n!==void 0&&l!=null&&y(n,["parameters","storageUri"],l);const c=g(t,["negativePrompt"]);n!==void 0&&c!=null&&y(n,["parameters","negativePrompt"],c);const d=g(t,["numberOfImages"]);n!==void 0&&d!=null&&y(n,["parameters","sampleCount"],d);const u=g(t,["aspectRatio"]);n!==void 0&&u!=null&&y(n,["parameters","aspectRatio"],u);const h=g(t,["guidanceScale"]);n!==void 0&&h!=null&&y(n,["parameters","guidanceScale"],h);const m=g(t,["seed"]);n!==void 0&&m!=null&&y(n,["parameters","seed"],m);const f=g(t,["safetyFilterLevel"]);n!==void 0&&f!=null&&y(n,["parameters","safetySetting"],f);const v=g(t,["personGeneration"]);n!==void 0&&v!=null&&y(n,["parameters","personGeneration"],v);const x=g(t,["includeSafetyAttributes"]);n!==void 0&&x!=null&&y(n,["parameters","includeSafetyAttributes"],x);const S=g(t,["includeRaiReason"]);n!==void 0&&S!=null&&y(n,["parameters","includeRaiReason"],S);const w=g(t,["language"]);n!==void 0&&w!=null&&y(n,["parameters","language"],w);const C=g(t,["outputMimeType"]);n!==void 0&&C!=null&&y(n,["parameters","outputOptions","mimeType"],C);const T=g(t,["outputCompressionQuality"]);n!==void 0&&T!=null&&y(n,["parameters","outputOptions","compressionQuality"],T);const E=g(t,["addWatermark"]);n!==void 0&&E!=null&&y(n,["parameters","addWatermark"],E);const R=g(t,["labels"]);n!==void 0&&R!=null&&y(n,["labels"],R);const _=g(t,["imageSize"]);n!==void 0&&_!=null&&y(n,["parameters","sampleImageSize"],_);const D=g(t,["enhancePrompt"]);return n!==void 0&&D!=null&&y(n,["parameters","enhancePrompt"],D),r}function PE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["prompt"]);c!=null&&y(r,["instances[0]","prompt"],c);const d=g(n,["config"]);return d!=null&&RE(d,r),r}function LE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["prompt"]);c!=null&&y(r,["instances[0]","prompt"],c);const d=g(n,["config"]);return d!=null&&ME(d,r),r}function OE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["predictions"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(u=>YE(u))),y(s,["generatedImages"],d)}const c=g(t,["positivePromptSafetyAttributes"]);return c!=null&&y(s,["positivePromptSafetyAttributes"],w0(c)),s}function UE(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["predictions"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(u=>ac(u))),y(s,["generatedImages"],d)}const c=g(t,["positivePromptSafetyAttributes"]);return c!=null&&y(s,["positivePromptSafetyAttributes"],C0(c)),s}function FE(t,n,s){const r={},l=g(t,["numberOfVideos"]);if(n!==void 0&&l!=null&&y(n,["parameters","sampleCount"],l),g(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const c=g(t,["durationSeconds"]);if(n!==void 0&&c!=null&&y(n,["parameters","durationSeconds"],c),g(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=g(t,["aspectRatio"]);n!==void 0&&d!=null&&y(n,["parameters","aspectRatio"],d);const u=g(t,["resolution"]);n!==void 0&&u!=null&&y(n,["parameters","resolution"],u);const h=g(t,["personGeneration"]);if(n!==void 0&&h!=null&&y(n,["parameters","personGeneration"],h),g(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const m=g(t,["negativePrompt"]);n!==void 0&&m!=null&&y(n,["parameters","negativePrompt"],m);const f=g(t,["enhancePrompt"]);if(n!==void 0&&f!=null&&y(n,["parameters","enhancePrompt"],f),g(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=g(t,["lastFrame"]);n!==void 0&&v!=null&&y(n,["instances[0]","lastFrame"],rc(v));const x=g(t,["referenceImages"]);if(n!==void 0&&x!=null){let S=x;Array.isArray(S)&&(S=S.map(w=>GI(w))),y(n,["instances[0]","referenceImages"],S)}if(g(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return r}function BE(t,n,s){const r={},l=g(t,["numberOfVideos"]);n!==void 0&&l!=null&&y(n,["parameters","sampleCount"],l);const c=g(t,["outputGcsUri"]);n!==void 0&&c!=null&&y(n,["parameters","storageUri"],c);const d=g(t,["fps"]);n!==void 0&&d!=null&&y(n,["parameters","fps"],d);const u=g(t,["durationSeconds"]);n!==void 0&&u!=null&&y(n,["parameters","durationSeconds"],u);const h=g(t,["seed"]);n!==void 0&&h!=null&&y(n,["parameters","seed"],h);const m=g(t,["aspectRatio"]);n!==void 0&&m!=null&&y(n,["parameters","aspectRatio"],m);const f=g(t,["resolution"]);n!==void 0&&f!=null&&y(n,["parameters","resolution"],f);const v=g(t,["personGeneration"]);n!==void 0&&v!=null&&y(n,["parameters","personGeneration"],v);const x=g(t,["pubsubTopic"]);n!==void 0&&x!=null&&y(n,["parameters","pubsubTopic"],x);const S=g(t,["negativePrompt"]);n!==void 0&&S!=null&&y(n,["parameters","negativePrompt"],S);const w=g(t,["enhancePrompt"]);n!==void 0&&w!=null&&y(n,["parameters","enhancePrompt"],w);const C=g(t,["generateAudio"]);n!==void 0&&C!=null&&y(n,["parameters","generateAudio"],C);const T=g(t,["lastFrame"]);n!==void 0&&T!=null&&y(n,["instances[0]","lastFrame"],vs(T));const E=g(t,["referenceImages"]);if(n!==void 0&&E!=null){let D=E;Array.isArray(D)&&(D=D.map(M=>zI(M))),y(n,["instances[0]","referenceImages"],D)}const R=g(t,["mask"]);n!==void 0&&R!=null&&y(n,["instances[0]","mask"],BI(R));const _=g(t,["compressionQuality"]);return n!==void 0&&_!=null&&y(n,["parameters","compressionQuality"],_),r}function GE(t,n){const s={},r=g(t,["name"]);r!=null&&y(s,["name"],r);const l=g(t,["metadata"]);l!=null&&y(s,["metadata"],l);const c=g(t,["done"]);c!=null&&y(s,["done"],c);const d=g(t,["error"]);d!=null&&y(s,["error"],d);const u=g(t,["response","generateVideoResponse"]);return u!=null&&y(s,["response"],VE(u)),s}function zE(t,n){const s={},r=g(t,["name"]);r!=null&&y(s,["name"],r);const l=g(t,["metadata"]);l!=null&&y(s,["metadata"],l);const c=g(t,["done"]);c!=null&&y(s,["done"],c);const d=g(t,["error"]);d!=null&&y(s,["error"],d);const u=g(t,["response"]);return u!=null&&y(s,["response"],KE(u)),s}function HE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["prompt"]);c!=null&&y(r,["instances[0]","prompt"],c);const d=g(n,["image"]);d!=null&&y(r,["instances[0]","image"],rc(d));const u=g(n,["video"]);u!=null&&y(r,["instances[0]","video"],I0(u));const h=g(n,["source"]);h!=null&&$E(h,r);const m=g(n,["config"]);return m!=null&&FE(m,r),r}function qE(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["prompt"]);c!=null&&y(r,["instances[0]","prompt"],c);const d=g(n,["image"]);d!=null&&y(r,["instances[0]","image"],vs(d));const u=g(n,["video"]);u!=null&&y(r,["instances[0]","video"],_0(u));const h=g(n,["source"]);h!=null&&WE(h,r);const m=g(n,["config"]);return m!=null&&BE(m,r),r}function VE(t,n){const s={},r=g(t,["generatedSamples"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(u=>XE(u))),y(s,["generatedVideos"],d)}const l=g(t,["raiMediaFilteredCount"]);l!=null&&y(s,["raiMediaFilteredCount"],l);const c=g(t,["raiMediaFilteredReasons"]);return c!=null&&y(s,["raiMediaFilteredReasons"],c),s}function KE(t,n){const s={},r=g(t,["videos"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(u=>QE(u))),y(s,["generatedVideos"],d)}const l=g(t,["raiMediaFilteredCount"]);l!=null&&y(s,["raiMediaFilteredCount"],l);const c=g(t,["raiMediaFilteredReasons"]);return c!=null&&y(s,["raiMediaFilteredReasons"],c),s}function $E(t,n,s){const r={},l=g(t,["prompt"]);n!==void 0&&l!=null&&y(n,["instances[0]","prompt"],l);const c=g(t,["image"]);n!==void 0&&c!=null&&y(n,["instances[0]","image"],rc(c));const d=g(t,["video"]);return n!==void 0&&d!=null&&y(n,["instances[0]","video"],I0(d)),r}function WE(t,n,s){const r={},l=g(t,["prompt"]);n!==void 0&&l!=null&&y(n,["instances[0]","prompt"],l);const c=g(t,["image"]);n!==void 0&&c!=null&&y(n,["instances[0]","image"],vs(c));const d=g(t,["video"]);return n!==void 0&&d!=null&&y(n,["instances[0]","video"],_0(d)),r}function YE(t,n){const s={},r=g(t,["_self"]);r!=null&&y(s,["image"],iI(r));const l=g(t,["raiFilteredReason"]);l!=null&&y(s,["raiFilteredReason"],l);const c=g(t,["_self"]);return c!=null&&y(s,["safetyAttributes"],w0(c)),s}function ac(t,n){const s={},r=g(t,["_self"]);r!=null&&y(s,["image"],T0(r));const l=g(t,["raiFilteredReason"]);l!=null&&y(s,["raiFilteredReason"],l);const c=g(t,["_self"]);c!=null&&y(s,["safetyAttributes"],C0(c));const d=g(t,["prompt"]);return d!=null&&y(s,["enhancedPrompt"],d),s}function JE(t,n){const s={},r=g(t,["_self"]);r!=null&&y(s,["mask"],T0(r));const l=g(t,["labels"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(s,["labels"],c)}return s}function XE(t,n){const s={},r=g(t,["video"]);return r!=null&&y(s,["video"],UI(r)),s}function QE(t,n){const s={},r=g(t,["_self"]);return r!=null&&y(s,["video"],FI(r)),s}function ZE(t,n){const s={},r=g(t,["modelSelectionConfig"]);r!=null&&y(s,["modelConfig"],r);const l=g(t,["responseJsonSchema"]);l!=null&&y(s,["responseJsonSchema"],l);const c=g(t,["audioTimestamp"]);c!=null&&y(s,["audioTimestamp"],c);const d=g(t,["candidateCount"]);d!=null&&y(s,["candidateCount"],d);const u=g(t,["enableAffectiveDialog"]);u!=null&&y(s,["enableAffectiveDialog"],u);const h=g(t,["frequencyPenalty"]);h!=null&&y(s,["frequencyPenalty"],h);const m=g(t,["logprobs"]);m!=null&&y(s,["logprobs"],m);const f=g(t,["maxOutputTokens"]);f!=null&&y(s,["maxOutputTokens"],f);const v=g(t,["mediaResolution"]);v!=null&&y(s,["mediaResolution"],v);const x=g(t,["presencePenalty"]);x!=null&&y(s,["presencePenalty"],x);const S=g(t,["responseLogprobs"]);S!=null&&y(s,["responseLogprobs"],S);const w=g(t,["responseMimeType"]);w!=null&&y(s,["responseMimeType"],w);const C=g(t,["responseModalities"]);C!=null&&y(s,["responseModalities"],C);const T=g(t,["responseSchema"]);T!=null&&y(s,["responseSchema"],T);const E=g(t,["routingConfig"]);E!=null&&y(s,["routingConfig"],E);const R=g(t,["seed"]);R!=null&&y(s,["seed"],R);const _=g(t,["speechConfig"]);_!=null&&y(s,["speechConfig"],_);const D=g(t,["stopSequences"]);D!=null&&y(s,["stopSequences"],D);const M=g(t,["temperature"]);M!=null&&y(s,["temperature"],M);const I=g(t,["thinkingConfig"]);I!=null&&y(s,["thinkingConfig"],I);const O=g(t,["topK"]);O!=null&&y(s,["topK"],O);const A=g(t,["topP"]);if(A!=null&&y(s,["topP"],A),g(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return s}function eI(t,n,s){const r={},l=g(n,["model"]);return l!=null&&y(r,["_url","name"],Tt(t,l)),r}function tI(t,n,s){const r={},l=g(n,["model"]);return l!=null&&y(r,["_url","name"],Tt(t,l)),r}function nI(t,n){const s={};if(g(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=g(t,["enableWidget"]);return r!=null&&y(s,["enableWidget"],r),s}function sI(t,n){const s={};if(g(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=g(t,["timeRangeFilter"]);return r!=null&&y(s,["timeRangeFilter"],r),s}function aI(t,n){const s={},r=g(t,["aspectRatio"]);r!=null&&y(s,["aspectRatio"],r);const l=g(t,["imageSize"]);if(l!=null&&y(s,["imageSize"],l),g(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(g(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return s}function rI(t,n){const s={},r=g(t,["aspectRatio"]);r!=null&&y(s,["aspectRatio"],r);const l=g(t,["imageSize"]);l!=null&&y(s,["imageSize"],l);const c=g(t,["personGeneration"]);c!=null&&y(s,["personGeneration"],c);const d=g(t,["outputMimeType"]);d!=null&&y(s,["imageOutputOptions","mimeType"],d);const u=g(t,["outputCompressionQuality"]);return u!=null&&y(s,["imageOutputOptions","compressionQuality"],u),s}function iI(t,n){const s={},r=g(t,["bytesBase64Encoded"]);r!=null&&y(s,["imageBytes"],Ma(r));const l=g(t,["mimeType"]);return l!=null&&y(s,["mimeType"],l),s}function T0(t,n){const s={},r=g(t,["gcsUri"]);r!=null&&y(s,["gcsUri"],r);const l=g(t,["bytesBase64Encoded"]);l!=null&&y(s,["imageBytes"],Ma(l));const c=g(t,["mimeType"]);return c!=null&&y(s,["mimeType"],c),s}function rc(t,n){const s={};if(g(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=g(t,["imageBytes"]);r!=null&&y(s,["bytesBase64Encoded"],Ma(r));const l=g(t,["mimeType"]);return l!=null&&y(s,["mimeType"],l),s}function vs(t,n){const s={},r=g(t,["gcsUri"]);r!=null&&y(s,["gcsUri"],r);const l=g(t,["imageBytes"]);l!=null&&y(s,["bytesBase64Encoded"],Ma(l));const c=g(t,["mimeType"]);return c!=null&&y(s,["mimeType"],c),s}function lI(t,n,s,r){const l={},c=g(n,["pageSize"]);s!==void 0&&c!=null&&y(s,["_query","pageSize"],c);const d=g(n,["pageToken"]);s!==void 0&&d!=null&&y(s,["_query","pageToken"],d);const u=g(n,["filter"]);s!==void 0&&u!=null&&y(s,["_query","filter"],u);const h=g(n,["queryBase"]);return s!==void 0&&h!=null&&y(s,["_url","models_url"],x0(t,h)),l}function oI(t,n,s,r){const l={},c=g(n,["pageSize"]);s!==void 0&&c!=null&&y(s,["_query","pageSize"],c);const d=g(n,["pageToken"]);s!==void 0&&d!=null&&y(s,["_query","pageToken"],d);const u=g(n,["filter"]);s!==void 0&&u!=null&&y(s,["_query","filter"],u);const h=g(n,["queryBase"]);return s!==void 0&&h!=null&&y(s,["_url","models_url"],x0(t,h)),l}function cI(t,n,s){const r={},l=g(n,["config"]);return l!=null&&lI(t,l,r),r}function dI(t,n,s){const r={},l=g(n,["config"]);return l!=null&&oI(t,l,r),r}function uI(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["nextPageToken"]);l!=null&&y(s,["nextPageToken"],l);const c=g(t,["_self"]);if(c!=null){let d=y0(c);Array.isArray(d)&&(d=d.map(u=>Zu(u))),y(s,["models"],d)}return s}function mI(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["nextPageToken"]);l!=null&&y(s,["nextPageToken"],l);const c=g(t,["_self"]);if(c!=null){let d=y0(c);Array.isArray(d)&&(d=d.map(u=>em(u))),y(s,["models"],d)}return s}function fI(t,n){const s={},r=g(t,["maskMode"]);r!=null&&y(s,["maskMode"],r);const l=g(t,["segmentationClasses"]);l!=null&&y(s,["maskClasses"],l);const c=g(t,["maskDilation"]);return c!=null&&y(s,["dilation"],c),s}function Zu(t,n){const s={},r=g(t,["name"]);r!=null&&y(s,["name"],r);const l=g(t,["displayName"]);l!=null&&y(s,["displayName"],l);const c=g(t,["description"]);c!=null&&y(s,["description"],c);const d=g(t,["version"]);d!=null&&y(s,["version"],d);const u=g(t,["_self"]);u!=null&&y(s,["tunedModelInfo"],_I(u));const h=g(t,["inputTokenLimit"]);h!=null&&y(s,["inputTokenLimit"],h);const m=g(t,["outputTokenLimit"]);m!=null&&y(s,["outputTokenLimit"],m);const f=g(t,["supportedGenerationMethods"]);f!=null&&y(s,["supportedActions"],f);const v=g(t,["temperature"]);v!=null&&y(s,["temperature"],v);const x=g(t,["maxTemperature"]);x!=null&&y(s,["maxTemperature"],x);const S=g(t,["topP"]);S!=null&&y(s,["topP"],S);const w=g(t,["topK"]);w!=null&&y(s,["topK"],w);const C=g(t,["thinking"]);return C!=null&&y(s,["thinking"],C),s}function em(t,n){const s={},r=g(t,["name"]);r!=null&&y(s,["name"],r);const l=g(t,["displayName"]);l!=null&&y(s,["displayName"],l);const c=g(t,["description"]);c!=null&&y(s,["description"],c);const d=g(t,["versionId"]);d!=null&&y(s,["version"],d);const u=g(t,["deployedModels"]);if(u!=null){let x=u;Array.isArray(x)&&(x=x.map(S=>CE(S))),y(s,["endpoints"],x)}const h=g(t,["labels"]);h!=null&&y(s,["labels"],h);const m=g(t,["_self"]);m!=null&&y(s,["tunedModelInfo"],AI(m));const f=g(t,["defaultCheckpointId"]);f!=null&&y(s,["defaultCheckpointId"],f);const v=g(t,["checkpoints"]);if(v!=null){let x=v;Array.isArray(x)&&(x=x.map(S=>S)),y(s,["checkpoints"],x)}return s}function pI(t,n){const s={},r=g(t,["mediaResolution"]);r!=null&&y(s,["mediaResolution"],r);const l=g(t,["codeExecutionResult"]);l!=null&&y(s,["codeExecutionResult"],l);const c=g(t,["executableCode"]);c!=null&&y(s,["executableCode"],c);const d=g(t,["fileData"]);d!=null&&y(s,["fileData"],EE(d));const u=g(t,["functionCall"]);u!=null&&y(s,["functionCall"],IE(u));const h=g(t,["functionResponse"]);h!=null&&y(s,["functionResponse"],h);const m=g(t,["inlineData"]);m!=null&&y(s,["inlineData"],ZC(m));const f=g(t,["text"]);f!=null&&y(s,["text"],f);const v=g(t,["thought"]);v!=null&&y(s,["thought"],v);const x=g(t,["thoughtSignature"]);x!=null&&y(s,["thoughtSignature"],x);const S=g(t,["videoMetadata"]);return S!=null&&y(s,["videoMetadata"],S),s}function hI(t,n){const s={},r=g(t,["productImage"]);return r!=null&&y(s,["image"],vs(r)),s}function gI(t,n,s){const r={},l=g(t,["numberOfImages"]);n!==void 0&&l!=null&&y(n,["parameters","sampleCount"],l);const c=g(t,["baseSteps"]);n!==void 0&&c!=null&&y(n,["parameters","baseSteps"],c);const d=g(t,["outputGcsUri"]);n!==void 0&&d!=null&&y(n,["parameters","storageUri"],d);const u=g(t,["seed"]);n!==void 0&&u!=null&&y(n,["parameters","seed"],u);const h=g(t,["safetyFilterLevel"]);n!==void 0&&h!=null&&y(n,["parameters","safetySetting"],h);const m=g(t,["personGeneration"]);n!==void 0&&m!=null&&y(n,["parameters","personGeneration"],m);const f=g(t,["addWatermark"]);n!==void 0&&f!=null&&y(n,["parameters","addWatermark"],f);const v=g(t,["outputMimeType"]);n!==void 0&&v!=null&&y(n,["parameters","outputOptions","mimeType"],v);const x=g(t,["outputCompressionQuality"]);n!==void 0&&x!=null&&y(n,["parameters","outputOptions","compressionQuality"],x);const S=g(t,["enhancePrompt"]);n!==void 0&&S!=null&&y(n,["parameters","enhancePrompt"],S);const w=g(t,["labels"]);return n!==void 0&&w!=null&&y(n,["labels"],w),r}function xI(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["source"]);c!=null&&vI(c,r);const d=g(n,["config"]);return d!=null&&gI(d,r),r}function yI(t,n){const s={},r=g(t,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>ac(c))),y(s,["generatedImages"],l)}return s}function vI(t,n,s){const r={},l=g(t,["prompt"]);n!==void 0&&l!=null&&y(n,["instances[0]","prompt"],l);const c=g(t,["personImage"]);n!==void 0&&c!=null&&y(n,["instances[0]","personImage","image"],vs(c));const d=g(t,["productImages"]);if(n!==void 0&&d!=null){let u=d;Array.isArray(u)&&(u=u.map(h=>hI(h))),y(n,["instances[0]","productImages"],u)}return r}function bI(t,n){const s={},r=g(t,["referenceImage"]);r!=null&&y(s,["referenceImage"],vs(r));const l=g(t,["referenceId"]);l!=null&&y(s,["referenceId"],l);const c=g(t,["referenceType"]);c!=null&&y(s,["referenceType"],c);const d=g(t,["maskImageConfig"]);d!=null&&y(s,["maskImageConfig"],fI(d));const u=g(t,["controlImageConfig"]);u!=null&&y(s,["controlImageConfig"],iE(u));const h=g(t,["styleImageConfig"]);h!=null&&y(s,["styleImageConfig"],h);const m=g(t,["subjectImageConfig"]);return m!=null&&y(s,["subjectImageConfig"],m),s}function w0(t,n){const s={},r=g(t,["safetyAttributes","categories"]);r!=null&&y(s,["categories"],r);const l=g(t,["safetyAttributes","scores"]);l!=null&&y(s,["scores"],l);const c=g(t,["contentType"]);return c!=null&&y(s,["contentType"],c),s}function C0(t,n){const s={},r=g(t,["safetyAttributes","categories"]);r!=null&&y(s,["categories"],r);const l=g(t,["safetyAttributes","scores"]);l!=null&&y(s,["scores"],l);const c=g(t,["contentType"]);return c!=null&&y(s,["contentType"],c),s}function NI(t,n){const s={},r=g(t,["category"]);if(r!=null&&y(s,["category"],r),g(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const l=g(t,["threshold"]);return l!=null&&y(s,["threshold"],l),s}function SI(t,n){const s={},r=g(t,["image"]);return r!=null&&y(s,["image"],vs(r)),s}function jI(t,n,s){const r={},l=g(t,["mode"]);n!==void 0&&l!=null&&y(n,["parameters","mode"],l);const c=g(t,["maxPredictions"]);n!==void 0&&c!=null&&y(n,["parameters","maxPredictions"],c);const d=g(t,["confidenceThreshold"]);n!==void 0&&d!=null&&y(n,["parameters","confidenceThreshold"],d);const u=g(t,["maskDilation"]);n!==void 0&&u!=null&&y(n,["parameters","maskDilation"],u);const h=g(t,["binaryColorThreshold"]);n!==void 0&&h!=null&&y(n,["parameters","binaryColorThreshold"],h);const m=g(t,["labels"]);return n!==void 0&&m!=null&&y(n,["labels"],m),r}function TI(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["source"]);c!=null&&CI(c,r);const d=g(n,["config"]);return d!=null&&jI(d,r),r}function wI(t,n){const s={},r=g(t,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>JE(c))),y(s,["generatedMasks"],l)}return s}function CI(t,n,s){const r={},l=g(t,["prompt"]);n!==void 0&&l!=null&&y(n,["instances[0]","prompt"],l);const c=g(t,["image"]);n!==void 0&&c!=null&&y(n,["instances[0]","image"],vs(c));const d=g(t,["scribbleImage"]);return n!==void 0&&d!=null&&y(n,["instances[0]","scribble"],SI(d)),r}function EI(t,n){const s={},r=g(t,["retrievalConfig"]);r!=null&&y(s,["retrievalConfig"],r);const l=g(t,["functionCallingConfig"]);return l!=null&&y(s,["functionCallingConfig"],_E(l)),s}function II(t,n){const s={};if(g(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=g(t,["computerUse"]);r!=null&&y(s,["computerUse"],r);const l=g(t,["fileSearch"]);l!=null&&y(s,["fileSearch"],l);const c=g(t,["codeExecution"]);if(c!=null&&y(s,["codeExecution"],c),g(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=g(t,["functionDeclarations"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(x=>x)),y(s,["functionDeclarations"],v)}const u=g(t,["googleMaps"]);u!=null&&y(s,["googleMaps"],nI(u));const h=g(t,["googleSearch"]);h!=null&&y(s,["googleSearch"],sI(h));const m=g(t,["googleSearchRetrieval"]);m!=null&&y(s,["googleSearchRetrieval"],m);const f=g(t,["urlContext"]);return f!=null&&y(s,["urlContext"],f),s}function E0(t,n){const s={},r=g(t,["retrieval"]);r!=null&&y(s,["retrieval"],r);const l=g(t,["computerUse"]);if(l!=null&&y(s,["computerUse"],l),g(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=g(t,["codeExecution"]);c!=null&&y(s,["codeExecution"],c);const d=g(t,["enterpriseWebSearch"]);d!=null&&y(s,["enterpriseWebSearch"],d);const u=g(t,["functionDeclarations"]);if(u!=null){let x=u;Array.isArray(x)&&(x=x.map(S=>AE(S))),y(s,["functionDeclarations"],x)}const h=g(t,["googleMaps"]);h!=null&&y(s,["googleMaps"],h);const m=g(t,["googleSearch"]);m!=null&&y(s,["googleSearch"],m);const f=g(t,["googleSearchRetrieval"]);f!=null&&y(s,["googleSearchRetrieval"],f);const v=g(t,["urlContext"]);return v!=null&&y(s,["urlContext"],v),s}function _I(t,n){const s={},r=g(t,["baseModel"]);r!=null&&y(s,["baseModel"],r);const l=g(t,["createTime"]);l!=null&&y(s,["createTime"],l);const c=g(t,["updateTime"]);return c!=null&&y(s,["updateTime"],c),s}function AI(t,n){const s={},r=g(t,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&y(s,["baseModel"],r);const l=g(t,["createTime"]);l!=null&&y(s,["createTime"],l);const c=g(t,["updateTime"]);return c!=null&&y(s,["updateTime"],c),s}function DI(t,n,s){const r={},l=g(t,["displayName"]);n!==void 0&&l!=null&&y(n,["displayName"],l);const c=g(t,["description"]);n!==void 0&&c!=null&&y(n,["description"],c);const d=g(t,["defaultCheckpointId"]);return n!==void 0&&d!=null&&y(n,["defaultCheckpointId"],d),r}function kI(t,n,s){const r={},l=g(t,["displayName"]);n!==void 0&&l!=null&&y(n,["displayName"],l);const c=g(t,["description"]);n!==void 0&&c!=null&&y(n,["description"],c);const d=g(t,["defaultCheckpointId"]);return n!==void 0&&d!=null&&y(n,["defaultCheckpointId"],d),r}function RI(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","name"],Tt(t,l));const c=g(n,["config"]);return c!=null&&DI(c,r),r}function MI(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["config"]);return c!=null&&kI(c,r),r}function PI(t,n,s){const r={},l=g(t,["outputGcsUri"]);n!==void 0&&l!=null&&y(n,["parameters","storageUri"],l);const c=g(t,["safetyFilterLevel"]);n!==void 0&&c!=null&&y(n,["parameters","safetySetting"],c);const d=g(t,["personGeneration"]);n!==void 0&&d!=null&&y(n,["parameters","personGeneration"],d);const u=g(t,["includeRaiReason"]);n!==void 0&&u!=null&&y(n,["parameters","includeRaiReason"],u);const h=g(t,["outputMimeType"]);n!==void 0&&h!=null&&y(n,["parameters","outputOptions","mimeType"],h);const m=g(t,["outputCompressionQuality"]);n!==void 0&&m!=null&&y(n,["parameters","outputOptions","compressionQuality"],m);const f=g(t,["enhanceInputImage"]);n!==void 0&&f!=null&&y(n,["parameters","upscaleConfig","enhanceInputImage"],f);const v=g(t,["imagePreservationFactor"]);n!==void 0&&v!=null&&y(n,["parameters","upscaleConfig","imagePreservationFactor"],v);const x=g(t,["labels"]);n!==void 0&&x!=null&&y(n,["labels"],x);const S=g(t,["numberOfImages"]);n!==void 0&&S!=null&&y(n,["parameters","sampleCount"],S);const w=g(t,["mode"]);return n!==void 0&&w!=null&&y(n,["parameters","mode"],w),r}function LI(t,n,s){const r={},l=g(n,["model"]);l!=null&&y(r,["_url","model"],Tt(t,l));const c=g(n,["image"]);c!=null&&y(r,["instances[0]","image"],vs(c));const d=g(n,["upscaleFactor"]);d!=null&&y(r,["parameters","upscaleConfig","upscaleFactor"],d);const u=g(n,["config"]);return u!=null&&PI(u,r),r}function OI(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["predictions"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>ac(d))),y(s,["generatedImages"],c)}return s}function UI(t,n){const s={},r=g(t,["uri"]);r!=null&&y(s,["uri"],r);const l=g(t,["encodedVideo"]);l!=null&&y(s,["videoBytes"],Ma(l));const c=g(t,["encoding"]);return c!=null&&y(s,["mimeType"],c),s}function FI(t,n){const s={},r=g(t,["gcsUri"]);r!=null&&y(s,["uri"],r);const l=g(t,["bytesBase64Encoded"]);l!=null&&y(s,["videoBytes"],Ma(l));const c=g(t,["mimeType"]);return c!=null&&y(s,["mimeType"],c),s}function BI(t,n){const s={},r=g(t,["image"]);r!=null&&y(s,["_self"],vs(r));const l=g(t,["maskMode"]);return l!=null&&y(s,["maskMode"],l),s}function GI(t,n){const s={},r=g(t,["image"]);r!=null&&y(s,["image"],rc(r));const l=g(t,["referenceType"]);return l!=null&&y(s,["referenceType"],l),s}function zI(t,n){const s={},r=g(t,["image"]);r!=null&&y(s,["image"],vs(r));const l=g(t,["referenceType"]);return l!=null&&y(s,["referenceType"],l),s}function I0(t,n){const s={},r=g(t,["uri"]);r!=null&&y(s,["uri"],r);const l=g(t,["videoBytes"]);l!=null&&y(s,["encodedVideo"],Ma(l));const c=g(t,["mimeType"]);return c!=null&&y(s,["encoding"],c),s}function _0(t,n){const s={},r=g(t,["uri"]);r!=null&&y(s,["gcsUri"],r);const l=g(t,["videoBytes"]);l!=null&&y(s,["bytesBase64Encoded"],Ma(l));const c=g(t,["mimeType"]);return c!=null&&y(s,["mimeType"],c),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HI(t,n){const s={},r=g(t,["displayName"]);return n!==void 0&&r!=null&&y(n,["displayName"],r),s}function qI(t){const n={},s=g(t,["config"]);return s!=null&&HI(s,n),n}function VI(t,n){const s={},r=g(t,["force"]);return n!==void 0&&r!=null&&y(n,["_query","force"],r),s}function KI(t){const n={},s=g(t,["name"]);s!=null&&y(n,["_url","name"],s);const r=g(t,["config"]);return r!=null&&VI(r,n),n}function $I(t){const n={},s=g(t,["name"]);return s!=null&&y(n,["_url","name"],s),n}function WI(t,n){const s={},r=g(t,["customMetadata"]);if(n!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>d)),y(n,["customMetadata"],c)}const l=g(t,["chunkingConfig"]);return n!==void 0&&l!=null&&y(n,["chunkingConfig"],l),s}function YI(t){const n={},s=g(t,["name"]);s!=null&&y(n,["name"],s);const r=g(t,["metadata"]);r!=null&&y(n,["metadata"],r);const l=g(t,["done"]);l!=null&&y(n,["done"],l);const c=g(t,["error"]);c!=null&&y(n,["error"],c);const d=g(t,["response"]);return d!=null&&y(n,["response"],XI(d)),n}function JI(t){const n={},s=g(t,["fileSearchStoreName"]);s!=null&&y(n,["_url","file_search_store_name"],s);const r=g(t,["fileName"]);r!=null&&y(n,["fileName"],r);const l=g(t,["config"]);return l!=null&&WI(l,n),n}function XI(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["parent"]);r!=null&&y(n,["parent"],r);const l=g(t,["documentName"]);return l!=null&&y(n,["documentName"],l),n}function QI(t,n){const s={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&y(n,["_query","pageSize"],r);const l=g(t,["pageToken"]);return n!==void 0&&l!=null&&y(n,["_query","pageToken"],l),s}function ZI(t){const n={},s=g(t,["config"]);return s!=null&&QI(s,n),n}function e_(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["nextPageToken"]);r!=null&&y(n,["nextPageToken"],r);const l=g(t,["fileSearchStores"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(n,["fileSearchStores"],c)}return n}function A0(t,n){const s={},r=g(t,["mimeType"]);n!==void 0&&r!=null&&y(n,["mimeType"],r);const l=g(t,["displayName"]);n!==void 0&&l!=null&&y(n,["displayName"],l);const c=g(t,["customMetadata"]);if(n!==void 0&&c!=null){let u=c;Array.isArray(u)&&(u=u.map(h=>h)),y(n,["customMetadata"],u)}const d=g(t,["chunkingConfig"]);return n!==void 0&&d!=null&&y(n,["chunkingConfig"],d),s}function t_(t){const n={},s=g(t,["fileSearchStoreName"]);s!=null&&y(n,["_url","file_search_store_name"],s);const r=g(t,["config"]);return r!=null&&A0(r,n),n}function n_(t){const n={},s=g(t,["sdkHttpResponse"]);return s!=null&&y(n,["sdkHttpResponse"],s),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const s_="Content-Type",a_="X-Server-Timeout",r_="User-Agent",tm="x-goog-api-client",i_="1.42.0",l_=`google-genai-sdk/${i_}`,o_="v1beta1",c_="v1beta",d_=5,u_=[408,429,500,502,503,504];class m_{constructor(n){var s,r,l;this.clientOptions=Object.assign({},n),this.customBaseUrl=(s=n.httpOptions)===null||s===void 0?void 0:s.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const c={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const u=n.project&&n.location||!!n.apiKey;this.customBaseUrl&&!u?(c.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?c.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(c.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),c.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:o_}else{if(!this.clientOptions.apiKey)throw new il({message:"API key must be set when using the Gemini API.",status:403});c.apiVersion=(l=this.clientOptions.apiVersion)!==null&&l!==void 0?l:c_,c.baseUrl="https://generativelanguage.googleapis.com/"}c.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=c,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(c,n.httpOptions))}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const n=new Headers;return await this.clientOptions.auth.addAuthHeaders(n),n}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&r.push(n.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),s=new URL(n);return s.protocol=s.protocol=="http:"?"ws":"wss",s.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,s,r){const l=[this.getRequestUrlInternal(s)];return r&&l.push(this.getBaseResourcePath()),n!==""&&l.push(n),new URL(`${l.join("/")}`)}shouldPrependVertexProjectPath(n,s){return!(s.baseUrl&&s.baseUrlResourceScope===Yu.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let s=this.clientOptions.httpOptions;n.httpOptions&&(s=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n,s),l=this.constructUrl(n.path,s,r);if(n.queryParams)for(const[d,u]of Object.entries(n.queryParams))l.searchParams.append(d,String(u));let c={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else c.body=n.body;return c=await this.includeExtraHttpOptionsToRequestInit(c,s,l.toString(),n.abortSignal),this.unaryApiCall(l,c,n.httpMethod)}patchHttpOptions(n,s){const r=JSON.parse(JSON.stringify(n));for(const[l,c]of Object.entries(s))typeof c=="object"?r[l]=Object.assign(Object.assign({},r[l]),c):c!==void 0&&(r[l]=c);return r}async requestStream(n){let s=this.clientOptions.httpOptions;n.httpOptions&&(s=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const r=this.shouldPrependVertexProjectPath(n,s),l=this.constructUrl(n.path,s,r);(!l.searchParams.has("alt")||l.searchParams.get("alt")!=="sse")&&l.searchParams.set("alt","sse");let c={};return c.body=n.body,c=await this.includeExtraHttpOptionsToRequestInit(c,s,l.toString(),n.abortSignal),this.streamApiCall(l,c,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,s,r,l){if(s&&s.timeout||l){const c=new AbortController,d=c.signal;if(s.timeout&&(s==null?void 0:s.timeout)>0){const u=setTimeout(()=>c.abort(),s.timeout);u&&typeof u.unref=="function"&&u.unref()}l&&l.addEventListener("abort",()=>{c.abort()}),n.signal=d}return s&&s.extraBody!==null&&f_(n,s.extraBody),n.headers=await this.getHeadersInternal(s,r),n}async unaryApiCall(n,s,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},s),{method:r})).then(async l=>(await uy(l),new Ju(l))).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})}async streamApiCall(n,s,r){return this.apiCall(n.toString(),Object.assign(Object.assign({},s),{method:r})).then(async l=>(await uy(l),this.processStreamResponse(l))).catch(l=>{throw l instanceof Error?l:new Error(JSON.stringify(l))})}processStreamResponse(n){return ps(this,arguments,function*(){var r;const l=(r=n==null?void 0:n.body)===null||r===void 0?void 0:r.getReader(),c=new TextDecoder("utf-8");if(!l)throw new Error("Response body is empty");try{let d="";const u="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:m,value:f}=yield rt(l.read());if(m){if(d.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=c.decode(f,{stream:!0});try{const w=JSON.parse(v);if("error"in w){const C=JSON.parse(JSON.stringify(w.error)),T=C.status,E=C.code,R=`got status: ${T}. ${JSON.stringify(w)}`;if(E>=400&&E<600)throw new il({message:R,status:E})}}catch(w){if(w.name==="ApiError")throw w}d+=v;let x=-1,S=0;for(;;){x=-1,S=0;for(const T of h){const E=d.indexOf(T);E!==-1&&(x===-1||E<x)&&(x=E,S=T.length)}if(x===-1)break;const w=d.substring(0,x);d=d.substring(x+S);const C=w.trim();if(C.startsWith(u)){const T=C.substring(u.length).trim();try{const E=new Response(T,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield rt(new Ju(E))}catch(E){throw new Error(`exception parsing stream chunk ${T}. ${E}`)}}}}}finally{l.releaseLock()}})}async apiCall(n,s){var r;if(!this.clientOptions.httpOptions||!this.clientOptions.httpOptions.retryOptions)return fetch(n,s);const l=this.clientOptions.httpOptions.retryOptions;return tT(async()=>{const d=await fetch(n,s);if(d.ok)return d;throw u_.includes(d.status)?new Error(`Retryable HTTP Error: ${d.statusText}`):new o0.AbortError(`Non-retryable exception ${d.statusText} sending request`)},{retries:((r=l.attempts)!==null&&r!==void 0?r:d_)-1})}getDefaultHeaders(){const n={},s=l_+" "+this.clientOptions.userAgentExtra;return n[r_]=s,n[tm]=s,n[s_]="application/json",n}async getHeadersInternal(n,s){const r=new Headers;if(n&&n.headers){for(const[l,c]of Object.entries(n.headers))r.append(l,c);n.timeout&&n.timeout>0&&r.append(a_,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,s),r}getFileName(n){var s;let r="";return typeof n=="string"&&(r=n.replace(/[/\\]+$/,""),r=(s=r.split(/[/\\]/).pop())!==null&&s!==void 0?s:""),r}async uploadFile(n,s){var r;const l={};s!=null&&(l.mimeType=s.mimeType,l.name=s.name,l.displayName=s.displayName),l.name&&!l.name.startsWith("files/")&&(l.name=`files/${l.name}`);const c=this.clientOptions.uploader,d=await c.stat(n);l.sizeBytes=String(d.size);const u=(r=s==null?void 0:s.mimeType)!==null&&r!==void 0?r:d.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");l.mimeType=u;const h={file:l},m=this.getFileName(n),f=Ve("upload/v1beta/files",h._url),v=await this.fetchUploadUrl(f,l.sizeBytes,l.mimeType,m,h,s==null?void 0:s.httpOptions);return c.upload(n,v,this)}async uploadFileToFileSearchStore(n,s,r){var l;const c=this.clientOptions.uploader,d=await c.stat(s),u=String(d.size),h=(l=r==null?void 0:r.mimeType)!==null&&l!==void 0?l:d.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const m=`upload/v1beta/${n}:uploadToFileSearchStore`,f=this.getFileName(s),v={};r!=null&&A0(r,v);const x=await this.fetchUploadUrl(m,u,h,f,v,r==null?void 0:r.httpOptions);return c.uploadToFileSearchStore(s,x,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,s,r,l,c,d){var u;let h={};d?h=d:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s}`,"X-Goog-Upload-Header-Content-Type":`${r}`},l?{"X-Goog-Upload-File-Name":l}:{})};const m=await this.request({path:n,body:JSON.stringify(c),httpMethod:"POST",httpOptions:h});if(!m||!(m!=null&&m.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(u=m==null?void 0:m.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function uy(t){var n;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const s=t.status;let r;!((n=t.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const l=JSON.stringify(r);throw s>=400&&s<600?new il({message:l,status:s}):new Error(l)}}function f_(t,n){if(!n||Object.keys(n).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let s={};if(typeof t.body=="string"&&t.body.length>0)try{const c=JSON.parse(t.body);if(typeof c=="object"&&c!==null&&!Array.isArray(c))s=c;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(c,d){const u=Object.assign({},c);for(const h in d)if(Object.prototype.hasOwnProperty.call(d,h)){const m=d[h],f=u[h];m&&typeof m=="object"&&!Array.isArray(m)&&f&&typeof f=="object"&&!Array.isArray(f)?u[h]=r(f,m):(f&&m&&typeof f!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof f}, New type: ${typeof m}. Overwriting.`),u[h]=m)}return u}const l=r(s,n);t.body=JSON.stringify(l)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p_="mcp_used/unknown";let h_=!1;function D0(t){for(const n of t)if(g_(n)||typeof n=="object"&&"inputSchema"in n)return!0;return h_}function k0(t){var n;const s=(n=t[tm])!==null&&n!==void 0?n:"";t[tm]=(s+` ${p_}`).trimStart()}function g_(t){return t!==null&&typeof t=="object"&&t instanceof Im}function x_(t){return ps(this,arguments,function*(s,r=100){let l,c=0;for(;c<r;){const d=yield rt(s.listTools({cursor:l}));for(const u of d.tools)yield yield rt(u),c++;if(!d.nextCursor)break;l=d.nextCursor}})}class Im{constructor(n=[],s){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=n,this.config=s}static create(n,s){return new Im(n,s)}async initialize(){var n,s,r,l;if(this.mcpTools.length>0)return;const c={},d=[];for(const f of this.mcpClients)try{for(var u=!0,h=(s=void 0,hs(x_(f))),m;m=await h.next(),n=m.done,!n;u=!0){l=m.value,u=!1;const v=l;d.push(v);const x=v.name;if(c[x])throw new Error(`Duplicate function name ${x} found in MCP tools. Please ensure function names are unique.`);c[x]=f}}catch(v){s={error:v}}finally{try{!u&&!n&&(r=h.return)&&await r.call(h)}finally{if(s)throw s.error}}this.mcpTools=d,this.functionNameToMcpClient=c}async tool(){return await this.initialize(),HT(this.mcpTools,this.config)}async callTool(n){await this.initialize();const s=[];for(const r of n)if(r.name in this.functionNameToMcpClient){const l=this.functionNameToMcpClient[r.name];let c;this.config.timeout&&(c={timeout:this.config.timeout});const d=await l.callTool({name:r.name,arguments:r.args},void 0,c);s.push({functionResponse:{name:r.name,response:d.isError?{error:d}:d}})}return s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function y_(t,n,s){const r=new PT;let l;s.data instanceof Blob?l=JSON.parse(await s.data.text()):l=JSON.parse(s.data),Object.assign(r,l),n(r)}class v_{constructor(n,s,r){this.apiClient=n,this.auth=s,this.webSocketFactory=r}async connect(n){var s,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),d=S_(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),h=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateMusic?key=${u}`;let m=()=>{};const f=new Promise(_=>{m=_}),v=n.callbacks,x=function(){m({})},S=this.apiClient,w={onopen:x,onmessage:_=>{y_(S,v.onmessage,_)},onerror:(s=v==null?void 0:v.onerror)!==null&&s!==void 0?s:function(_){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(_){}},C=this.webSocketFactory.create(h,N_(d),w);C.connect(),await f;const R={setup:{model:Tt(this.apiClient,n.model)}};return C.send(JSON.stringify(R)),new b_(C,this.apiClient)}}class b_{constructor(n,s){this.conn=n,this.apiClient=s}async setWeightedPrompts(n){if(!n.weightedPrompts||Object.keys(n.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const s=HC(n);this.conn.send(JSON.stringify({clientContent:s}))}async setMusicGenerationConfig(n){n.musicGenerationConfig||(n.musicGenerationConfig={});const s=zC(n);this.conn.send(JSON.stringify(s))}sendPlaybackControl(n){const s={playbackControl:n};this.conn.send(JSON.stringify(s))}play(){this.sendPlaybackControl(Fr.PLAY)}pause(){this.sendPlaybackControl(Fr.PAUSE)}stop(){this.sendPlaybackControl(Fr.STOP)}resetContext(){this.sendPlaybackControl(Fr.RESET_CONTEXT)}close(){this.conn.close()}}function N_(t){const n={};return t.forEach((s,r)=>{n[r]=s}),n}function S_(t){const n=new Headers;for(const[s,r]of Object.entries(t))n.append(s,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const j_="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function T_(t,n,s){const r=new MT;let l;s.data instanceof Blob?l=await s.data.text():s.data instanceof ArrayBuffer?l=new TextDecoder().decode(s.data):l=s.data;const c=JSON.parse(l);if(t.isVertexAI()){const d=KC(c);Object.assign(r,d)}else Object.assign(r,c);n(r)}class w_{constructor(n,s,r){this.apiClient=n,this.auth=s,this.webSocketFactory=r,this.music=new v_(this.apiClient,this.auth,this.webSocketFactory)}async connect(n){var s,r,l,c,d,u;if(n.config&&n.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let f;const v=this.apiClient.getHeaders();n.config&&n.config.tools&&D0(n.config.tools)&&k0(v);const x=__(v);if(this.apiClient.isVertexAI()){const U=this.apiClient.getProject(),P=this.apiClient.getLocation(),F=this.apiClient.getApiKey(),q=!!U&&!!P||!!F;this.apiClient.getCustomBaseUrl()&&!q?f=h:(f=`${h}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x,f))}else{const U=this.apiClient.getApiKey();let P="BidiGenerateContent",F="key";U!=null&&U.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",F="access_token"),f=`${h}/ws/google.ai.generativelanguage.${m}.GenerativeService.${P}?${F}=${U}`}let S=()=>{};const w=new Promise(U=>{S=U}),C=n.callbacks,T=function(){var U;(U=C==null?void 0:C.onopen)===null||U===void 0||U.call(C),S({})},E=this.apiClient,R={onopen:T,onmessage:U=>{T_(E,C.onmessage,U)},onerror:(s=C==null?void 0:C.onerror)!==null&&s!==void 0?s:function(U){},onclose:(r=C==null?void 0:C.onclose)!==null&&r!==void 0?r:function(U){}},_=this.webSocketFactory.create(f,I_(x),R);_.connect(),await w;let D=Tt(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const U=this.apiClient.getProject(),P=this.apiClient.getLocation();U&&P&&(D=`projects/${U}/locations/${P}/`+D)}let M={};this.apiClient.isVertexAI()&&((l=n.config)===null||l===void 0?void 0:l.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[$o.AUDIO]}:n.config.responseModalities=[$o.AUDIO]),!((c=n.config)===null||c===void 0)&&c.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(u=(d=n.config)===null||d===void 0?void 0:d.tools)!==null&&u!==void 0?u:[],O=[];for(const U of I)if(this.isCallableTool(U)){const P=U;O.push(await P.tool())}else O.push(U);O.length>0&&(n.config.tools=O);const A={model:D,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?M=GC(this.apiClient,A):M=BC(this.apiClient,A),delete M.config,_.send(JSON.stringify(M)),new E_(_,this.apiClient)}isCallableTool(n){return"callTool"in n&&typeof n.callTool=="function"}}const C_={turnComplete:!0};class E_{constructor(n,s){this.conn=n,this.apiClient=s}tLiveClientContent(n,s){if(s.turns!==null&&s.turns!==void 0){let r=[];try{r=$n(s.turns),n.isVertexAI()||(r=r.map(l=>cl(l)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof s.turns}'`)}return{clientContent:{turns:r,turnComplete:s.turnComplete}}}return{clientContent:{turnComplete:s.turnComplete}}}tLiveClienttToolResponse(n,s){let r=[];if(s.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(s.functionResponses)?r=s.functionResponses:r=[s.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const c of r){if(typeof c!="object"||c===null||!("name"in c)||!("response"in c))throw new Error(`Could not parse function response, type '${typeof c}'.`);if(!n.isVertexAI()&&!("id"in c))throw new Error(j_)}return{toolResponse:{functionResponses:r}}}sendClientContent(n){n=Object.assign(Object.assign({},C_),n);const s=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(s))}sendRealtimeInput(n){let s={};this.apiClient.isVertexAI()?s={realtimeInput:VC(n)}:s={realtimeInput:qC(n)},this.conn.send(JSON.stringify(s))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const s=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(s))}close(){this.conn.close()}}function I_(t){const n={};return t.forEach((s,r)=>{n[r]=s}),n}function __(t){const n=new Headers;for(const[s,r]of Object.entries(t))n.append(s,r);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const my=10;function fy(t){var n,s,r;if(!((n=t==null?void 0:t.automaticFunctionCalling)===null||n===void 0)&&n.disable)return!0;let l=!1;for(const d of(s=t==null?void 0:t.tools)!==null&&s!==void 0?s:[])if(zr(d)){l=!0;break}if(!l)return!0;const c=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return c&&(c<0||!Number.isInteger(c))||c==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",c),!0):!1}function zr(t){return"callTool"in t&&typeof t.callTool=="function"}function A_(t){var n,s,r;return(r=(s=(n=t.config)===null||n===void 0?void 0:n.tools)===null||s===void 0?void 0:s.some(l=>zr(l)))!==null&&r!==void 0?r:!1}function py(t){var n;const s=[];return!((n=t==null?void 0:t.config)===null||n===void 0)&&n.tools&&t.config.tools.forEach((r,l)=>{if(zr(r))return;const c=r;c.functionDeclarations&&c.functionDeclarations.length>0&&s.push(l)}),s}function hy(t){var n;return!(!((n=t==null?void 0:t.automaticFunctionCalling)===null||n===void 0)&&n.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class D_ extends na{constructor(n){super(),this.apiClient=n,this.embedContent=async s=>{if(!this.apiClient.isVertexAI())return await this.embedContentInternal(s);if(s.model.includes("gemini")&&s.model!=="gemini-embedding-001"||s.model.includes("maas")){const l=$n(s.contents);if(l.length>1)throw new Error("The embedContent API for this model only supports one content at a time.");const c=Object.assign(Object.assign({},s),{content:l[0],embeddingApiType:Wo.EMBED_CONTENT});return await this.embedContentInternal(c)}else{const l=Object.assign(Object.assign({},s),{embeddingApiType:Wo.PREDICT});return await this.embedContentInternal(l)}},this.generateContent=async s=>{var r,l,c,d,u;const h=await this.processParamsMaybeAddMcpUsage(s);if(this.maybeMoveToResponseJsonSchem(s),!A_(s)||fy(s.config))return await this.generateContentInternal(h);const m=py(s);if(m.length>0){const C=m.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${C}.`)}let f,v;const x=$n(h.contents),S=(c=(l=(r=h.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||l===void 0?void 0:l.maximumRemoteCalls)!==null&&c!==void 0?c:my;let w=0;for(;w<S&&(f=await this.generateContentInternal(h),!(!f.functionCalls||f.functionCalls.length===0));){const C=f.candidates[0].content,T=[];for(const E of(u=(d=s.config)===null||d===void 0?void 0:d.tools)!==null&&u!==void 0?u:[])if(zr(E)){const _=await E.callTool(f.functionCalls);T.push(..._)}w++,v={role:"user",parts:T},h.contents=$n(h.contents),h.contents.push(C),h.contents.push(v),hy(h.config)&&(x.push(C),x.push(v))}return hy(h.config)&&(f.automaticFunctionCallingHistory=x),f},this.generateContentStream=async s=>{var r,l,c,d,u;if(this.maybeMoveToResponseJsonSchem(s),fy(s.config)){const v=await this.processParamsMaybeAddMcpUsage(s);return await this.generateContentStreamInternal(v)}const h=py(s);if(h.length>0){const v=h.map(x=>`tools[${x}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const m=(c=(l=(r=s==null?void 0:s.config)===null||r===void 0?void 0:r.toolConfig)===null||l===void 0?void 0:l.functionCallingConfig)===null||c===void 0?void 0:c.streamFunctionCallArguments,f=(u=(d=s==null?void 0:s.config)===null||d===void 0?void 0:d.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(m&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(s)},this.generateImages=async s=>await this.generateImagesInternal(s).then(r=>{var l;let c;const d=[];if(r!=null&&r.generatedImages)for(const h of r.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((l=h==null?void 0:h.safetyAttributes)===null||l===void 0?void 0:l.contentType)==="Positive Prompt"?c=h==null?void 0:h.safetyAttributes:d.push(h);let u;return c?u={generatedImages:d,positivePromptSafetyAttributes:c,sdkHttpResponse:r.sdkHttpResponse}:u={generatedImages:d,sdkHttpResponse:r.sdkHttpResponse},u}),this.list=async s=>{var r;const d={config:Object.assign(Object.assign({},{queryBase:!0}),s==null?void 0:s.config)};if(this.apiClient.isVertexAI()&&!d.config.queryBase){if(!((r=d.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");d.config.filter="labels.tune-type:*"}return new ar(ta.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(d),d)},this.editImage=async s=>{const r={model:s.model,prompt:s.prompt,referenceImages:[],config:s.config};return s.referenceImages&&s.referenceImages&&(r.referenceImages=s.referenceImages.map(l=>l.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async s=>{let r={numberOfImages:1,mode:"upscale"};s.config&&(r=Object.assign(Object.assign({},r),s.config));const l={model:s.model,image:s.image,upscaleFactor:s.upscaleFactor,config:r};return await this.upscaleImageInternal(l)},this.generateVideos=async s=>{var r,l,c,d,u,h;if((s.prompt||s.image||s.video)&&s.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=s.video)===null||r===void 0)&&r.uri&&(!((l=s.video)===null||l===void 0)&&l.videoBytes)?s.video={uri:s.video.uri,mimeType:s.video.mimeType}:!((d=(c=s.source)===null||c===void 0?void 0:c.video)===null||d===void 0)&&d.uri&&(!((h=(u=s.source)===null||u===void 0?void 0:u.video)===null||h===void 0)&&h.videoBytes)&&(s.source.video={uri:s.source.video.uri,mimeType:s.source.video.mimeType})),await this.generateVideosInternal(s)}}maybeMoveToResponseJsonSchem(n){n.config&&n.config.responseSchema&&(n.config.responseJsonSchema||Object.keys(n.config.responseSchema).includes("$schema")&&(n.config.responseJsonSchema=n.config.responseSchema,delete n.config.responseSchema))}async processParamsMaybeAddMcpUsage(n){var s,r,l;const c=(s=n.config)===null||s===void 0?void 0:s.tools;if(!c)return n;const d=await Promise.all(c.map(async h=>zr(h)?await h.tool():h)),u={model:n.model,contents:n.contents,config:Object.assign(Object.assign({},n.config),{tools:d})};if(u.config.tools=d,n.config&&n.config.tools&&D0(n.config.tools)){const h=(l=(r=n.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&l!==void 0?l:{};let m=Object.assign({},h);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),k0(m),u.config.httpOptions=Object.assign(Object.assign({},n.config.httpOptions),{headers:m})}return u}async initAfcToolsMap(n){var s,r,l;const c=new Map;for(const d of(r=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&r!==void 0?r:[])if(zr(d)){const u=d,h=await u.tool();for(const m of(l=h.functionDeclarations)!==null&&l!==void 0?l:[]){if(!m.name)throw new Error("Function declaration name is required.");if(c.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);c.set(m.name,u)}}return c}async processAfcStream(n){var s,r,l;const c=(l=(r=(s=n.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&l!==void 0?l:my;let d=!1,u=0;const h=await this.initAfcToolsMap(n);return(function(m,f,v){return ps(this,arguments,function*(){for(var x,S,w,C,T,E;u<c;){d&&(u++,d=!1);const M=yield rt(m.processParamsMaybeAddMcpUsage(v)),I=yield rt(m.generateContentStreamInternal(M)),O=[],A=[];try{for(var R=!0,_=(S=void 0,hs(I)),D;D=yield rt(_.next()),x=D.done,!x;R=!0){C=D.value,R=!1;const U=C;if(yield yield rt(U),U.candidates&&(!((T=U.candidates[0])===null||T===void 0)&&T.content)){A.push(U.candidates[0].content);for(const P of(E=U.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(u<c&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(P.functionCall.name)){const F=yield rt(f.get(P.functionCall.name).callTool([P.functionCall]));O.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(U){S={error:U}}finally{try{!R&&!x&&(w=_.return)&&(yield rt(w.call(_)))}finally{if(S)throw S.error}}if(O.length>0){d=!0;const U=new Qi;U.candidates=[{content:{role:"user",parts:O}}],yield yield rt(U);const P=[];P.push(...A),P.push({role:"user",parts:O});const F=$n(v.contents).concat(P);v.contents=F}else break}})})(this,h,n)}async generateContentInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=oy(this.apiClient,n);return u=Ve("{model}:generateContent",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=dy(f),x=new Qi;return Object.assign(x,v),x})}else{const m=ly(this.apiClient,n);return u=Ve("{model}:generateContent",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=cy(f),x=new Qi;return Object.assign(x,v),x})}}async generateContentStreamInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=oy(this.apiClient,n);return u=Ve("{model}:streamGenerateContent?alt=sse",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.requestStream({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}),d.then(function(v){return ps(this,arguments,function*(){var x,S,w,C;try{for(var T=!0,E=hs(v),R;R=yield rt(E.next()),x=R.done,!x;T=!0){C=R.value,T=!1;const _=C,D=dy(yield rt(_.json()),n);D.sdkHttpResponse={headers:_.headers};const M=new Qi;Object.assign(M,D),yield yield rt(M)}}catch(_){S={error:_}}finally{try{!T&&!x&&(w=E.return)&&(yield rt(w.call(E)))}finally{if(S)throw S.error}}})})}else{const m=ly(this.apiClient,n);return u=Ve("{model}:streamGenerateContent?alt=sse",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.requestStream({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}),d.then(function(v){return ps(this,arguments,function*(){var x,S,w,C;try{for(var T=!0,E=hs(v),R;R=yield rt(E.next()),x=R.done,!x;T=!0){C=R.value,T=!1;const _=C,D=cy(yield rt(_.json()),n);D.sdkHttpResponse={headers:_.headers};const M=new Qi;Object.assign(M,D),yield yield rt(M)}}catch(_){S={error:_}}finally{try{!T&&!x&&(w=E.return)&&(yield rt(w.call(E)))}finally{if(S)throw S.error}}})})}}async embedContentInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=jE(this.apiClient,n,n),f=VT(n.model)?"{model}:embedContent":"{model}:predict";return u=Ve(f,m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(v=>v.json().then(x=>{const S=x;return S.sdkHttpResponse={headers:v.headers},S})),d.then(v=>{const x=wE(v,n),S=new qx;return Object.assign(S,x),S})}else{const m=SE(this.apiClient,n);return u=Ve("{model}:batchEmbedContents",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=TE(f),x=new qx;return Object.assign(x,v),x})}}async generateImagesInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=LE(this.apiClient,n);return u=Ve("{model}:predict",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=UE(f),x=new Vx;return Object.assign(x,v),x})}else{const m=PE(this.apiClient,n);return u=Ve("{model}:predict",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=OE(f),x=new Vx;return Object.assign(x,v),x})}}async editImageInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const u=yE(this.apiClient,n);return c=Ve("{model}:predict",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const f=m;return f.sdkHttpResponse={headers:h.headers},f})),l.then(h=>{const m=vE(h),f=new ST;return Object.assign(f,m),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const u=LI(this.apiClient,n);return c=Ve("{model}:predict",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const f=m;return f.sdkHttpResponse={headers:h.headers},f})),l.then(h=>{const m=OI(h),f=new jT;return Object.assign(f,m),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const u=xI(this.apiClient,n);return c=Ve("{model}:predict",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=yI(h),f=new TT;return Object.assign(f,m),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const u=TI(this.apiClient,n);return c=Ve("{model}:predict",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=wI(h),f=new wT;return Object.assign(f,m),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=tI(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>em(f))}else{const m=eI(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>Zu(f))}}async listInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=dI(this.apiClient,n);return u=Ve("{models_url}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=mI(f),x=new Kx;return Object.assign(x,v),x})}else{const m=cI(this.apiClient,n);return u=Ve("{models_url}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=uI(f),x=new Kx;return Object.assign(x,v),x})}}async update(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=MI(this.apiClient,n);return u=Ve("{model}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>em(f))}else{const m=RI(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>Zu(f))}}async delete(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=pE(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=gE(f),x=new $x;return Object.assign(x,v),x})}else{const m=fE(this.apiClient,n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=hE(f),x=new $x;return Object.assign(x,v),x})}}async countTokens(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=dE(this.apiClient,n);return u=Ve("{model}:countTokens",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=mE(f),x=new Wx;return Object.assign(x,v),x})}else{const m=cE(this.apiClient,n);return u=Ve("{model}:countTokens",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=uE(f),x=new Wx;return Object.assign(x,v),x})}}async computeTokens(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const u=nE(this.apiClient,n);return c=Ve("{model}:computeTokens",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const f=m;return f.sdkHttpResponse={headers:h.headers},f})),l.then(h=>{const m=sE(h),f=new CT;return Object.assign(f,m),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=qE(this.apiClient,n);return u=Ve("{model}:predictLongRunning",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d.then(f=>{const v=zE(f),x=new Yo;return Object.assign(x,v),x})}else{const m=HE(this.apiClient,n);return u=Ve("{model}:predictLongRunning",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d.then(f=>{const v=GE(f),x=new Yo;return Object.assign(x,v),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k_ extends na{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const s=n.operation,r=n.config;if(s.name===void 0||s.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const l=s.name.split("/operations/")[0];let c;r&&"httpOptions"in r&&(c=r.httpOptions);const d=await this.fetchPredictVideosOperationInternal({operationName:s.name,resourceName:l,config:{httpOptions:c}});return s._fromAPIResponse({apiResponse:d,_isVertexAI:!0})}else{const l=await this.getVideosOperationInternal({operationName:s.name,config:r});return s._fromAPIResponse({apiResponse:l,_isVertexAI:!1})}}async get(n){const s=n.operation,r=n.config;if(s.name===void 0||s.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const l=s.name.split("/operations/")[0];let c;r&&"httpOptions"in r&&(c=r.httpOptions);const d=await this.fetchPredictVideosOperationInternal({operationName:s.name,resourceName:l,config:{httpOptions:c}});return s._fromAPIResponse({apiResponse:d,_isVertexAI:!0})}else{const l=await this.getVideosOperationInternal({operationName:s.name,config:r});return s._fromAPIResponse({apiResponse:l,_isVertexAI:!1})}}async getVideosOperationInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=gT(n);return u=Ve("{operationName}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),d}else{const m=hT(n);return u=Ve("{operationName}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json()),d}}async fetchPredictVideosOperationInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const u=oT(n);return c=Ve("{resourceName}:fetchPredictOperation",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R_(t){const n={},s=g(t,["data"]);if(s!=null&&y(n,["data"],s),g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function M_(t){const n={},s=g(t,["parts"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>H_(c))),y(n,["parts"],l)}const r=g(t,["role"]);return r!=null&&y(n,["role"],r),n}function P_(t,n,s){const r={},l=g(n,["expireTime"]);s!==void 0&&l!=null&&y(s,["expireTime"],l);const c=g(n,["newSessionExpireTime"]);s!==void 0&&c!=null&&y(s,["newSessionExpireTime"],c);const d=g(n,["uses"]);s!==void 0&&d!=null&&y(s,["uses"],d);const u=g(n,["liveConnectConstraints"]);s!==void 0&&u!=null&&y(s,["bidiGenerateContentSetup"],z_(t,u));const h=g(n,["lockAdditionalFields"]);return s!==void 0&&h!=null&&y(s,["fieldMask"],h),r}function L_(t,n){const s={},r=g(n,["config"]);return r!=null&&y(s,["config"],P_(t,r,s)),s}function O_(t){const n={};if(g(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=g(t,["fileUri"]);s!=null&&y(n,["fileUri"],s);const r=g(t,["mimeType"]);return r!=null&&y(n,["mimeType"],r),n}function U_(t){const n={},s=g(t,["id"]);s!=null&&y(n,["id"],s);const r=g(t,["args"]);r!=null&&y(n,["args"],r);const l=g(t,["name"]);if(l!=null&&y(n,["name"],l),g(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function F_(t){const n={};if(g(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=g(t,["enableWidget"]);return s!=null&&y(n,["enableWidget"],s),n}function B_(t){const n={};if(g(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=g(t,["timeRangeFilter"]);return s!=null&&y(n,["timeRangeFilter"],s),n}function G_(t,n){const s={},r=g(t,["generationConfig"]);n!==void 0&&r!=null&&y(n,["setup","generationConfig"],r);const l=g(t,["responseModalities"]);n!==void 0&&l!=null&&y(n,["setup","generationConfig","responseModalities"],l);const c=g(t,["temperature"]);n!==void 0&&c!=null&&y(n,["setup","generationConfig","temperature"],c);const d=g(t,["topP"]);n!==void 0&&d!=null&&y(n,["setup","generationConfig","topP"],d);const u=g(t,["topK"]);n!==void 0&&u!=null&&y(n,["setup","generationConfig","topK"],u);const h=g(t,["maxOutputTokens"]);n!==void 0&&h!=null&&y(n,["setup","generationConfig","maxOutputTokens"],h);const m=g(t,["mediaResolution"]);n!==void 0&&m!=null&&y(n,["setup","generationConfig","mediaResolution"],m);const f=g(t,["seed"]);n!==void 0&&f!=null&&y(n,["setup","generationConfig","seed"],f);const v=g(t,["speechConfig"]);n!==void 0&&v!=null&&y(n,["setup","generationConfig","speechConfig"],Em(v));const x=g(t,["thinkingConfig"]);n!==void 0&&x!=null&&y(n,["setup","generationConfig","thinkingConfig"],x);const S=g(t,["enableAffectiveDialog"]);n!==void 0&&S!=null&&y(n,["setup","generationConfig","enableAffectiveDialog"],S);const w=g(t,["systemInstruction"]);n!==void 0&&w!=null&&y(n,["setup","systemInstruction"],M_(hn(w)));const C=g(t,["tools"]);if(n!==void 0&&C!=null){let I=$r(C);Array.isArray(I)&&(I=I.map(O=>V_(Kr(O)))),y(n,["setup","tools"],I)}const T=g(t,["sessionResumption"]);n!==void 0&&T!=null&&y(n,["setup","sessionResumption"],q_(T));const E=g(t,["inputAudioTranscription"]);n!==void 0&&E!=null&&y(n,["setup","inputAudioTranscription"],E);const R=g(t,["outputAudioTranscription"]);n!==void 0&&R!=null&&y(n,["setup","outputAudioTranscription"],R);const _=g(t,["realtimeInputConfig"]);n!==void 0&&_!=null&&y(n,["setup","realtimeInputConfig"],_);const D=g(t,["contextWindowCompression"]);n!==void 0&&D!=null&&y(n,["setup","contextWindowCompression"],D);const M=g(t,["proactivity"]);if(n!==void 0&&M!=null&&y(n,["setup","proactivity"],M),g(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return s}function z_(t,n){const s={},r=g(n,["model"]);r!=null&&y(s,["setup","model"],Tt(t,r));const l=g(n,["config"]);return l!=null&&y(s,["config"],G_(l,s)),s}function H_(t){const n={},s=g(t,["mediaResolution"]);s!=null&&y(n,["mediaResolution"],s);const r=g(t,["codeExecutionResult"]);r!=null&&y(n,["codeExecutionResult"],r);const l=g(t,["executableCode"]);l!=null&&y(n,["executableCode"],l);const c=g(t,["fileData"]);c!=null&&y(n,["fileData"],O_(c));const d=g(t,["functionCall"]);d!=null&&y(n,["functionCall"],U_(d));const u=g(t,["functionResponse"]);u!=null&&y(n,["functionResponse"],u);const h=g(t,["inlineData"]);h!=null&&y(n,["inlineData"],R_(h));const m=g(t,["text"]);m!=null&&y(n,["text"],m);const f=g(t,["thought"]);f!=null&&y(n,["thought"],f);const v=g(t,["thoughtSignature"]);v!=null&&y(n,["thoughtSignature"],v);const x=g(t,["videoMetadata"]);return x!=null&&y(n,["videoMetadata"],x),n}function q_(t){const n={},s=g(t,["handle"]);if(s!=null&&y(n,["handle"],s),g(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function V_(t){const n={};if(g(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=g(t,["computerUse"]);s!=null&&y(n,["computerUse"],s);const r=g(t,["fileSearch"]);r!=null&&y(n,["fileSearch"],r);const l=g(t,["codeExecution"]);if(l!=null&&y(n,["codeExecution"],l),g(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const c=g(t,["functionDeclarations"]);if(c!=null){let f=c;Array.isArray(f)&&(f=f.map(v=>v)),y(n,["functionDeclarations"],f)}const d=g(t,["googleMaps"]);d!=null&&y(n,["googleMaps"],F_(d));const u=g(t,["googleSearch"]);u!=null&&y(n,["googleSearch"],B_(u));const h=g(t,["googleSearchRetrieval"]);h!=null&&y(n,["googleSearchRetrieval"],h);const m=g(t,["urlContext"]);return m!=null&&y(n,["urlContext"],m),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K_(t){const n=[];for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const r=t[s];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const l=Object.keys(r).map(c=>`${s}.${c}`);n.push(...l)}else n.push(s)}return n.join(",")}function $_(t,n){let s=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const c=r.setup;typeof c=="object"&&c!==null?(t.bidiGenerateContentSetup=c,s=c):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const l=t.fieldMask;if(s){const c=K_(s);if(Array.isArray(n==null?void 0:n.lockAdditionalFields)&&(n==null?void 0:n.lockAdditionalFields.length)===0)c?t.fieldMask=c:delete t.fieldMask;else if(n!=null&&n.lockAdditionalFields&&n.lockAdditionalFields.length>0&&l!==null&&Array.isArray(l)&&l.length>0){const d=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];l.length>0&&(u=l.map(m=>d.includes(m)?`generationConfig.${m}`:m));const h=[];c&&h.push(c),u.length>0&&h.push(...u),h.length>0?t.fieldMask=h.join(","):delete t.fieldMask}else delete t.fieldMask}else l!==null&&Array.isArray(l)&&l.length>0?t.fieldMask=l.join(","):delete t.fieldMask;return t}class W_ extends na{constructor(n){super(),this.apiClient=n}async create(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=L_(this.apiClient,n);c=Ve("auth_tokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const h=$_(u,n.config);return l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y_(t,n){const s={},r=g(t,["force"]);return n!==void 0&&r!=null&&y(n,["_query","force"],r),s}function J_(t){const n={},s=g(t,["name"]);s!=null&&y(n,["_url","name"],s);const r=g(t,["config"]);return r!=null&&Y_(r,n),n}function X_(t){const n={},s=g(t,["name"]);return s!=null&&y(n,["_url","name"],s),n}function Q_(t,n){const s={},r=g(t,["pageSize"]);n!==void 0&&r!=null&&y(n,["_query","pageSize"],r);const l=g(t,["pageToken"]);return n!==void 0&&l!=null&&y(n,["_query","pageToken"],l),s}function Z_(t){const n={},s=g(t,["parent"]);s!=null&&y(n,["_url","parent"],s);const r=g(t,["config"]);return r!=null&&Q_(r,n),n}function eA(t){const n={},s=g(t,["sdkHttpResponse"]);s!=null&&y(n,["sdkHttpResponse"],s);const r=g(t,["nextPageToken"]);r!=null&&y(n,["nextPageToken"],r);const l=g(t,["documents"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>d)),y(n,["documents"],c)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tA extends na{constructor(n){super(),this.apiClient=n,this.list=async s=>new ar(ta.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:s.parent,config:r.config}),await this.listInternal(s),s)}async get(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=X_(n);return c=Ve("{name}",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>h)}}async delete(n){var s,r;let l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=J_(n);l=Ve("{name}",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Z_(n);return c=Ve("{parent}/documents",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=eA(h),f=new ET;return Object.assign(f,m),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nA extends na{constructor(n,s=new tA(n)){super(),this.apiClient=n,this.documents=s,this.list=async(r={})=>new ar(ta.PAGED_ITEM_FILE_SEARCH_STORES,l=>this.listInternal(l),await this.listInternal(r),r)}async uploadToFileSearchStore(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(n.fileSearchStoreName,n.file,n.config)}async create(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qI(n);return c=Ve("fileSearchStores",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>h)}}async get(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=$I(n);return c=Ve("{name}",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>h)}}async delete(n){var s,r;let l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=KI(n);l=Ve("{name}",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ZI(n);return c=Ve("fileSearchStores",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=e_(h),f=new IT;return Object.assign(f,m),f})}}async uploadToFileSearchStoreInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=t_(n);return c=Ve("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=n_(h),f=new _T;return Object.assign(f,m),f})}}async importFile(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=JI(n);return c=Ve("{file_search_store_name}:importFile",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),l.then(h=>{const m=YI(h),f=new Sm;return Object.assign(f,m),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let R0=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return R0=t.randomUUID.bind(t),t.randomUUID();const n=new Uint8Array(1),s=t?()=>t.getRandomValues(n)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^s()&15>>+r/4).toString(16))};const sA=()=>R0();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nm(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const sm=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const n=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(n.stack=t.stack),t.cause&&!n.cause&&(n.cause=t.cause),t.name&&(n.name=t.name),n}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cs extends Error{}class An extends cs{constructor(n,s,r,l){super(`${An.makeMessage(n,s,r)}`),this.status=n,this.headers=l,this.error=s}static makeMessage(n,s,r){const l=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):r;return n&&l?`${n} ${l}`:n?`${n} status code (no body)`:l||"(no status code or body)"}static generate(n,s,r,l){if(!n||!l)return new ic({message:r,cause:sm(s)});const c=s;return n===400?new P0(n,c,r,l):n===401?new L0(n,c,r,l):n===403?new O0(n,c,r,l):n===404?new U0(n,c,r,l):n===409?new F0(n,c,r,l):n===422?new B0(n,c,r,l):n===429?new G0(n,c,r,l):n>=500?new z0(n,c,r,l):new An(n,c,r,l)}}class am extends An{constructor({message:n}={}){super(void 0,void 0,n||"Request was aborted.",void 0)}}class ic extends An{constructor({message:n,cause:s}){super(void 0,void 0,n||"Connection error.",void 0),s&&(this.cause=s)}}class M0 extends ic{constructor({message:n}={}){super({message:n??"Request timed out."})}}class P0 extends An{}class L0 extends An{}class O0 extends An{}class U0 extends An{}class F0 extends An{}class B0 extends An{}class G0 extends An{}class z0 extends An{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aA=/^[a-z][a-z0-9+.-]*:/i,rA=t=>aA.test(t);let rm=t=>(rm=Array.isArray,rm(t));const iA=rm;let lA=iA;const gy=lA;function oA(t){if(!t)return!0;for(const n in t)return!1;return!0}function cA(t,n){return Object.prototype.hasOwnProperty.call(t,n)}const dA=(t,n)=>{if(typeof n!="number"||!Number.isInteger(n))throw new cs(`${t} must be an integer`);if(n<0)throw new cs(`${t} must be a positive integer`);return n},uA=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mA=t=>new Promise(n=>setTimeout(n,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Or="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fA(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const pA=()=>{var t,n,s,r,l;const c=fA();if(c==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Or,"X-Stainless-OS":yy(Deno.build.os),"X-Stainless-Arch":xy(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(n=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&n!==void 0?n:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Or,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(c==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Or,"X-Stainless-OS":yy((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":xy((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(l=globalThis.process.version)!==null&&l!==void 0?l:"unknown"};const d=hA();return d?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Or,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${d.browser}`,"X-Stainless-Runtime-Version":d.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Or,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function hA(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:n,pattern:s}of t){const r=s.exec(navigator.userAgent);if(r){const l=r[1]||0,c=r[2]||0,d=r[3]||0;return{browser:n,version:`${l}.${c}.${d}`}}}return null}const xy=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",yy=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Ro;const gA=()=>Ro??(Ro=pA());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xA(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function H0(...t){const n=globalThis.ReadableStream;if(typeof n>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new n(...t)}function yA(t){let n=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return H0({start(){},async pull(s){const{done:r,value:l}=await n.next();r?s.close():s.enqueue(l)},async cancel(){var s;await((s=n.return)===null||s===void 0?void 0:s.call(n))}})}function q0(t){if(t[Symbol.asyncIterator])return t;const n=t.getReader();return{async next(){try{const s=await n.read();return s!=null&&s.done&&n.releaseLock(),s}catch(s){throw n.releaseLock(),s}},async return(){const s=n.cancel();return n.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function vA(t){var n,s;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((s=(n=t[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(n));return}const r=t.getReader(),l=r.cancel();r.releaseLock(),await l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bA=({headers:t,body:n})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(n)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const V0=()=>{var t;if(typeof File>"u"){const{process:n}=globalThis,s=typeof((t=n==null?void 0:n.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(n.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ru(t,n,s){return V0(),new File(t,n??"unknown_file",s)}function NA(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const SA=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const K0=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",jA=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&K0(t),TA=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function wA(t,n,s){if(V0(),t=await t,jA(t))return t instanceof File?t:Ru([await t.arrayBuffer()],t.name);if(TA(t)){const l=await t.blob();return n||(n=new URL(t.url).pathname.split(/[\\/]/).pop()),Ru(await im(l),n,s)}const r=await im(t);if(n||(n=NA(t)),!(s!=null&&s.type)){const l=r.find(c=>typeof c=="object"&&"type"in c&&c.type);typeof l=="string"&&(s=Object.assign(Object.assign({},s),{type:l}))}return Ru(r,n,s)}async function im(t){var n,s,r,l,c;let d=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)d.push(t);else if(K0(t))d.push(t instanceof Blob?t:await t.arrayBuffer());else if(SA(t))try{for(var u=!0,h=hs(t),m;m=await h.next(),n=m.done,!n;u=!0){l=m.value,u=!1;const f=l;d.push(...await im(f))}}catch(f){s={error:f}}finally{try{!u&&!n&&(r=h.return)&&await r.call(h)}finally{if(s)throw s.error}}else{const f=(c=t==null?void 0:t.constructor)===null||c===void 0?void 0:c.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${CA(t)}`)}return d}function CA(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $0{constructor(n){this._client=n}}$0._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function W0(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const vy=Object.freeze(Object.create(null)),EA=(t=W0)=>(function(s,...r){if(s.length===1)return s[0];let l=!1;const c=[],d=s.reduce((f,v,x)=>{var S,w,C;/[?#]/.test(v)&&(l=!0);const T=r[x];let E=(l?encodeURIComponent:t)(""+T);return x!==r.length&&(T==null||typeof T=="object"&&T.toString===((C=Object.getPrototypeOf((w=Object.getPrototypeOf((S=T.hasOwnProperty)!==null&&S!==void 0?S:vy))!==null&&w!==void 0?w:vy))===null||C===void 0?void 0:C.toString))&&(E=T+"",c.push({start:f.length+v.length,length:E.length,error:`Value of type ${Object.prototype.toString.call(T).slice(8,-1)} is not a valid path parameter`})),f+v+(x===r.length?"":E)},""),u=d.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let m;for(;(m=h.exec(u))!==null;)c.push({start:m.index,length:m[0].length,error:`Value "${m[0]}" can't be safely passed as a path parameter`});if(c.sort((f,v)=>f.start-v.start),c.length>0){let f=0;const v=c.reduce((x,S)=>{const w=" ".repeat(S.start-f),C="^".repeat(S.length);return f=S.start+S.length,x+w+C},"");throw new cs(`Path parameters result in path with invalid segments:
${c.map(x=>x.error).join(`
`)}
${d}
${v}`)}return d}),Mo=EA(W0);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Y0 extends $0{create(n,s){var r;const{api_version:l=this._client.apiVersion}=n,c=Xo(n,["api_version"]);if("model"in c&&"agent_config"in c)throw new cs("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in c&&"generation_config"in c)throw new cs("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Mo`/${l}/interactions`,Object.assign(Object.assign({body:c},s),{stream:(r=n.stream)!==null&&r!==void 0?r:!1}))}delete(n,s={},r){const{api_version:l=this._client.apiVersion}=s??{};return this._client.delete(Mo`/${l}/interactions/${n}`,r)}cancel(n,s={},r){const{api_version:l=this._client.apiVersion}=s??{};return this._client.post(Mo`/${l}/interactions/${n}/cancel`,r)}get(n,s={},r){var l;const c=s??{},{api_version:d=this._client.apiVersion}=c,u=Xo(c,["api_version"]);return this._client.get(Mo`/${d}/interactions/${n}`,Object.assign(Object.assign({query:u},r),{stream:(l=s==null?void 0:s.stream)!==null&&l!==void 0?l:!1}))}}Y0._key=Object.freeze(["interactions"]);class J0 extends Y0{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IA(t){let n=0;for(const l of t)n+=l.length;const s=new Uint8Array(n);let r=0;for(const l of t)s.set(l,r),r+=l.length;return s}let Po;function _m(t){let n;return(Po??(n=new globalThis.TextEncoder,Po=n.encode.bind(n)))(t)}let Lo;function by(t){let n;return(Lo??(n=new globalThis.TextDecoder,Lo=n.decode.bind(n)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lc{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(n){if(n==null)return[];const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?_m(n):n;this.buffer=IA([this.buffer,s]);const r=[];let l;for(;(l=_A(this.buffer,this.carriageReturnIndex))!=null;){if(l.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=l.index;continue}if(this.carriageReturnIndex!=null&&(l.index!==this.carriageReturnIndex+1||l.carriage)){r.push(by(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const c=this.carriageReturnIndex!==null?l.preceding-1:l.preceding,d=by(this.buffer.subarray(0,c));r.push(d),this.buffer=this.buffer.subarray(l.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}lc.NEWLINE_CHARS=new Set([`
`,"\r"]);lc.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function _A(t,n){for(let l=n??0;l<t.length;l++){if(t[l]===10)return{preceding:l,index:l+1,carriage:!1};if(t[l]===13)return{preceding:l,index:l+1,carriage:!0}}return null}function AA(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qo={off:0,error:200,warn:300,info:400,debug:500},Ny=(t,n,s)=>{if(t){if(cA(Qo,t))return t;_n(s).warn(`${n} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Qo))}`)}};function el(){}function Oo(t,n,s){return!n||Qo[t]>Qo[s]?el:n[t].bind(n)}const DA={error:el,warn:el,info:el,debug:el};let Sy=new WeakMap;function _n(t){var n;const s=t.logger,r=(n=t.logLevel)!==null&&n!==void 0?n:"off";if(!s)return DA;const l=Sy.get(s);if(l&&l[0]===r)return l[1];const c={error:Oo("error",s,r),warn:Oo("warn",s,r),info:Oo("info",s,r),debug:Oo("debug",s,r)};return Sy.set(s,[r,c]),c}const nr=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([n,s])=>[n,n.toLowerCase()==="x-goog-api-key"||n.toLowerCase()==="authorization"||n.toLowerCase()==="cookie"||n.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Br{constructor(n,s,r){this.iterator=n,this.controller=s,this.client=r}static fromSSEResponse(n,s,r){let l=!1;const c=r?_n(r):console;function d(){return ps(this,arguments,function*(){var h,m,f,v;if(l)throw new cs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");l=!0;let x=!1;try{try{for(var S=!0,w=hs(kA(n,s)),C;C=yield rt(w.next()),h=C.done,!h;S=!0){v=C.value,S=!1;const T=v;if(!x)if(T.data.startsWith("[DONE]")){x=!0;continue}else try{yield yield rt(JSON.parse(T.data))}catch(E){throw c.error("Could not parse message into JSON:",T.data),c.error("From chunk:",T.raw),E}}}catch(T){m={error:T}}finally{try{!S&&!h&&(f=w.return)&&(yield rt(f.call(w)))}finally{if(m)throw m.error}}x=!0}catch(T){if(nm(T))return yield rt(void 0);throw T}finally{x||s.abort()}})}return new Br(d,s,r)}static fromReadableStream(n,s,r){let l=!1;function c(){return ps(this,arguments,function*(){var h,m,f,v;const x=new lc,S=q0(n);try{for(var w=!0,C=hs(S),T;T=yield rt(C.next()),h=T.done,!h;w=!0){v=T.value,w=!1;const E=v;for(const R of x.decode(E))yield yield rt(R)}}catch(E){m={error:E}}finally{try{!w&&!h&&(f=C.return)&&(yield rt(f.call(C)))}finally{if(m)throw m.error}}for(const E of x.flush())yield yield rt(E)})}function d(){return ps(this,arguments,function*(){var h,m,f,v;if(l)throw new cs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");l=!0;let x=!1;try{try{for(var S=!0,w=hs(c()),C;C=yield rt(w.next()),h=C.done,!h;S=!0){v=C.value,S=!1;const T=v;x||T&&(yield yield rt(JSON.parse(T)))}}catch(T){m={error:T}}finally{try{!S&&!h&&(f=w.return)&&(yield rt(f.call(w)))}finally{if(m)throw m.error}}x=!0}catch(T){if(nm(T))return yield rt(void 0);throw T}finally{x||s.abort()}})}return new Br(d,s,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const n=[],s=[],r=this.iterator(),l=c=>({next:()=>{if(c.length===0){const d=r.next();n.push(d),s.push(d)}return c.shift()}});return[new Br(()=>l(n),this.controller,this.client),new Br(()=>l(s),this.controller,this.client)]}toReadableStream(){const n=this;let s;return H0({async start(){s=n[Symbol.asyncIterator]()},async pull(r){try{const{value:l,done:c}=await s.next();if(c)return r.close();const d=_m(JSON.stringify(l)+`
`);r.enqueue(d)}catch(l){r.error(l)}},async cancel(){var r;await((r=s.return)===null||r===void 0?void 0:r.call(s))}})}}function kA(t,n){return ps(this,arguments,function*(){var r,l,c,d;if(!t.body)throw n.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new cs("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new cs("Attempted to iterate over a response with no body");const u=new MA,h=new lc,m=q0(t.body);try{for(var f=!0,v=hs(RA(m)),x;x=yield rt(v.next()),r=x.done,!r;f=!0){d=x.value,f=!1;const S=d;for(const w of h.decode(S)){const C=u.decode(w);C&&(yield yield rt(C))}}}catch(S){l={error:S}}finally{try{!f&&!r&&(c=v.return)&&(yield rt(c.call(v)))}finally{if(l)throw l.error}}for(const S of h.flush()){const w=u.decode(S);w&&(yield yield rt(w))}})}function RA(t){return ps(this,arguments,function*(){var s,r,l,c;let d=new Uint8Array;try{for(var u=!0,h=hs(t),m;m=yield rt(h.next()),s=m.done,!s;u=!0){c=m.value,u=!1;const f=c;if(f==null)continue;const v=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?_m(f):f;let x=new Uint8Array(d.length+v.length);x.set(d),x.set(v,d.length),d=x;let S;for(;(S=AA(d))!==-1;)yield yield rt(d.slice(0,S)),d=d.slice(S)}}catch(f){r={error:f}}finally{try{!u&&!s&&(l=h.return)&&(yield rt(l.call(h)))}finally{if(r)throw r.error}}d.length>0&&(yield yield rt(d))})}class MA{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(n){if(n.endsWith("\r")&&(n=n.substring(0,n.length-1)),!n){if(!this.event&&!this.data.length)return null;const c={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],c}if(this.chunks.push(n),n.startsWith(":"))return null;let[s,r,l]=PA(n,":");return l.startsWith(" ")&&(l=l.substring(1)),s==="event"?this.event=l:s==="data"&&this.data.push(l),null}}function PA(t,n){const s=t.indexOf(n);return s!==-1?[t.substring(0,s),n,t.substring(s+n.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function LA(t,n){const{response:s,requestLogID:r,retryOfRequestLogID:l,startTime:c}=n,d=await(async()=>{var u;if(n.options.stream)return _n(t).debug("response",s.status,s.url,s.headers,s.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(s,n.controller,t):Br.fromSSEResponse(s,n.controller,t);if(s.status===204)return null;if(n.options.__binaryResponse)return s;const h=s.headers.get("content-type"),m=(u=h==null?void 0:h.split(";")[0])===null||u===void 0?void 0:u.trim();return(m==null?void 0:m.includes("application/json"))||(m==null?void 0:m.endsWith("+json"))?s.headers.get("content-length")==="0"?void 0:await s.json():await s.text()})();return _n(t).debug(`[${r}] response parsed`,nr({retryOfRequestLogID:l,url:s.url,status:s.status,body:d,durationMs:Date.now()-c})),d}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Am extends Promise{constructor(n,s,r=LA){super(l=>{l(null)}),this.responsePromise=s,this.parseResponse=r,this.client=n}_thenUnwrap(n){return new Am(this.client,this.responsePromise,async(s,r)=>n(await this.parseResponse(s,r),r))}asResponse(){return this.responsePromise.then(n=>n.response)}async withResponse(){const[n,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:n,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(n=>this.parseResponse(this.client,n))),this.parsedPromise}then(n,s){return this.parse().then(n,s)}catch(n){return this.parse().catch(n)}finally(n){return this.parse().finally(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const X0=Symbol("brand.privateNullableHeaders");function*OA(t){if(!t)return;if(X0 in t){const{values:r,nulls:l}=t;yield*r.entries();for(const c of l)yield[c,null];return}let n=!1,s;t instanceof Headers?s=t.entries():gy(t)?s=t:(n=!0,s=Object.entries(t??{}));for(let r of s){const l=r[0];if(typeof l!="string")throw new TypeError("expected header name to be a string");const c=gy(r[1])?r[1]:[r[1]];let d=!1;for(const u of c)u!==void 0&&(n&&!d&&(d=!0,yield[l,null]),yield[l,u])}}const Zi=t=>{const n=new Headers,s=new Set;for(const r of t){const l=new Set;for(const[c,d]of OA(r)){const u=c.toLowerCase();l.has(u)||(n.delete(c),l.add(u)),d===null?(n.delete(c),s.add(u)):(n.append(c,d),s.delete(u))}}return{[X0]:!0,values:n,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Mu=t=>{var n,s,r,l,c,d;if(typeof globalThis.process<"u")return(r=(s=(n=nT)===null||n===void 0?void 0:n[t])===null||s===void 0?void 0:s.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(d=(c=(l=globalThis.Deno.env)===null||l===void 0?void 0:l.get)===null||c===void 0?void 0:c.call(l,t))===null||d===void 0?void 0:d.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Q0;class oc{constructor(n){var s,r,l,c,d,u,h,{baseURL:m=Mu("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(s=Mu("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:v="v1beta"}=n,x=Xo(n,["baseURL","apiKey","apiVersion"]);const S=Object.assign(Object.assign({apiKey:f,apiVersion:v},x),{baseURL:m||"https://generativelanguage.googleapis.com"});this.baseURL=S.baseURL,this.timeout=(r=S.timeout)!==null&&r!==void 0?r:oc.DEFAULT_TIMEOUT,this.logger=(l=S.logger)!==null&&l!==void 0?l:console;const w="warn";this.logLevel=w,this.logLevel=(d=(c=Ny(S.logLevel,"ClientOptions.logLevel",this))!==null&&c!==void 0?c:Ny(Mu("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&d!==void 0?d:w,this.fetchOptions=S.fetchOptions,this.maxRetries=(u=S.maxRetries)!==null&&u!==void 0?u:2,this.fetch=(h=S.fetch)!==null&&h!==void 0?h:xA(),this.encoder=bA,this._options=S,this.apiKey=f,this.apiVersion=v,this.clientAdapter=S.clientAdapter}withOptions(n){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),n))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:n,nulls:s}){if(!(n.has("authorization")||n.has("x-goog-api-key"))&&!(this.apiKey&&n.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(n){const s=Zi([n.headers]);if(!(s.values.has("authorization")||s.values.has("x-goog-api-key"))){if(this.apiKey)return Zi([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Zi([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(n){return Object.entries(n).filter(([s,r])=>typeof r<"u").map(([s,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(s)}=`;throw new cs(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Or}`}defaultIdempotencyKey(){return`stainless-node-retry-${sA()}`}makeStatusError(n,s,r,l){return An.generate(n,s,r,l)}buildURL(n,s,r){const l=!this.baseURLOverridden()&&r||this.baseURL,c=rA(n)?new URL(n):new URL(l+(l.endsWith("/")&&n.startsWith("/")?n.slice(1):n)),d=this.defaultQuery();return oA(d)||(s=Object.assign(Object.assign({},d),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(c.search=this.stringifyQuery(s)),c.toString()}async prepareOptions(n){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!n.path.startsWith(`/${this.apiVersion}/projects/`)){const s=n.path.slice(this.apiVersion.length+1);n.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${s}`}}async prepareRequest(n,{url:s,options:r}){}get(n,s){return this.methodRequest("get",n,s)}post(n,s){return this.methodRequest("post",n,s)}patch(n,s){return this.methodRequest("patch",n,s)}put(n,s){return this.methodRequest("put",n,s)}delete(n,s){return this.methodRequest("delete",n,s)}methodRequest(n,s,r){return this.request(Promise.resolve(r).then(l=>Object.assign({method:n,path:s},l)))}request(n,s=null){return new Am(this,this.makeRequest(n,s,void 0))}async makeRequest(n,s,r){var l,c,d;const u=await n,h=(l=u.maxRetries)!==null&&l!==void 0?l:this.maxRetries;s==null&&(s=h),await this.prepareOptions(u);const{req:m,url:f,timeout:v}=await this.buildRequest(u,{retryCount:h-s});await this.prepareRequest(m,{url:f,options:u});const x="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),S=r===void 0?"":`, retryOf: ${r}`,w=Date.now();if(_n(this).debug(`[${x}] sending request`,nr({retryOfRequestLogID:r,method:u.method,url:f,options:u,headers:m.headers})),!((c=u.signal)===null||c===void 0)&&c.aborted)throw new am;const C=new AbortController,T=await this.fetchWithTimeout(f,m,v,C).catch(sm),E=Date.now();if(T instanceof globalThis.Error){const _=`retrying, ${s} attempts remaining`;if(!((d=u.signal)===null||d===void 0)&&d.aborted)throw new am;const D=nm(T)||/timed? ?out/i.test(String(T)+("cause"in T?String(T.cause):""));if(s)return _n(this).info(`[${x}] connection ${D?"timed out":"failed"} - ${_}`),_n(this).debug(`[${x}] connection ${D?"timed out":"failed"} (${_})`,nr({retryOfRequestLogID:r,url:f,durationMs:E-w,message:T.message})),this.retryRequest(u,s,r??x);throw _n(this).info(`[${x}] connection ${D?"timed out":"failed"} - error; no more retries left`),_n(this).debug(`[${x}] connection ${D?"timed out":"failed"} (error; no more retries left)`,nr({retryOfRequestLogID:r,url:f,durationMs:E-w,message:T.message})),D?new M0:new ic({cause:T})}const R=`[${x}${S}] ${m.method} ${f} ${T.ok?"succeeded":"failed"} with status ${T.status} in ${E-w}ms`;if(!T.ok){const _=await this.shouldRetry(T);if(s&&_){const U=`retrying, ${s} attempts remaining`;return await vA(T.body),_n(this).info(`${R} - ${U}`),_n(this).debug(`[${x}] response error (${U})`,nr({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,durationMs:E-w})),this.retryRequest(u,s,r??x,T.headers)}const D=_?"error; no more retries left":"error; not retryable";_n(this).info(`${R} - ${D}`);const M=await T.text().catch(U=>sm(U).message),I=uA(M),O=I?void 0:M;throw _n(this).debug(`[${x}] response error (${D})`,nr({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,message:O,durationMs:Date.now()-w})),this.makeStatusError(T.status,I,O,T.headers)}return _n(this).info(R),_n(this).debug(`[${x}] response start`,nr({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,durationMs:E-w})),{response:T,options:u,controller:C,requestLogID:x,retryOfRequestLogID:r,startTime:w}}async fetchWithTimeout(n,s,r,l){const c=s||{},{signal:d,method:u}=c,h=Xo(c,["signal","method"]),m=this._makeAbort(l);d&&d.addEventListener("abort",m,{once:!0});const f=setTimeout(m,r),v=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,x=Object.assign(Object.assign(Object.assign({signal:l.signal},v?{duplex:"half"}:{}),{method:"GET"}),h);u&&(x.method=u.toUpperCase());try{return await this.fetch.call(void 0,n,x)}finally{clearTimeout(f)}}async shouldRetry(n){const s=n.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:n.status===408||n.status===409||n.status===429||n.status>=500}async retryRequest(n,s,r,l){var c;let d;const u=l==null?void 0:l.get("retry-after-ms");if(u){const m=parseFloat(u);Number.isNaN(m)||(d=m)}const h=l==null?void 0:l.get("retry-after");if(h&&!d){const m=parseFloat(h);Number.isNaN(m)?d=Date.parse(h)-Date.now():d=m*1e3}if(!(d&&0<=d&&d<60*1e3)){const m=(c=n.maxRetries)!==null&&c!==void 0?c:this.maxRetries;d=this.calculateDefaultRetryTimeoutMillis(s,m)}return await mA(d),this.makeRequest(n,s-1,r)}calculateDefaultRetryTimeoutMillis(n,s){const c=s-n,d=Math.min(.5*Math.pow(2,c),8),u=1-Math.random()*.25;return d*u*1e3}async buildRequest(n,{retryCount:s=0}={}){var r,l,c;const d=Object.assign({},n),{method:u,path:h,query:m,defaultBaseURL:f}=d,v=this.buildURL(h,m,f);"timeout"in d&&dA("timeout",d.timeout),d.timeout=(r=d.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:x,body:S}=this.buildBody({options:d}),w=await this.buildHeaders({options:n,method:u,bodyHeaders:x,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:w},d.signal&&{signal:d.signal}),globalThis.ReadableStream&&S instanceof globalThis.ReadableStream&&{duplex:"half"}),S&&{body:S}),(l=this.fetchOptions)!==null&&l!==void 0?l:{}),(c=d.fetchOptions)!==null&&c!==void 0?c:{}),url:v,timeout:d.timeout}}async buildHeaders({options:n,method:s,bodyHeaders:r,retryCount:l}){let c={};this.idempotencyHeader&&s!=="get"&&(n.idempotencyKey||(n.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=n.idempotencyKey);const d=await this.authHeaders(n);let u=Zi([c,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(l)},n.timeout?{"X-Stainless-Timeout":String(Math.trunc(n.timeout/1e3))}:{}),gA()),this._options.defaultHeaders,r,n.headers,d]);return this.validateHeaders(u),u.values}_makeAbort(n){return()=>n.abort()}buildBody({options:{body:n,headers:s}}){if(!n)return{bodyHeaders:void 0,body:void 0};const r=Zi([s]);return ArrayBuffer.isView(n)||n instanceof ArrayBuffer||n instanceof DataView||typeof n=="string"&&r.values.has("content-type")||globalThis.Blob&&n instanceof globalThis.Blob||n instanceof FormData||n instanceof URLSearchParams||globalThis.ReadableStream&&n instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:n}:typeof n=="object"&&(Symbol.asyncIterator in n||Symbol.iterator in n&&"next"in n&&typeof n.next=="function")?{bodyHeaders:void 0,body:yA(n)}:typeof n=="object"&&r.values.get("content-type")==="application/x-www-form-urlencoded"?{bodyHeaders:{"content-type":"application/x-www-form-urlencoded"},body:this.stringifyQuery(n)}:this.encoder({body:n,headers:r})}}oc.DEFAULT_TIMEOUT=6e4;class gn extends oc{constructor(){super(...arguments),this.interactions=new J0(this)}}Q0=gn;gn.GeminiNextGenAPIClient=Q0;gn.GeminiNextGenAPIClientError=cs;gn.APIError=An;gn.APIConnectionError=ic;gn.APIConnectionTimeoutError=M0;gn.APIUserAbortError=am;gn.NotFoundError=U0;gn.ConflictError=F0;gn.RateLimitError=G0;gn.BadRequestError=P0;gn.AuthenticationError=L0;gn.InternalServerError=z0;gn.PermissionDeniedError=O0;gn.UnprocessableEntityError=B0;gn.toFile=wA;gn.Interactions=J0;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UA(t,n){const s={},r=g(t,["name"]);return r!=null&&y(s,["_url","name"],r),s}function FA(t,n){const s={},r=g(t,["name"]);return r!=null&&y(s,["_url","name"],r),s}function BA(t,n){const s={},r=g(t,["sdkHttpResponse"]);return r!=null&&y(s,["sdkHttpResponse"],r),s}function GA(t,n){const s={},r=g(t,["sdkHttpResponse"]);return r!=null&&y(s,["sdkHttpResponse"],r),s}function zA(t,n,s){const r={};if(g(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const l=g(t,["tunedModelDisplayName"]);if(n!==void 0&&l!=null&&y(n,["displayName"],l),g(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const c=g(t,["epochCount"]);n!==void 0&&c!=null&&y(n,["tuningTask","hyperparameters","epochCount"],c);const d=g(t,["learningRateMultiplier"]);if(d!=null&&y(r,["tuningTask","hyperparameters","learningRateMultiplier"],d),g(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(g(t,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(g(t,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const u=g(t,["batchSize"]);n!==void 0&&u!=null&&y(n,["tuningTask","hyperparameters","batchSize"],u);const h=g(t,["learningRate"]);if(n!==void 0&&h!=null&&y(n,["tuningTask","hyperparameters","learningRate"],h),g(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(g(t,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(g(t,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(g(t,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(g(t,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");if(g(t,["encryptionSpec"])!==void 0)throw new Error("encryptionSpec parameter is not supported in Gemini API.");return r}function HA(t,n,s){const r={};let l=g(s,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const I=g(t,["validationDataset"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec"],Pu(I))}else if(l==="PREFERENCE_TUNING"){const I=g(t,["validationDataset"]);n!==void 0&&I!=null&&y(n,["preferenceOptimizationSpec"],Pu(I))}else if(l==="DISTILLATION"){const I=g(t,["validationDataset"]);n!==void 0&&I!=null&&y(n,["distillationSpec"],Pu(I))}const c=g(t,["tunedModelDisplayName"]);n!==void 0&&c!=null&&y(n,["tunedModelDisplayName"],c);const d=g(t,["description"]);n!==void 0&&d!=null&&y(n,["description"],d);let u=g(s,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const I=g(t,["epochCount"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec","hyperParameters","epochCount"],I)}else if(u==="PREFERENCE_TUNING"){const I=g(t,["epochCount"]);n!==void 0&&I!=null&&y(n,["preferenceOptimizationSpec","hyperParameters","epochCount"],I)}else if(u==="DISTILLATION"){const I=g(t,["epochCount"]);n!==void 0&&I!=null&&y(n,["distillationSpec","hyperParameters","epochCount"],I)}let h=g(s,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const I=g(t,["learningRateMultiplier"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],I)}else if(h==="PREFERENCE_TUNING"){const I=g(t,["learningRateMultiplier"]);n!==void 0&&I!=null&&y(n,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],I)}else if(h==="DISTILLATION"){const I=g(t,["learningRateMultiplier"]);n!==void 0&&I!=null&&y(n,["distillationSpec","hyperParameters","learningRateMultiplier"],I)}let m=g(s,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const I=g(t,["exportLastCheckpointOnly"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec","exportLastCheckpointOnly"],I)}else if(m==="PREFERENCE_TUNING"){const I=g(t,["exportLastCheckpointOnly"]);n!==void 0&&I!=null&&y(n,["preferenceOptimizationSpec","exportLastCheckpointOnly"],I)}else if(m==="DISTILLATION"){const I=g(t,["exportLastCheckpointOnly"]);n!==void 0&&I!=null&&y(n,["distillationSpec","exportLastCheckpointOnly"],I)}let f=g(s,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const I=g(t,["adapterSize"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec","hyperParameters","adapterSize"],I)}else if(f==="PREFERENCE_TUNING"){const I=g(t,["adapterSize"]);n!==void 0&&I!=null&&y(n,["preferenceOptimizationSpec","hyperParameters","adapterSize"],I)}else if(f==="DISTILLATION"){const I=g(t,["adapterSize"]);n!==void 0&&I!=null&&y(n,["distillationSpec","hyperParameters","adapterSize"],I)}let v=g(s,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const I=g(t,["tuningMode"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec","tuningMode"],I)}const x=g(t,["customBaseModel"]);n!==void 0&&x!=null&&y(n,["customBaseModel"],x);let S=g(s,["config","method"]);if(S===void 0&&(S="SUPERVISED_FINE_TUNING"),S==="SUPERVISED_FINE_TUNING"){const I=g(t,["batchSize"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec","hyperParameters","batchSize"],I)}let w=g(s,["config","method"]);if(w===void 0&&(w="SUPERVISED_FINE_TUNING"),w==="SUPERVISED_FINE_TUNING"){const I=g(t,["learningRate"]);n!==void 0&&I!=null&&y(n,["supervisedTuningSpec","hyperParameters","learningRate"],I)}const C=g(t,["labels"]);n!==void 0&&C!=null&&y(n,["labels"],C);const T=g(t,["beta"]);n!==void 0&&T!=null&&y(n,["preferenceOptimizationSpec","hyperParameters","beta"],T);const E=g(t,["baseTeacherModel"]);n!==void 0&&E!=null&&y(n,["distillationSpec","baseTeacherModel"],E);const R=g(t,["tunedTeacherModelSource"]);n!==void 0&&R!=null&&y(n,["distillationSpec","tunedTeacherModelSource"],R);const _=g(t,["sftLossWeightMultiplier"]);n!==void 0&&_!=null&&y(n,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],_);const D=g(t,["outputUri"]);n!==void 0&&D!=null&&y(n,["outputUri"],D);const M=g(t,["encryptionSpec"]);return n!==void 0&&M!=null&&y(n,["encryptionSpec"],M),r}function qA(t,n){const s={},r=g(t,["baseModel"]);r!=null&&y(s,["baseModel"],r);const l=g(t,["preTunedModel"]);l!=null&&y(s,["preTunedModel"],l);const c=g(t,["trainingDataset"]);c!=null&&tD(c);const d=g(t,["config"]);return d!=null&&zA(d,s),s}function VA(t,n){const s={},r=g(t,["baseModel"]);r!=null&&y(s,["baseModel"],r);const l=g(t,["preTunedModel"]);l!=null&&y(s,["preTunedModel"],l);const c=g(t,["trainingDataset"]);c!=null&&nD(c,s,n);const d=g(t,["config"]);return d!=null&&HA(d,s,n),s}function KA(t,n){const s={},r=g(t,["name"]);return r!=null&&y(s,["_url","name"],r),s}function $A(t,n){const s={},r=g(t,["name"]);return r!=null&&y(s,["_url","name"],r),s}function WA(t,n,s){const r={},l=g(t,["pageSize"]);n!==void 0&&l!=null&&y(n,["_query","pageSize"],l);const c=g(t,["pageToken"]);n!==void 0&&c!=null&&y(n,["_query","pageToken"],c);const d=g(t,["filter"]);return n!==void 0&&d!=null&&y(n,["_query","filter"],d),r}function YA(t,n,s){const r={},l=g(t,["pageSize"]);n!==void 0&&l!=null&&y(n,["_query","pageSize"],l);const c=g(t,["pageToken"]);n!==void 0&&c!=null&&y(n,["_query","pageToken"],c);const d=g(t,["filter"]);return n!==void 0&&d!=null&&y(n,["_query","filter"],d),r}function JA(t,n){const s={},r=g(t,["config"]);return r!=null&&WA(r,s),s}function XA(t,n){const s={},r=g(t,["config"]);return r!=null&&YA(r,s),s}function QA(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["nextPageToken"]);l!=null&&y(s,["nextPageToken"],l);const c=g(t,["tunedModels"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(u=>Z0(u))),y(s,["tuningJobs"],d)}return s}function ZA(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["nextPageToken"]);l!=null&&y(s,["nextPageToken"],l);const c=g(t,["tuningJobs"]);if(c!=null){let d=c;Array.isArray(d)&&(d=d.map(u=>lm(u))),y(s,["tuningJobs"],d)}return s}function eD(t,n){const s={},r=g(t,["name"]);r!=null&&y(s,["model"],r);const l=g(t,["name"]);return l!=null&&y(s,["endpoint"],l),s}function tD(t,n){const s={};if(g(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=g(t,["examples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),y(s,["examples","examples"],l)}return s}function nD(t,n,s){const r={};let l=g(s,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const d=g(t,["gcsUri"]);n!==void 0&&d!=null&&y(n,["supervisedTuningSpec","trainingDatasetUri"],d)}else if(l==="PREFERENCE_TUNING"){const d=g(t,["gcsUri"]);n!==void 0&&d!=null&&y(n,["preferenceOptimizationSpec","trainingDatasetUri"],d)}else if(l==="DISTILLATION"){const d=g(t,["gcsUri"]);n!==void 0&&d!=null&&y(n,["distillationSpec","promptDatasetUri"],d)}let c=g(s,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const d=g(t,["vertexDatasetResource"]);n!==void 0&&d!=null&&y(n,["supervisedTuningSpec","trainingDatasetUri"],d)}else if(c==="PREFERENCE_TUNING"){const d=g(t,["vertexDatasetResource"]);n!==void 0&&d!=null&&y(n,["preferenceOptimizationSpec","trainingDatasetUri"],d)}else if(c==="DISTILLATION"){const d=g(t,["vertexDatasetResource"]);n!==void 0&&d!=null&&y(n,["distillationSpec","promptDatasetUri"],d)}if(g(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Z0(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["name"]);l!=null&&y(s,["name"],l);const c=g(t,["state"]);c!=null&&y(s,["state"],h0(c));const d=g(t,["createTime"]);d!=null&&y(s,["createTime"],d);const u=g(t,["tuningTask","startTime"]);u!=null&&y(s,["startTime"],u);const h=g(t,["tuningTask","completeTime"]);h!=null&&y(s,["endTime"],h);const m=g(t,["updateTime"]);m!=null&&y(s,["updateTime"],m);const f=g(t,["description"]);f!=null&&y(s,["description"],f);const v=g(t,["baseModel"]);v!=null&&y(s,["baseModel"],v);const x=g(t,["_self"]);return x!=null&&y(s,["tunedModel"],eD(x)),s}function lm(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["name"]);l!=null&&y(s,["name"],l);const c=g(t,["state"]);c!=null&&y(s,["state"],h0(c));const d=g(t,["createTime"]);d!=null&&y(s,["createTime"],d);const u=g(t,["startTime"]);u!=null&&y(s,["startTime"],u);const h=g(t,["endTime"]);h!=null&&y(s,["endTime"],h);const m=g(t,["updateTime"]);m!=null&&y(s,["updateTime"],m);const f=g(t,["error"]);f!=null&&y(s,["error"],f);const v=g(t,["description"]);v!=null&&y(s,["description"],v);const x=g(t,["baseModel"]);x!=null&&y(s,["baseModel"],x);const S=g(t,["tunedModel"]);S!=null&&y(s,["tunedModel"],S);const w=g(t,["preTunedModel"]);w!=null&&y(s,["preTunedModel"],w);const C=g(t,["supervisedTuningSpec"]);C!=null&&y(s,["supervisedTuningSpec"],C);const T=g(t,["preferenceOptimizationSpec"]);T!=null&&y(s,["preferenceOptimizationSpec"],T);const E=g(t,["distillationSpec"]);E!=null&&y(s,["distillationSpec"],E);const R=g(t,["tuningDataStats"]);R!=null&&y(s,["tuningDataStats"],R);const _=g(t,["encryptionSpec"]);_!=null&&y(s,["encryptionSpec"],_);const D=g(t,["partnerModelTuningSpec"]);D!=null&&y(s,["partnerModelTuningSpec"],D);const M=g(t,["customBaseModel"]);M!=null&&y(s,["customBaseModel"],M);const I=g(t,["experiment"]);I!=null&&y(s,["experiment"],I);const O=g(t,["labels"]);O!=null&&y(s,["labels"],O);const A=g(t,["outputUri"]);A!=null&&y(s,["outputUri"],A);const U=g(t,["pipelineJob"]);U!=null&&y(s,["pipelineJob"],U);const P=g(t,["serviceAccount"]);P!=null&&y(s,["serviceAccount"],P);const F=g(t,["tunedModelDisplayName"]);F!=null&&y(s,["tunedModelDisplayName"],F);const q=g(t,["veoTuningSpec"]);return q!=null&&y(s,["veoTuningSpec"],q),s}function sD(t,n){const s={},r=g(t,["sdkHttpResponse"]);r!=null&&y(s,["sdkHttpResponse"],r);const l=g(t,["name"]);l!=null&&y(s,["name"],l);const c=g(t,["metadata"]);c!=null&&y(s,["metadata"],c);const d=g(t,["done"]);d!=null&&y(s,["done"],d);const u=g(t,["error"]);return u!=null&&y(s,["error"],u),s}function Pu(t,n){const s={},r=g(t,["gcsUri"]);r!=null&&y(s,["validationDatasetUri"],r);const l=g(t,["vertexDatasetResource"]);return l!=null&&y(s,["validationDatasetUri"],l),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aD extends na{constructor(n){super(),this.apiClient=n,this.list=async(s={})=>new ar(ta.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(s),s),this.get=async s=>await this.getInternal(s),this.tune=async s=>{var r;if(this.apiClient.isVertexAI())if(s.baseModel.startsWith("projects/")){const l={tunedModelName:s.baseModel};!((r=s.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(l.checkpointId=s.config.preTunedModelCheckpointId);const c=Object.assign(Object.assign({},s),{preTunedModel:l});return c.baseModel=void 0,await this.tuneInternal(c)}else{const l=Object.assign({},s);return await this.tuneInternal(l)}else{const l=Object.assign({},s),c=await this.tuneMldevInternal(l);let d="";return c.metadata!==void 0&&c.metadata.tunedModel!==void 0?d=c.metadata.tunedModel:c.name!==void 0&&c.name.includes("/operations/")&&(d=c.name.split("/operations/")[0]),{name:d,state:Wu.JOB_STATE_QUEUED}}}}async getInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=$A(n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>lm(f))}else{const m=KA(n);return u=Ve("{name}",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>Z0(f))}}async listInternal(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=XA(n);return u=Ve("tuningJobs",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=ZA(f),x=new Yx;return Object.assign(x,v),x})}else{const m=JA(n);return u=Ve("tunedModels",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=QA(f),x=new Yx;return Object.assign(x,v),x})}}async cancel(n){var s,r,l,c;let d,u="",h={};if(this.apiClient.isVertexAI()){const m=FA(n);return u=Ve("{name}:cancel",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=GA(f),x=new Jx;return Object.assign(x,v),x})}else{const m=UA(n);return u=Ve("{name}:cancel",m._url),h=m._query,delete m._url,delete m._query,d=this.apiClient.request({path:u,queryParams:h,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(l=n.config)===null||l===void 0?void 0:l.httpOptions,abortSignal:(c=n.config)===null||c===void 0?void 0:c.abortSignal}).then(f=>f.json().then(v=>{const x=v;return x.sdkHttpResponse={headers:f.headers},x})),d.then(f=>{const v=BA(f),x=new Jx;return Object.assign(x,v),x})}}async tuneInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const u=VA(n,n);return c=Ve("tuningJobs",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const f=m;return f.sdkHttpResponse={headers:h.headers},f})),l.then(h=>lm(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var s,r;let l,c="",d={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qA(n);return c=Ve("tunedModels",u._url),d=u._query,delete u._url,delete u._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=n.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=n.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(m=>{const f=m;return f.sdkHttpResponse={headers:h.headers},f})),l.then(h=>sD(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rD{async download(n,s){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const iD=1024*1024*8,lD=3,oD=1e3,cD=2,Zo="x-goog-upload-status";async function dD(t,n,s){var r;const l=await ev(t,n,s),c=await(l==null?void 0:l.json());if(((r=l==null?void 0:l.headers)===null||r===void 0?void 0:r[Zo])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}async function uD(t,n,s){var r;const l=await ev(t,n,s),c=await(l==null?void 0:l.json());if(((r=l==null?void 0:l.headers)===null||r===void 0?void 0:r[Zo])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const d=c0(c),u=new jm;return Object.assign(u,d),u}async function ev(t,n,s){var r,l;let c=0,d=0,u=new Ju(new Response),h="upload";for(c=t.size;d<c;){const m=Math.min(iD,c-d),f=t.slice(d,d+m);d+m>=c&&(h+=", finalize");let v=0,x=oD;for(;v<lD&&(u=await s.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(d),"Content-Length":String(m)}}}),!(!((r=u==null?void 0:u.headers)===null||r===void 0)&&r[Zo]));)v++,await fD(x),x=x*cD;if(d+=m,((l=u==null?void 0:u.headers)===null||l===void 0?void 0:l[Zo])!=="active")break;if(c<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function mD(t){return{size:t.size,type:t.type}}function fD(t){return new Promise(n=>setTimeout(n,t))}class pD{async upload(n,s,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await dD(n,s,r)}async uploadToFileSearchStore(n,s,r){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await uD(n,s,r)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await mD(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hD{create(n,s,r){return new gD(n,s,r)}}class gD{constructor(n,s,r){this.url=n,this.headers=s,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jy="x-goog-api-key";class xD{constructor(n){this.apiKey=n}async addAuthHeaders(n,s){if(n.get(jy)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");n.append(jy,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yD="gl-node/";class vD{get interactions(){var n;if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const s=this.httpOptions;s!=null&&s.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const r=new gn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:s==null?void 0:s.timeout,maxRetries:(n=s==null?void 0:s.retryOptions)===null||n===void 0?void 0:n.attempts});return this._interactions=r.interactions,this._interactions}constructor(n){var s;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=n.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=n.apiKey;const r=iT(n.httpOptions,n.vertexai,void 0,void 0);r&&(n.httpOptions?n.httpOptions.baseUrl=r:n.httpOptions={baseUrl:r}),this.apiVersion=n.apiVersion,this.httpOptions=n.httpOptions;const l=new xD(this.apiKey);this.apiClient=new m_({auth:l,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:yD+"web",uploader:new pD,downloader:new rD}),this.models=new D_(this.apiClient),this.live=new w_(this.apiClient,l,new hD),this.batches=new Ow(this.apiClient),this.chats=new yC(this.models,this.apiClient),this.caches=new hC(this.apiClient),this.files=new AC(this.apiClient),this.operations=new k_(this.apiClient),this.authTokens=new W_(this.apiClient),this.tunings=new aD(this.apiClient),this.fileSearchStores=new nA(this.apiClient)}}var bD={};const dl=typeof process<"u"&&bD?"your-gemini-api-key-here":"",cc=new vD({apiKey:dl});async function Jn(t){if(!dl)return console.warn("Gemini API Key is missing. Narrative generation skipped."),"API Key missing. Cannot generate narrative.";try{return(await cc.models.generateContent({model:"gemini-3-flash-preview",contents:t})).text||""}catch(n){return console.error("Gemini API Error:",n),"Error generating content."}}const ND=async(t,n)=>{const s=`
        You are a supportive agricultural advisor for a seaweed farm. Write a monthly performance review for a specific farmer.
        Write in English. Tone: Professional, encouraging, and constructive.

        Farmer: ${t.farmerName} (Site: ${t.siteName})
        Period: ${t.period}

        Data:
        - Planted: ${t.production.plantedLines} lines
        - Harvested: ${t.production.harvestedLines} lines
        - Total Weight: ${t.production.harvestedWeight.toFixed(2)} kg
        - Average Growth Rate: ${t.efficiency.avgGrowthRate.toFixed(2)} %/day
        - Currently Active Cycles: ${t.efficiency.activeCycles}
        - Incidents Reported: ${t.incidentsCount}

        Instructions:
        1. Start with a summary of their production.
        2. Evaluate their efficiency based on growth rate (Standard is ~3-4%).
        3. Mention their engagement based on planted lines.
        4. Address any incidents.
        5. Conclude with advice.
        Format with "###" headings.
    `,r=`
        Vous tes un conseiller agricole bienveillant pour une ferme d'algues. Rdigez un bilan de performance mensuel pour un fermier spcifique.
        Rdigez en franais. Ton : Professionnel, encourageant et constructif.

        Fermier : ${t.farmerName} (Site : ${t.siteName})
        Priode : ${t.period}

        Donnes :
        - Plant : ${t.production.plantedLines} lignes
        - Rcolt : ${t.production.harvestedLines} lignes
        - Poids Total : ${t.production.harvestedWeight.toFixed(2)} kg
        - Taux de Croissance Moyen : ${t.efficiency.avgGrowthRate.toFixed(2)} %/jour
        - Cycles Actuellement Actifs : ${t.efficiency.activeCycles}
        - Incidents Signals : ${t.incidentsCount}

        Instructions :
        1. Commencez par un rsum de leur production.
        2. valuez leur efficacit (Standard ~3-4%).
        3. Mentionnez leur engagement.
        4. Abordez les incidents s'il y en a.
        5. Concluez par un conseil.
        Utilisez "###" pour les titres de section.
    `;return Jn(n==="fr"?r:s)},SD=async(t,n)=>{const s=`
        As an aquaculture expert, suggest a drying strategy.
        Language: ${n==="fr"?"French":"English"}
        
        Seaweed Type: ${t.seaweedType}
        Wet Weight: ${t.totalWeight} kg
        Harvest Notes: ${t.notes}
        
        Suggest estimated drying time, target moisture content, and specific precautions.
    `;return Jn(s)},jD=async(t,n,s,r,l)=>{if(!dl)return console.warn("Gemini API Key is missing. Incident description analysis skipped."),{};const c=`
        Analyze this incident description from a seaweed farm: "${t}"
        
        Available Incident Types: ${s.map(d=>d.id).join(", ")}
        Available Severities: ${r.map(d=>d.id).join(", ")}
        Available Module Codes: ${n.join(", ")}
        
        Return a JSON object with:
        - suggestedType (string, one of available types)
        - suggestedSeverity (string, one of available severities)
        - suggestedModuleCodes (array of strings, matches found in description)
    `;try{const d=await cc.models.generateContent({model:"gemini-3-flash-preview",contents:c,config:{responseMimeType:"application/json",responseSchema:{type:ln.OBJECT,properties:{suggestedType:{type:ln.STRING},suggestedSeverity:{type:ln.STRING},suggestedModuleCodes:{type:ln.ARRAY,items:{type:ln.STRING}}}}}});return JSON.parse(d.text||"{}")}catch(d){return console.error("Gemini JSON analysis failed",d),{}}},TD=async(t,n)=>{var r;if(!dl)return console.warn("Gemini API Key is missing. Image analysis skipped."),{description:"API Key missing. Cannot analyze image.",severity:"LOW",type:"OTHER",treatments:""};const s=`
        Analyze this image of seaweed. It might show signs of disease (like Ice-Ice, EFA), pests (grazing), or be healthy.
        
        Identify the most likely issue.
        Output ONLY a JSON object with:
        - type: (one of: "PEST_DISEASE", "ENVIRONMENTAL", "OTHER")
        - severity: (one of: "LOW", "MEDIUM", "HIGH", "CRITICAL")
        - description: A short description of the visual symptoms observed in ${n==="fr"?"French":"English"}.
        - treatments: A concise list of immediate actions or treatments recommended for this specific issue in ${n==="fr"?"French":"English"}.
    `;try{const l=t.split(",")[1]||t;let d=((r=(await cc.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{mimeType:"image/jpeg",data:l}},{text:s}]}})).text)==null?void 0:r.trim())||"{}";return d.startsWith("```json")?d=d.substring(7,d.length-3).trim():d.startsWith("```")&&(d=d.substring(3,d.length-3).trim()),JSON.parse(d)}catch(l){return console.error("Gemini Image analysis failed",l),{description:"Analysis failed",severity:"LOW",type:"OTHER",treatments:""}}},wD=async(t,n,s,r,l,c)=>{if(!dl)return console.warn("Gemini API Key is missing. Prediction skipped."),null;const d=r.map(m=>({planted:m.plantingDate,harvested:m.harvestDate,yield:m.harvestedWeight})),u=l.map(m=>({temp:m.temperature,salinity:m.salinity,date:m.date})),h=`
        Predict harvest date and yield for a seaweed cycle.
        Language: ${c==="fr"?"French":"English"}
        
        Current Cycle: Planted ${t.plantingDate}, Type ${s.name}, Initial Weight ${t.initialWeight}kg.
        Historical Data: ${JSON.stringify(d.slice(0,10))}
        Recent Weather: ${JSON.stringify(u.slice(0,5))}
        
        Return JSON with:
        - predictedHarvestDateStart (YYYY-MM-DD)
        - predictedHarvestDateEnd (YYYY-MM-DD)
        - predictedYieldKgMin (number)
        - predictedYieldKgMax (number)
        - confidenceScore (0.0 to 1.0)
        - reasoning (string)
    `;try{const m=await cc.models.generateContent({model:"gemini-3-pro-preview",contents:h,config:{responseMimeType:"application/json",responseSchema:{type:ln.OBJECT,properties:{predictedHarvestDateStart:{type:ln.STRING},predictedHarvestDateEnd:{type:ln.STRING},predictedYieldKgMin:{type:ln.NUMBER},predictedYieldKgMax:{type:ln.NUMBER},confidenceScore:{type:ln.NUMBER},reasoning:{type:ln.STRING}}}}});return JSON.parse(m.text||"{}")}catch(m){return console.error("Gemini harvest prediction failed",m),null}},CD=async(t,n)=>{const s=`
        Analyze monthly production report data.
        Language: ${n==="fr"?"French":"English"}
        Data: ${JSON.stringify(t).substring(0,2e3)}
        
        Highlight top performers, underperforming batches, and duration trends. Use "###" for headings.
    `;return Jn(s)},ED=async(t,n,s)=>{const r=`
        Analyze credit report.
        Language: ${s==="fr"?"French":"English"}
        Summary: ${JSON.stringify(n)}
        
        Discuss credit usage trends and top borrowers. Use "###" for headings.
    `;return Jn(r)},ID=async(t,n,s)=>{const r=`
        Analyze inventory report.
        Language: ${s==="fr"?"French":"English"}
        Summary: ${JSON.stringify(n)}
        
        Discuss stock composition and value distribution. Use "###" for headings.
    `;return Jn(r)},_D=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste de donnes agricoles. Analysez les donnes JSON fournies qui correspondent au tableau "Aperu Gnral de la Ferme".
        
        INSTRUCTIONS STRICTES :
        1. Ne donnez PAS de conseils gnraux sur l'agriculture.
        2. Ne parlez QUE des chiffres prsents dans les donnes. Assumez que tout champ manquant ou vide a une valeur de zro.
        3. Interprtez les colonnes suivantes : 
           - Comparez le "Total Lignes  l'eau" par rapport aux "Total Lignes Rcoltes".
           - Comparez la "Production (Kg)" entre les sites s'il y en a plusieurs.
           - Analysez le "Taux de croissance moyen" : est-il cohrent avec la production ?
           - Commentez la "Prvision de production" (m1, m2, m3) : la tendance est-elle  la hausse ou  la baisse ?
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais de manire concise et factuelle.
    `;return`${JSON.stringify(t)}`,Jn(s)},AD=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste RH. Analysez les donnes JSON fournies correspondant au tableau "Rpartition des Salaris par Site".
        
        INSTRUCTIONS STRICTES :
        1. Comparez les effectifs "Permanents" vs "Journaliers".
        2. Identifiez quel site a la masse salariale ("Montant du mois") la plus leve.
        3. Calculez et mentionnez le cot moyen par employ si pertinent bas sur les totaux.
        4. Ne faites aucune supposition extrieure aux chiffres fournis. Assumez que tout champ manquant ou vide a une valeur de zro.
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais.
    `;return`${JSON.stringify(t)}`,Jn(s)},DD=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste de stock. Analysez les donnes JSON fournies correspondant au tableau "Stocks sur Sites".
        
        INSTRUCTIONS STRICTES :
        1. Pour chaque site/type d'algue, comparez le "Stock Ouverture" au "Stock Fermeture". Le stock a-t-il augment ou diminu ?
        2. Analysez les volumes d'"Entres" (rcoltes) par rapport aux "Sorties" (transferts/ventes).
        3. Signalez tout site o le stock de fermeture semble anormalement lev par rapport aux sorties (accumulation).
        4. Assumez que tout champ manquant ou vide a une valeur de zro.
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais.
    `;return`${JSON.stringify(t)}`,Jn(s)},kD=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste logistique. Analysez les donnes JSON fournies correspondant au tableau "Stock Magasin de Presse".
        
        INSTRUCTIONS STRICTES :
        1. Distinguez clairement les "Algues en Vrac" (matire premire) des "Algues Presses" (produit fini).
        2. Commentez le taux de transformation : les sorties de Vrac correspondent-elles aux entres de Press (approximativement) ?
        3. Analysez le stock final de balles prtes  l'export.
        4. Assumez que tout champ manquant ou vide a une valeur de zro.
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais.
    `;return`${JSON.stringify(t)}`,Jn(s)},RD=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste export. Analysez les donnes JSON fournies correspondant au tableau "Liste des Exportations Ralises".
        
        INSTRUCTIONS STRICTES :
        1. Rsumez le volume total (Kg) et la valeur totale exporte sur la priode.
        2. Comparez ces chiffres aux totaux de l'anne (si fournis).
        3. Mentionnez les principales destinations ou clients bass sur les colonnes "Destinataire" et "Facture N".
        4. Assumez que tout champ manquant ou vide a une valeur de zro.
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais.
    `;return`${JSON.stringify(t)}`,Jn(s)},MD=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste de production. Analysez les donnes JSON fournies correspondant  la matrice "Production Mensuelle par Site".
        
        INSTRUCTIONS STRICTES :
        1. Identifiez le mois ayant la plus forte production (Kg) et celui avec la plus faible.
        2. Observez la tendance des "Taux de croissance (%)" au fil des mois : y a-t-il une saisonnalit visible ?
        3. Comparez la performance relative des diffrents sites sur les 3 derniers mois affichs.
        4. Assumez que tout champ manquant ou vide a une valeur de zro.
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais.
    `;return`${JSON.stringify(t)}`,Jn(s)},PD=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste financier. Analysez les donnes JSON fournies correspondant au tableau "Situation des Crdits".
        
        INSTRUCTIONS STRICTES :
        1. Comparez les colonnes du "Mois Prcdent" avec celles du "Mois En Cours" (Priode actuelle).
        2. Le "Solde Crdits" a-t-il augment ou diminu ?
        3. Analysez le ratio entre "Total Remboursements" et l'encours de crdit. Le recouvrement est-il efficace sur cette priode ?
        4. Ne citez que les chiffres du tableau. Assumez que tout champ manquant ou vide a une valeur de zro.
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais.
    `;return`${JSON.stringify(t)}`,Jn(s)},LD=async(t,n)=>{const s=`
        Agissez strictement en tant qu'analyste de performance. Analysez les donnes JSON fournies correspondant au tableau "Statistique Individuelle des Fermiers".
        
        INSTRUCTIONS STRICTES :
        1. Identifiez les 3 fermiers ayant la plus grosse production (Kg) sur la priode la plus rcente (colonne la plus  droite).
        2. Reprez les fermiers ayant des lignes plantes ("P") mais aucune rcolte ("R") ou une production trs faible ("Kg"), signalant un problme potentiel.
        3. Commentez la tendance gnrale : la majorit des fermiers sont-ils en phase de plantation ou de rcolte ?
        4. Ne faites aucune supposition ou conseil. Basez-vous uniquement sur les chiffres. Assumez que tout champ manquant ou vide a une valeur de zro.
        
        Donnes : ${JSON.stringify(t)}
        Rpondez en franais.
    `;return`${JSON.stringify(t)}`,Jn(s)},Dm=({children:t,content:n,className:s})=>e.jsxs("div",{className:`relative group flex items-center ${s}`,children:[t,e.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max max-w-xs p-3 text-sm text-white bg-gray-900 dark:bg-black rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none z-20",children:[n,e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-x-4 border-x-transparent border-t-4 border-t-gray-900 dark:border-t-black"})]})]}),tv=({isOpen:t,onClose:n,operationToEdit:s})=>{const{t:r}=je(),{sites:l,getFarmersBySite:c,modules:d,seaweedTypes:u,employees:h,serviceProviders:m,startCultivationFromCuttings:f,updateCuttingOperation:v,cultivationCycles:x}=qe(),{settings:S}=$e(),w=N.useCallback(()=>{var q,z,J,W,G,B;if(s){const X=x.find(ae=>ae.cuttingOperationId===s.id),$=d.find(ae=>{var H;return ae.id===((H=s.moduleCuts[0])==null?void 0:H.moduleId)});return{serviceProviderId:s.serviceProviderId,siteId:s.siteId,date:s.date,plantingDate:(X==null?void 0:X.plantingDate)||s.date,lines:String(((q=s.moduleCuts[0])==null?void 0:q.linesCut)||""),initialWeight:String((X==null?void 0:X.initialWeight)||""),seaweedTypeId:s.seaweedTypeId,pricePerLine:String(s.unitPrice),beneficiaryFarmerId:s.beneficiaryFarmerId||($==null?void 0:$.farmerId)||"",zoneId:($==null?void 0:$.zoneId)||"",moduleId:($==null?void 0:$.id)||""}}const F=new Date().toISOString().split("T")[0];return{serviceProviderId:((z=m[0])==null?void 0:z.id)||"",siteId:((J=l[0])==null?void 0:J.id)||"",date:F,plantingDate:F,lines:"",initialWeight:"",seaweedTypeId:((W=u[0])==null?void 0:W.id)||"",pricePerLine:"",beneficiaryFarmerId:"",zoneId:((B=(G=l.find(X=>{var $;return X.id===((($=l[0])==null?void 0:$.id)||"")}))==null?void 0:G.zones[0])==null?void 0:B.id)||"",moduleId:""}},[s,l,m,u,x,d]),[C,T]=N.useState(w()),[E,R]=N.useState({});N.useEffect(()=>{t&&T(w())},[t,w]);const _=N.useMemo(()=>{var F;return((F=l.find(q=>q.id===C.siteId))==null?void 0:F.zones)||[]},[l,C.siteId]),D=N.useMemo(()=>c(C.siteId),[c,C.siteId]),M=N.useMemo(()=>d.filter(F=>{var J;if(F.siteId!==C.siteId||C.zoneId&&F.zoneId!==C.zoneId)return!1;const q=F.statusHistory||[],z=q.length>0?q[q.length-1].status:"FREE";return s&&F.id===((J=s.moduleCuts[0])==null?void 0:J.moduleId)?!0:z==="FREE"}),[d,C.siteId,C.zoneId,s]),I=N.useMemo(()=>{const F=parseFloat(C.lines),q=parseFloat(C.pricePerLine);return!isNaN(F)&&!isNaN(q)?F*q:0},[C.lines,C.pricePerLine]),O=F=>{const q=l.find(z=>z.id===F);T(z=>{var J;return{...z,siteId:F,zoneId:((J=q==null?void 0:q.zones[0])==null?void 0:J.id)||"",beneficiaryFarmerId:"",moduleId:""}})},A=N.useCallback(()=>{const F={};return C.serviceProviderId||(F.serviceProviderId=r("validationRequired")),C.siteId||(F.siteId=r("validationRequired")),C.date||(F.date=r("validationRequired")),C.plantingDate||(F.plantingDate=r("validationRequired")),new Date(C.plantingDate)<new Date(C.date)&&(F.plantingDate=r("validationPlantingDateAfterOperation")),(!C.lines||parseFloat(C.lines)<=0)&&(F.lines=r("validationPositiveNumber")),(!C.initialWeight||parseFloat(C.initialWeight)<=0)&&(F.initialWeight=r("validationPositiveNumber")),C.seaweedTypeId||(F.seaweedTypeId=r("validationRequired")),(!C.pricePerLine||parseFloat(C.pricePerLine)<0)&&(F.pricePerLine=r("validationNonNegative")),C.beneficiaryFarmerId||(F.beneficiaryFarmerId=r("validationRequired")),C.zoneId||(F.zoneId=r("validationRequired")),C.moduleId||(F.moduleId=r("validationRequired")),F},[C,r]);N.useEffect(()=>{R(A())},[C,A]);const U=F=>{F.preventDefault();const q=A();if(Object.keys(q).length>0){R(q);return}const z=d.find(J=>J.id===C.moduleId);if(s){const J={date:C.date,siteId:C.siteId,serviceProviderId:C.serviceProviderId,moduleCuts:[{moduleId:C.moduleId,linesCut:parseFloat(C.lines)}],unitPrice:parseFloat(C.pricePerLine),totalAmount:I,notes:r("notes_plantingOperationForModule").replace("{code}",(z==null?void 0:z.code)||""),seaweedTypeId:C.seaweedTypeId,beneficiaryFarmerId:C.beneficiaryFarmerId},W={...s,...J},G={[C.moduleId]:parseFloat(C.initialWeight)};v(W,G,C.plantingDate)}else{const J={date:C.date,siteId:C.siteId,serviceProviderId:C.serviceProviderId,moduleCuts:[{moduleId:C.moduleId,linesCut:parseFloat(C.lines)}],unitPrice:parseFloat(C.pricePerLine),totalAmount:I,isPaid:!1,notes:r("notes_plantingOperationForModule").replace("{code}",(z==null?void 0:z.code)||""),seaweedTypeId:C.seaweedTypeId},W={moduleId:C.moduleId,seaweedTypeId:C.seaweedTypeId,plantingDate:C.plantingDate,status:Je.PLANTED,initialWeight:parseFloat(C.initialWeight),linesPlanted:parseFloat(C.lines)};f(J,W,C.beneficiaryFarmerId)}n()},P=Object.keys(E).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:r(s?"editCuttingOperation":"newPlanting"),widthClass:"max-w-4xl",children:e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(De,{label:r("serviceProvider"),value:C.serviceProviderId,onChange:F=>T(q=>({...q,serviceProviderId:F.target.value})),error:E.serviceProviderId,required:!0,children:[e.jsx("option",{value:"",children:r("selectProvider")}),m.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsx(de,{label:r("dateOperation"),type:"date",value:C.date,onChange:F=>T(q=>({...q,date:F.target.value})),error:E.date,required:!0}),e.jsx(de,{label:r("pricePerLine"),type:"number",step:"any",value:C.pricePerLine,onChange:F=>T(q=>({...q,pricePerLine:F.target.value})),error:E.pricePerLine,required:!0})]}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:r("detailsModule")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(De,{label:r("site"),value:C.siteId,onChange:F=>O(F.target.value),error:E.siteId,required:!0,children:[e.jsx("option",{value:"",children:r("selectSite")}),l.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsxs(De,{label:r("zonePlantation"),value:C.zoneId,onChange:F=>T(q=>({...q,zoneId:F.target.value})),disabled:!C.siteId,error:E.zoneId,required:!0,children:[e.jsx("option",{value:"",children:r("selectZone")}),_.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsxs(De,{label:r("numModule"),value:C.moduleId,onChange:F=>T(q=>({...q,moduleId:F.target.value})),disabled:!C.zoneId,error:E.moduleId,required:!0,children:[e.jsx("option",{value:"",children:r("selectAModule")}),M.map(F=>e.jsx("option",{value:F.id,children:F.code},F.id))]}),e.jsxs(De,{label:r("seaweedType"),value:C.seaweedTypeId,onChange:F=>T(q=>({...q,seaweedTypeId:F.target.value})),error:E.seaweedTypeId,required:!0,children:[e.jsx("option",{value:"",children:r("selectType")}),u.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsx(de,{label:r("nombreLignesCoupees"),type:"number",value:C.lines,onChange:F=>T(q=>({...q,lines:F.target.value})),error:E.lines,required:!0}),e.jsx(de,{label:r("poidsInitialLignes"),type:"number",step:"any",value:C.initialWeight,onChange:F=>T(q=>({...q,initialWeight:F.target.value})),error:E.initialWeight,required:!0}),e.jsxs(De,{label:r("fermierBeneficiaire"),value:C.beneficiaryFarmerId,onChange:F=>T(q=>({...q,beneficiaryFarmerId:F.target.value})),disabled:!C.siteId,error:E.beneficiaryFarmerId,required:!0,children:[e.jsx("option",{value:"",children:r("selectFarmer")}),D.map(F=>e.jsx("option",{value:F.id,children:`${F.firstName} ${F.lastName}`},F.id))]}),e.jsx(de,{label:r("plantingDate"),type:"date",value:C.plantingDate,onChange:F=>T(q=>({...q,plantingDate:F.target.value})),error:E.plantingDate,required:!0})]})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg font-semibold text-lg text-right",children:[r("valeurBouturage"),": ",Ae(I,S.localization)]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:r("cancel")}),e.jsx(se,{type:"submit",disabled:P,children:r("save")})]})]})})},Ty=t=>{if(!t||t==="rgba(0, 0, 0, 0)"||t==="transparent"||t==="inherit")return;const n=t.match(/\d+/g);if(!n||n.length<3)return;const[s,r,l]=n.map(Number),c=d=>d.toString(16).padStart(2,"0");return`FF${c(s)}${c(r)}${c(l)}`.toUpperCase()};function nv(t){if(!t)return"";const n=t.trim();if(!n)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n;if(/^-?\d+(\.\d+)?%$/.test(n))return parseFloat(n)/100;const s=n.replace(/^[^\d\-\.,]+/,"").replace(/[^\d]+$/,"").replace(/\s/g,"");if(!s)return n;let r;if(/^-?\d+(\.\d+)?$/.test(s))r=parseFloat(s);else if(/^-?\d+(,\d+)?$/.test(s))r=parseFloat(s.replace(",","."));else{const l=s.replace(/,/g,"");if(!isNaN(Number(l))&&l.includes("."))r=parseFloat(l);else{const c=s.replace(/\./g,"").replace(",",".");isNaN(Number(c))||(r=parseFloat(c))}}return r!==void 0&&!isNaN(r)?r:n}const Hr=t=>{var n;return((n=t.innerText)==null?void 0:n.trim())||""};function sv(t){var r;const n=[];if(t.classList.contains("no-print")||t.style.display==="none")return[];if(t.tagName==="HEADER")return[];if(t.tagName==="SCRIPT"||t.tagName==="STYLE"||t.tagName==="BUTTON")return[];if(t.tagName==="TABLE"||t.classList.contains("grid")||t.classList.contains("prose")||/^H[1-6]$/.test(t.tagName))return[t];const s=Array.from(t.children);if(s.length>0)for(const l of s)n.push(...sv(l));else{const l=(r=t.innerText)==null?void 0:r.trim();l&&(t.tagName==="P"||t.tagName==="DIV"||t.tagName==="SPAN")&&l.length>1&&n.push(t)}return n}function OD(t,n,s){const r=t.getCell(n,s);return r.isMerged&&r.master.address!==r.address}function UD(t,n,s){let r=s;return[n.querySelector("thead"),n.querySelector("tbody"),n.querySelector("tfoot")].forEach(c=>{if(!c)return;Array.from(c.querySelectorAll("tr")).forEach(u=>{let h=1;Array.from(u.querySelectorAll("th, td")).forEach(f=>{const v=f,x=Hr(v),S=parseInt(v.getAttribute("colspan")||"1"),w=parseInt(v.getAttribute("rowspan")||"1");for(;OD(t,r,h);)h++;const C=t.getCell(r,h);let T=x;const E=v.tagName==="TH"||c.tagName==="THEAD";E||(T=nv(x)),C.value=T;const R=window.getComputedStyle(v),_=Ty(R.backgroundColor),D=Ty(R.color),M=E||R.fontWeight==="700"||R.fontWeight==="bold",I=R.textAlign;if(E)C.font={bold:!0,color:{argb:"FFFFFFFF"}},C.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},C.border={top:{style:"medium"},left:{style:"medium"},bottom:{style:"medium"},right:{style:"medium"}},C.alignment={horizontal:"center",vertical:"middle",wrapText:!0};else{C.font={color:{argb:D||"FF000000"},bold:M},_&&_!=="FFFFFFFF"&&(C.fill={type:"pattern",pattern:"solid",fgColor:{argb:_}}),C.border={top:{style:"thin",color:{argb:"FFD9D9D9"}},left:{style:"thin",color:{argb:"FFD9D9D9"}},bottom:{style:"thin",color:{argb:"FFD9D9D9"}},right:{style:"thin",color:{argb:"FFD9D9D9"}}};let O=I==="center"?"center":I==="right"?"right":"left";typeof T=="number"&&I!=="center"&&(O="right"),C.alignment={horizontal:O,vertical:"middle",wrapText:!0}}if(S>1||w>1)try{t.mergeCells(r,h,r+w-1,h+S-1)}catch(O){console.warn("Merge conflict in Excel export",O)}h+=S}),r++})}),r}function FD(t,n,s){const r=Array.from(n.children);let l=s;if(r.length>0&&r.length<=4){let c=1;return r.forEach(d=>{const u=Hr(d).split(`
`).filter(f=>f.trim()),h=t.getCell(l,c);h.value=u[0],h.font={color:{argb:"FF7F7F7F"},italic:!0};const m=t.getCell(l+1,c);m.value=nv(u[1]||""),m.font={bold:!0,size:12},m.alignment={horizontal:"left"},c+=3}),l+3}return r.forEach(c=>{const d=Hr(c),u=t.getCell(l,1);u.value=d,u.alignment={wrapText:!0},l++}),l}function BD(t,n,s){const r=Hr(n);if(!r)return s;const l=t.getCell(s,1);return l.value=r,n.tagName==="H3"||n.tagName==="H4"||n.classList.contains("font-bold")?l.font={bold:!0,size:11,color:{argb:"FF4472C4"}}:l.alignment={wrapText:!0},t.mergeCells(s,1,s,12),s+1}const GD=async(t,n)=>{const s=document.getElementById("printable-area");if(!s){console.error("No printable area found");return}const r=new ExcelJS.Workbook;r.creator="AlgaManage",r.created=new Date;const l=s.querySelectorAll(".report-page-landscape, .print-page");if(l.length===0){alert("No report content found to export.");return}for(let m=0;m<l.length;m++){const f=l[m];let v=`Page ${m+1}`;const x=f.querySelector("h2")||f.querySelector("h3");if(x){const M=Hr(x).replace(/[\\/?*:[\]]/g," ").substring(0,30);M&&(v=M)}let S=v,w=1;for(;r.getWorksheet(S);)S=`${v} (${w++})`;const C=r.addWorksheet(S,{views:[{showGridLines:!1,zoomScale:85}],pageSetup:{orientation:"landscape",paperSize:9,fitToPage:!0}});C.columns=Array.from({length:50},()=>({width:14})),C.getColumn(1).width=20;let T=1;const E=f.querySelector("header");E&&(Hr(E).split(`
`).filter(I=>I.trim()).forEach(I=>{const A=C.getRow(T).getCell(1);A.value=I,A.font={bold:!0,size:12,color:{argb:"FF2F5597"}},C.mergeCells(T,1,T,12),T++}),T++);const _=f.firstElementChild||f,D=sv(_);for(const M of D)M.tagName==="TABLE"?(T=UD(C,M,T),T+=2):M.classList.contains("grid")?(T=FD(C,M,T),T+=2):T=BD(C,M,T)}const c=await r.xlsx.writeBuffer(),d=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),u=window.URL.createObjectURL(d),h=document.createElement("a");h.href=u,h.download=`${n}.xlsx`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(u)},Yr=async(t,n,s,r="Sheet1")=>{const l=new ExcelJS.Workbook;l.creator="AlgaManage",l.created=new Date;const c=l.addWorksheet(r);c.columns=n.map(v=>({header:v.header,key:v.key,width:v.width||15}));const d=c.getRow(1);d.font={bold:!0,color:{argb:"FFFFFFFF"}},d.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},t.forEach(v=>{c.addRow(v)});const u=await l.xlsx.writeBuffer(),h=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=window.URL.createObjectURL(h),f=document.createElement("a");f.href=m,f.download=`${s}.xlsx`,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(m)},av=async(t,n)=>{const s=new ExcelJS.Workbook;s.creator="AlgaManage",s.created=new Date,t.forEach(u=>{const h=s.addWorksheet(u.sheetName);h.columns=u.columns.map(f=>({header:f.header,key:f.key,width:f.width||15}));const m=h.getRow(1);m.font={bold:!0,color:{argb:"FFFFFFFF"}},m.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},u.data.forEach(f=>{h.addRow(f)})});const r=await s.xlsx.writeBuffer(),l=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),c=window.URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=`${n}.xlsx`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c)},zD=({status:t})=>{const{t:n}=je();if(t==="normal")return null;const s=t==="nearing"?"text-yellow-500":"text-red-600",r=n(t==="nearing"?"nearingHarvest":"overdueHarvest");return e.jsxs("div",{className:"relative group flex justify-center",children:[e.jsx(te,{name:"AlertTriangle",className:`w-5 h-5 ${s}`}),e.jsx("span",{className:"absolute bottom-full mb-2 w-max px-2 py-1 text-xs text-white bg-gray-900 rounded-md opacity-0 group-hover:opacity-100 transition-opacity z-10 pointer-events-none",children:r})]})},km=({initialFilters:t,pageTitle:n})=>{var rr;const{t:s,language:r}=je(),{cultivationCycles:l,modules:c,seaweedTypes:d,farmers:u,sites:h,periodicTests:m,updateCultivationCycle:f,deleteCultivationCycle:v,incidentTypes:x}=qe(),[S,w]=N.useState(!1),[C,T]=N.useState(!1),[E,R]=N.useState(null),[_,D]=N.useState(!1),[M,I]=N.useState(null),[O,A]=N.useState({key:"module.code",direction:"ascending"}),[U,P]=N.useState(!1),[F,q]=N.useState(null),[z,J]=N.useState(!1),[W,G]=N.useState(null),[B,X]=N.useState({date:"",notes:"",linesHarvested:"",harvestedWeight:"",cuttingsWeight:""}),[$,ae]=N.useState(""),[H,ie]=N.useState({siteId:(t==null?void 0:t.siteId)||"all",seaweedTypeId:(t==null?void 0:t.seaweedTypeId)||"all"}),[ue,Ne]=xm(),oe=ue.get("highlight"),ne=N.useRef(new Map),[we,fe]=N.useState({}),[Q,ee]=N.useState(null),{settings:ye}=$e();N.useEffect(()=>{if(oe){ee(oe);const Be=ne.current.get(oe);Be&&(Be.scrollIntoView({behavior:"smooth",block:"center"}),Be.classList.add("highlight-row"),setTimeout(()=>{Be.classList.remove("highlight-row")},2e3)),Ne({},{replace:!0})}},[oe,Ne]);const Le=(Be,Ye)=>{ie(He=>({...He,[Be]:Ye}))},ke=N.useCallback(()=>{ie({siteId:(t==null?void 0:t.siteId)||"all",seaweedTypeId:(t==null?void 0:t.seaweedTypeId)||"all"})},[t]),Re=N.useMemo(()=>{const Be=new Date;Be.setHours(0,0,0,0);let Ye=l.map(He=>{let bt="normal";const st=new Date(He.plantingDate);st.setHours(0,0,0,0);const It=He.harvestDate?new Date(He.harvestDate):Be;It.setHours(0,0,0,0);const xn=Math.ceil((It.getTime()-st.getTime())/(1e3*60*60*24));if(He.status===Je.PLANTED||He.status===Je.GROWING){const $t=(Be.getTime()-st.getTime())/864e5;$t>Zs?bt="overdue":$t>Zs-bm&&(bt="nearing")}let yn;if(He.harvestDate&&He.plantingDate&&He.harvestedWeight&&He.initialWeight&&He.harvestedWeight>0&&He.initialWeight>0){const aa=(new Date(He.harvestDate).getTime()-new Date(He.plantingDate).getTime())/(1e3*60*60*24),Ss=sc(He.initialWeight,He.harvestedWeight,aa);Ss!==null&&(yn=Ss)}const cn=c.find($t=>$t.id===He.moduleId),Ns=cn?u.find($t=>$t.id===cn.farmerId):void 0;return{cycle:He,module:cn,seaweedType:d.find($t=>$t.id===He.seaweedTypeId),farmer:Ns,alertStatus:bt,growthRate:yn,age:xn}});return H.siteId!=="all"&&(Ye=Ye.filter(He=>{var bt;return((bt=He.module)==null?void 0:bt.siteId)===H.siteId})),H.seaweedTypeId!=="all"&&(Ye=Ye.filter(He=>He.cycle.seaweedTypeId===H.seaweedTypeId)),Ye.sort((He,bt)=>{const st=(yn,cn)=>{if(Object.prototype.hasOwnProperty.call(yn,cn))return yn[cn];if(Object.prototype.hasOwnProperty.call(yn.cycle,cn))return yn.cycle[cn];const Ns=cn.split(".");let $t=yn;for(const Xn of Ns){if($t==null)return;$t=$t[Xn]}return $t},It=st(He,O.key),xn=st(bt,O.key);return It==null?1:xn==null?-1:typeof It=="string"&&typeof xn=="string"?O.direction==="ascending"?It.localeCompare(xn):xn.localeCompare(It):It<xn?O.direction==="ascending"?-1:1:It>xn?O.direction==="ascending"?1:-1:0}),Ye},[l,c,d,u,O,H]),Ke=N.useCallback(async Be=>{const Ye=Be.cycle.id;fe(st=>({...st,[Ye]:{isLoading:!0,error:null,result:null}}));const He=l.filter(st=>st.seaweedTypeId===Be.cycle.seaweedTypeId&&st.id!==Ye&&st.harvestDate),bt=m.filter(st=>{var It;return st.siteId===((It=Be.module)==null?void 0:It.siteId)}).sort((st,It)=>new Date(It.date).getTime()-new Date(st.date).getTime());if(!Be.module||!Be.seaweedType){fe(st=>({...st,[Ye]:{result:null,isLoading:!1,error:s("predictionError")}}));return}try{const st=await wD(Be.cycle,Be.module,Be.seaweedType,He,bt,r);fe(st?It=>({...It,[Ye]:{result:st,isLoading:!1,error:null}}):It=>({...It,[Ye]:{result:null,isLoading:!1,error:s("predictionError")}}))}catch(st){console.error("Prediction failed unexpectedly:",st),fe(It=>({...It,[Ye]:{result:null,isLoading:!1,error:s("predictionError")}}))}},[l,m,r,s]),ze=Be=>{let Ye="ascending";O.key===Be&&O.direction==="ascending"&&(Ye="descending"),A({key:Be,direction:Ye})},Se=Be=>O.key!==Be?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):O.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),Oe=(Be=null)=>{R(Be),w(!0)},be=()=>{R(null),w(!1),T(!1)},xe=Be=>{I(Be),D(!0)},Ue=()=>{M&&v(M),D(!1),I(null)},Ze=Be=>{q(Be),P(!0)},Et=Be=>{f(Be),be()},ot=async()=>{const Be=Re.map(He=>{var bt,st,It;return{moduleCode:((bt=He.module)==null?void 0:bt.code)||s("unknown"),farmerName:He.farmer?`${He.farmer.firstName} ${He.farmer.lastName}`:s("unknown"),seaweedType:((st=He.seaweedType)==null?void 0:st.name)||s("unknown"),plantingDate:He.cycle.plantingDate,initialWeight:He.cycle.initialWeight||0,linesPlanted:He.cycle.linesPlanted||((It=He.module)==null?void 0:It.lines)||0,age:He.age,status:s(`status_${He.cycle.status}`),harvestDate:He.cycle.harvestDate||"-",harvestedWeight:He.cycle.harvestedWeight||0,cuttingsWeight:He.cycle.cuttingsTakenAtHarvestKg||0,netWeight:(He.cycle.harvestedWeight||0)-(He.cycle.cuttingsTakenAtHarvestKg||0),linesHarvested:He.cycle.linesHarvested||0,growthRate:He.growthRate?`${He.growthRate.toFixed(2)}%`:"-",notes:He.cycle.processingNotes||""}}),Ye=[{header:s("moduleCode"),key:"moduleCode",width:15},{header:s("farmer"),key:"farmerName",width:20},{header:s("seaweedType"),key:"seaweedType",width:15},{header:s("plantingDate"),key:"plantingDate",width:15},{header:`${s("initialWeight")} (Kg)`,key:"initialWeight",width:15},{header:s("linesPlanted"),key:"linesPlanted",width:15},{header:s("ageInDays"),key:"age",width:10},{header:s("status"),key:"status",width:15},{header:s("harvestDate"),key:"harvestDate",width:15},{header:`${s("harvestedWeight")} (Kg)`,key:"harvestedWeight",width:15},{header:`${s("cuttingsWeightKg")} (Kg)`,key:"cuttingsWeight",width:15},{header:`${s("wetProduction")} (Kg)`,key:"netWeight",width:15},{header:s("linesHarvested"),key:"linesHarvested",width:15},{header:s("growthRate"),key:"growthRate",width:15},{header:s("notes"),key:"notes",width:30}];await Yr(Be,Ye,`CultivationCycles_${new Date().toISOString().split("T")[0]}`,"Cultivation Cycles")},Pt=Be=>{var He;G(Be);let Ye=new Date().toISOString().split("T")[0];if(Be.cycle.plantingDate){const bt=new Date(Be.cycle.plantingDate),st=new Date(bt);st.setDate(bt.getDate()+Zs),Ye=st.toISOString().split("T")[0]}X({date:Ye,notes:"Harvest for maturity",linesHarvested:String(Be.cycle.linesPlanted||((He=Be.module)==null?void 0:He.lines)||""),harvestedWeight:"",cuttingsWeight:""}),ae(""),J(!0)},wt=()=>{const Be=B.notes==="Other",Ye=parseFloat(B.harvestedWeight),He=parseFloat(B.cuttingsWeight);if(W&&B.date&&(!Be||$.trim())&&B.linesHarvested&&!isNaN(Ye)&&Ye>0&&B.cuttingsWeight!==""&&!isNaN(He)&&He>=0){const bt=Be?$:B.notes;f({...W.cycle,status:Je.HARVESTED,harvestDate:B.date,processingNotes:bt,linesHarvested:Number(B.linesHarvested),harvestedWeight:Ye,cuttingsTakenAtHarvestKg:He}),J(!1),G(null)}},gt=({sortKey:Be,label:Ye,className:He=""})=>e.jsx("th",{className:`p-3 ${He}`,children:e.jsxs("button",{onClick:()=>ze(Be),className:`group flex items-center gap-2 w-full whitespace-nowrap ${He.includes("text-right")?"justify-end":""}`,children:[Ye," ",Se(Be)]})}),Kt=parseFloat(B.harvestedWeight)||0,bs=parseFloat(B.cuttingsWeight)||0,Ds=Kt-bs;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:n||s("cultivationCycleManagementTitle")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(se,{variant:"secondary",onClick:ot,children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-5 h-5 mr-2"}),s("exportExcel")]}),e.jsxs(se,{onClick:()=>T(!0),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),s("addCycle")]})]})]}),e.jsx(Ge,{className:"mb-6",title:s("filtersTitle"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs(De,{label:s("site"),value:H.siteId,onChange:Be=>Le("siteId",Be.target.value),disabled:!!(t!=null&&t.siteId),children:[e.jsx("option",{value:"all",children:s("allSites")}),h.map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]}),e.jsxs(De,{label:s("seaweedType"),value:H.seaweedTypeId,onChange:Be=>Le("seaweedTypeId",Be.target.value),disabled:!!(t!=null&&t.seaweedTypeId),children:[e.jsx("option",{value:"all",children:s("allSeaweedTypes")}),d.map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]}),e.jsx(se,{variant:"secondary",onClick:ke,className:"h-[42px] w-full",children:s("clearFilters")})]})}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-12"}),e.jsx("th",{className:"p-3 w-16 text-center",children:s("alerts")}),e.jsx(gt,{sortKey:"module.code",label:s("module")}),e.jsx(gt,{sortKey:"farmer.firstName",label:s("farmer")}),e.jsx(gt,{sortKey:"seaweedType.name",label:s("seaweedType")}),e.jsx(gt,{sortKey:"plantingDate",label:s("plantingDate")}),e.jsx(gt,{sortKey:"age",label:s("ageInDays"),className:"text-right"}),e.jsx(gt,{sortKey:"harvestDate",label:s("harvestDate")}),e.jsx(gt,{sortKey:"status",label:s("status")}),e.jsx("th",{className:"p-3 text-right",children:s("actions")})]})}),e.jsx("tbody",{children:Re.map(Be=>{const{cycle:Ye,module:He,seaweedType:bt,farmer:st,alertStatus:It,age:xn}=Be,yn=Q===Ye.id;return e.jsxs(ft.Fragment,{children:[e.jsxs("tr",{ref:cn=>{cn?ne.current.set(Ye.id,cn):ne.current.delete(Ye.id)},className:`border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20 ${Ye.id===oe?"highlight-row":""}`,children:[e.jsx("td",{className:"p-3 text-center",children:e.jsx(se,{variant:"ghost",className:"p-1 !rounded-full",onClick:()=>ee(yn?null:Ye.id),"aria-expanded":yn,"aria-controls":`details-${Ye.id}`,children:e.jsx(te,{name:"ChevronRight",className:`w-5 h-5 transition-transform ${yn?"rotate-90":""}`})})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx(zD,{status:It})}),e.jsx("td",{className:"p-3 font-mono font-semibold whitespace-nowrap",children:(He==null?void 0:He.code)||s("unknown")}),e.jsx("td",{className:"p-3 whitespace-nowrap",children:st?`${st.firstName} ${st.lastName}`:s("unknown")}),e.jsx("td",{className:"p-3 whitespace-nowrap",children:(bt==null?void 0:bt.name)||s("unknown")}),e.jsx("td",{className:"p-3 whitespace-nowrap",children:Ye.plantingDate}),e.jsx("td",{className:"p-3 text-right font-semibold",children:xn>=50?e.jsx(Dm,{content:s("exactAge").replace("{days}",String(xn)),children:e.jsx("span",{className:"cursor-help border-b border-dotted",children:"+50"})}):xn}),e.jsx("td",{className:"p-3 whitespace-nowrap",children:Ye.harvestDate||"-"}),e.jsx("td",{className:"p-3",children:e.jsx(mn,{status:Ye.status})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[(Ye.status===Je.PLANTED||Ye.status===Je.GROWING)&&e.jsxs(se,{variant:"primary",onClick:()=>Pt(Be),children:[e.jsx(te,{name:"Scissors",className:"w-4 h-4"}),s("harvest")]}),e.jsxs(se,{variant:"ghost",onClick:()=>Ze(Be),children:[e.jsx(te,{name:"FileText",className:"w-4 h-4"}),s("history")]}),e.jsx(se,{variant:"ghost",onClick:()=>Oe(Ye),children:e.jsx(te,{name:"Settings",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",onClick:()=>xe(Ye.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]}),yn&&e.jsx("tr",{id:`details-${Ye.id}`,children:e.jsx("td",{colSpan:10,className:"p-0",children:e.jsx(HD,{info:Be,prediction:we[Ye.id]||{isLoading:!1,error:null,result:null},onPredict:()=>Ke(Be)})})})]},Ye.id)})})]})})}),C&&e.jsx(tv,{isOpen:C,onClose:be}),S&&e.jsx(qD,{isOpen:S,onClose:be,onSave:Et,cycle:E}),_&&e.jsx(Ut,{isOpen:_,onClose:()=>D(!1),onConfirm:Ue,title:s("confirmDeleteTitle"),message:s("confirmDeleteCycle")}),U&&F&&F.module&&e.jsx(Jj,{isOpen:U,onClose:()=>P(!1),cycle:F.cycle,module:F.module}),z&&W&&e.jsx(Ut,{isOpen:z,onClose:()=>J(!1),onConfirm:wt,title:`${s("confirmHarvestTitle")}: ${(rr=W.module)==null?void 0:rr.code}`,message:e.jsxs("div",{className:"space-y-4 text-left",children:[e.jsx("p",{children:s("confirmHarvestMessage")}),e.jsx(de,{label:s("harvestDate"),type:"date",value:B.date,onChange:Be=>X(Ye=>({...Ye,date:Be.target.value}))}),e.jsx(de,{label:s("harvestedWeightKg"),type:"number",value:B.harvestedWeight,onChange:Be=>X(Ye=>({...Ye,harvestedWeight:Be.target.value}))}),e.jsx(de,{label:s("cuttingsWeightKg"),type:"number",value:B.cuttingsWeight,onChange:Be=>X(Ye=>({...Ye,cuttingsWeight:Be.target.value}))}),e.jsx(de,{label:s("wetProduction"),type:"text",value:`${Ds.toFixed(2)} kg`,disabled:!0}),e.jsx(de,{label:s("linesHarvested"),type:"number",value:B.linesHarvested,onChange:Be=>X(Ye=>({...Ye,linesHarvested:Be.target.value}))}),e.jsxs(De,{label:s("harvestReason"),value:B.notes,onChange:Be=>X(Ye=>({...Ye,notes:Be.target.value})),children:[e.jsx("option",{value:"Harvest for maturity",children:s("harvestReason_maturity")}),x.map(Be=>e.jsx("option",{value:Be.name,children:Be.name},Be.id)),e.jsx("option",{value:"Other",children:s("other")})]}),B.notes==="Other"&&e.jsx(de,{label:s("other"),value:$,onChange:Be=>ae(Be.target.value),error:$.trim()?"":s("validationReasonRequired"),placeholder:s("otherReasonPlaceholder")})]}),confirmText:s("harvest"),confirmDisabled:!B.date||!B.harvestedWeight||!B.linesHarvested||!B.cuttingsWeight||B.notes==="Other"&&!$.trim()})]})},HD=({info:t,prediction:n,onPredict:s})=>{const{t:r}=je(),{settings:l}=$e(),{cycle:c,growthRate:d}=t,u=c.status===Je.PLANTED||c.status===Je.GROWING,h=({label:m,value:f})=>e.jsxs("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:m}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:f})]});return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-4 grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:r("performance")}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsx(h,{label:r("initialWeight"),value:`${c.initialWeight} kg`}),e.jsx(h,{label:r("linesPlanted"),value:c.linesPlanted||"-"}),e.jsx(h,{label:r("harvestedWeight"),value:c.harvestedWeight?`${c.harvestedWeight} kg`:"-"}),e.jsx(h,{label:r("linesHarvested"),value:c.linesHarvested||"-"}),d!==void 0&&e.jsx(h,{label:`${r("growthRate")} (SGR)`,value:`${Fe(d,{...l.localization,nonMonetaryDecimals:2})}% / day`})]})]}),c.processingNotes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:r("notes")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 p-2 bg-gray-100 dark:bg-gray-800 rounded",children:c.processingNotes})]})]}),e.jsx("div",{className:"md:col-span-1",children:u&&e.jsxs(Ge,{children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:r("aiPrediction")}),n.isLoading?e.jsx("div",{className:"flex justify-center items-center h-24",children:e.jsx(te,{name:"Activity",className:"animate-spin w-6 h-6 text-gray-500"})}):n.error?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-red-500 mb-2",children:n.error}),e.jsxs(se,{onClick:s,className:"!px-2 !py-1 text-sm",children:[e.jsx(te,{name:"AlertTriangle",className:"w-4 h-4 mr-1"}),r("retry")]})]}):n.result?e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{label:r("predictedHarvest"),value:`${n.result.predictedHarvestDateStart}  ${n.result.predictedHarvestDateEnd}`}),e.jsx(h,{label:r("predictedYieldKg"),value:`${Fe(n.result.predictedYieldKgMin,{...l.localization,nonMonetaryDecimals:0})} - ${Fe(n.result.predictedYieldKgMax,{...l.localization,nonMonetaryDecimals:0})} kg`}),e.jsx(h,{label:r("confidence"),value:e.jsx(Dm,{content:e.jsx("div",{className:"max-w-xs",children:n.result.reasoning}),children:e.jsxs("span",{className:"font-semibold cursor-help border-b border-dotted",children:[(n.result.confidenceScore*100).toFixed(0),"%"]})})})]}):e.jsxs(se,{onClick:s,className:"w-full",children:[e.jsx(te,{name:"Bot",className:"w-5 h-5"}),r("predict")]})]})})]})},qD=({isOpen:t,onClose:n,onSave:s,cycle:r})=>{const{t:l}=je(),{modules:c,seaweedTypes:d}=qe(),[u,h]=N.useState({moduleId:"",seaweedTypeId:"",plantingDate:"",initialWeight:"",status:Je.PLANTED});N.useEffect(()=>{r&&h({moduleId:r.moduleId,seaweedTypeId:r.seaweedTypeId,plantingDate:r.plantingDate,initialWeight:String(r.initialWeight),status:r.status})},[r]);const m=(v,x)=>{h(S=>({...S,[v]:x}))},f=v=>{v.preventDefault(),r&&s({...r,...u,initialWeight:parseFloat(u.initialWeight)})};return e.jsx(at,{isOpen:t,onClose:n,title:l("editCycle"),children:e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx(De,{label:l("module"),value:u.moduleId,onChange:v=>m("moduleId",v.target.value),required:!0,disabled:!0,children:c.map(v=>e.jsx("option",{value:v.id,children:v.code},v.id))}),e.jsx(De,{label:l("seaweedType"),value:u.seaweedTypeId,onChange:v=>m("seaweedTypeId",v.target.value),required:!0,children:d.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))}),e.jsx(de,{label:l("plantingDate"),type:"date",value:u.plantingDate,onChange:v=>m("plantingDate",v.target.value),required:!0}),e.jsx(de,{label:l("initialWeight"),type:"number",value:u.initialWeight,onChange:v=>m("initialWeight",v.target.value),required:!0}),e.jsx(De,{label:l("status"),value:u.status,onChange:v=>m("status",v.target.value),required:!0,children:Object.values(Je).map(v=>e.jsx("option",{value:v,children:l(`status_${v}`)},v))}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{type:"submit",children:l("save")})]})]})})},VD=()=>e.jsx(km,{}),KD=()=>{var X;const{t,language:n}=je(),{settings:s}=$e(),{cultivationCycles:r,modules:l,seaweedTypes:c,farmers:d,sites:u,updateCultivationCycle:h}=qe(),[m,f]=N.useState({siteId:"all",seaweedTypeId:"all"}),[v,x]=N.useState({key:"module.code",direction:"ascending"}),[S,w]=N.useState(!1),[C,T]=N.useState(null),[E,R]=N.useState(""),[_,D]=N.useState(""),[M,I]=N.useState(!1),[O,A]=N.useState(""),U=($,ae)=>{f(H=>({...H,[$]:ae}))},P=N.useCallback(()=>{f({siteId:"all",seaweedTypeId:"all"})},[]),F=N.useMemo(()=>{if(!C||!C.cycle)return null;const{cycle:$}=C;if($.harvestDate&&$.plantingDate&&$.harvestedWeight&&$.initialWeight&&$.harvestedWeight>0&&$.initialWeight>0){const H=(new Date($.harvestDate).getTime()-new Date($.plantingDate).getTime())/(1e3*60*60*24);return sc($.initialWeight,$.harvestedWeight,H)}return null},[C]),q=N.useMemo(()=>{let $=r.filter(ae=>ae.status===Je.HARVESTED).map(ae=>{const H=l.find(Ne=>Ne.id===ae.moduleId),ie=H?d.find(Ne=>Ne.id===H.farmerId):void 0,ue=(ae.harvestedWeight||0)-(ae.cuttingsTakenAtHarvestKg||0);return{cycle:ae,module:H,seaweedType:c.find(Ne=>Ne.id===ae.seaweedTypeId),farmer:ie,netHarvestedWeight:ue}});return m.siteId!=="all"&&($=$.filter(ae=>{var H;return((H=ae.module)==null?void 0:H.siteId)===m.siteId})),m.seaweedTypeId!=="all"&&($=$.filter(ae=>ae.cycle.seaweedTypeId===m.seaweedTypeId)),$.sort((ae,H)=>{const ie=(oe,ne)=>{if(ne==="netHarvestedWeight")return oe.netHarvestedWeight;const we=ne.split(".");let fe=oe;for(const Q of we){if(fe==null)return;fe=fe[Q]}return fe},ue=ie(ae,v.key),Ne=ie(H,v.key);return ue==null?1:Ne==null?-1:typeof ue=="string"&&typeof Ne=="string"?v.direction==="ascending"?ue.localeCompare(Ne):Ne.localeCompare(ue):ue<Ne?v.direction==="ascending"?-1:1:ue>Ne?v.direction==="ascending"?1:-1:0}),$},[r,l,c,d,m,v]),z=$=>{let ae="ascending";v.key===$&&v.direction==="ascending"&&(ae="descending"),x({key:$,direction:ae})},J=$=>v.key!==$?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):v.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),W=({sortKey:$,label:ae,className:H=""})=>e.jsx("th",{className:`p-3 ${H}`,children:e.jsxs("button",{onClick:()=>z($),className:`group flex items-center gap-2 w-full ${H.includes("text-right")?"justify-end":""}`,children:[ae," ",J($)]})}),G=N.useCallback(async $=>{var H;T($),R($.cycle.harvestDate||new Date().toISOString().split("T")[0]),w(!0),I(!0),D("");const ae=await SD({seaweedType:((H=$.seaweedType)==null?void 0:H.name)||t("unknown"),totalWeight:$.netHarvestedWeight||0,notes:$.cycle.processingNotes||""},n);D(ae),I(!1)},[n,t]);N.useEffect(()=>{S&&(C!=null&&C.cycle.harvestDate)&&E&&new Date(E)<new Date(C.cycle.harvestDate)?A(t("validationDryingStartDate")):A("")},[S,E,C,t]);const B=()=>{C&&E&&!O&&(h({...C.cycle,status:Je.DRYING,dryingStartDate:E}),w(!1),T(null))};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6",children:t("harvestProcessingTitle")}),e.jsx(Ge,{className:"mb-6",title:t("filtersTitle"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs(De,{label:t("site"),value:m.siteId,onChange:$=>U("siteId",$.target.value),children:[e.jsx("option",{value:"all",children:t("allSites")}),u.map($=>e.jsx("option",{value:$.id,children:$.name},$.id))]}),e.jsxs(De,{label:t("seaweedType"),value:m.seaweedTypeId,onChange:$=>U("seaweedTypeId",$.target.value),children:[e.jsx("option",{value:"all",children:t("allSeaweedTypes")}),c.map($=>e.jsx("option",{value:$.id,children:$.name},$.id))]}),e.jsx(se,{variant:"secondary",onClick:P,className:"h-[42px] w-full",children:t("clearFilters")})]})}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(W,{sortKey:"module.code",label:t("module")}),e.jsx(W,{sortKey:"farmer.firstName",label:t("farmer")}),e.jsx(W,{sortKey:"seaweedType.name",label:t("seaweedType")}),e.jsx(W,{sortKey:"cycle.harvestDate",label:t("harvestDate")}),e.jsx(W,{sortKey:"netHarvestedWeight",label:t("netHarvestedWeightKg"),className:"text-right"}),e.jsx(W,{sortKey:"cycle.linesHarvested",label:t("linesHarvested"),className:"text-right"}),e.jsx("th",{className:"p-3",children:t("harvestReason")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[q.map($=>{var ae,H;return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3 font-mono font-semibold",children:((ae=$.module)==null?void 0:ae.code)||t("unknown")}),e.jsx("td",{className:"p-3",children:$.farmer?`${$.farmer.firstName} ${$.farmer.lastName}`:t("unknown")}),e.jsx("td",{className:"p-3",children:((H=$.seaweedType)==null?void 0:H.name)||t("unknown")}),e.jsx("td",{className:"p-3",children:$.cycle.harvestDate}),e.jsx("td",{className:"p-3 text-right",children:Fe($.netHarvestedWeight,s.localization)}),e.jsx("td",{className:"p-3 text-right",children:$.cycle.linesHarvested}),e.jsx("td",{className:"p-3",children:$.cycle.processingNotes}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs(se,{variant:"primary",onClick:()=>G($),children:[e.jsx(te,{name:"Wind",className:"w-4 h-4"}),t("startDrying")]})})]},$.cycle.id)}),q.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center p-6 text-gray-500 dark:text-gray-400",children:t("noHarvestedBatches")})})]})]})})}),S&&C&&e.jsx(at,{isOpen:S,onClose:()=>w(!1),title:`${t("startDryingFor")} ${(X=C.module)==null?void 0:X.code}`,footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:()=>w(!1),children:t("cancel")}),e.jsx(se,{variant:"primary",onClick:B,disabled:!E||!!O,children:t("confirm")})]}),children:e.jsxs("div",{className:"space-y-4",children:[F!==null&&e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-900/50 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t("growthRate")}),e.jsxs("p",{className:"text-xl font-bold",children:[Fe(F,s.localization),t("growthRateUnit")]})]}),e.jsx(de,{label:t("dryingStartDate"),type:"date",value:E,onChange:$=>R($.target.value),required:!0,error:O}),e.jsx(Ge,{title:t("geminiSuggestion"),children:M?e.jsx("p",{children:t("loading")}):e.jsx("p",{className:"whitespace-pre-wrap font-serif",children:_||t("noSuggestion")})})]})})]})},$D=()=>{var q;const{t}=je(),{settings:n}=$e(),{cultivationCycles:s,modules:r,seaweedTypes:l,sites:c,updateCultivationCycle:d}=qe(),[u,h]=N.useState({siteId:"all",seaweedTypeId:"all"}),[m,f]=N.useState({key:"module.code",direction:"ascending"}),[v,x]=N.useState(!1),[S,w]=N.useState(null),[C,T]=N.useState({dryingCompletionDate:"",baggingStartDate:"",actualDryWeight:""}),[E,R]=N.useState({}),_=(z,J)=>{h(W=>({...W,[z]:J}))},D=N.useCallback(()=>{h({siteId:"all",seaweedTypeId:"all"})},[]),M=N.useMemo(()=>{let z=s.filter(J=>J.status===Je.DRYING).map(J=>{const W=r.find(X=>X.id===J.moduleId);let G=0;if(J.dryingStartDate){const X=new Date(J.dryingStartDate);G=Math.ceil((new Date().getTime()-X.getTime())/864e5)}const B=(J.harvestedWeight||0)-(J.cuttingsTakenAtHarvestKg||0);return{cycle:J,module:W,seaweedType:l.find(X=>X.id===J.seaweedTypeId),dryingDuration:G,netHarvestedWeight:B}});return u.siteId!=="all"&&(z=z.filter(J=>{var W;return((W=J.module)==null?void 0:W.siteId)===u.siteId})),u.seaweedTypeId!=="all"&&(z=z.filter(J=>J.cycle.seaweedTypeId===u.seaweedTypeId)),z.sort((J,W)=>{const G=($,ae)=>{const H=ae.split(".");let ie=$;for(const ue of H){if(ie==null)return;ie=ie[ue]}return ie},B=G(J,m.key),X=G(W,m.key);return B==null?1:X==null?-1:B<X?m.direction==="ascending"?-1:1:B>X?m.direction==="ascending"?1:-1:0}),z},[s,r,l,u,m]),I=z=>{let J="ascending";m.key===z&&m.direction==="ascending"&&(J="descending"),f({key:z,direction:J})},O=z=>m.key!==z?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):m.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),A=({sortKey:z,label:J,className:W=""})=>e.jsx("th",{className:`p-3 ${W}`,children:e.jsxs("button",{onClick:()=>I(z),className:`group flex items-center gap-2 w-full ${W.includes("text-right")?"justify-end":""}`,children:[J," ",O(z)]})}),U=N.useCallback(z=>{w(z);let J=new Date;if(z.cycle.dryingStartDate){const G=new Date(z.cycle.dryingStartDate);G.setDate(G.getDate()+5),J=G}const W=J.toISOString().split("T")[0];T({dryingCompletionDate:W,baggingStartDate:W,actualDryWeight:""}),x(!0)},[]),P=N.useCallback(()=>{if(!S)return{};const z={},J=new Date;return J.setHours(23,59,59,999),C.dryingCompletionDate?(new Date(C.dryingCompletionDate)>J&&(z.dryingCompletionDate=t("validationFutureDate")),S.cycle.dryingStartDate&&C.dryingCompletionDate<S.cycle.dryingStartDate&&(z.dryingCompletionDate=t("validationDryingCompletionDate"))):z.dryingCompletionDate=t("validationRequired"),C.baggingStartDate?(new Date(C.baggingStartDate)>J&&(z.baggingStartDate=t("validationFutureDate")),C.dryingCompletionDate&&C.baggingStartDate<C.dryingCompletionDate&&(z.baggingStartDate=t("validationBaggingStartDate"))):z.baggingStartDate=t("validationRequired"),(!C.actualDryWeight||isNaN(parseFloat(C.actualDryWeight))||parseFloat(C.actualDryWeight)<=0)&&(z.actualDryWeight=t("validationPositiveNumber")),z},[C,S,t]);N.useEffect(()=>{v&&R(P())},[C,v,P]);const F=()=>{const z=P();if(Object.keys(z).length>0){R(z);return}S&&C.dryingCompletionDate&&C.baggingStartDate&&(d({...S.cycle,status:Je.BAGGING,dryingCompletionDate:C.dryingCompletionDate,baggingStartDate:C.baggingStartDate,actualDryWeightKg:parseFloat(C.actualDryWeight)}),x(!1),w(null))};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6",children:t("dryingManagementTitle")}),e.jsx(Ge,{className:"mb-6",title:t("filtersTitle"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs(De,{label:t("site"),value:u.siteId,onChange:z=>_("siteId",z.target.value),children:[e.jsx("option",{value:"all",children:t("allSites")}),c.map(z=>e.jsx("option",{value:z.id,children:z.name},z.id))]}),e.jsxs(De,{label:t("seaweedType"),value:u.seaweedTypeId,onChange:z=>_("seaweedTypeId",z.target.value),children:[e.jsx("option",{value:"all",children:t("allSeaweedTypes")}),l.map(z=>e.jsx("option",{value:z.id,children:z.name},z.id))]}),e.jsx(se,{variant:"secondary",onClick:D,className:"h-[42px] w-full",children:t("clearFilters")})]})}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(A,{sortKey:"module.code",label:t("module")}),e.jsx(A,{sortKey:"seaweedType.name",label:t("seaweedType")}),e.jsx(A,{sortKey:"cycle.harvestDate",label:t("harvestDate")}),e.jsx(A,{sortKey:"cycle.dryingStartDate",label:t("dryingStartDate")}),e.jsx(A,{sortKey:"dryingDuration",label:t("dryingDuration"),className:"text-right"}),e.jsx(A,{sortKey:"netHarvestedWeight",label:t("netHarvestedWeightKg"),className:"text-right"}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[M.map(z=>{var J,W;return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3 font-mono font-semibold",children:((J=z.module)==null?void 0:J.code)||t("unknown")}),e.jsx("td",{className:"p-3",children:((W=z.seaweedType)==null?void 0:W.name)||t("unknown")}),e.jsx("td",{className:"p-3",children:z.cycle.harvestDate}),e.jsx("td",{className:"p-3",children:z.cycle.dryingStartDate}),e.jsx("td",{className:"p-3 text-right",children:z.dryingDuration}),e.jsx("td",{className:"p-3 text-right",children:Fe(z.netHarvestedWeight,n.localization)}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs(se,{variant:"primary",onClick:()=>U(z),children:[e.jsx(te,{name:"Archive",className:"w-4 h-4"}),t("completeDrying")]})})]},z.cycle.id)}),M.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-6 text-gray-500 dark:text-gray-400",children:t("noBatchesDrying")})})]})]})})}),v&&S&&e.jsx(at,{isOpen:v,onClose:()=>x(!1),title:`${t("completeDryingFor")} ${(q=S.module)==null?void 0:q.code}`,footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:()=>x(!1),children:t("cancel")}),e.jsx(se,{variant:"primary",onClick:F,disabled:Object.keys(E).length>0,children:t("confirm")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(de,{label:t("dryingStartDate"),type:"date",value:S.cycle.dryingStartDate||"",disabled:!0,className:"bg-gray-100 dark:bg-gray-800"}),e.jsx(de,{label:t("dryingCompletionDate"),type:"date",value:C.dryingCompletionDate,onChange:z=>T(J=>({...J,dryingCompletionDate:z.target.value,baggingStartDate:z.target.value})),error:E.dryingCompletionDate,required:!0}),e.jsx(de,{label:t("baggingStartDate"),type:"date",value:C.baggingStartDate,onChange:z=>T(J=>({...J,baggingStartDate:z.target.value})),error:E.baggingStartDate,required:!0}),e.jsx(de,{label:t("actualDryWeight"),type:"number",step:"any",value:C.actualDryWeight,onChange:z=>T(J=>({...J,actualDryWeight:z.target.value})),error:E.actualDryWeight,required:!0,autoFocus:!0})]})})]})},WD=({weights:t,onChange:n})=>{const{t:s}=je(),[r,l]=N.useState([]);N.useEffect(()=>{const d=[...t.map(String)],h=Math.max(1,Math.ceil((d.length+1)/10))*10;for(;d.length<h;)d.push("");l(d)},[t]);const c=(d,u)=>{const h=[...r];if(h[d]=u,d===h.length-1&&u.trim()!=="")for(let f=0;f<10;f++)h.push("");l(h);const m=h.map(f=>parseFloat(f)).filter(f=>!isNaN(f)&&f>0);n(m)};return e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("bagWeights")}),e.jsx("div",{className:"grid grid-cols-5 gap-2 max-h-60 overflow-y-auto p-2 border rounded-md dark:border-gray-600",children:r.map((d,u)=>e.jsx(de,{type:"number",step:"any",placeholder:`${s("bag")} ${u+1}`,value:d,onChange:h=>c(u,h.target.value)},u))})]})},YD=()=>{const{t,language:n}=je(),{settings:s}=$e(),{cultivationCycles:r,modules:l,seaweedTypes:c,sites:d,updateCultivationCycle:u,updateMultipleCultivationCycles:h,addMultipleStockMovements:m}=qe(),[f,v]=N.useState({siteId:"all",seaweedTypeId:"all"}),[x,S]=N.useState({key:"module.code",direction:"ascending"}),[w,C]=N.useState(!1),[T,E]=N.useState(null),[R,_]=N.useState({baggedDate:""}),[D,M]=N.useState([]),[I,O]=N.useState([]),[A,U]=N.useState(!1),P=N.useRef(null),[F,q]=N.useState({}),[z,J]=N.useState(null),W=N.useMemo(()=>({totalWeightKg:D.reduce((ee,ye)=>ee+ye,0),totalBags:D.length}),[D]),G=(ee,ye)=>{v(Le=>({...Le,[ee]:ye}))},B=N.useCallback(()=>{v({siteId:"all",seaweedTypeId:"all"})},[]),X=N.useCallback(()=>{const ee={},ye=new Date;return ye.setHours(23,59,59,999),R.baggedDate?new Date(R.baggedDate)>ye&&(ee.baggedDate=t("validationFutureDate")):ee.baggedDate=t("validationRequired"),W.totalBags===0&&(ee.bagWeights=t("validationAtLeastOneRequired")),ee},[R,W,t]);N.useEffect(()=>{w&&q(X())},[w,X,R,W]);const $=N.useMemo(()=>{let ee=r.filter(ye=>ye.status===Je.BAGGING).map(ye=>{const Le=l.find(Re=>Re.id===ye.moduleId);let ke=0;if(ye.dryingStartDate&&ye.dryingCompletionDate){const Re=new Date(ye.dryingStartDate),Ke=new Date(ye.dryingCompletionDate);ke=Math.ceil((Ke.getTime()-Re.getTime())/864e5)}return{cycle:ye,module:Le,seaweedType:c.find(Re=>Re.id===ye.seaweedTypeId),dryingDuration:ke}});return f.siteId!=="all"&&(ee=ee.filter(ye=>{var Le;return((Le=ye.module)==null?void 0:Le.siteId)===f.siteId})),f.seaweedTypeId!=="all"&&(ee=ee.filter(ye=>ye.cycle.seaweedTypeId===f.seaweedTypeId)),ee.sort((ye,Le)=>{const ke=(ze,Se)=>{const Oe=Se.split(".");let be=ze;for(const xe of Oe){if(be==null)return;be=be[xe]}return be},Re=ke(ye,x.key),Ke=ke(Le,x.key);return Re==null?1:Ke==null?-1:Re<Ke?x.direction==="ascending"?-1:1:Re>Ke?x.direction==="ascending"?1:-1:0}),ee},[r,l,c,f,x]),ae=ee=>{let ye="ascending";x.key===ee&&x.direction==="ascending"&&(ye="descending"),S({key:ee,direction:ye})},H=ee=>x.key!==ee?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):x.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),ie=({sortKey:ee,label:ye,className:Le=""})=>e.jsx("th",{className:`p-3 ${Le}`,children:e.jsxs("button",{onClick:()=>ae(ee),className:`group flex items-center gap-2 w-full ${Le.includes("text-right")?"justify-end":""}`,children:[ye," ",H(ee)]})}),ue=N.useCallback(ee=>{E(ee),_({baggedDate:ee.cycle.baggingStartDate||new Date().toISOString().split("T")[0]}),M([]),C(!0)},[]),Ne=()=>{const ee=X();if(Object.keys(ee).length>0){q(ee);return}if(T){const ye={...T.cycle,status:Je.BAGGED,baggedDate:R.baggedDate,baggedBagsCount:W.totalBags,baggedWeightKg:W.totalWeightKg,bagWeights:D};u(ye),C(!1),E(null)}},oe=()=>{const ee=new Date().toISOString().split("T")[0],ye=r.filter(ke=>I.includes(ke.id)).map(ke=>({...ke,status:Je.BAGGED,baggedDate:ee,baggedBagsCount:Math.ceil((ke.actualDryWeightKg||0)/25),baggedWeightKg:ke.actualDryWeightKg})),Le=ye.map(ke=>{const Re=l.find(Ke=>Ke.id===ke.moduleId);return{date:ee,siteId:(Re==null?void 0:Re.siteId)||"",seaweedTypeId:ke.seaweedTypeId,type:Kn.BAGGING_TRANSFER,designation:`From Batch Bagging (Module ${Re==null?void 0:Re.code})`,inKg:ke.baggedWeightKg,inBags:ke.baggedBagsCount,relatedId:ke.id}});h(ye),m(Le),alert(t("batchBaggingCompleteSuccess")),O([]),U(!1)},ne=ee=>{var ye,Le;J({data:{t:"b",id:ee.cycle.id},title:`BATCH: ${(ye=ee.module)==null?void 0:ye.code}`,subtitle:`${(Le=ee.seaweedType)==null?void 0:Le.name} - ${new Date(ee.cycle.plantingDate).toLocaleDateString()}`})};N.useEffect(()=>{if(P.current){const ee=I.length,ye=$.length;P.current.checked=ee===ye&&ye>0,P.current.indeterminate=ee>0&&ee<ye}},[I,$]);const we=N.useCallback(ee=>{ee.target.checked?O($.map(ye=>ye.cycle.id)):O([])},[$]),fe=(ee,ye)=>{ee.target.checked?O(Le=>[...Le,ye]):O(Le=>Le.filter(ke=>ke!==ye))},Q=Object.keys(F).length>0;return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6",children:t("baggingManagementTitle")}),e.jsx(Ge,{className:"mb-6",title:t("filtersTitle"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs(De,{label:t("site"),value:f.siteId,onChange:ee=>G("siteId",ee.target.value),children:[e.jsx("option",{value:"all",children:t("allSites")}),d.map(ee=>e.jsx("option",{value:ee.id,children:ee.name},ee.id))]}),e.jsxs(De,{label:t("seaweedType"),value:f.seaweedTypeId,onChange:ee=>G("seaweedTypeId",ee.target.value),children:[e.jsx("option",{value:"all",children:t("allSeaweedTypes")}),c.map(ee=>e.jsx("option",{value:ee.id,children:ee.name},ee.id))]}),e.jsx(se,{variant:"secondary",onClick:B,className:"h-[42px] w-full",children:t("clearFilters")})]})}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-4",children:e.jsx(jt,{ref:P,onChange:we})}),e.jsx(ie,{sortKey:"module.code",label:t("module")}),e.jsx(ie,{sortKey:"seaweedType.name",label:t("seaweedType")}),e.jsx(ie,{sortKey:"cycle.dryingCompletionDate",label:t("dryingCompletionDate")}),e.jsx(ie,{sortKey:"cycle.baggingStartDate",label:t("baggingStartDate")}),e.jsx(ie,{sortKey:"cycle.actualDryWeightKg",label:t("dryWeightToBag"),className:"text-right"}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[$.map(ee=>{var ye,Le,ke;return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:I.includes(ee.cycle.id),onChange:Re=>fe(Re,ee.cycle.id),"aria-label":t("selectBatch").replace("{code}",((ye=ee.module)==null?void 0:ye.code)||"")})}),e.jsx("td",{className:"p-3 font-mono font-semibold",children:((Le=ee.module)==null?void 0:Le.code)||t("unknown")}),e.jsx("td",{className:"p-3",children:((ke=ee.seaweedType)==null?void 0:ke.name)||t("unknown")}),e.jsx("td",{className:"p-3",children:ee.cycle.dryingCompletionDate}),e.jsx("td",{className:"p-3",children:ee.cycle.baggingStartDate}),e.jsx("td",{className:"p-3 text-right",children:Fe(ee.cycle.actualDryWeightKg||0,s.localization)}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(se,{variant:"ghost",onClick:()=>ne(ee),title:t("print"),children:e.jsx(te,{name:"QrCode",className:"w-4 h-4"})}),e.jsxs(se,{variant:"primary",onClick:()=>ue(ee),children:[e.jsx(te,{name:"Archive",className:"w-4 h-4"}),t("completeBagging")]})]})})]},ee.cycle.id)}),$.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-6 text-gray-500 dark:text-gray-400",children:t("noBatchesBagging")})})]})]})})}),I.length>0&&e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md border-t border-gray-200 dark:border-gray-700 flex items-center justify-center gap-4 z-20 md:ml-16",children:[e.jsx("span",{className:"font-semibold",children:t("itemsSelected").replace("{count}",String(I.length))}),e.jsxs(se,{onClick:()=>U(!0),children:[e.jsx(te,{name:"Archive",className:"w-4 h-4"}),t("completeSelectedBatches").replace("{count}",String(I.length))]})]}),w&&T&&(()=>{var Le;const ee=T.cycle.actualDryWeightKg||0,ye=ee-W.totalWeightKg;return e.jsx(at,{isOpen:w,onClose:()=>C(!1),title:`${t("completeBaggingFor")} ${(Le=T.module)==null?void 0:Le.code}`,footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:()=>C(!1),children:t("cancel")}),e.jsx(se,{variant:"primary",onClick:Ne,disabled:Q,children:t("confirmAndMoveToStock")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(de,{label:t("baggedDate"),type:"date",value:R.baggedDate,onChange:ke=>_(Re=>({...Re,baggedDate:ke.target.value})),error:F.baggedDate,required:!0}),e.jsx(de,{label:t("weightToBag"),type:"text",value:`${Fe(ye,s.localization)} / ${Fe(ee,s.localization)} kg`,disabled:!0,containerClassName:`transition-colors rounded-md ${ye<0?"bg-red-100 dark:bg-red-900/50":""}`}),e.jsx(WD,{weights:D,onChange:M}),F.bagWeights&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:F.bagWeights}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg font-semibold text-lg",children:[t("totalBaggedWeightKg"),": ",W.totalWeightKg.toFixed(2)," kg (",W.totalBags," ",t("bags"),")"]})]})})})(),A&&e.jsx(Ut,{isOpen:A,onClose:()=>U(!1),onConfirm:oe,title:t("confirmBatchBaggingTitle"),message:t("confirmBatchBaggingMessage").replace("{count}",String(I.length)).replace("{date}",new Date().toLocaleDateString(n)),confirmText:t("confirm")}),z&&e.jsx(l0,{qrData:z.data,title:z.title,subtitle:z.subtitle,detail:"SCAN FOR TRACEABILITY",onClose:()=>J(null)})]})},JD=({isOpen:t,onClose:n,onConfirm:s,selectedCount:r,defaultDate:l})=>{const{t:c}=je(),[d,u]=N.useState(l);return N.useEffect(()=>{t&&u(l)},[t,l]),e.jsx(at,{isOpen:t,onClose:n,title:c("confirmTransfer"),widthClass:"max-w-md",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:c("cancel")}),e.jsx(se,{onClick:()=>s(d),disabled:!d,children:c("confirm")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c("confirmNormalTransferMessage").replace("{count}",String(r))}),e.jsx(de,{label:c("stockTransferDate"),type:"date",value:d,onChange:h=>u(h.target.value),required:!0})]})})},XD=()=>{const{t}=je(),{cultivationCycles:n,modules:s,transferBaggedToStock:r}=qe(),[l,c]=N.useState([]),[d,u]=N.useState(!1),h=N.useMemo(()=>n.filter(w=>w.status===Je.BAGGED).map(w=>{const C=s.find(T=>T.id===w.moduleId);return{cycle:w,module:C}}),[n,s]),m=N.useMemo(()=>{const w=n.filter(T=>l.includes(T.id));if(w.length===0)return new Date().toISOString().split("T")[0];const C=w.reduce((T,E)=>E.baggedDate&&E.baggedDate>T?E.baggedDate:T,"0000-00-00");return C==="0000-00-00"?new Date().toISOString().split("T")[0]:C},[l,n]),f=w=>{w.target.checked?c(h.map(C=>C.cycle.id)):c([])},v=(w,C)=>{w.target.checked?c(T=>[...T,C]):c(T=>T.filter(E=>E!==C))},x=()=>{l.length>0&&u(!0)},S=w=>{r(l,w),c([]),u(!1)};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("pendingTransfers")}),e.jsxs(se,{onClick:x,disabled:l.length===0,children:[e.jsx(te,{name:"ArrowRightLeft",className:"w-4 h-4"}),t("transferToWarehouse")]})]}),e.jsxs("div",{className:"overflow-x-auto max-h-[60vh]",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"sticky top-0 bg-white dark:bg-gray-800",children:e.jsxs("tr",{className:"border-b-2 border-gray-300 dark:border-gray-600",children:[e.jsx("th",{className:"p-2 w-4",children:e.jsx(jt,{onChange:f,checked:l.length===h.length&&h.length>0})}),e.jsx("th",{className:"p-2 font-semibold",children:t("moduleCode")}),e.jsx("th",{className:"p-2 font-semibold",children:t("baggedDate")}),e.jsx("th",{className:"p-2 font-semibold text-right",children:t("baggedWeightKg")}),e.jsx("th",{className:"p-2 font-semibold text-right",children:t("bags")})]})}),e.jsx("tbody",{children:h.map(({cycle:w,module:C})=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-2",children:e.jsx(jt,{checked:l.includes(w.id),onChange:T=>v(T,w.id)})}),e.jsx("td",{className:"p-2 font-mono",children:C==null?void 0:C.code}),e.jsx("td",{className:"p-2",children:w.baggedDate}),e.jsx("td",{className:"p-2 text-right",children:w.baggedWeightKg}),e.jsx("td",{className:"p-2 text-right",children:w.baggedBagsCount})]},w.id))})]}),h.length===0&&e.jsx("p",{className:"text-center p-8 text-gray-500",children:t("noPendingTransfers")})]}),e.jsx(JD,{isOpen:d,onClose:()=>u(!1),onConfirm:S,selectedCount:l.length,defaultDate:m})]})},QD=({isOpen:t,onClose:n,siteId:s,siteName:r,seaweedTypeId:l,seaweedTypeName:c})=>{const{t:d,language:u}=je(),{settings:h}=$e(),{stockMovements:m}=qe(),f=N.useRef(null),v=N.useRef(null),x=N.useMemo(()=>{const w=m.filter(E=>E.siteId===s&&E.seaweedTypeId===l).sort((E,R)=>new Date(E.date).getTime()-new Date(R.date).getTime());let C=0,T=0;return w.map(E=>{const R=(E.inKg||0)-(E.outKg||0),_=(E.inBags||0)-(E.outBags||0);return C+=R,T+=_,{...E,balanceKg:C,balanceBags:T}})},[m,s,l]);N.useEffect(()=>{if(!t||!f.current||x.length===0)return;const w=f.current.getContext("2d");if(!w)return;v.current&&v.current.destroy();const C=h.theme.className.includes("dark"),T=C?"#9ca3af":"#4b5563",E=C?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)";return window.Chart&&(v.current=new window.Chart(w,{type:"line",data:{labels:x.map(R=>new Date(R.date).toLocaleDateString(u)),datasets:[{label:`${d("stockKg")} - ${c}`,data:x.map(R=>R.balanceKg),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,tension:.1,fill:!0,pointRadius:3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,labels:{color:T}},tooltip:{mode:"index",intersect:!1}},scales:{x:{ticks:{color:T,maxRotation:45,minRotation:0},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:T},grid:{color:E},title:{display:!0,text:"Kg",color:T}}}}})),()=>{v.current&&v.current.destroy()}},[t,x,c,d,u,h.theme]);const S=[...x].reverse();return e.jsx(at,{isOpen:t,onClose:n,title:`${d("stockHistory")}: ${c} @ ${r}`,widthClass:"max-w-4xl",footer:e.jsx(se,{onClick:n,children:d("close")}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-64 w-full bg-gray-50 dark:bg-gray-800/50 rounded-lg p-2 border border-gray-200 dark:border-gray-700",children:x.length>0?e.jsx("canvas",{ref:f}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:d("noDataForReport")})}),e.jsx("div",{className:"overflow-x-auto max-h-[40vh] border rounded-lg border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"sticky top-0 bg-white dark:bg-gray-800 shadow-sm z-10",children:e.jsxs("tr",{className:"border-b-2 border-gray-300 dark:border-gray-600",children:[e.jsx("th",{className:"p-3 whitespace-nowrap",children:d("date")}),e.jsx("th",{className:"p-3",children:d("movementType")}),e.jsx("th",{className:"p-3",children:d("designation")}),e.jsxs("th",{className:"p-3 text-right text-green-600",children:[d("in")," (Kg)"]}),e.jsxs("th",{className:"p-3 text-right text-red-600",children:[d("out")," (Kg)"]}),e.jsxs("th",{className:"p-3 text-right font-bold text-blue-600",children:[d("balance")," (Kg)"]}),e.jsx("th",{className:"p-3 text-right text-gray-500",children:d("bags")})]})}),e.jsxs("tbody",{children:[S.map(w=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-700/30",children:[e.jsx("td",{className:"p-3 whitespace-nowrap font-mono text-xs",children:w.date}),e.jsx("td",{className:"p-3 text-xs font-medium uppercase text-gray-600 dark:text-gray-400",children:d(`stockMovement_${w.type}`)}),e.jsx("td",{className:"p-3 text-xs truncate max-w-[200px]",title:w.designation,children:w.designation}),e.jsx("td",{className:"p-3 text-right text-green-600 font-medium",children:w.inKg?`+${Fe(w.inKg,h.localization)}`:"-"}),e.jsx("td",{className:"p-3 text-right text-red-600 font-medium",children:w.outKg?`-${Fe(w.outKg,h.localization)}`:"-"}),e.jsx("td",{className:"p-3 text-right font-bold text-blue-600",children:Fe(w.balanceKg,h.localization)}),e.jsx("td",{className:"p-3 text-right text-gray-500 text-xs",children:w.balanceBags})]},w.id)),S.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-6 text-center text-gray-500",children:d("noDataForReport")})})]})]})})]})})},ZD=()=>{const{t}=je(),{stockMovements:n,sites:s,seaweedTypes:r}=qe(),{settings:l}=$e(),[c,d]=N.useState({key:"siteName",direction:"ascending"}),[u,h]=N.useState(null),[m,f]=N.useState({siteId:"all",seaweedTypeId:"all",date:""}),v=N.useMemo(()=>{const D=new Map;n.forEach(A=>{if(m.date&&A.date>m.date||m.siteId!=="all"&&A.siteId!==m.siteId||m.seaweedTypeId!=="all"&&A.seaweedTypeId!==m.seaweedTypeId)return;const U=`${A.siteId}|${A.seaweedTypeId}`,P=D.get(U)||{kg:0,bags:0};P.kg+=(A.inKg||0)-(A.outKg||0),P.bags+=(A.inBags||0)-(A.outBags||0),D.set(U,P)});const M=new Map(s.map(A=>[A.id,A.name])),I=new Map(r.map(A=>[A.id,A])),O=[];return D.forEach((A,U)=>{if(A.kg>.01||A.bags>0){const[P,F]=U.split("|"),q=M.get(P)||t("unknown"),z=I.get(F),J=(z==null?void 0:z.name)||t("unknown"),W=A.kg*((z==null?void 0:z.dryPrice)||0);O.push({siteId:P,siteName:q,seaweedTypeId:F,seaweedTypeName:J,kg:A.kg,bags:A.bags,value:W})}}),O},[n,s,r,t,m]),x=N.useMemo(()=>[...v].sort((D,M)=>{const I=D[c.key],O=M[c.key];return typeof I=="string"&&typeof O=="string"?c.direction==="ascending"?I.localeCompare(O):O.localeCompare(I):I<O?c.direction==="ascending"?-1:1:I>O?c.direction==="ascending"?1:-1:0}),[v,c]),S=N.useMemo(()=>({totalKg:v.reduce((D,M)=>D+M.kg,0),totalValue:v.reduce((D,M)=>D+M.value,0),distinctItems:v.length}),[v]),w=D=>{let M="ascending";c.key===D&&c.direction==="ascending"&&(M="descending"),d({key:D,direction:M})},C=D=>c.key!==D?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):c.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),T=({sortKey:D,label:M,className:I})=>e.jsx("th",{className:`p-3 ${I}`,children:e.jsxs("button",{onClick:()=>w(D),className:`group flex items-center gap-2 w-full ${I!=null&&I.includes("text-right")?"justify-end":""}`,children:[M,C(D)]})}),E=(D,M)=>{f(I=>({...I,[D]:M}))},R=()=>{f({siteId:"all",seaweedTypeId:"all",date:""})},_=()=>{const D=x.map(O=>({site:O.siteName,seaweedType:O.seaweedTypeName,kg:O.kg,bags:O.bags,value:O.value})),M=[{header:t("site"),key:"site",width:25},{header:t("seaweedType"),key:"seaweedType",width:20},{header:`${t("stockKg")}`,key:"kg",width:15},{header:t("stockBags"),key:"bags",width:15},{header:t("value"),key:"value",width:20}],I=m.date||new Date().toISOString().split("T")[0];Yr(D,M,`OnSite_Stock_${I}`,"Stock Status")};return e.jsxs("div",{children:[e.jsx(Ge,{className:"mb-6",title:t("filtersTitle"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[e.jsxs(De,{label:t("site"),value:m.siteId,onChange:D=>E("siteId",D.target.value),children:[e.jsx("option",{value:"all",children:t("allSites")}),s.filter(D=>D.id!=="pressing-warehouse").map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]}),e.jsxs(De,{label:t("seaweedType"),value:m.seaweedTypeId,onChange:D=>E("seaweedTypeId",D.target.value),children:[e.jsx("option",{value:"all",children:t("allSeaweedTypes")}),r.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]}),e.jsx(de,{label:t("stockHistory")+" ("+t("date")+")",type:"date",value:m.date,onChange:D=>E("date",D.target.value),placeholder:"Current"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{variant:"secondary",onClick:R,className:"h-[42px] flex-1",children:t("clearFilters")}),e.jsxs(se,{onClick:_,variant:"secondary",className:"h-[42px] flex-1",children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-5 h-5 mr-2"}),t("exportExcel")]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"Package",className:"w-10 h-10 text-blue-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("totalStockKgHeader")}),e.jsx("p",{className:"text-3xl font-bold",children:Fe(S.totalKg,l.localization)})]})]})}),e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"DollarSign",className:"w-10 h-10 text-green-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("totalStockValue")}),e.jsx("p",{className:"text-3xl font-bold",children:Ae(S.totalValue,l.localization)})]})]})}),e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"Archive",className:"w-10 h-10 text-purple-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("distinctStockItems")}),e.jsx("p",{className:"text-3xl font-bold",children:S.distinctItems})]})]})})]}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t("stockSummaryBySiteAndType")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2 italic",children:t("clickForHistory")}),e.jsxs("div",{className:"overflow-x-auto max-h-[60vh]",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"sticky top-0 bg-white dark:bg-gray-800",children:e.jsxs("tr",{className:"border-b-2 border-gray-300 dark:border-gray-600",children:[e.jsx(T,{sortKey:"siteName",label:t("site")}),e.jsx(T,{sortKey:"seaweedTypeName",label:t("seaweedType")}),e.jsx(T,{sortKey:"kg",label:t("stockKg"),className:"text-right"}),e.jsx(T,{sortKey:"bags",label:t("stockBags"),className:"text-right"}),e.jsx(T,{sortKey:"value",label:t("value"),className:"text-right"})]})}),e.jsx("tbody",{children:x.map(D=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors cursor-pointer",onClick:()=>h(D),children:[e.jsx("td",{className:"p-3 font-semibold",children:D.siteName}),e.jsx("td",{className:"p-3",children:D.seaweedTypeName}),e.jsx("td",{className:"p-3 text-right",children:Fe(D.kg,l.localization)}),e.jsx("td",{className:"p-3 text-right",children:Fe(D.bags,{...l.localization,nonMonetaryDecimals:0})}),e.jsx("td",{className:"p-3 text-right font-semibold",children:Ae(D.value,l.localization)})]},`${D.siteId}-${D.seaweedTypeId}`))})]}),x.length===0&&e.jsx("p",{className:"text-center p-8 text-gray-500",children:t("noStockData")})]}),u&&e.jsx(QD,{isOpen:!!u,onClose:()=>h(null),siteId:u.siteId,siteName:u.siteName,seaweedTypeId:u.seaweedTypeId,seaweedTypeName:u.seaweedTypeName})]})},ek=({isOpen:t,onClose:n})=>{const{t:s}=je(),{sites:r,seaweedTypes:l,addStockMovement:c}=qe(),[d,u]=N.useState({date:new Date().toISOString().split("T")[0],siteId:"",seaweedTypeId:"",direction:"in",kg:"",bags:"",designation:""}),[h,m]=N.useState({});N.useEffect(()=>{var S,w;t&&(u({date:new Date().toISOString().split("T")[0],siteId:((S=r.find(C=>C.id!=="pressing-warehouse"))==null?void 0:S.id)||"",seaweedTypeId:((w=l[0])==null?void 0:w.id)||"",direction:"in",kg:"",bags:"",designation:""}),m({}))},[t,r,l]);const f=N.useCallback(()=>{const S={};d.designation.trim()||(S.designation=s("validationRequired"));const w=parseFloat(d.kg),C=parseInt(d.bags,10);if(!d.kg&&!d.bags||isNaN(w)&&isNaN(C)){const T=s("validationAtLeastOneRequired");S.kg=T,S.bags=T}return d.kg&&(isNaN(w)||w<=0)&&(S.kg=s("validationPositiveNumber")),d.bags&&(isNaN(C)||C<=0)&&(S.bags=s("validationPositiveNumber")),S},[d,s]);N.useEffect(()=>{m(f())},[d,f]);const v=()=>{const S=f();if(Object.keys(S).length>0){m(S);return}c({date:d.date,siteId:d.siteId,seaweedTypeId:d.seaweedTypeId,type:d.direction==="in"?Kn.ADJUSTMENT_IN:Kn.ADJUSTMENT_OUT,designation:d.designation,inKg:d.direction==="in"&&parseFloat(d.kg)||void 0,outKg:d.direction==="out"&&parseFloat(d.kg)||void 0,inBags:d.direction==="in"&&parseInt(d.bags)||void 0,outBags:d.direction==="out"&&parseInt(d.bags)||void 0}),n()},x=Object.keys(h).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:s("recordStockAdjustment"),footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:s("cancel")}),e.jsx(se,{onClick:v,disabled:x,children:s("save")})]}),children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{label:s("date"),type:"date",value:d.date,onChange:S=>u(w=>({...w,date:S.target.value}))}),e.jsx(De,{label:s("site"),value:d.siteId,onChange:S=>u(w=>({...w,siteId:S.target.value})),children:r.filter(S=>S.id!=="pressing-warehouse").map(S=>e.jsx("option",{value:S.id,children:S.name},S.id))}),e.jsx(De,{label:s("seaweedType"),value:d.seaweedTypeId,onChange:S=>u(w=>({...w,seaweedTypeId:S.target.value})),children:l.map(S=>e.jsx("option",{value:S.id,children:S.name},S.id))}),e.jsxs(De,{label:s("direction"),value:d.direction,onChange:S=>u(w=>({...w,direction:S.target.value})),children:[e.jsx("option",{value:"in",children:s("in")}),e.jsx("option",{value:"out",children:s("out")})]}),e.jsx(de,{label:s("kg"),type:"number",step:"any",value:d.kg,onChange:S=>u(w=>({...w,kg:S.target.value})),error:h.kg}),e.jsx(de,{label:s("bags"),type:"number",value:d.bags,onChange:S=>u(w=>({...w,bags:S.target.value})),error:h.bags}),e.jsx(de,{containerClassName:"col-span-2",label:s("reasonForAdjustment"),value:d.designation,onChange:S=>u(w=>({...w,designation:S.target.value})),required:!0,error:h.designation})]})})},tk=()=>{var w,C;const{t}=je(),{stockMovements:n,sites:s,seaweedTypes:r}=qe(),{settings:l}=$e(),[c,d]=N.useState({siteId:((w=s.find(T=>T.id!=="pressing-warehouse"))==null?void 0:w.id)||"",seaweedTypeId:((C=r[0])==null?void 0:C.id)||"",startDate:"",endDate:""}),[u,h]=N.useState({key:"date",direction:"descending"}),m=T=>{let E="ascending";u.key===T&&u.direction==="ascending"&&(E="descending"),h({key:T,direction:E})},f=T=>u.key!==T?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):u.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),v=(T,E)=>{d(R=>({...R,[T]:E}))},x=N.useMemo(()=>{if(!c.siteId||!c.seaweedTypeId)return[];const T=n.filter(M=>M.siteId===c.siteId&&M.seaweedTypeId===c.seaweedTypeId).sort((M,I)=>new Date(M.date).getTime()-new Date(I.date).getTime()||M.id.localeCompare(I.id));let E=0,R=0;const D=T.map(M=>(E+=(M.inKg||0)-(M.outKg||0),R+=(M.inBags||0)-(M.outBags||0),{...M,balanceKg:E,balanceBags:R})).filter(M=>!(c.startDate&&M.date<c.startDate||c.endDate&&M.date>c.endDate));return D.sort((M,I)=>{const O=M[u.key]??"",A=I[u.key]??"";let U=0;return typeof O=="string"&&typeof A=="string"?U=O.localeCompare(A):typeof O=="number"&&typeof A=="number"&&(U=O-A),U!==0?u.direction==="ascending"?U:-U:u.key!=="date"?new Date(I.date).getTime()-new Date(M.date).getTime():0}),D},[n,c.siteId,c.seaweedTypeId,c.startDate,c.endDate,u]),S=async()=>{var D,M;const T=x.map(I=>({date:I.date,type:t(`stockMovement_${I.type}`),designation:I.designation,inKg:I.inKg||0,inBags:I.inBags||0,outKg:I.outKg||0,outBags:I.outBags||0,balanceKg:I.balanceKg,balanceBags:I.balanceBags})).reverse(),E=[{header:t("date"),key:"date",width:15},{header:t("movementType"),key:"type",width:25},{header:t("designation"),key:"designation",width:40},{header:`${t("in")} (${t("kg")})`,key:"inKg",width:15},{header:`${t("in")} (${t("bags")})`,key:"inBags",width:15},{header:`${t("out")} (${t("kg")})`,key:"outKg",width:15},{header:`${t("out")} (${t("bags")})`,key:"outBags",width:15},{header:`${t("balance")} (${t("kg")})`,key:"balanceKg",width:15},{header:`${t("balance")} (${t("bags")})`,key:"balanceBags",width:15}],R=((D=s.find(I=>I.id===c.siteId))==null?void 0:D.name)||c.siteId,_=((M=r.find(I=>I.id===c.seaweedTypeId))==null?void 0:M.name)||c.seaweedTypeId;await Yr(T,E,`Stock_Movement_${R}_${_}_${new Date().toISOString().split("T")[0]}`,"Stock Movements")};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-end",children:[e.jsx(De,{label:t("site"),value:c.siteId,onChange:T=>v("siteId",T.target.value),children:s.filter(T=>T.id!=="pressing-warehouse").map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))}),e.jsx(De,{label:t("seaweedType"),value:c.seaweedTypeId,onChange:T=>v("seaweedTypeId",T.target.value),children:r.map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))}),e.jsx(de,{label:t("startDate"),type:"date",value:c.startDate,onChange:T=>v("startDate",T.target.value)}),e.jsx(de,{label:t("endDate"),type:"date",value:c.endDate,onChange:T=>v("endDate",T.target.value)}),e.jsxs(se,{onClick:S,variant:"secondary",className:"h-[42px]",disabled:x.length===0,children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-5 h-5 mr-2"}),t("exportExcel")]})]}),e.jsxs("div",{className:"overflow-x-auto max-h-[60vh]",children:[e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsxs("thead",{className:"sticky top-0 bg-white dark:bg-gray-800",children:[e.jsxs("tr",{className:"border-b-2 border-gray-300 dark:border-gray-600",children:[e.jsx("th",{rowSpan:2,className:"p-3 align-bottom",children:e.jsxs("button",{onClick:()=>m("date"),className:"group flex items-center gap-2 w-full",children:[t("date")," ",f("date")]})}),e.jsx("th",{rowSpan:2,className:"p-3 align-bottom",children:e.jsxs("button",{onClick:()=>m("type"),className:"group flex items-center gap-2 w-full",children:[t("movementType")," ",f("type")]})}),e.jsx("th",{rowSpan:2,className:"p-3 align-bottom",children:e.jsxs("button",{onClick:()=>m("designation"),className:"group flex items-center gap-2 w-full",children:[t("designation")," ",f("designation")]})}),e.jsx("th",{colSpan:2,className:"p-3 text-center border-b border-gray-300 dark:border-gray-600",children:t("in")}),e.jsx("th",{colSpan:2,className:"p-3 text-center border-b border-gray-300 dark:border-gray-600",children:t("out")}),e.jsx("th",{colSpan:2,className:"p-3 text-center border-b border-gray-300 dark:border-gray-600",children:t("balance")})]}),e.jsxs("tr",{className:"border-b-2 border-gray-300 dark:border-gray-600",children:[e.jsx("th",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>m("inKg"),className:"group flex items-center justify-center gap-2 w-full",children:[t("kg")," ",f("inKg")]})}),e.jsx("th",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>m("inBags"),className:"group flex items-center justify-center gap-2 w-full",children:[t("bags")," ",f("inBags")]})}),e.jsx("th",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>m("outKg"),className:"group flex items-center justify-center gap-2 w-full",children:[t("kg")," ",f("outKg")]})}),e.jsx("th",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>m("outBags"),className:"group flex items-center justify-center gap-2 w-full",children:[t("bags")," ",f("outBags")]})}),e.jsx("th",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>m("balanceKg"),className:"group flex items-center justify-center gap-2 w-full",children:[t("kg")," ",f("balanceKg")]})}),e.jsx("th",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>m("balanceBags"),className:"group flex items-center justify-center gap-2 w-full",children:[t("bags")," ",f("balanceBags")]})})]})]}),e.jsx("tbody",{children:x.map(T=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 align-middle",children:[e.jsx("td",{className:"p-3 whitespace-nowrap",children:T.date}),e.jsx("td",{className:"p-3 whitespace-nowrap",children:t(`stockMovement_${T.type}`)}),e.jsx("td",{className:"p-3",children:T.designation}),e.jsx("td",{className:"p-3 text-right text-green-600 dark:text-green-400",children:T.inKg?`+${Fe(T.inKg,l.localization)}`:""}),e.jsx("td",{className:"p-3 text-right text-green-600 dark:text-green-400",children:T.inBags?`+${T.inBags}`:""}),e.jsx("td",{className:"p-3 text-right text-red-600 dark:text-red-400",children:T.outKg?`-${Fe(T.outKg,l.localization)}`:""}),e.jsx("td",{className:"p-3 text-right text-red-600 dark:text-red-400",children:T.outBags?`-${T.outBags}`:""}),e.jsx("td",{className:"p-3 text-right font-bold",children:Fe(T.balanceKg,l.localization)}),e.jsx("td",{className:"p-3 text-right font-bold",children:T.balanceBags})]},T.id))})]}),x.length===0&&e.jsx("p",{className:"text-center p-8 text-gray-500",children:t("noDataForReport")})]})]})},nk=()=>{const{t}=je(),[n,s]=N.useState("status"),[r,l]=N.useState(!1);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("onSiteStorageTitle")}),e.jsxs(se,{onClick:()=>l(!0),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("recordMovement")]})]}),e.jsxs(Ge,{children:[e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-4",children:[e.jsx("button",{onClick:()=>s("status"),className:`py-2 px-4 text-sm font-medium ${n==="status"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:t("stockStatus")}),e.jsx("button",{onClick:()=>s("transfer"),className:`py-2 px-4 text-sm font-medium ${n==="transfer"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:t("normalTransfer")}),e.jsx("button",{onClick:()=>s("history"),className:`py-2 px-4 text-sm font-medium ${n==="history"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:t("movementHistory")})]}),n==="status"&&e.jsx(ZD,{}),n==="transfer"&&e.jsx(XD,{}),n==="history"&&e.jsx(tk,{})]}),e.jsx(ek,{isOpen:r,onClose:()=>l(!1)})]})},sk=({isOpen:t,onClose:n,farmer:s})=>{const{t:r}=je(),{sites:l}=qe(),c=l.find(u=>u.id===s.siteId),d=({label:u,value:h})=>e.jsxs("div",{className:"bg-gray-100/50 dark:bg-gray-900/50 p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:u}),e.jsx("p",{className:"mt-1 text-md text-gray-900 dark:text-gray-100",children:h||"N/A"})]});return e.jsx(at,{isOpen:t,onClose:n,title:`${r("farmer")}: ${s.firstName} ${s.lastName} (${s.code})`,widthClass:"max-w-3xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(d,{label:r("firstName"),value:s.firstName}),e.jsx(d,{label:r("lastName"),value:s.lastName}),e.jsx(d,{label:r("code"),value:s.code}),e.jsx(d,{label:r("gender"),value:r(`gender_${s.gender}`)}),e.jsx(d,{label:r("dob"),value:s.dob}),e.jsx(d,{label:r("birthPlace"),value:s.birthPlace}),e.jsx(d,{label:r("idNumber"),value:s.idNumber}),e.jsx(d,{label:r("address"),value:s.address}),e.jsx(d,{label:r("site"),value:c==null?void 0:c.name}),e.jsx(d,{label:r("maritalStatus"),value:r(`maritalStatus_${s.maritalStatus}`)}),e.jsx(d,{label:r("nationality"),value:s.nationality}),e.jsx(d,{label:r("parentsInfo"),value:s.parentsInfo})]})})},rv=({isOpen:t,onClose:n,onAssign:s,sites:r,selectedCount:l})=>{var m;const{t:c}=je(),[d,u]=N.useState(((m=r[0])==null?void 0:m.id)||""),h=()=>{d&&s(d)};return e.jsx(at,{isOpen:t,onClose:n,title:c("assignSiteTitle"),widthClass:"max-w-md",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:c("cancel")}),e.jsx(se,{onClick:h,disabled:!d,children:c("assign")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:c("itemsSelected").replace("{count}",String(l))}),e.jsx(De,{label:c("site"),value:d,onChange:f=>u(f.target.value),children:r.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))})]})})},ak=({isOpen:t,onClose:n,preselectedFarmerIds:s=[]})=>{const{t:r,language:l}=je(),{sites:c,farmers:d,addMessageLog:u,messageLogs:h}=qe(),{currentUser:m}=ys(),[f,v]=N.useState("compose"),[x,S]=N.useState(s.length>0?"SELECTED":"ALL"),[w,C]=N.useState(""),[T,E]=N.useState("SMS"),[R,_]=N.useState(""),[D,M]=N.useState(!1);N.useEffect(()=>{t&&(s.length>0?S("SELECTED"):S("ALL"),_(""),M(!1),v("compose"))},[t,s]);const I=N.useMemo(()=>{switch(x){case"ALL":return d;case"SITE":return d.filter(A=>A.siteId===w);case"SELECTED":return d.filter(A=>s.includes(A.id));default:return[]}},[x,w,d,s]),O=async()=>{if(!R.trim())return;M(!0),await new Promise(U=>setTimeout(U,1500));const A={date:new Date().toISOString(),senderId:(m==null?void 0:m.id)||"unknown",recipientCount:I.length,filterType:x,filterValue:x==="SITE"?w:void 0,channel:T,content:R,status:"SENT"};u(A),M(!1),alert(r("messageSentSuccess")),n()};return e.jsxs(at,{isOpen:t,onClose:n,title:r("broadcastTitle"),widthClass:"max-w-4xl",footer:f==="compose"?e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:r("cancel")}),e.jsxs(se,{onClick:O,disabled:D||I.length===0||!R.trim(),children:[e.jsx(te,{name:"Send",className:`w-4 h-4 mr-2 ${D?"animate-spin":""}`}),r(D?"sending":"sendMessage")]})]}):e.jsx(se,{variant:"secondary",onClick:n,children:r("close")}),children:[e.jsx("div",{className:"mb-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>v("compose"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${f==="compose"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r("composeMessage")}),e.jsx("button",{onClick:()=>v("history"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${f==="history"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r("messageHistory")})]})}),f==="compose"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(De,{label:r("recipientScope"),value:x,onChange:A=>S(A.target.value),children:[e.jsx("option",{value:"ALL",children:r("scope_ALL")}),e.jsx("option",{value:"SITE",children:r("scope_SITE")}),e.jsxs("option",{value:"SELECTED",disabled:s.length===0,children:[r("scope_SELECTED")," (",s.length,")"]})]}),x==="SITE"&&e.jsxs(De,{label:r("site"),value:w,onChange:A=>C(A.target.value),children:[e.jsx("option",{value:"",children:r("selectSite")}),c.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]}),e.jsxs(De,{label:r("channel"),value:T,onChange:A=>E(A.target.value),children:[e.jsx("option",{value:"SMS",children:r("channel_SMS")}),e.jsx("option",{value:"WHATSAPP",children:r("channel_WHATSAPP")})]}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:[r("recipient")," Count: ",e.jsx("span",{className:"font-bold text-lg",children:I.length})]}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-300",children:"Farmers with valid phone numbers will receive this message."})]})]}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("messageContent")}),e.jsx("textarea",{className:"w-full flex-grow p-3 border rounded-lg dark:bg-gray-800 dark:border-gray-700 focus:ring-2 focus:ring-blue-500 outline-none resize-none",placeholder:"Type your message here...",value:R,onChange:A=>_(A.target.value),maxLength:T==="SMS"?160:1e3,rows:6}),e.jsxs("div",{className:"text-right text-xs text-gray-500 mt-1",children:[r("charCount").replace("{count}",String(R.length))," / ",T==="SMS"?160:1e3]})]})]})}),f==="history"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:r("date")}),e.jsx("th",{className:"p-3",children:r("channel")}),e.jsx("th",{className:"p-3",children:r("recipient")}),e.jsx("th",{className:"p-3",children:r("messageContent")}),e.jsx("th",{className:"p-3",children:r("status")})]})}),e.jsx("tbody",{children:h.length>0?h.slice().reverse().map(A=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-3 whitespace-nowrap",children:new Date(A.date).toLocaleString()}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${A.channel==="WHATSAPP"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:A.channel})}),e.jsxs("td",{className:"p-3",children:[A.recipientCount," Farmers (",A.filterType,")"]}),e.jsx("td",{className:"p-3 truncate max-w-xs",title:A.content,children:A.content}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"text-green-600 font-semibold",children:A.status})})]},A.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-6 text-center text-gray-500",children:r("noHistory")})})})]})})]})},rk=({isOpen:t,onClose:n,farmer:s,onConfirm:r})=>{const{t:l}=je(),[c,d]=N.useState(new Date().toISOString().split("T")[0]),[u,h]=N.useState(""),[m,f]=N.useState(""),v=()=>{if(!c||!u.trim()){f(l("validationRequired"));return}r(s.id,c,u),n()};return e.jsx(at,{isOpen:t,onClose:n,title:l("confirmFire"),widthClass:"max-w-md",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{variant:"danger",onClick:v,children:l("fire")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:l("confirmFireMessage").replace("{name}",`${s.firstName} ${s.lastName}`)}),e.jsx(de,{label:l("exitDate"),type:"date",value:c,onChange:x=>d(x.target.value),required:!0}),e.jsx(de,{label:l("exitReason"),value:u,onChange:x=>h(x.target.value),placeholder:"e.g. Resignation, Performance, Relocation...",required:!0,error:m})]})})},ik=()=>{const{farmers:t,sites:n,addFarmer:s,updateFarmer:r,deleteFarmer:l,deleteMultipleFarmers:c,updateFarmersSite:d}=qe(),{t:u}=je(),[h,m]=N.useState(!1),[f,v]=N.useState(null),[x,S]=N.useState(!1),[w,C]=N.useState(null),[T,E]=N.useState(null),[R,_]=N.useState({key:"code",direction:"ascending"}),[D,M]=N.useState([]),[I,O]=N.useState(!1),[A,U]=N.useState(!1),[P,F]=N.useState(!1),[q,z]=N.useState(_s.ACTIVE),[J,W]=N.useState(!1),[G,B]=N.useState(null),X=N.useMemo(()=>new Map(n.map(Se=>[Se.id,Se.name])),[n]),$=N.useMemo(()=>q==="ALL"?t:t.filter(Se=>Se.status===q),[t,q]),ae=N.useMemo(()=>{let Se=[...$];return Se.sort((Oe,be)=>{let xe,Ue;return R.key==="siteName"?(xe=X.get(Oe.siteId)||"",Ue=X.get(be.siteId)||""):(xe=Oe[R.key],Ue=be[R.key]),xe<Ue?R.direction==="ascending"?-1:1:xe>Ue?R.direction==="ascending"?1:-1:0}),Se},[$,R,X]),H=Se=>{let Oe="ascending";R.key===Se&&R.direction==="ascending"&&(Oe="descending"),_({key:Se,direction:Oe})},ie=Se=>R.key!==Se?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):R.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),ue=({sortKey:Se,label:Oe})=>e.jsx("th",{className:"p-3",children:e.jsxs("button",{onClick:()=>H(Se),className:"group flex items-center gap-2 hover:text-blue-500 dark:hover:text-blue-400 transition-colors",children:[Oe,ie(Se)]})}),Ne=(Se=null)=>{v(Se),m(!0)},oe=()=>{v(null),m(!1)},ne=()=>{w&&l(w),S(!1),C(null)},we=Se=>{B(Se),W(!0)},fe=(Se,Oe,be)=>{G&&(r({...G,status:_s.INACTIVE,exitDate:Oe,exitReason:be}),B(null))},Q=Se=>{r({...Se,status:_s.ACTIVE,joinDate:new Date().toISOString().split("T")[0],exitDate:void 0,exitReason:void 0})},ee=Se=>{E(Se)},ye=()=>{E(null)},Le=Se=>{Se.target.checked?M(ae.map(Oe=>Oe.id)):M([])},ke=(Se,Oe)=>{Se.target.checked?M(be=>[...be,Oe]):M(be=>be.filter(xe=>xe!==Oe))},Re=()=>{O(!0)},Ke=()=>{c(D),M([]),O(!1)},ze=Se=>{d(D,Se),M([]),U(!1)};return e.jsxs("div",{className:"pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:u("farmerManagementTitle")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(se,{variant:"secondary",onClick:()=>{M([]),F(!0)},children:[e.jsx(te,{name:"Bell",className:"w-5 h-5 mr-2"}),u("broadcastMessage")]}),e.jsxs(se,{onClick:()=>Ne(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5 mr-2"}),u("addFarmer")]})]})]}),e.jsx(Ge,{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:[u("status"),":"]}),e.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[e.jsx("button",{className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${q==="ACTIVE"?"bg-white dark:bg-gray-600 shadow-sm text-green-700 dark:text-green-300":"text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,onClick:()=>z(_s.ACTIVE),children:u("status_ACTIVE")}),e.jsx("button",{className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${q==="INACTIVE"?"bg-white dark:bg-gray-600 shadow-sm text-red-700 dark:text-red-300":"text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,onClick:()=>z(_s.INACTIVE),children:u("status_INACTIVE")}),e.jsx("button",{className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${q==="ALL"?"bg-white dark:bg-gray-600 shadow-sm":"text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,onClick:()=>z("ALL"),children:u("all")})]})]})}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-4",children:e.jsx(jt,{checked:ae.length>0&&D.length===ae.length,onChange:Le,"aria-label":u("selectAllFarmers")})}),e.jsx("th",{className:"p-3 w-20",children:u("status")}),e.jsx(ue,{sortKey:"code",label:u("code")}),e.jsx(ue,{sortKey:"firstName",label:u("firstName")}),e.jsx(ue,{sortKey:"lastName",label:u("lastName")}),e.jsx(ue,{sortKey:"siteName",label:u("site")}),e.jsx(ue,{sortKey:"joinDate",label:u("joinDate")}),e.jsx("th",{className:"p-3 text-right",children:u("actions")})]})}),e.jsx("tbody",{children:ae.map(Se=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:D.includes(Se.id),onChange:Oe=>ke(Oe,Se.id),"aria-label":u("selectFarmerNamed").replace("{name}",`${Se.firstName} ${Se.lastName}`)})}),e.jsx("td",{className:"p-3",children:e.jsx(mn,{status:Se.status})}),e.jsx("td",{className:"p-3 font-mono",children:Se.code}),e.jsx("td",{className:"p-3 font-semibold",children:e.jsx("button",{onClick:()=>ee(Se),className:"text-blue-600 dark:text-blue-400 hover:underline bg-transparent border-none p-0 cursor-pointer text-left",children:Se.firstName})}),e.jsx("td",{className:"p-3 font-semibold",children:e.jsx("button",{onClick:()=>ee(Se),className:"text-blue-600 dark:text-blue-400 hover:underline bg-transparent border-none p-0 cursor-pointer text-left",children:Se.lastName})}),e.jsx("td",{className:"p-3",children:X.get(Se.siteId)||u("unknown")}),e.jsx("td",{className:"p-3 text-xs",children:Se.joinDate}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(se,{variant:"ghost",onClick:()=>Ne(Se),children:e.jsx(te,{name:"Edit2",className:"w-4 h-4"})}),Se.status===_s.ACTIVE?e.jsx(se,{variant:"danger",onClick:()=>we(Se),title:u("fireFarmer"),children:e.jsx(te,{name:"LogOut",className:"w-4 h-4"})}):e.jsx(se,{variant:"secondary",onClick:()=>Q(Se),title:u("hireFarmer"),children:e.jsx(te,{name:"UserPlus",className:"w-4 h-4"})})]})})]},Se.id))})]})})}),D.length>0&&e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md border-t border-gray-200 dark:border-gray-700 flex items-center justify-center gap-4 z-20 ml-16",children:[e.jsx("span",{className:"font-semibold",children:u("itemsSelected").replace("{count}",String(D.length))}),e.jsxs(se,{onClick:()=>U(!0),children:[e.jsx(te,{name:"MapPin",className:"w-4 h-4 mr-2"}),u("assignSite")]}),e.jsxs(se,{onClick:()=>F(!0),variant:"secondary",children:[e.jsx(te,{name:"Bell",className:"w-4 h-4 mr-2"}),u("broadcastMessage")]}),e.jsxs(se,{variant:"danger",onClick:Re,children:[e.jsx(te,{name:"Trash2",className:"w-4 h-4 mr-2"}),u("deleteSelected")]})]}),h&&e.jsx(lk,{isOpen:h,onClose:oe,farmer:f,onSave:Se=>{f?r({...f,...Se}):s(Se),oe()}}),J&&G&&e.jsx(rk,{isOpen:J,onClose:()=>W(!1),farmer:G,onConfirm:fe}),P&&e.jsx(ak,{isOpen:P,onClose:()=>F(!1),preselectedFarmerIds:D}),x&&e.jsx(Ut,{isOpen:x,onClose:()=>S(!1),onConfirm:ne,title:u("confirmDeleteTitle"),message:u("confirmDeleteFarmer")}),I&&e.jsx(Ut,{isOpen:I,onClose:()=>O(!1),onConfirm:Ke,title:u("confirmBulkDeleteTitle"),message:u("confirmBulkDeleteFarmers").replace("{count}",String(D.length))}),A&&e.jsx(rv,{isOpen:A,onClose:()=>U(!1),onAssign:ze,sites:n,selectedCount:D.length}),T&&e.jsx(sk,{isOpen:!!T,onClose:ye,farmer:T})]})},lk=({isOpen:t,onClose:n,farmer:s,onSave:r})=>{const{t:l}=je(),{sites:c}=qe(),[d,u]=N.useState({firstName:"",lastName:"",gender:"Male",dob:"",birthPlace:"",idNumber:"",address:"",siteId:"",maritalStatus:"Single",nationality:"",parentsInfo:"",phone:"",status:_s.ACTIVE,joinDate:new Date().toISOString().split("T")[0]}),[h,m]=N.useState(""),[f,v]=N.useState({}),x=N.useMemo(()=>{var E;return{firstName:"",lastName:"",gender:"Male",dob:"",birthPlace:"",idNumber:"",address:"",siteId:((E=c[0])==null?void 0:E.id)||"",maritalStatus:"Single",nationality:"",parentsInfo:"",phone:"",status:_s.ACTIVE,joinDate:new Date().toISOString().split("T")[0]}},[c]),S=N.useCallback(E=>{const R={};return E.firstName.trim()||(R.firstName=l("validationRequired")),E.lastName.trim()||(R.lastName=l("validationRequired")),E.siteId||(R.siteId=l("validationRequired")),E.joinDate||(R.joinDate=l("validationRequired")),R},[l]);N.useEffect(()=>{if(s){const{code:E,id:R,..._}=s;u(_),m(E)}else u(x),m("")},[s,x,t]),N.useEffect(()=>{if(!s&&d.firstName&&d.lastName){const E=(d.firstName.substring(0,1)+d.lastName.substring(0,2)).toUpperCase();m(E)}},[d.firstName,d.lastName,s]),N.useEffect(()=>{v(S(d))},[d,S]);const w=(E,R)=>{u(_=>({..._,[E]:R}))},C=E=>{E.preventDefault();const R=S(d);Object.keys(R).length===0?r({...d,code:h}):v(R)},T=Object.keys(f).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l(s?"editFarmer":"addFarmer"),widthClass:"max-w-4xl",children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(de,{label:l("firstName"),value:d.firstName,onChange:E=>w("firstName",E.target.value),error:f.firstName,required:!0}),e.jsx(de,{label:l("lastName"),value:d.lastName,onChange:E=>w("lastName",E.target.value),error:f.lastName,required:!0}),e.jsx(de,{label:l("code"),value:h,disabled:!0}),e.jsxs(De,{label:l("gender"),value:d.gender,onChange:E=>w("gender",E.target.value),children:[e.jsx("option",{value:"Male",children:l("gender_Male")}),e.jsx("option",{value:"Female",children:l("gender_Female")}),e.jsx("option",{value:"Other",children:l("gender_Other")})]}),e.jsxs(De,{label:l("maritalStatus"),value:d.maritalStatus,onChange:E=>w("maritalStatus",E.target.value),children:[e.jsx("option",{value:"Single",children:l("maritalStatus_Single")}),e.jsx("option",{value:"Married",children:l("maritalStatus_Married")}),e.jsx("option",{value:"Divorced",children:l("maritalStatus_Divorced")}),e.jsx("option",{value:"Widowed",children:l("maritalStatus_Widowed")})]}),e.jsxs(De,{label:l("site"),value:d.siteId,onChange:E=>w("siteId",E.target.value),error:f.siteId,required:!0,children:[e.jsx("option",{value:"",children:l("selectSite")}),c.map(E=>e.jsx("option",{value:E.id,children:E.name},E.id))]}),e.jsx(de,{label:l("joinDate"),type:"date",value:d.joinDate,onChange:E=>w("joinDate",E.target.value),required:!0,error:f.joinDate}),e.jsx(de,{label:l("phoneNumber"),type:"tel",value:d.phone||"",onChange:E=>w("phone",E.target.value),placeholder:"+261..."}),e.jsx(de,{label:l("dob"),value:d.dob,onChange:E=>w("dob",E.target.value),placeholder:"e.g. 1990-05-15 or Circa 1981"}),e.jsx(de,{label:l("birthPlace"),value:d.birthPlace,onChange:E=>w("birthPlace",E.target.value)}),e.jsx(de,{label:l("nationality"),value:d.nationality,onChange:E=>w("nationality",E.target.value)}),e.jsx(de,{containerClassName:"md:col-span-3",label:l("idNumber"),value:d.idNumber,onChange:E=>w("idNumber",E.target.value)}),e.jsx(de,{containerClassName:"md:col-span-3",label:l("address"),value:d.address,onChange:E=>w("address",E.target.value)}),e.jsx(de,{containerClassName:"md:col-span-3",label:l("parentsInfo"),value:d.parentsInfo,onChange:E=>w("parentsInfo",E.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{type:"submit",disabled:T,children:l("save")})]})]})})},ok=({isOpen:t,onClose:n,employee:s})=>{const{t:r}=je(),{sites:l}=qe(),{settings:c}=$e(),d=l.find(h=>h.id===s.siteId),u=({label:h,value:m})=>e.jsxs("div",{className:"bg-gray-100/50 dark:bg-gray-900/50 p-3 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:h}),e.jsx("p",{className:"mt-1 text-md text-gray-900 dark:text-gray-100",children:m||"N/A"})]});return e.jsx(at,{isOpen:t,onClose:n,title:`${r("employeeProfile")}: ${s.firstName} ${s.lastName}`,widthClass:"max-w-3xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(u,{label:r("firstName"),value:s.firstName}),e.jsx(u,{label:r("lastName"),value:s.lastName}),e.jsx(u,{label:r("code"),value:s.code}),e.jsx(u,{label:r("employeeType"),value:e.jsx(mn,{status:s.employeeType})}),e.jsx(u,{label:r("role"),value:s.role}),e.jsx(u,{label:r("category"),value:s.category}),e.jsx(u,{label:r("team"),value:s.team}),e.jsx(u,{label:r("grossWage"),value:Ae(s.grossWage,c.localization)}),e.jsx(u,{label:r("site"),value:d==null?void 0:d.name}),e.jsx(u,{label:r("email"),value:s.email}),e.jsx(u,{label:r("phone"),value:s.phone}),e.jsx(u,{label:r("hireDate"),value:s.hireDate})]})})},ck=({currentPage:t,totalPages:n,onPageChange:s,itemsPerPage:r,totalItems:l,onItemsPerPageChange:c})=>{const{t:d}=je(),u=l===0?0:(t-1)*r+1,h=Math.min(t*r,l),m=()=>{const f=[];if(n<=7)for(let v=1;v<=n;v++)f.push(v);else f.push(1),t>3&&f.push("..."),t>2&&f.push(t-1),t!==1&&t!==n&&f.push(t),t<n-1&&f.push(t+1),t<n-2&&f.push("..."),f.push(n);return[...new Set(f)]};return n<=1&&l<=r?null:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between mt-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"mb-2 md:mb-0",children:[d("pagination.showing")," ",u,"-",h," ",d("pagination.of")," ",l," ",d("pagination.results")]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:[d("pagination.itemsPerPage"),":"]}),e.jsxs(De,{value:r,onChange:f=>c(Number(f.target.value)),className:"!w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{variant:"ghost",onClick:()=>s(t-1),disabled:t===1,className:"!px-2","aria-label":d("pagination.previous"),children:[e.jsx(te,{name:"ChevronLeft",className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:d("pagination.previous")})]}),e.jsx("div",{className:"flex items-center gap-1",children:m().map((f,v)=>typeof f=="number"?e.jsx(se,{variant:t===f?"primary":"ghost",onClick:()=>s(f),className:"!px-3 !py-1","aria-label":`Go to page ${f}`,"aria-current":t===f?"page":void 0,children:f},v):e.jsx("span",{className:"px-2 py-1",children:"..."},v))}),e.jsxs(se,{variant:"ghost",onClick:()=>s(t+1),disabled:t===n||n===0,className:"!px-2","aria-label":d("pagination.next"),children:[e.jsx("span",{className:"hidden sm:inline",children:d("pagination.next")}),e.jsx(te,{name:"ChevronRight",className:"w-5 h-5"})]})]})]})]})},dk=({isOpen:t,onClose:n,employee:s,onSave:r})=>{const{t:l}=je(),{sites:c,roles:d}=qe(),{settings:u}=$e(),[h,m]=N.useState(!1),f=N.useMemo(()=>({firstName:"",lastName:"",employeeType:"PERMANENT",role:"",team:"",phone:"",email:"",hireDate:new Date().toISOString().split("T")[0],siteId:"",grossWage:"",category:""}),[]),[v,x]=N.useState(f),[S,w]=N.useState(""),[C,T]=N.useState({}),E=N.useCallback(M=>{const I={};M.firstName.trim()||(I.firstName=l("validationRequired")),M.lastName.trim()||(I.lastName=l("validationRequired")),M.role.trim()||(I.role=l("validationRequired")),M.category.trim()||(I.category=l("validationRequired")),M.hireDate||(I.hireDate=l("validationRequired")),M.phone.trim()||(I.phone=l("validationRequired"));const O=typeof M.grossWage=="string"?Ku(M.grossWage,u.localization):M.grossWage;return(isNaN(O)||O<=0)&&(I.grossWage=l("validationPositiveNumber")),M.email&&!/\S+@\S+\.\S+/.test(M.email)&&(I.email=l("validationEmail")),I},[l,u.localization]);N.useEffect(()=>{if(s){const{code:M,id:I,...O}=s;x({...O,team:O.team||"",siteId:O.siteId||"",grossWage:String(O.grossWage)}),w(M)}else x(f),w("")},[s,f,t]),N.useEffect(()=>{if(!s&&v.firstName&&v.lastName){const M=(v.firstName.substring(0,1)+v.lastName.substring(0,2)).toUpperCase();w(M)}},[v.firstName,v.lastName,s]),N.useEffect(()=>{T(E(v))},[v,E]);const R=(M,I)=>{x(O=>({...O,[M]:I}))},_=M=>{M.preventDefault();const I=E(v);if(Object.keys(I).length>0){T(I);return}const O={...v,code:S,siteId:v.siteId||void 0,team:v.team||void 0,grossWage:typeof v.grossWage=="string"?Ku(v.grossWage,u.localization):parseFloat(v.grossWage)||0,status:(s==null?void 0:s.status)||ym.ACTIVE,exitDate:s==null?void 0:s.exitDate,exitReason:s==null?void 0:s.exitReason,email:v.email,phone:v.phone};r(O)},D=Object.keys(C).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l(s?"editEmployee":"addEmployee"),widthClass:"max-w-3xl",children:e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(de,{label:l("firstName"),value:v.firstName,onChange:M=>R("firstName",M.target.value),error:C.firstName,required:!0,autoFocus:!0}),e.jsx(de,{label:l("lastName"),value:v.lastName,onChange:M=>R("lastName",M.target.value),error:C.lastName,required:!0}),e.jsx(de,{label:l("code"),value:S,disabled:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(De,{label:l("employeeType"),value:v.employeeType,onChange:M=>R("employeeType",M.target.value),children:[e.jsx("option",{value:"PERMANENT",children:l("employeeType_PERMANENT")}),e.jsx("option",{value:"CASUAL",children:l("employeeType_CASUAL")})]}),e.jsxs(De,{label:l("role"),value:v.role,onChange:M=>R("role",M.target.value),error:C.role,required:!0,children:[e.jsx("option",{value:"",children:l("selectRole")}),d.map(M=>e.jsx("option",{value:M.name,children:M.name},M.id))]}),e.jsx(de,{label:`${l("team")} (${l("optional")})`,value:v.team,onChange:M=>R("team",M.target.value)}),e.jsx(de,{label:l("grossWage"),type:h?"number":"text",value:h?v.grossWage:Ae(parseFloat(v.grossWage)||0,u.localization),onFocus:()=>m(!0),onChange:M=>R("grossWage",M.target.value),onBlur:()=>m(!1),error:C.grossWage,required:!0}),e.jsxs(De,{label:l("site"),value:v.siteId,onChange:M=>R("siteId",M.target.value),children:[e.jsx("option",{value:"",children:l("noSpecificSite")}),c.map(M=>e.jsx("option",{value:M.id,children:M.name},M.id))]}),e.jsx(de,{label:l("category"),value:v.category,onChange:M=>R("category",M.target.value),error:C.category,required:!0}),e.jsx(de,{label:`${l("email")} (${l("optional")})`,type:"email",value:v.email,onChange:M=>R("email",M.target.value),error:C.email}),e.jsx(de,{label:l("phone"),type:"tel",value:v.phone,onChange:M=>R("phone",M.target.value),required:!0,error:C.phone}),e.jsx(de,{label:l("hireDate"),type:"date",value:v.hireDate,onChange:M=>R("hireDate",M.target.value),error:C.hireDate,required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{type:"submit",disabled:D,children:l("save")})]})]})})},uk=()=>{const{employees:t,sites:n,addEmployee:s,updateEmployee:r,deleteEmployee:l,deleteMultipleEmployees:c,updateEmployeesSite:d,roles:u}=qe(),{t:h}=je(),[m,f]=N.useState(!1),[v,x]=N.useState(null),[S,w]=N.useState(!1),[C,T]=N.useState(null),[E,R]=N.useState(null),[_,D]=N.useState({key:"code",direction:"ascending"}),[M,I]=N.useState({name:"",siteId:"all",role:"all"}),[O,A]=N.useState([]),[U,P]=N.useState(!1),[F,q]=N.useState(!1),z=N.useRef(null),[J,W]=N.useState(1),[G,B]=N.useState(10),X=N.useMemo(()=>new Map(n.map(be=>[be.id,be.name])),[n]),$=N.useMemo(()=>[...new Set(t.map(be=>be.role).filter(Boolean))].sort(),[t]),ae=N.useMemo(()=>{let be=[...t];if(M.name){const xe=M.name.toLowerCase();be=be.filter(Ue=>`${Ue.firstName} ${Ue.lastName}`.toLowerCase().includes(xe)||Ue.code.toLowerCase().includes(xe))}return M.siteId!=="all"&&(be=be.filter(xe=>xe.siteId===M.siteId)),M.role!=="all"&&(be=be.filter(xe=>xe.role===M.role)),be.sort((xe,Ue)=>{let Ze,Et;return _.key==="siteName"?(Ze=xe.siteId&&X.get(xe.siteId)||"",Et=Ue.siteId&&X.get(Ue.siteId)||""):(Ze=xe[_.key]||"",Et=Ue[_.key]||""),Ze<Et?_.direction==="ascending"?-1:1:Ze>Et?_.direction==="ascending"?1:-1:0}),be},[t,M,_,X]);N.useEffect(()=>{W(1)},[M.name,M.siteId,M.role,G]);const H=N.useMemo(()=>{const be=(J-1)*G;return ae.slice(be,be+G)},[ae,J,G]);N.useEffect(()=>{if(z.current){const be=new Set(H.map(Ze=>Ze.id)),xe=O.filter(Ze=>be.has(Ze)).length,Ue=xe===H.length&&H.length>0;z.current.checked=Ue,z.current.indeterminate=xe>0&&!Ue}},[O,H]);const ie=(be,xe)=>{I(Ue=>({...Ue,[be]:xe}))},ue=()=>{I({name:"",siteId:"all",role:"all"})},Ne=be=>{let xe="ascending";_.key===be&&_.direction==="ascending"&&(xe="descending"),D({key:be,direction:xe})},oe=be=>_.key!==be?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):_.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),ne=({sortKey:be,label:xe})=>e.jsx("th",{className:"p-3",children:e.jsxs("button",{onClick:()=>Ne(be),className:"group flex items-center gap-2 hover:text-blue-500 dark:hover:text-blue-400 transition-colors",children:[xe,oe(be)]})}),we=(be=null)=>{x(be),f(!0)},fe=()=>{x(null),f(!1)},Q=be=>{T(be),w(!0)},ee=()=>{C&&l(C),w(!1),T(null)},ye=be=>{v?r({...v,...be}):s(be),fe()},Le=be=>{R(be)},ke=()=>{R(null)},Re=N.useCallback(be=>{const xe=H.map(Ue=>Ue.id);if(be.target.checked)A(Ue=>[...new Set([...Ue,...xe])]);else{const Ue=new Set(xe);A(Ze=>Ze.filter(Et=>!Ue.has(Et)))}},[H]),Ke=(be,xe)=>{be.target.checked?A(Ue=>[...Ue,xe]):A(Ue=>Ue.filter(Ze=>Ze!==xe))},ze=()=>{P(!0)},Se=()=>{c(O),A([]),P(!1)},Oe=be=>{d(O,be),A([]),q(!1)};return e.jsxs("div",{className:"pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:h("employeeManagementTitle")}),e.jsxs(se,{onClick:()=>we(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),h("addEmployee")]})]}),e.jsx(Ge,{className:"mb-6",title:h("filtersTitle"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end",children:[e.jsx(de,{label:h("searchByNameOrCode"),value:M.name,onChange:be=>ie("name",be.target.value),placeholder:h("searchByNameOrCode")}),e.jsxs(De,{label:h("site"),value:M.siteId,onChange:be=>ie("siteId",be.target.value),children:[e.jsx("option",{value:"all",children:h("allSites")}),n.map(be=>e.jsx("option",{value:be.id,children:be.name},be.id))]}),e.jsxs(De,{label:h("role"),value:M.role,onChange:be=>ie("role",be.target.value),children:[e.jsx("option",{value:"all",children:h("allRoles")}),$.map(be=>e.jsx("option",{value:be,children:be},be))]}),e.jsx(se,{variant:"secondary",onClick:ue,className:"h-[42px]",children:h("clearFilters")})]})}),e.jsxs(Ge,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-4",children:e.jsx(jt,{ref:z,onChange:Re,"aria-label":h("selectAllEmployees")})}),e.jsx(ne,{sortKey:"code",label:h("code")}),e.jsx(ne,{sortKey:"firstName",label:h("firstName")}),e.jsx(ne,{sortKey:"lastName",label:h("lastName")}),e.jsx(ne,{sortKey:"role",label:h("role")}),e.jsx(ne,{sortKey:"team",label:h("team")}),e.jsx(ne,{sortKey:"siteName",label:h("site")}),e.jsx(ne,{sortKey:"phone",label:h("phone")}),e.jsx(ne,{sortKey:"hireDate",label:h("hireDate")}),e.jsx("th",{className:"p-3 text-right",children:h("actions")})]})}),e.jsx("tbody",{children:H.map(be=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:O.includes(be.id),onChange:xe=>Ke(xe,be.id),"aria-label":h("selectEmployeeNamed").replace("{name}",`${be.firstName} ${be.lastName}`)})}),e.jsx("td",{className:"p-3 font-mono",children:be.code}),e.jsx("td",{className:"p-3 font-semibold",children:e.jsx("button",{onClick:()=>Le(be),className:"text-blue-600 dark:text-blue-400 hover:underline bg-transparent border-none p-0 cursor-pointer text-left",children:be.firstName})}),e.jsx("td",{className:"p-3 font-semibold",children:be.lastName}),e.jsx("td",{className:"p-3",children:be.role}),e.jsx("td",{className:"p-3",children:be.team||h("none")}),e.jsx("td",{className:"p-3",children:be.siteId?X.get(be.siteId)||h("unknown"):h("noSpecificSite")}),e.jsx("td",{className:"p-3",children:be.phone}),e.jsx("td",{className:"p-3",children:be.hireDate}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(se,{variant:"ghost",onClick:()=>we(be),children:[e.jsx(te,{name:"Settings",className:"w-4 h-4"}),h("edit")]}),e.jsxs(se,{variant:"danger",onClick:()=>Q(be.id),children:[e.jsx(te,{name:"Trash2",className:"w-4 h-4"}),h("delete")]})]})})]},be.id))})]})}),ae.length===0&&e.jsx("p",{className:"text-center p-8 text-gray-500",children:h("noEmployeesMatchFilters")}),e.jsx(ck,{currentPage:J,totalPages:Math.ceil(ae.length/G),onPageChange:W,itemsPerPage:G,totalItems:ae.length,onItemsPerPageChange:be=>{B(be),W(1)}})]}),O.length>0&&e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md border-t border-gray-200 dark:border-gray-700 flex items-center justify-center gap-4 z-20 md:ml-16",children:[e.jsx("span",{className:"font-semibold",children:h("itemsSelected").replace("{count}",String(O.length))}),e.jsxs(se,{onClick:()=>q(!0),children:[e.jsx(te,{name:"MapPin",className:"w-4 h-4"}),h("assignSite")]}),e.jsxs(se,{variant:"danger",onClick:ze,children:[e.jsx(te,{name:"Trash2",className:"w-4 h-4"}),h("deleteSelected")]})]}),m&&e.jsx(dk,{isOpen:m,onClose:fe,employee:v,onSave:ye}),S&&e.jsx(Ut,{isOpen:S,onClose:()=>w(!1),onConfirm:ee,title:h("confirmDeleteTitle"),message:h("confirmDeleteEmployee")}),U&&e.jsx(Ut,{isOpen:U,onClose:()=>P(!1),onConfirm:Se,title:h("confirmBulkDeleteTitle"),message:h("confirmBulkDeleteEmployees").replace("{count}",String(O.length))}),F&&e.jsx(rv,{isOpen:F,onClose:()=>q(!1),onAssign:Oe,sites:n,selectedCount:O.length}),E&&e.jsx(ok,{isOpen:!!E,onClose:ke,employee:E})]})},mk=({isOpen:t,onClose:n,slip:s})=>{const{t:r}=je(),{settings:l}=$e(),{seaweedTypes:c,addPressingSlip:d,updatePressingSlip:u,pressedStockMovements:h}=qe(),m=N.useCallback(()=>{var _;return{date:new Date().toISOString().split("T")[0],seaweedTypeId:((_=c[0])==null?void 0:_.id)||"",sourceSiteId:"pressing-warehouse",consumedWeightKg:"",consumedBags:"",producedWeightKg:"",producedBalesCount:""}},[c]),[f,v]=N.useState(m()),[x,S]=N.useState({});N.useEffect(()=>{t&&(v(s?{date:s.date,seaweedTypeId:s.seaweedTypeId,sourceSiteId:"pressing-warehouse",consumedWeightKg:String(s.consumedWeightKg),consumedBags:String(s.consumedBags),producedWeightKg:String(s.producedWeightKg),producedBalesCount:String(s.producedBalesCount)}:m()),S({}))},[t,s,m]);const w=N.useMemo(()=>{if(!f.seaweedTypeId)return{kg:0,bags:0};const _=h.filter(I=>I.seaweedTypeId===f.seaweedTypeId&&I.siteId==="pressing-warehouse");let D=0,M=0;return _.forEach(I=>{[ut.BULK_IN_FROM_SITE,ut.FARMER_DELIVERY].includes(I.type)?(D+=I.inKg||0,M+=I.inBales||0):[ut.PRESSING_CONSUMPTION].includes(I.type)&&(D-=I.outKg||0,M-=I.outBales||0)}),s&&s.seaweedTypeId===f.seaweedTypeId&&(D+=s.consumedWeightKg,M+=s.consumedBags),{kg:Math.max(0,D),bags:Math.max(0,M)}},[h,f.seaweedTypeId,s]),C=N.useCallback(()=>{const _={};f.date||(_.date=r("validationRequired")),f.seaweedTypeId||(_.seaweedTypeId=r("validationRequired"));const D=parseFloat(f.consumedWeightKg);!f.consumedWeightKg||isNaN(D)||D<=0?_.consumedWeightKg=r("validationPositiveNumber"):D>w.kg&&(_.consumedWeightKg=r("validationStockUnavailableBulk").replace("{availableStock}",Fe(w.kg,l.localization)));const M=parseInt(f.consumedBags,10);return!f.consumedBags||isNaN(M)||M<0?_.consumedBags=r("validationNonNegative"):M>w.bags&&(_.consumedBags=r("validationStockUnavailableBags").replace("{availableStock}",String(w.bags))),(!f.producedWeightKg||isNaN(parseFloat(f.producedWeightKg))||parseFloat(f.producedWeightKg)<=0)&&(_.producedWeightKg=r("validationPositiveNumber")),(!f.producedBalesCount||isNaN(parseInt(f.producedBalesCount,10))||parseInt(f.producedBalesCount,10)<=0)&&(_.producedBalesCount=r("validationPositiveNumber")),_},[f,r,w,l.localization]);N.useEffect(()=>{S(C())},[f,C]);const T=(_,D)=>{v(M=>({...M,[_]:D}))},E=_=>{_.preventDefault();const D=C();if(Object.keys(D).length>0){S(D);return}const M={date:f.date,seaweedTypeId:f.seaweedTypeId,sourceSiteId:"pressing-warehouse",consumedWeightKg:parseFloat(f.consumedWeightKg),consumedBags:parseInt(f.consumedBags,10)||0,producedWeightKg:parseFloat(f.producedWeightKg),producedBalesCount:parseInt(f.producedBalesCount,10)};s?u({...s,...M}):d(M),n()},R=Object.keys(x).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:r(s?"editPressingSlip":"newPressingSlip"),widthClass:"max-w-4xl",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:r("cancel")}),e.jsx(se,{onClick:E,disabled:R,children:r("save")})]}),children:e.jsx("form",{onSubmit:E,className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{label:r("date"),type:"date",value:f.date,onChange:_=>T("date",_.target.value),error:x.date,required:!0}),e.jsx(De,{label:r("seaweedType"),value:f.seaweedTypeId,onChange:_=>T("seaweedTypeId",_.target.value),error:x.seaweedTypeId,required:!0,children:c.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("originInformation")}),e.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 font-bold",children:r("pressedWarehouseTitle")})]}),e.jsx("div",{className:"md:col-span-2 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:[r("availableBulkStock"),":"]}),e.jsxs("span",{className:"font-bold text-lg text-blue-900 dark:text-blue-100",children:[Fe(w.kg,l.localization)," kg (",w.bags," ",r("bags"),")"]})]})}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-xl border border-red-200 dark:border-red-700 space-y-4",children:[e.jsx("h4",{className:"text-sm font-bold uppercase tracking-widest text-red-700 dark:text-red-200 border-b border-red-300 pb-1 mb-2",children:r("bulkWeightConsumed")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(de,{label:`${r("warehouse_weightKg")}`,type:"number",step:"any",value:f.consumedWeightKg,onChange:_=>T("consumedWeightKg",_.target.value),error:x.consumedWeightKg,required:!0}),e.jsx(de,{label:r("sac"),type:"number",value:f.consumedBags,onChange:_=>T("consumedBags",_.target.value),error:x.consumedBags,required:!0})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-xl border border-green-200 dark:border-green-700 space-y-4",children:[e.jsx("h4",{className:"text-sm font-bold uppercase tracking-widest text-green-700 dark:text-green-200 border-b border-green-300 pb-1 mb-2",children:r("pressedWeightObtained")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(de,{label:`${r("warehouse_weightKg")}`,type:"number",step:"any",value:f.producedWeightKg,onChange:_=>T("producedWeightKg",_.target.value),error:x.producedWeightKg,required:!0}),e.jsx(de,{label:r("baleSingular"),type:"number",value:f.producedBalesCount,onChange:_=>T("producedBalesCount",_.target.value),error:x.producedBalesCount,required:!0})]})]})]})})})},fk=({isOpen:t,onClose:n})=>{const{t:s}=je(),{seaweedTypes:r,addPressedStockAdjustment:l}=qe(),[c,d]=N.useState({date:new Date().toISOString().split("T")[0],seaweedTypeId:"",direction:"in",kg:"",bales:"",designation:""}),[u,h]=N.useState({});N.useEffect(()=>{var x;t&&(d({date:new Date().toISOString().split("T")[0],seaweedTypeId:((x=r[0])==null?void 0:x.id)||"",direction:"in",kg:"",bales:"",designation:""}),h({}))},[t,r]);const m=N.useCallback(()=>{const x={};c.seaweedTypeId||(x.seaweedTypeId=s("validationRequired")),c.designation.trim()||(x.designation=s("validationRequired"));const S=parseFloat(c.kg),w=parseInt(c.bales,10);if(!c.kg&&!c.bales||isNaN(S)&&isNaN(w)){const C=s("validationAtLeastOneRequired");x.kg=C,x.bales=C}return c.kg&&(isNaN(S)||S<=0)&&(x.kg=s("validationPositiveNumber")),c.bales&&(isNaN(w)||w<=0)&&(x.bales=s("validationPositiveNumber")),x},[c,s]);N.useEffect(()=>{h(m())},[c,m]);const f=()=>{const x=m();if(Object.keys(x).length>0){h(x);return}l({date:c.date,siteId:"pressing-warehouse",seaweedTypeId:c.seaweedTypeId,type:c.direction==="in"?ut.ADJUSTMENT_IN:ut.ADJUSTMENT_OUT,designation:c.designation,inKg:c.direction==="in"&&parseFloat(c.kg)||void 0,outKg:c.direction==="out"&&parseFloat(c.kg)||void 0,inBales:c.direction==="in"&&parseInt(c.bales)||void 0,outBales:c.direction==="out"&&parseInt(c.bales)||void 0}),n()},v=Object.keys(u).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:`${s("recordStockAdjustment")} (${s("pressedSeaweed")})`,footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:s("cancel")}),e.jsx(se,{onClick:f,disabled:v,children:s("save")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:s("date"),type:"date",value:c.date,onChange:x=>d(S=>({...S,date:x.target.value}))}),e.jsx(De,{label:s("seaweedType"),value:c.seaweedTypeId,onChange:x=>d(S=>({...S,seaweedTypeId:x.target.value})),children:r.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))})]}),e.jsxs(De,{label:s("direction"),value:c.direction,onChange:x=>d(S=>({...S,direction:x.target.value})),children:[e.jsx("option",{value:"in",children:s("in")}),e.jsx("option",{value:"out",children:s("out")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:s("kg"),type:"number",step:"any",value:c.kg,onChange:x=>d(S=>({...S,kg:x.target.value})),error:u.kg}),e.jsx(de,{label:s("baleSingular"),type:"number",value:c.bales,onChange:x=>d(S=>({...S,bales:x.target.value})),error:u.bales})]}),e.jsx(de,{label:s("reasonForAdjustment"),value:c.designation,onChange:x=>d(S=>({...S,designation:x.target.value})),required:!0,error:u.designation,placeholder:"e.g. Initial Stock, Correction, Found Stock..."})]})})},pk=()=>{const{t}=je(),{settings:n}=$e(),{pressedStockMovements:s,seaweedTypes:r}=qe(),{bulkStock:l,pressedStock:c,totals:d}=N.useMemo(()=>{const h=new Map,m=new Map;s.forEach(T=>{const E=T.seaweedTypeId;let R=h.get(E)||{kg:0,bags:0},_=m.get(E)||{bales:0,kg:0};switch(T.type){case ut.BULK_IN_FROM_SITE:case ut.FARMER_DELIVERY:R.kg+=T.inKg||0,R.bags+=T.inBales||0;break;case ut.PRESSING_CONSUMPTION:R.kg-=T.outKg||0,R.bags-=T.outBales||0;break;case ut.PRESSING_IN:case ut.INITIAL_STOCK:case ut.ADJUSTMENT_IN:_.bales+=T.inBales||0,_.kg+=T.inKg||0;break;case ut.EXPORT_OUT:case ut.RETURN_TO_SITE:case ut.ADJUSTMENT_OUT:_.bales-=T.outBales||0,_.kg-=T.outKg||0;break}h.set(E,R),m.set(E,_)});const f=(T,E)=>Array.from(T.entries()).map(([R,_])=>{const D=r.find(I=>I.id===R),M=_.kg*((D==null?void 0:D.dryPrice)||0);return{seaweedTypeId:R,name:(D==null?void 0:D.name)||t("unknown"),siteName:t("pressedWarehouseTitle"),..._,value:M}}).filter(R=>R.kg>.01||(E?R.bales>0:R.bags>0)),v=f(h,!1),x=f(m,!0),S=v.reduce((T,E)=>T+E.value,0),w=x.reduce((T,E)=>T+E.value,0),C={pressedBales:x.reduce((T,E)=>T+E.bales,0),pressedKg:x.reduce((T,E)=>T+E.kg,0),pressedValue:w,totalValue:S+w};return{bulkStock:v,pressedStock:x,totals:C}},[s,r,t]),u=()=>{const h=l.map(v=>({name:v.name,kg:v.kg,bags:v.bags,value:v.value})),m=c.map(v=>({name:v.name,kg:v.kg,bales:v.bales,value:v.value})),f=[{sheetName:t("bulkSeaweed"),columns:[{header:t("seaweedType"),key:"name",width:25},{header:t("warehouse_weightKg"),key:"kg",width:15},{header:t("bags"),key:"bags",width:15},{header:t("value"),key:"value",width:20}],data:h},{sheetName:t("pressedSeaweed"),columns:[{header:t("seaweedType"),key:"name",width:25},{header:t("warehouse_weightKg"),key:"kg",width:15},{header:t("bales"),key:"bales",width:15},{header:t("value"),key:"value",width:20}],data:m}];av(f,"Pressed_Warehouse_Summary")};return e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(se,{onClick:u,variant:"secondary",children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-5 h-5 mr-2"}),t("exportExcel")]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"Archive",className:"w-10 h-10 text-blue-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("warehouse_totalBalesInStock")}),e.jsx("p",{className:"text-3xl font-bold",children:d.pressedBales})]})]})}),e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"Package",className:"w-10 h-10 text-green-500 mr-4"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-500",children:[t("totalStockKg")," (",t("pressedSeaweed"),")"]}),e.jsx("p",{className:"text-3xl font-bold",children:Fe(d.pressedKg,n.localization)})]})]})}),e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"DollarSign",className:"w-10 h-10 text-yellow-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("totalStockValue")}),e.jsx("p",{className:"text-3xl font-bold",children:Ae(d.totalValue,n.localization)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mt-6",children:[e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-2 h-6 bg-red-500 rounded-sm mr-2"}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:t("bulkSeaweed")})]}),e.jsx(Ge,{className:"flex-grow border-t-4 border-t-red-500",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700 text-xs uppercase text-gray-500",children:[e.jsx("th",{className:"p-2 pl-0",children:t("seaweedType")}),e.jsx("th",{className:"p-2 text-right",children:t("kg")}),e.jsx("th",{className:"p-2 text-right",children:t("bags")})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700/50",children:[l.map(h=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"p-3 pl-0 font-medium text-gray-900 dark:text-gray-100",children:h.name}),e.jsx("td",{className:"p-3 text-right",children:Fe(h.kg,n.localization)}),e.jsx("td",{className:"p-3 text-right text-gray-500",children:h.bags})]},h.seaweedTypeId)),l.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"p-6 text-center text-sm text-gray-400 italic",children:t("noStockData")})})]})]})})})]}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-2 h-6 bg-green-500 rounded-sm mr-2"}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:t("pressedSeaweed")})]}),e.jsx(Ge,{className:"flex-grow border-t-4 border-t-green-500",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700 text-xs uppercase text-gray-500",children:[e.jsx("th",{className:"p-2 pl-0",children:t("seaweedType")}),e.jsx("th",{className:"p-2 text-right",children:t("kg")}),e.jsx("th",{className:"p-2 text-right",children:t("bales")}),e.jsx("th",{className:"p-2 text-right",children:t("value")})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700/50",children:[c.map(h=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"p-3 pl-0 font-medium text-gray-900 dark:text-gray-100",children:h.name}),e.jsx("td",{className:"p-3 text-right",children:Fe(h.kg,n.localization)}),e.jsx("td",{className:"p-3 text-right text-gray-500",children:h.bales}),e.jsx("td",{className:"p-3 text-right font-medium text-green-600 dark:text-green-400",children:Ae(h.value,n.localization)})]},h.seaweedTypeId)),c.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-6 text-center text-sm text-gray-400 italic",children:t("noStockData")})})]})]})})})]})]})]})},hk=({onEdit:t,onDelete:n})=>{const{t:s}=je(),{pressingSlips:r,seaweedTypes:l,exportDocuments:c}=qe(),[d,u]=N.useState({key:"date",direction:"descending"}),h=N.useMemo(()=>new Map(c.map(w=>[w.id,w])),[c]),m=N.useMemo(()=>new Map(l.map(w=>[w.id,w.name])),[l]),f=N.useMemo(()=>[...r].sort((w,C)=>{const T=w[d.key],E=C[d.key];return T<E?d.direction==="ascending"?-1:1:T>E?d.direction==="ascending"?1:-1:0}),[r,d]),v=w=>{let C="ascending";d.key===w&&d.direction==="ascending"&&(C="descending"),u({key:w,direction:C})},x=w=>d.key!==w?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):d.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),S=()=>{const w=f.map(T=>{var E;return{slipNo:T.slipNo,date:T.date,seaweedType:m.get(T.seaweedTypeId)||s("unknown"),consumedWeightKg:T.consumedWeightKg,producedWeightKg:T.producedWeightKg,producedBalesCount:T.producedBalesCount,linkedExport:T.exportDocId?((E=h.get(T.exportDocId))==null?void 0:E.docNo)||"Linked":"No"}}),C=[{header:s("slipNo"),key:"slipNo",width:20},{header:s("date"),key:"date",width:15},{header:s("seaweedType"),key:"seaweedType",width:20},{header:s("bulkWeightConsumed"),key:"consumedWeightKg",width:20},{header:s("pressedWeightObtained"),key:"producedWeightKg",width:20},{header:s("bales"),key:"producedBalesCount",width:15},{header:s("linkedExport"),key:"linkedExport",width:20}];Yr(w,C,`PressingSlips_${new Date().toISOString().split("T")[0]}`,"Pressing Slips")};return e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(se,{onClick:S,variant:"secondary",children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-4 h-4 mr-2"})," ",s("exportExcel")]})}),e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700 font-bold bg-gray-50 dark:bg-gray-800",children:[e.jsx("th",{className:"p-3",children:e.jsxs("button",{onClick:()=>v("slipNo"),className:"group flex items-center gap-2",children:[s("slipNo")," ",x("slipNo")]})}),e.jsx("th",{className:"p-3",children:e.jsxs("button",{onClick:()=>v("date"),className:"group flex items-center gap-2",children:[s("date")," ",x("date")]})}),e.jsx("th",{className:"p-3",children:s("seaweedType")}),e.jsx("th",{className:"p-3 text-right text-red-600",children:s("bulkWeightConsumed")}),e.jsx("th",{className:"p-3 text-right text-green-600",children:s("pressedWeightObtained")}),e.jsx("th",{className:"p-3 text-right",children:s("bales")}),e.jsx("th",{className:"p-3",children:s("linkedExport")}),e.jsx("th",{className:"p-3 text-right",children:s("actions")})]})}),e.jsx("tbody",{children:f.map(w=>{const C=w.exportDocId?h.get(w.exportDocId):null,T=!!C;return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3 font-mono",children:w.slipNo}),e.jsx("td",{className:"p-3",children:w.date}),e.jsx("td",{className:"p-3 font-semibold",children:m.get(w.seaweedTypeId)||s("unknown")}),e.jsxs("td",{className:"p-3 text-right text-red-600 font-medium",children:["-",w.consumedWeightKg," kg"]}),e.jsxs("td",{className:"p-3 text-right text-green-600 font-bold",children:["+",w.producedWeightKg," kg"]}),e.jsx("td",{className:"p-3 text-right font-semibold",children:w.producedBalesCount}),e.jsx("td",{className:"p-3",children:C?e.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:C.docNo}):"-"}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(se,{variant:"ghost",onClick:()=>t(w),disabled:T,children:e.jsx(te,{name:"Settings",className:"w-4 h-4"})}),e.jsx(Dm,{content:s(T?"cannotDeleteLinkedSlip":"delete"),children:e.jsx(se,{variant:"danger",onClick:()=>n(w),disabled:T,children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})})]})})]},w.id)})})]})]})},gk=()=>{const{t}=je(),{pressedStockMovements:n,seaweedTypes:s}=qe(),{settings:r}=$e(),[l,c]=N.useState({seaweedTypeId:"all",startDate:"",endDate:""}),{filteredBulkHistory:d,filteredPressedHistory:u}=N.useMemo(()=>{const m=l.seaweedTypeId==="all"?[...n]:n.filter(T=>T.seaweedTypeId===l.seaweedTypeId);m.sort((T,E)=>new Date(T.date).getTime()-new Date(E.date).getTime()||T.id.localeCompare(E.id));let f=0,v=0,x=0,S=0;const C=m.map(T=>{const E=[ut.BULK_IN_FROM_SITE,ut.FARMER_DELIVERY,ut.PRESSING_CONSUMPTION].includes(T.type);return E?(f+=(T.inKg||0)-(T.outKg||0),v+=(T.inBales||0)-(T.outBales||0),{...T,isBulk:E,balanceKg:f,balanceUnits:v}):(x+=(T.inKg||0)-(T.outKg||0),S+=(T.inBales||0)-(T.outBales||0),{...T,isBulk:E,balanceKg:x,balanceUnits:S})}).filter(T=>!(l.startDate&&T.date<l.startDate||l.endDate&&T.date>l.endDate));return{filteredBulkHistory:C.filter(T=>T.isBulk).reverse(),filteredPressedHistory:C.filter(T=>!T.isBulk).reverse()}},[n,l.seaweedTypeId,l.startDate,l.endDate]),h=()=>{const m=d.map(x=>({date:x.date,designation:`${t(`pressedStockMovement_${x.type}`)}: ${x.designation}`,inKg:x.inKg,inBags:x.inBales,outKg:x.outKg,outBags:x.outBales,balanceKg:x.balanceKg,balanceBags:x.balanceUnits})).reverse(),f=u.map(x=>({date:x.date,designation:`${t(`pressedStockMovement_${x.type}`)}: ${x.designation}`,inKg:x.inKg,inBales:x.inBales,outKg:x.outKg,outBales:x.outBales,balanceKg:x.balanceKg,balanceBales:x.balanceUnits})).reverse(),v=[{sheetName:t("bulkSeaweed"),columns:[{header:t("date"),key:"date",width:15},{header:t("designation"),key:"designation",width:40},{header:"IN (Kg)",key:"inKg",width:15},{header:"IN (Bags)",key:"inBags",width:15},{header:"OUT (Kg)",key:"outKg",width:15},{header:"OUT (Bags)",key:"outBags",width:15},{header:"Balance (Kg)",key:"balanceKg",width:15},{header:"Balance (Bags)",key:"balanceBags",width:15}],data:m},{sheetName:t("pressedSeaweed"),columns:[{header:t("date"),key:"date",width:15},{header:t("designation"),key:"designation",width:40},{header:"IN (Kg)",key:"inKg",width:15},{header:"IN (Bales)",key:"inBales",width:15},{header:"OUT (Kg)",key:"outKg",width:15},{header:"OUT (Bales)",key:"outBales",width:15},{header:"Balance (Kg)",key:"balanceKg",width:15},{header:"Balance (Bales)",key:"balanceBales",width:15}],data:f}];av(v,`Warehouse_Movement_History_${new Date().toISOString().split("T")[0]}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 items-end",children:[e.jsxs(De,{label:t("seaweedType"),value:l.seaweedTypeId,onChange:m=>c(f=>({...f,seaweedTypeId:m.target.value})),children:[e.jsx("option",{value:"all",children:t("allSeaweedTypes")}),s.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]}),e.jsx(de,{label:t("startDate"),type:"date",value:l.startDate,onChange:m=>c(f=>({...f,startDate:m.target.value}))}),e.jsx(de,{label:t("endDate"),type:"date",value:l.endDate,onChange:m=>c(f=>({...f,endDate:m.target.value}))}),e.jsxs(se,{onClick:h,variant:"secondary",className:"h-[42px]",children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-5 h-5 mr-2"}),t("exportExcel")]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8",children:[e.jsx(Ge,{title:`${t("bulkSeaweed")} (${t("forPressing")})`,children:e.jsx("div",{className:"overflow-x-auto max-h-[60vh]",children:e.jsxs("table",{className:"w-full text-left text-xs border-collapse",children:[e.jsxs("thead",{className:"sticky top-0 bg-gray-50 dark:bg-gray-800 z-10 shadow-sm",children:[e.jsxs("tr",{className:"border-b border-gray-300 dark:border-gray-600",children:[e.jsx("th",{rowSpan:2,className:"p-2 border-r dark:border-gray-600",children:t("date")}),e.jsx("th",{rowSpan:2,className:"p-2 border-r dark:border-gray-600",style:{minWidth:"200px"},children:t("designation")}),e.jsx("th",{colSpan:2,className:"p-1 text-center border-b dark:border-gray-600",children:"IN"}),e.jsx("th",{colSpan:2,className:"p-1 text-center border-b dark:border-gray-600",children:"OUT"}),e.jsx("th",{colSpan:2,className:"p-1 text-center border-b dark:border-gray-600",children:t("balance")})]}),e.jsxs("tr",{className:"border-b border-gray-300 dark:border-gray-600",children:[e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("kg")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("bags")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("kg")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("bags")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("kg")}),e.jsx("th",{className:"p-2 text-center",children:t("bags")})]})]}),e.jsx("tbody",{children:d.map(m=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700/50",children:[e.jsx("td",{className:"p-2 whitespace-nowrap border-r dark:border-gray-700",children:m.date}),e.jsxs("td",{className:"p-2 border-r dark:border-gray-700",children:[t(`pressedStockMovement_${m.type}`),": ",m.designation]}),e.jsx("td",{className:"p-2 text-right border-r dark:border-gray-700 text-green-600",children:m.inKg?`+${Fe(m.inKg,r.localization)}`:""}),e.jsx("td",{className:"p-2 text-center border-r dark:border-gray-700 text-green-600",children:m.inBales?`+${m.inBales}`:""}),e.jsx("td",{className:"p-2 text-right border-r dark:border-gray-700 text-red-600",children:m.outKg?`-${Fe(m.outKg,r.localization)}`:""}),e.jsx("td",{className:"p-2 text-center border-r dark:border-gray-700 text-red-600",children:m.outBales?`-${m.outBales}`:""}),e.jsx("td",{className:"p-2 text-right border-r dark:border-gray-700 font-bold",children:Fe(m.balanceKg,r.localization)}),e.jsx("td",{className:"p-2 text-center font-bold",children:m.balanceUnits})]},m.id))})]})})}),e.jsx(Ge,{title:`${t("pressedSeaweed")} (${t("bales")})`,children:e.jsx("div",{className:"overflow-x-auto max-h-[60vh]",children:e.jsxs("table",{className:"w-full text-left text-xs border-collapse",children:[e.jsxs("thead",{className:"sticky top-0 bg-gray-50 dark:bg-gray-800 z-10 shadow-sm",children:[e.jsxs("tr",{className:"border-b border-gray-300 dark:border-gray-600",children:[e.jsx("th",{rowSpan:2,className:"p-2 border-r dark:border-gray-600",children:t("date")}),e.jsx("th",{rowSpan:2,className:"p-2 border-r dark:border-gray-600",style:{minWidth:"200px"},children:t("designation")}),e.jsx("th",{colSpan:2,className:"p-1 text-center border-b dark:border-gray-600",children:"IN"}),e.jsx("th",{colSpan:2,className:"p-1 text-center border-b dark:border-gray-600",children:"OUT"}),e.jsx("th",{colSpan:2,className:"p-1 text-center border-b dark:border-gray-600",children:t("balance")})]}),e.jsxs("tr",{className:"border-b border-gray-300 dark:border-gray-600",children:[e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("kg")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("baleSingular")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("kg")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("baleSingular")}),e.jsx("th",{className:"p-2 text-center border-r dark:border-gray-600",children:t("kg")}),e.jsx("th",{className:"p-2 text-center",children:t("baleSingular")})]})]}),e.jsx("tbody",{children:u.map(m=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700/50",children:[e.jsx("td",{className:"p-2 whitespace-nowrap border-r dark:border-gray-700",children:m.date}),e.jsxs("td",{className:"p-2 border-r dark:border-gray-700",children:[t(`pressedStockMovement_${m.type}`),": ",m.designation]}),e.jsx("td",{className:"p-2 text-right border-r dark:border-gray-700 text-green-600",children:m.inKg?`+${Fe(m.inKg,r.localization)}`:""}),e.jsx("td",{className:"p-2 text-center border-r dark:border-gray-700 text-green-600",children:m.inBales||""}),e.jsx("td",{className:"p-2 text-right border-r dark:border-gray-700 text-red-600",children:m.outKg?`-${Fe(m.outKg,r.localization)}`:""}),e.jsx("td",{className:"p-2 text-center border-r dark:border-gray-700 text-red-600",children:m.outBales?`-${m.outBales}`:""}),e.jsx("td",{className:"p-2 text-right border-r dark:border-gray-700 font-bold",children:Fe(m.balanceKg,r.localization)}),e.jsx("td",{className:"p-2 text-center font-bold",children:m.balanceUnits})]},m.id))})]})})})]})]})},xk=()=>{const{t}=je(),{deletePressingSlip:n}=qe(),[s,r]=N.useState("summary"),[l,c]=N.useState(!1),[d,u]=N.useState(null),[h,m]=N.useState(!1),[f,v]=N.useState(!1),[x,S]=N.useState(null),w=E=>{u(E),c(!0)},C=E=>{S(E),v(!0)},T=()=>{x&&!x.exportDocId&&n(x.id),v(!1),S(null)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("pressedWarehouseTitle")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(se,{variant:"secondary",onClick:()=>m(!0),children:[e.jsx(te,{name:"SlidersHorizontal",className:"w-5 h-5"}),t("recordStockAdjustment")]}),e.jsxs(se,{onClick:()=>w(null),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("recordPressingSlip")]})]})]}),e.jsxs(Ge,{children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:e.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[e.jsx("button",{onClick:()=>r("summary"),className:`py-2 px-4 text-sm font-medium ${s==="summary"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:t("summaryView")}),e.jsx("button",{onClick:()=>r("slips"),className:`py-2 px-4 text-sm font-medium ${s==="slips"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:t("pressingSlips")}),e.jsx("button",{onClick:()=>r("history"),className:`py-2 px-4 text-sm font-medium ${s==="history"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"}`,children:t("movementHistory")})]})}),s==="summary"&&e.jsx(pk,{}),s==="slips"&&e.jsx(hk,{onEdit:E=>w(E),onDelete:C}),s==="history"&&e.jsx(gk,{})]}),e.jsx(mk,{isOpen:l,onClose:()=>c(!1),slip:d}),e.jsx(fk,{isOpen:h,onClose:()=>m(!1)}),f&&e.jsx(Ut,{isOpen:f,onClose:()=>v(!1),onConfirm:T,title:t("confirmDeleteTitle"),message:x!=null&&x.exportDocId?t("confirmDeletePressingSlipLinked"):t("confirmDeletePressingSlip"),confirmDisabled:!!(x!=null&&x.exportDocId)})]})},yk=({isOpen:t,onClose:n,doc:s})=>{const{t:r}=je(),{seaweedTypes:l,pressingSlips:c,addExportDocument:d,updateExportDocument:u,pressedStockMovements:h}=qe(),m=N.useCallback(()=>{var P,F,q;return{docType:zu.COMMERCIAL_INVOICE,invoiceNo:"",date:new Date().toISOString().split("T")[0],seaweedTypeId:((P=l[0])==null?void 0:P.id)||"",nature:"",poNo:"",domiciliationNo:"",destinationCountry:"",city:"",notifyParty:"",debtor:"",vessel:"",seaWaybill:"",voyageNo:"",currency:"EUR",localExchangeRate:"",pressingSlipIds:[],containers:[],customsNomenclature:"12, 122, 100, 000",countryOfOrigin:((F=Vt.find(z=>z.code==="MG"))==null?void 0:F.code)||((q=Vt[0])==null?void 0:q.code)||"",incoterms:Dg[0]||"",paymentTerms:kg[0]||"",swiftBank:"",rexReference:""}},[l]),[f,v]=N.useState(m()),[x,S]=N.useState({});N.useEffect(()=>{v(s?{...m(),...s,localExchangeRate:String(s.localExchangeRate),containers:s.containers,rexReference:s.rexReference||""}:m())},[s,t,m]);const w=N.useMemo(()=>c.filter(P=>P.seaweedTypeId===f.seaweedTypeId&&(!P.exportDocId||P.exportDocId===(s==null?void 0:s.id))),[c,f.seaweedTypeId,s]),C=N.useMemo(()=>c.filter(P=>f.pressingSlipIds.includes(P.id)),[c,f.pressingSlipIds]),T=N.useMemo(()=>{const P=C.reduce((q,z)=>q+z.producedWeightKg,0),F=C.reduce((q,z)=>q+z.producedBalesCount,0);return{totalWeightKg:P,totalBales:F}},[C]),E=N.useMemo(()=>{const P=f.containers.reduce((q,z)=>q+Number(z.seaweedWeightKg||0),0),F=f.containers.reduce((q,z)=>q+Number(z.packagesCount||0),0);return{totalWeightKg:P,totalBales:F}},[f.containers]),R=N.useCallback(()=>{const P={};f.invoiceNo||(P.invoiceNo=r("validationRequired")),f.date||(P.date=r("validationRequired")),f.seaweedTypeId||(P.seaweedTypeId=r("validationRequired")),f.nature||(P.nature=r("validationRequired")),f.destinationCountry||(P.destinationCountry=r("validationRequired")),(!f.localExchangeRate||isNaN(parseFloat(f.localExchangeRate))||parseFloat(f.localExchangeRate)<=0)&&(P.localExchangeRate=r("validationPositiveNumber")),f.pressingSlipIds.length===0&&(P.pressingSlipIds=r("validationRequired")),f.containers.length===0&&(P.containers=r("validationRequired")),f.customsNomenclature||(P.customsNomenclature=r("validationRequired")),f.countryOfOrigin||(P.countryOfOrigin=r("validationRequired")),f.incoterms||(P.incoterms=r("validationRequired")),f.paymentTerms||(P.paymentTerms=r("validationRequired")),f.swiftBank||(P.swiftBank=r("validationRequired")),Math.abs(E.totalWeightKg-T.totalWeightKg)>.01&&(P.containers=r("validationContainerWeights")),E.totalBales!==T.totalBales&&(P.containers||(P.containers=r("validationContainerBales")));const F=f.containers.map(q=>{const z={};return q.containerNo||(z.containerNo=r("validationRequired")),q.sealNo||(z.sealNo=r("validationRequired")),z});return F.some(q=>Object.keys(q).length>0)&&(P.containerErrors=F),P},[f,r,E,T]);N.useEffect(()=>{S(R())},[f,R]);const _=(P,F)=>{const q={...f,[P]:F};P==="seaweedTypeId"&&(q.pressingSlipIds=[]),v(q)},D=P=>{const F=f.pressingSlipIds.includes(P)?f.pressingSlipIds.filter(q=>q!==P):[...f.pressingSlipIds,P];v(q=>({...q,pressingSlipIds:F}))},M=(P,F,q)=>{const z=[...f.containers],J={...z[P],[F]:q},W=Number(J.tareKg)||0,G=Number(J.seaweedWeightKg)||0,B=Number(J.packageWeightKg)||0;J.grossWeightKg=W+G+B;const X=Number(J.unitPrice)||0;J.value=G*X,z[P]=J,v($=>({...$,containers:z}))},I=()=>{const P={id:`new-container-${Date.now()}`,containerNo:"",sealNo:"",containerType:Hu.GP40,volumeM3:0,tareKg:0,packageWeightKg:0,seaweedWeightKg:0,packagesCount:0,grossWeightKg:0,unitPrice:0,value:0};v(F=>({...F,containers:[...F.containers,P]}))},O=P=>{v(F=>({...F,containers:F.containers.filter((q,z)=>z!==P)}))},A=P=>{P.preventDefault();const F=R();if(Object.keys(F).length>0){S(F);return}const q={...f,localExchangeRate:parseFloat(f.localExchangeRate),containers:f.containers.map(W=>({...W,volumeM3:Number(W.volumeM3)||0,tareKg:Number(W.tareKg)||0,packageWeightKg:Number(W.packageWeightKg)||0,seaweedWeightKg:Number(W.seaweedWeightKg)||0,packagesCount:Number(W.packagesCount)||0,grossWeightKg:Number(W.grossWeightKg)||0,unitPrice:Number(W.unitPrice)||0,value:Number(W.value)||0}))},z=c.find(W=>W.id===q.pressingSlipIds[0]);if(!z){alert(r("alert_noValidSlips"));return}let J=z.sourceSiteId;if(!J){const W=h.filter(G=>G.type===ut.BULK_IN_FROM_SITE&&G.seaweedTypeId===z.seaweedTypeId).sort((G,B)=>new Date(B.date).getTime()-new Date(G.date).getTime())[0];J=W==null?void 0:W.siteId}if(!J){console.error("Critical Error: Could not determine the origin site for the selected pressing slips.",z),alert(r("alert_cannotDetermineSourceSite"));return}s?u({...s,...q}):d(q,J),n()},U=Object.keys(x).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:r(s?"editExportDocument":"createExportDocument"),widthClass:"max-w-7xl",children:e.jsxs("form",{onSubmit:A,className:"flex flex-col max-h-[calc(90vh-130px)]",children:[e.jsxs("div",{className:"flex-grow overflow-y-auto pr-2 space-y-6",children:[e.jsx(Ge,{title:r("documentDetails"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(De,{label:r("docType"),value:f.docType,onChange:P=>_("docType",P.target.value),children:Object.values(zu).map(P=>e.jsx("option",{value:P,children:r(P)},P))}),e.jsx(de,{label:r("invoiceNo"),value:f.invoiceNo,onChange:P=>_("invoiceNo",P.target.value),error:x.invoiceNo}),e.jsx(de,{label:r("date"),type:"date",value:f.date,onChange:P=>_("date",P.target.value),error:x.date}),e.jsx(De,{label:r("seaweedType"),value:f.seaweedTypeId,onChange:P=>_("seaweedTypeId",P.target.value),error:x.seaweedTypeId,children:l.map(P=>e.jsx("option",{value:P.id,children:P.name},P.id))}),e.jsx(de,{containerClassName:"lg:col-span-2",label:r("natureLabel"),value:f.nature,onChange:P=>_("nature",P.target.value),error:x.nature}),e.jsx(de,{label:r("poNo"),value:f.poNo,onChange:P=>_("poNo",P.target.value)}),e.jsx(de,{label:r("domiciliationNo"),value:f.domiciliationNo,onChange:P=>_("domiciliationNo",P.target.value)}),e.jsx(de,{label:r("rexReference"),value:f.rexReference,onChange:P=>_("rexReference",P.target.value)}),e.jsx(de,{label:r("destinationCountry"),value:f.destinationCountry,onChange:P=>_("destinationCountry",P.target.value),error:x.destinationCountry}),e.jsx(de,{label:r("city"),value:f.city,onChange:P=>_("city",P.target.value)}),e.jsx(de,{label:r("notifyParty"),value:f.notifyParty,onChange:P=>_("notifyParty",P.target.value)}),e.jsx(de,{label:r("debtor"),value:f.debtor,onChange:P=>_("debtor",P.target.value)}),e.jsx(de,{label:r("vessel"),value:f.vessel,onChange:P=>_("vessel",P.target.value)}),e.jsx(de,{label:r("seaWaybill"),value:f.seaWaybill,onChange:P=>_("seaWaybill",P.target.value)}),e.jsx(de,{label:r("voyageNo"),value:f.voyageNo,onChange:P=>_("voyageNo",P.target.value)}),e.jsxs(De,{label:r("currency"),value:f.currency,onChange:P=>_("currency",P.target.value),children:[e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"USD",children:"USD"})]}),e.jsx(de,{label:r("localExchangeRate"),type:"number",step:"any",value:f.localExchangeRate,onChange:P=>_("localExchangeRate",P.target.value),error:x.localExchangeRate}),e.jsx(de,{label:r("customsNomenclature"),value:f.customsNomenclature,onChange:P=>_("customsNomenclature",P.target.value),error:x.customsNomenclature,containerClassName:"lg:col-span-2"}),e.jsx(De,{label:r("countryOfOrigin"),value:f.countryOfOrigin,onChange:P=>_("countryOfOrigin",P.target.value),error:x.countryOfOrigin,containerClassName:"lg:col-span-2",children:Vt.map(P=>e.jsx("option",{value:P.code,children:P.name},P.code))}),e.jsx(De,{label:r("incoterms"),value:f.incoterms,onChange:P=>_("incoterms",P.target.value),error:x.incoterms,containerClassName:"lg:col-span-2",children:Dg.map(P=>e.jsx("option",{value:P,children:r(P)},P))}),e.jsx(De,{label:r("paymentTerms"),value:f.paymentTerms,onChange:P=>_("paymentTerms",P.target.value),error:x.paymentTerms,containerClassName:"lg:col-span-2",children:kg.map(P=>e.jsx("option",{value:P,children:r(P)},P))}),e.jsx(de,{label:r("swiftBank"),value:f.swiftBank,onChange:P=>_("swiftBank",P.target.value),error:x.swiftBank,containerClassName:"lg:col-span-4"})]})}),e.jsxs(Ge,{title:r("selectPressingSlips"),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:r("availableSlips")}),e.jsxs("div",{className:"max-h-48 overflow-y-auto border rounded-md p-2 space-y-1",children:[w.filter(P=>!f.pressingSlipIds.includes(P.id)).map(P=>e.jsxs("div",{onClick:()=>D(P.id),className:"p-2 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/50 cursor-pointer flex justify-between",children:[e.jsxs("span",{children:[P.slipNo," (",P.producedBalesCount," ",r("bales"),")"]}),e.jsx(te,{name:"PlusCircle",className:"w-5 h-5 text-green-500"})]},P.id)),w.length===0&&e.jsx("p",{className:"text-sm text-gray-500 p-2",children:r("noSlipsAvailable")})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:r("selectedSlips")}),e.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-md p-2 space-y-1",children:C.map(P=>e.jsxs("div",{onClick:()=>D(P.id),className:"p-2 rounded-md bg-blue-50 dark:bg-blue-900/30 hover:bg-red-50 dark:hover:bg-red-900/30 cursor-pointer flex justify-between",children:[e.jsxs("span",{children:[P.slipNo," (",P.producedBalesCount," ",r("bales"),")"]}),e.jsx(te,{name:"X",className:"w-5 h-5 text-red-500"})]},P.id))})]})]}),x.pressingSlipIds&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:x.pressingSlipIds}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2 font-semibold",children:[e.jsxs("div",{children:[r("totalSelectedWeight"),": ",T.totalWeightKg.toFixed(2)," kg"]}),e.jsxs("div",{children:[r("totalSelectedBales"),": ",T.totalBales]})]})]}),e.jsxs(Ge,{title:r("containerManagement"),children:[e.jsx("div",{className:"space-y-4",children:f.containers.map((P,F)=>{var q,z,J,W;return e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg relative",children:[e.jsx(se,{type:"button",variant:"danger",onClick:()=>O(F),className:"absolute top-2 right-2 p-1 !rounded-full h-8 w-8",children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})}),e.jsxs("h5",{className:"font-semibold mb-3 text-lg",children:[r("container")," #",F+1]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-x-6 gap-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h6",{className:"font-semibold text-center text-gray-600 dark:text-gray-400",children:r("identification")}),e.jsx(de,{label:r("containerNo"),value:P.containerNo,onChange:G=>M(F,"containerNo",G.target.value),error:(z=(q=x.containerErrors)==null?void 0:q[F])==null?void 0:z.containerNo}),e.jsx(de,{label:r("sealNo"),value:P.sealNo,onChange:G=>M(F,"sealNo",G.target.value),error:(W=(J=x.containerErrors)==null?void 0:J[F])==null?void 0:W.sealNo}),e.jsx(De,{label:r("containerType"),value:P.containerType,onChange:G=>M(F,"containerType",G.target.value),children:Object.values(Hu).map(G=>e.jsx("option",{value:G,children:G},G))}),e.jsx(de,{label:r("volumeM3"),type:"number",value:P.volumeM3,onChange:G=>M(F,"volumeM3",G.target.value)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h6",{className:"font-semibold text-center text-gray-600 dark:text-gray-400",children:r("weights")}),e.jsx(de,{label:r("tareKg"),type:"number",value:P.tareKg,onChange:G=>M(F,"tareKg",G.target.value)}),e.jsx(de,{label:r("packageWeightKg"),type:"number",value:P.packageWeightKg||"",onChange:G=>M(F,"packageWeightKg",G.target.value)}),e.jsx(de,{label:r("seaweedWeightKg"),type:"number",value:P.seaweedWeightKg,onChange:G=>M(F,"seaweedWeightKg",G.target.value)}),e.jsx(de,{label:r("grossWeightKg"),type:"number",value:P.grossWeightKg,disabled:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h6",{className:"font-semibold text-center text-gray-600 dark:text-gray-400",children:r("contentsAndValue")}),e.jsx(de,{label:r("packagesCount"),type:"number",value:P.packagesCount,onChange:G=>M(F,"packagesCount",G.target.value)}),e.jsx(de,{label:r("unitPrice"),type:"number",step:"any",value:P.unitPrice,onChange:G=>M(F,"unitPrice",G.target.value)}),e.jsx(de,{label:r("value"),type:"number",value:P.value,disabled:!0})]})]})})]},P.id||F)})}),x.containers&&e.jsx("p",{className:"mt-2 text-xs text-red-600 dark:text-red-400",children:x.containers}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2 font-semibold",children:[e.jsxs("div",{children:[r("totalContainerWeight"),": ",E.totalWeightKg.toFixed(2)," kg"]}),e.jsxs("div",{children:[r("totalContainerBales"),": ",E.totalBales]})]}),e.jsxs(se,{type:"button",variant:"secondary",onClick:I,className:"mt-4",children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),r("addContainer")]})]})]}),e.jsxs("footer",{className:"flex-shrink-0 flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700 mt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:r("cancel")}),e.jsx(se,{type:"submit",disabled:U,children:r("save")})]})]})})},gs=({children:t,landscape:n=!1})=>n?e.jsx("div",{className:"print-page report-page-landscape bg-white shadow-lg mx-auto my-8 flex flex-col",children:t}):e.jsx("div",{className:"print-page bg-white shadow-lg mx-auto my-8",children:e.jsx("div",{className:"p-12 text-black font-serif",children:t})}),Da={units:["","one","two","three","four","five","six","seven","eight","nine"],teens:["ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],tens:["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],scales:["","thousand","million","billion","trillion"],and:"and",zero:"zero"},In={units:["zro","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],teens:["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],tens:["","dix","vingt","trente","quarante","cinquante","soixante","soixante-dix","quatre-vingt","quatre-vingt-dix"],scales:["","mille","million","milliard","billion"]},wy=t=>{if(t===0)return In.units[0];const n=d=>{if(d===0)return"";if(d<10)return In.units[d];if(d<20)return In.teens[d-10];const u=Math.floor(d/10),h=d%10;if(u===7||u===9)return`${In.tens[u-1]}-${In.teens[h]}`;let m=In.tens[u];return h>0?h===1&&u<8&&u>1?m+=" et un":m+=`-${In.units[h]}`:u===8&&(m+="s"),m},s=d=>{const u=Math.floor(d/100),h=d%100;let m="";return u>0&&(m=u>1?`${In.units[u]} cent`:"cent",h===0&&u>1&&(m+="s")),h>0&&(m+=(m?" ":"")+n(h)),m};let r=[],l=0;for(;t>0;){const d=t%1e3;if(d>0){let u=s(d);if(l>0){d===1&&l===1&&(u="");let h=In.scales[l];d>1&&l>1&&(h+="s"),r.unshift(h)}u&&r.unshift(u)}t=Math.floor(t/1e3),l++}let c=r.join(" ").trim();c=c.replace(/quatre-vingt(?!\S)/g,"quatre-vingts"),c=c.replace(/quatre-vingts-un/g,"quatre-vingt-un"),c=c.replace(/quatre-vingts-onze/g,"quatre-vingt-onze"),c=c.replace(/cent(?!\S)/g,"cents");for(let d=1;d<10;d++)c=c.replace(new RegExp(`cents ${In.units[d]}`,"g"),`cent ${In.units[d]}`),c=c.replace(new RegExp(`cents ${In.teens[d-1]}`,"g"),`cent ${In.teens[d-1]}`);for(let d=2;d<10;d++)c=c.replace(new RegExp(`cents ${In.tens[d]}`,"g"),`cent ${In.tens[d]}`);return c=c.replace(/cents et un/g,"cent et un"),c=c.replace(/cents mille/g,"cent mille"),c.replace("un mille","mille")},Cy=t=>{if(t===0)return Da.zero;const n=c=>{if(c===0)return"";if(c<10)return Da.units[c];if(c<20)return Da.teens[c-10];const d=Math.floor(c/10),u=c%10;return Da.tens[d]+(u>0?`-${Da.units[u]}`:"")},s=c=>{const d=Math.floor(c/100),u=c%100;let h="";return d>0&&(h=`${Da.units[d]} hundred`),u>0&&(h+=(h?` ${Da.and} `:"")+n(u)),h};let r=[],l=0;for(;t>0;){const c=t%1e3;c>0&&(r.unshift(Da.scales[l]),r.unshift(s(c))),t=Math.floor(t/1e3),l++}return r.filter(Boolean).join(" ").trim()},iv=(t,n="en",s)=>{const r=Math.floor(t),l=Math.round((t-r)*10**((s==null?void 0:s.monetaryDecimals)||2));let c;n==="fr"?c=wy(r):c=Cy(r);let d=c;if(s!=null&&s.currency&&(d+=` ${s.currency}`),l>0){let u;n==="fr"?u=wy(l):u=Cy(l),d+=` ${n==="fr"?"et":"and"} ${u} ${n==="fr"?"centimes":"cents"}`}return d&&(d=d.charAt(0).toUpperCase()+d.slice(1)),d},vk=({doc:t})=>{var v;const{settings:n}=$e(),{t:s,language:r}=je(),{seaweedTypes:l}=qe();l.find(x=>x.id===t.seaweedTypeId);const c=t.containers.reduce((x,S)=>x+S.packagesCount,0),d=t.containers.reduce((x,S)=>x+S.seaweedWeightKg,0),u=t.containers.reduce((x,S)=>x+S.value,0),h=t.currency==="EUR"?"":t.currency==="USD"?"$":t.currency,m=iv(u,r,{currency:t.currency,monetaryDecimals:2}),f=new Date(t.date).toLocaleDateString(r==="fr"?"fr-FR":"en-GB");return e.jsxs(gs,{children:[e.jsxs("header",{className:"flex justify-between items-start mb-8",children:[e.jsxs("div",{children:[e.jsx("img",{src:n.company.logoUrl,alt:"Company Logo",className:"h-20 mb-2"}),e.jsx("h1",{className:"font-bold text-lg",children:n.company.name}),e.jsx("p",{className:"text-xs",children:n.company.address}),e.jsxs("p",{className:"text-xs",children:["NIF: ",n.company.nif," / STAT: ",n.company.stat," / RC: ",n.company.rc]}),e.jsxs("p",{className:"text-xs",children:["Tel: ",n.company.phone]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("h2",{className:"text-3xl font-bold uppercase",children:[s("COMMERCIAL_INVOICE")," N ",t.invoiceNo]}),e.jsxs("div",{className:"mt-4 space-y-1",children:[t.rexReference&&e.jsxs("p",{children:[s("rexReference"),": ",t.rexReference]}),e.jsxs("p",{children:[s("domiciliationNo")," N ",t.domiciliationNo]}),e.jsxs("p",{children:[s("dateLabel")," ",f]})]})]})]}),e.jsxs("section",{className:"mb-8",children:[e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsxs("td",{className:"w-1/2 align-top pr-4",children:[e.jsx("p",{className:"font-bold uppercase text-gray-500 mb-1",children:s("debtor")}),e.jsxs("div",{className:"border p-2 min-h-[100px]",children:[e.jsx("p",{className:"font-bold text-base",children:t.debtor}),t.debtorAddress&&e.jsx("p",{className:"whitespace-pre-wrap",children:t.debtorAddress}),(t.debtorPhone||t.debtorEmail)&&e.jsxs("p",{className:"mt-2 text-xs text-gray-600",children:[t.debtorPhone&&e.jsxs("span",{children:["Tel: ",t.debtorPhone," "]}),t.debtorEmail&&e.jsxs("span",{children:["Email: ",t.debtorEmail]})]})]})]}),e.jsxs("td",{className:"w-1/2 align-top pl-4",children:[e.jsx("p",{className:"font-bold uppercase text-gray-500 mb-1",children:s("notifyParty")}),e.jsxs("div",{className:"border p-2 min-h-[100px]",children:[e.jsx("p",{className:"font-bold text-base",children:t.notifyParty}),t.notifyPartyAddress?e.jsx("p",{className:"whitespace-pre-wrap",children:t.notifyPartyAddress}):e.jsxs("p",{children:[t.city,", ",t.destinationCountry]}),(t.notifyPartyPhone||t.notifyPartyEmail)&&e.jsxs("p",{className:"mt-2 text-xs text-gray-600",children:[t.notifyPartyPhone&&e.jsxs("span",{children:["Tel: ",t.notifyPartyPhone," "]}),t.notifyPartyEmail&&e.jsxs("span",{children:["Email: ",t.notifyPartyEmail]})]})]})]})]})})}),e.jsxs("p",{className:"text-sm mt-4",children:[e.jsxs("span",{className:"font-bold",children:[s("orderRef"),":"]})," ",t.poNo]})]}),e.jsx("section",{children:e.jsxs("table",{className:"w-full border-collapse border border-black text-sm text-black",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-black p-1",children:s("description")}),e.jsx("th",{className:"border border-black p-1",children:s("packages")}),e.jsxs("th",{className:"border border-black p-1",children:[s("netWeight")," (Kg)"]}),e.jsxs("th",{className:"border border-black p-1",children:[s("unitPrice")," (",t.currency,")"]}),e.jsxs("th",{className:"border border-black p-1",children:[s("amount")," (",t.currency,")"]})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsxs("td",{className:"border border-black p-1 h-32 align-top",children:[e.jsx("p",{children:t.nature}),e.jsxs("p",{children:["Incoterm: ",t.incoterms]}),e.jsxs("p",{children:["HS Code: ",t.customsNomenclature]}),e.jsxs("p",{children:["Country of Origin: ",t.countryOfOrigin]})]}),e.jsx("td",{className:"border border-black p-1 align-top text-center",children:c}),e.jsx("td",{className:"border border-black p-1 align-top text-right",children:Fe(d,n.localization)}),e.jsx("td",{className:"border border-black p-1 align-top text-right",children:Ae(((v=t.containers[0])==null?void 0:v.unitPrice)||0,{...n.localization,currencySymbol:""})}),e.jsx("td",{className:"border border-black p-1 align-top text-right",children:Ae(u,{...n.localization,currencySymbol:""})})]})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{colSpan:3,className:"border border-black p-1",children:s("totalExclTax")}),e.jsx("td",{colSpan:2,className:"border border-black p-1 text-right",children:Ae(u,{...n.localization,currencySymbol:h})})]})})]})}),e.jsx("section",{className:"mt-4 text-sm",children:e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[s("amountInWords"),":"]})," ",m]})}),e.jsxs("section",{className:"mt-8 text-xs space-y-1",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[s("paymentTerms"),":"]})," ",t.paymentTerms]}),e.jsx("p",{children:e.jsxs("span",{className:"font-bold",children:[s("bankDetails"),":"]})}),e.jsx("p",{className:"pl-4",children:n.company.name}),e.jsxs("p",{className:"pl-4",children:["SWIFT: ",t.swiftBank]})]}),e.jsx("footer",{className:"mt-16 text-right",children:e.jsxs("div",{className:"inline-block text-center",children:[e.jsx("p",{className:"mb-12",children:s("theManager")}),e.jsx("hr",{className:"border-black"})]})})]})},bk=({doc:t})=>{var v;const{settings:n}=$e(),{t:s,language:r}=je(),{seaweedTypes:l}=qe(),c=l.find(x=>x.id===t.seaweedTypeId),d=t.containers.reduce((x,S)=>x+S.packagesCount,0),u=t.containers.reduce((x,S)=>x+S.seaweedWeightKg,0),h=t.containers.reduce((x,S)=>x+S.grossWeightKg,0),m=new Date(t.date).toLocaleDateString(r==="fr"?"fr-FR":"en-GB"),f=((v=Vt.find(x=>x.name.toLowerCase()===t.destinationCountry.toLowerCase()))==null?void 0:v.name)||t.destinationCountry;return e.jsxs(gs,{children:[e.jsxs("header",{className:"flex justify-between items-start mb-8",children:[e.jsxs("div",{children:[e.jsx("img",{src:n.company.logoUrl,alt:"Company Logo",className:"h-20 mb-2"}),e.jsx("h1",{className:"font-bold text-lg",children:n.company.name}),e.jsx("p",{className:"text-xs",children:n.company.address}),e.jsxs("p",{className:"text-xs",children:["NIF: ",n.company.nif," / STAT: ",n.company.stat," / RC: ",n.company.rc]}),e.jsxs("p",{className:"text-xs",children:["Tel: ",n.company.phone]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h2",{className:"text-2xl font-bold uppercase",children:s("packingAndWeightList")}),e.jsxs("p",{className:"mt-2",children:[s("invoiceNoLabel"),": ",t.invoiceNo]}),e.jsxs("p",{className:"mt-1",children:[s("dateLabel"),": ",m]})]})]}),e.jsxs("section",{className:"text-sm mb-8 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsxs("strong",{className:"col-span-1",children:[s("senderLabel"),":"]}),e.jsxs("span",{className:"col-span-4",children:[n.company.name," / PC ",t.debtor]})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsxs("strong",{className:"col-span-1",children:[s("recipientLabel"),":"]}),e.jsxs("div",{className:"col-span-4",children:[e.jsx("p",{children:t.notifyParty}),e.jsxs("p",{children:[t.city,", ",f]})]})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsxs("strong",{className:"col-span-1",children:[s("natureLabel"),":"]}),e.jsx("span",{className:"col-span-4",children:t.nature})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsxs("strong",{className:"col-span-1",children:[s("packageCountLabel"),":"]}),e.jsxs("span",{className:"col-span-4",children:[d," ",s("bales")]})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsxs("strong",{className:"col-span-1",children:[s("grossWeightLabel"),":"]}),e.jsxs("span",{className:"col-span-4",children:[Fe(h,n.localization)," Kg"]})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsxs("strong",{className:"col-span-1",children:[s("netWeightLabel"),":"]}),e.jsxs("span",{className:"col-span-4",children:[Fe(u,n.localization)," Kg"]})]})]}),e.jsxs("table",{className:"w-full border-collapse border border-black text-sm mb-8 text-black",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-black p-1",children:s("containerNo")}),e.jsx("th",{className:"border border-black p-1",children:s("sealNo")}),e.jsx("th",{className:"border border-black p-1",children:s("tareKg")}),e.jsx("th",{className:"border border-black p-1",children:s("packageWeightKg")}),e.jsx("th",{className:"border border-black p-1",children:s("seaweedType")}),e.jsx("th",{className:"border border-black p-1",children:s("netWeightLabel")}),e.jsx("th",{className:"border border-black p-1",children:s("packages")}),e.jsx("th",{className:"border border-black p-1",children:s("grossWeightLabel")})]})}),e.jsxs("tbody",{children:[t.containers.map(x=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1",children:x.containerNo}),e.jsx("td",{className:"border border-black p-1",children:x.sealNo}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[Fe(x.tareKg,n.localization)," Kg"]}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[Fe(x.packageWeightKg||0,n.localization)," Kg"]}),e.jsx("td",{className:"border border-black p-1",children:c==null?void 0:c.name}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[Fe(x.seaweedWeightKg,n.localization)," Kg"]}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[x.packagesCount," ",s("bales")]}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[Fe(x.grossWeightKg,n.localization)," Kg"]})]},x.id)),e.jsxs("tr",{className:"font-bold bg-gray-100",children:[e.jsx("td",{colSpan:5,className:"border border-black p-1"}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[Fe(u,n.localization)," Kg"]}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[d," ",s("bales")]}),e.jsxs("td",{className:"border border-black p-1 text-right",children:[Fe(h,n.localization)," Kg"]})]})]})]}),e.jsx("p",{className:"text-sm mb-16",children:s("customsWeighingStatement")}),e.jsx("p",{className:"text-sm mb-8 text-center",children:s("signedAtLocation").replace("{location}","Antsiranana").replace("{date}",m)}),e.jsx("footer",{className:"mt-16 text-right",children:e.jsxs("div",{className:"inline-block text-center",children:[e.jsx("p",{className:"mb-16",children:s("theManager")}),e.jsx("hr",{className:"border-black"}),e.jsxs("p",{className:"text-sm",children:[s("perProcurationem")," ",n.company.name]})]})})]})},Nk=({doc:t})=>{var h,m;const{settings:n}=$e(),{t:s}=je(),r=t.containers.reduce((f,v)=>f+v.packagesCount,0),l=t.containers.reduce((f,v)=>f+v.seaweedWeightKg,0),c=t.containers.reduce((f,v)=>f+v.grossWeightKg,0),d=((h=Vt.find(f=>f.code===t.countryOfOrigin))==null?void 0:h.name)||t.countryOfOrigin,u=((m=Vt.find(f=>f.name.toLowerCase()===t.destinationCountry.toLowerCase()))==null?void 0:m.name)||t.destinationCountry;return e.jsx(gs,{children:e.jsxs("div",{className:"border-2 border-black p-4",children:[e.jsx("header",{className:"text-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold uppercase",children:s("CERTIFICATE_OF_ORIGIN")})}),e.jsx("table",{className:"w-full border-collapse text-xs text-black",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border border-black w-1/2",children:[e.jsxs("p",{className:"font-bold",children:["1. ",s("exporter")]}),e.jsx("p",{className:"pl-4",children:n.company.name}),e.jsx("p",{className:"pl-4",children:n.company.address})]}),e.jsxs("td",{className:"p-2 border border-black w-1/2",rowSpan:2,children:[e.jsx("p",{className:"font-bold text-center",children:s("CERTIFICATE_OF_ORIGIN").toUpperCase()}),e.jsxs("p",{className:"text-center",children:[s("refNo")," ",t.docNo]})]})]}),e.jsx("tr",{children:e.jsxs("td",{className:"p-2 border border-black w-1/2",children:[e.jsxs("p",{className:"font-bold",children:["2. ",s("consignee")]}),e.jsx("p",{className:"pl-4 font-semibold",children:t.notifyParty}),t.notifyPartyAddress?e.jsx("p",{className:"pl-4 whitespace-pre-wrap",children:t.notifyPartyAddress}):e.jsxs("p",{className:"pl-4",children:[t.city,", ",u]}),(t.notifyPartyPhone||t.notifyPartyEmail)&&e.jsxs("p",{className:"pl-4 mt-1 text-xs",children:[t.notifyPartyPhone&&e.jsxs("span",{children:["Tel: ",t.notifyPartyPhone," "]}),t.notifyPartyEmail&&e.jsxs("span",{children:["Email: ",t.notifyPartyEmail]})]})]})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,className:"p-2 border border-black",children:[e.jsxs("p",{className:"font-bold",children:["3. ",s("transportDetails")]}),e.jsxs("p",{className:"pl-4",children:[s("vessel"),": ",t.vessel," / ",s("voyageNo"),": ",t.voyageNo]}),e.jsxs("p",{className:"pl-4",children:[s("seaWaybill"),": ",t.seaWaybill]})]})}),e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border border-black font-bold align-top",children:["4. ",s("marksAndNumbers")]}),e.jsxs("td",{className:"p-2 border border-black font-bold align-top",children:["5. ",s("packagesAndDescription")]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border border-black align-top h-24",children:t.containers.map(f=>e.jsx("p",{children:f.containerNo},f.id))}),e.jsxs("td",{className:"p-2 border border-black align-top h-24",children:[e.jsxs("p",{children:[r," ",s("bales")]}),e.jsx("p",{children:t.nature}),e.jsxs("p",{children:["HS Code: ",t.customsNomenclature]})]})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border border-black font-bold align-top",children:["6. ",s("originCriterion")]}),e.jsxs("td",{className:"p-2 border border-black font-bold align-top",children:["7. ",s("quantity")]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 border border-black align-top h-16",children:s("originCriterionA")}),e.jsxs("td",{className:"p-2 border border-black align-top h-16",children:[e.jsxs("p",{children:[s("netWeightLabel"),": ",Fe(l,n.localization)," KGS"]}),e.jsxs("p",{children:[s("grossWeightLabel"),": ",Fe(c,n.localization)," KGS"]})]})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border border-black font-bold align-top",children:["8. ",s("invoiceNumberAndDate")]}),e.jsxs("td",{className:"p-2 border border-black font-bold align-top",children:["9. ",s("remarks")]})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border border-black align-top h-12",children:[t.invoiceNo," / ",t.date]}),e.jsx("td",{className:"p-2 border border-black align-top h-12"})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"p-2 border border-black align-top h-32",children:[e.jsxs("p",{className:"font-bold",children:["10. ",s("declarationByExporter")]}),e.jsx("p",{className:"mt-1",children:s("exporterDeclarationText")}),e.jsx("p",{className:"font-bold text-center mt-2",children:d}),e.jsx("div",{className:"mt-8 text-right",children:e.jsx("p",{className:"border-t border-black pt-1 inline-block",children:s("placeDateSignature")})})]}),e.jsxs("td",{className:"p-2 border border-black align-top h-32",children:[e.jsxs("p",{className:"font-bold",children:["11. ",s("certification")]}),e.jsx("p",{className:"mt-1",children:s("certificationText")}),e.jsx("div",{className:"mt-16 text-right",children:e.jsx("p",{className:"border-t border-black pt-1 inline-block",children:s("placeDateSignature")})})]})]})]})})]})})},Sk=({isOpen:t,onClose:n,doc:s,docTypeToShow:r})=>{const{t:l}=je(),{settings:c}=$e(),[d,u]=N.useState(!1),h=()=>{switch(r){case"invoice":return`${l("printInvoice")} - ${s.docNo}`;case"packing-list":return`${l("printPackingList")} - ${s.docNo}`;case"cert-of-origin":return`${l("printCertOfOrigin")} - ${s.docNo}`;case"all":default:return`${l("printDocumentsFor")} ${s.docNo}`}},m=()=>{window.print()},f=async()=>{u(!0),document.body.classList.add("generating-pdf");try{const{jsPDF:v}=window.jspdf,x=window.html2canvas,S=document.getElementById("printable-area");if(!S)throw new Error("Printable area not found");const w=new v({orientation:"p",unit:"mm",format:"a4",compress:!0});w.setProperties({title:`Export Documents - ${s.docNo}`,subject:"Export Documentation",author:c.company.name,creator:"AlgaManage"});const C=S.getElementsByClassName("print-page");for(let T=0;T<C.length;T++){const R=(await x(C[T],{scale:4,useCORS:!0,windowWidth:1200,backgroundColor:"#ffffff"})).toDataURL("image/png");T>0&&w.addPage();const _=w.getImageProperties(R),D=w.internal.pageSize.getWidth(),M=_.height*D/_.width;w.addImage(R,"PNG",0,0,D,M,void 0,"FAST")}w.save(`Export-Documents-${s.docNo}.pdf`)}catch(v){console.error("Error generating PDF:",v),alert(l("pdfGenerationError"))}finally{document.body.classList.remove("generating-pdf"),u(!1)}};return e.jsxs(at,{isOpen:t,onClose:n,title:h(),widthClass:"max-w-screen-lg",children:[e.jsx("div",{className:"fixed bottom-6 right-6 z-[1100] no-print flex gap-3",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-full shadow-xl border border-gray-200 dark:border-gray-700 flex gap-2 animate-in fade-in slide-in-from-bottom-4",children:[e.jsxs(se,{onClick:f,disabled:d,className:"rounded-full !px-4 shadow-sm",children:[e.jsx(te,{name:d?"Activity":"Download",className:`w-5 h-5 ${d?"animate-spin":""}`}),e.jsx("span",{className:"ml-2",children:l(d?"downloading":"downloadPdf")})]}),e.jsxs(se,{onClick:m,variant:"primary",className:"rounded-full !px-4 shadow-md",children:[e.jsx(te,{name:"Printer",className:"w-5 h-5"}),e.jsx("span",{className:"ml-2",children:l("print")})]})]})}),e.jsxs("div",{id:"printable-area",className:"bg-gray-200 dark:bg-gray-700 p-4 sm:p-8",children:[(r==="invoice"||r==="all")&&e.jsx(vk,{doc:s}),(r==="packing-list"||r==="all")&&e.jsx(bk,{doc:s}),(r==="cert-of-origin"||r==="all")&&e.jsx(Nk,{doc:s})]})]})},jk=()=>{const{t}=je(),{settings:n}=$e(),{exportDocuments:s,seaweedTypes:r,deleteExportDocument:l}=qe(),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,f]=N.useState(!1),[v,x]=N.useState(null),[S,w]=N.useState({key:"date",direction:"descending"}),[C,T]=N.useState(!1),[E,R]=N.useState(null),[_,D]=N.useState("all"),[M,I]=N.useState(null),O=N.useRef(null),A=N.useMemo(()=>new Map(r.map(X=>[X.id,X.name])),[r]),U=N.useMemo(()=>{let X=s.map($=>({...$,totalValue:$.containers.reduce((ae,H)=>ae+H.value,0)}));return X.sort(($,ae)=>{let H,ie;switch(S.key){case"seaweedTypeName":H=A.get($.seaweedTypeId)||"",ie=A.get(ae.seaweedTypeId)||"";break;case"totalValue":H=$.totalValue,ie=ae.totalValue;break;default:H=$[S.key],ie=ae[S.key]}return H==null?1:ie==null?-1:H<ie?S.direction==="ascending"?-1:1:H>ie?S.direction==="ascending"?1:-1:0}),X},[s,S,A]);N.useEffect(()=>{const X=$=>{O.current&&!O.current.contains($.target)&&I(null)};return document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X)}},[]);const P=X=>{let $="ascending";S.key===X&&S.direction==="ascending"&&($="descending"),w({key:X,direction:$})},F=X=>S.key!==X?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):S.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),q=({sortKey:X,label:$,className:ae})=>e.jsx("th",{className:`p-3 ${ae}`,children:e.jsxs("button",{onClick:()=>P(X),className:`group flex items-center gap-2 w-full ${ae!=null&&ae.includes("text-right")?"justify-end":""}`,children:[$,F(X)]})}),z=(X=null)=>{h(X),d(!0)},J=()=>{h(null),d(!1)},W=X=>{x(X),f(!0)},G=()=>{v&&l(v),f(!1),x(null)},B=(X,$)=>{R(X),D($),T(!0),I(null)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:t("exports")}),e.jsxs(se,{onClick:()=>z(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("createExportDocument")]})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(q,{sortKey:"docNo",label:t("docNo")}),e.jsx(q,{sortKey:"date",label:t("date")}),e.jsx(q,{sortKey:"invoiceNo",label:t("invoiceNo")}),e.jsx(q,{sortKey:"seaweedTypeName",label:t("seaweedType")}),e.jsx(q,{sortKey:"destinationCountry",label:t("destination")}),e.jsx("th",{className:"p-3 text-center",children:t("containers")}),e.jsx(q,{sortKey:"totalValue",label:t("totalValue"),className:"text-right"}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[U.map(X=>{const $=X.currency==="EUR"?"":X.currency==="USD"?"$":X.currency;return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3 font-mono",children:X.docNo}),e.jsx("td",{className:"p-3",children:X.date}),e.jsx("td",{className:"p-3",children:X.invoiceNo}),e.jsx("td",{className:"p-3",children:A.get(X.seaweedTypeId)||X.seaweedTypeId}),e.jsx("td",{className:"p-3",children:X.destinationCountry}),e.jsx("td",{className:"p-3 text-center",children:X.containers.length}),e.jsx("td",{className:"p-3 text-right",children:Ae(X.totalValue,{...n.localization,currencySymbol:$})}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"relative flex justify-end gap-1",ref:M===X.id?O:null,children:[e.jsxs(se,{variant:"ghost",onClick:()=>I(M===X.id?null:X.id),children:[t("documents"),e.jsx(te,{name:"ChevronDown",className:"w-4 h-4"})]}),M===X.id&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-md shadow-lg z-10 p-1",children:[e.jsxs("button",{onClick:()=>B(X,"invoice"),className:"w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md flex items-center gap-2",children:[e.jsx(te,{name:"FileText",className:"w-4 h-4"})," ",t("printInvoice")]}),e.jsxs("button",{onClick:()=>B(X,"packing-list"),className:"w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md flex items-center gap-2",children:[e.jsx(te,{name:"Package",className:"w-4 h-4"})," ",t("printPackingList")]}),e.jsxs("button",{onClick:()=>B(X,"cert-of-origin"),className:"w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md flex items-center gap-2",children:[e.jsx(te,{name:"Globe",className:"w-4 h-4"})," ",t("printCertOfOrigin")]}),e.jsx("div",{className:"my-1 border-t dark:border-gray-600"}),e.jsxs("button",{onClick:()=>B(X,"all"),className:"w-full text-left px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md flex items-center gap-2",children:[e.jsx(te,{name:"Printer",className:"w-4 h-4"})," ",t("printAllDocuments")]})]}),e.jsx(se,{variant:"ghost",onClick:()=>z(X),children:e.jsx(te,{name:"Settings",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",onClick:()=>W(X.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]},X.id)}),U.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"p-6 text-center text-gray-500",children:t("noDataForReport")})})]})]})})}),c&&e.jsx(yk,{isOpen:c,onClose:J,doc:u}),C&&E&&e.jsx(Sk,{isOpen:C,onClose:()=>T(!1),doc:E,docTypeToShow:_}),m&&e.jsx(Ut,{isOpen:m,onClose:()=>f(!1),onConfirm:G,title:t("confirmDeleteTitle"),message:t("confirmDeleteExport")})]})},Tk=()=>{const{t}=je(),{serviceProviders:n,addServiceProvider:s,updateServiceProvider:r,deleteServiceProvider:l}=qe(),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,f]=N.useState(!1),[v,x]=N.useState(null),[S,w]=N.useState({key:"name",direction:"ascending"}),C=N.useMemo(()=>{let O=[...n];return O.sort((A,U)=>{const P=A[S.key]||"",F=U[S.key]||"";return P<F?S.direction==="ascending"?-1:1:P>F?S.direction==="ascending"?1:-1:0}),O},[n,S]),T=O=>{let A="ascending";S.key===O&&S.direction==="ascending"&&(A="descending"),w({key:O,direction:A})},E=O=>S.key!==O?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400"}):S.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),R=({sortKey:O,label:A,className:U})=>e.jsx("th",{className:`p-3 ${U}`,children:e.jsxs("button",{onClick:()=>T(O),className:`group flex items-center gap-2 w-full ${U!=null&&U.includes("text-right")?"justify-end":""}`,children:[A,E(O)]})}),_=(O=null)=>{h(O),d(!0)},D=()=>{h(null),d(!1)},M=O=>{x(O),f(!0)},I=()=>{v&&l(v),f(!1),x(null)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("serviceProvidersTitle")}),e.jsxs(se,{onClick:()=>_(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("addProvider")]})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(R,{sortKey:"name",label:t("name")}),e.jsx(R,{sortKey:"serviceType",label:t("serviceType")}),e.jsx(R,{sortKey:"contactPerson",label:t("contactPerson")}),e.jsx(R,{sortKey:"phone",label:t("phone")}),e.jsx(R,{sortKey:"email",label:t("email")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[C.map(O=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3 font-semibold",children:O.name}),e.jsx("td",{className:"p-3",children:O.serviceType}),e.jsx("td",{className:"p-3",children:O.contactPerson||"-"}),e.jsx("td",{className:"p-3",children:O.phone}),e.jsx("td",{className:"p-3",children:O.email||"-"}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(se,{variant:"ghost",onClick:()=>_(O),children:[e.jsx(te,{name:"Settings",className:"w-4 h-4"}),t("edit")]}),e.jsx(se,{variant:"danger",onClick:()=>M(O.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]},O.id)),C.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-6 text-center text-gray-500",children:t("noProviders")})})]})]})})}),c&&e.jsx(wk,{isOpen:c,onClose:D,provider:u,onSave:O=>{u?r({...u,...O}):s(O),D()}}),m&&e.jsx(Ut,{isOpen:m,onClose:()=>f(!1),onConfirm:I,title:t("confirmDeleteTitle"),message:t("confirmDeleteProvider")})]})},wk=({isOpen:t,onClose:n,provider:s,onSave:r})=>{const{t:l}=je(),[c,d]=N.useState({name:"",serviceType:"",contactPerson:"",phone:"",email:"",address:"",joinDate:new Date().toISOString().split("T")[0]}),[u,h]=N.useState({});N.useEffect(()=>{d(s?{name:s.name,serviceType:s.serviceType,contactPerson:s.contactPerson||"",phone:s.phone,email:s.email||"",address:s.address||"",joinDate:s.joinDate||new Date().toISOString().split("T")[0]}:{name:"",serviceType:"",contactPerson:"",phone:"",email:"",address:"",joinDate:new Date().toISOString().split("T")[0]})},[s,t]);const m=N.useCallback(()=>{const S={};return c.name.trim()||(S.name=l("validationRequired")),c.serviceType.trim()||(S.serviceType=l("validationRequired")),c.phone.trim()||(S.phone=l("validationRequired")),c.email&&!/\S+@\S+\.\S+/.test(c.email)&&(S.email=l("validationEmail")),S},[c,l]);N.useEffect(()=>{h(m())},[c,m]);const f=(S,w)=>{d(C=>({...C,[S]:w}))},v=S=>{S.preventDefault();const w=m();if(Object.keys(w).length>0){h(w);return}r({...c,status:(s==null?void 0:s.status)||vm.ACTIVE,contactPerson:c.contactPerson||void 0,email:c.email||void 0,address:c.address||void 0})},x=Object.keys(u).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l(s?"editProvider":"addProvider"),widthClass:"max-w-3xl",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{onClick:v,disabled:x,children:l("save")})]}),children:e.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:l("name"),value:c.name,onChange:S=>f("name",S.target.value),error:u.name,required:!0,autoFocus:!0}),e.jsx(de,{label:l("serviceType"),value:c.serviceType,onChange:S=>f("serviceType",S.target.value),error:u.serviceType,required:!0}),e.jsx(de,{label:`${l("contactPerson")} (${l("optional")})`,value:c.contactPerson,onChange:S=>f("contactPerson",S.target.value)}),e.jsx(de,{label:l("phone"),value:c.phone,onChange:S=>f("phone",S.target.value),error:u.phone,required:!0}),e.jsx(de,{label:`${l("email")} (${l("optional")})`,type:"email",value:c.email,onChange:S=>f("email",S.target.value),error:u.email}),e.jsx(de,{label:l("hireDate"),type:"date",value:c.joinDate,onChange:S=>f("joinDate",S.target.value),required:!0}),e.jsx(de,{containerClassName:"md:col-span-2",label:`${l("address")} (${l("optional")})`,value:c.address,onChange:S=>f("address",S.target.value)})]})})},Ck=({weights:t,onChange:n})=>{const{t:s}=je(),[r,l]=N.useState([]);N.useEffect(()=>{const d=[...t.map(String)],h=Math.max(1,Math.ceil((d.length+1)/10))*10;for(;d.length<h;)d.push("");l(d)},[t.length]);const c=(d,u)=>{const h=[...r];if(h[d]=u,d===h.length-1&&u.trim()!=="")for(let f=0;f<10;f++)h.push("");l(h);const m=h.map(f=>parseFloat(f)).filter(f=>!isNaN(f)&&f>0);n(m)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:s("bagWeights")}),e.jsx("div",{className:"grid grid-cols-5 gap-2 max-h-60 overflow-y-auto p-2 border rounded-md dark:border-gray-600 bg-gray-50 dark:bg-gray-800",children:r.map((d,u)=>e.jsx(de,{type:"number",step:"any",placeholder:`${s("sac")} ${u+1}`,value:d,onChange:h=>c(u,h.target.value),className:"text-center"},u))})]})},Ek=({isOpen:t,onClose:n})=>{const{t:s}=je(),{settings:r}=$e(),{sites:l,farmers:c,seaweedTypes:d,addFarmerDelivery:u,getFarmersBySite:h,stockMovements:m}=qe(),[f,v]=N.useState({date:new Date().toISOString().split("T")[0],siteId:"",farmerId:"",seaweedTypeId:"",destination:"PRESSING_WAREHOUSE_BULK"}),[x,S]=N.useState([]),[w,C]=N.useState([]),[T,E]=N.useState({});N.useEffect(()=>{var U,P;if(t){const F=((U=l.find(q=>q.id!=="pressing-warehouse"))==null?void 0:U.id)||"";v({date:new Date().toISOString().split("T")[0],siteId:F,farmerId:"",seaweedTypeId:((P=d[0])==null?void 0:P.id)||"",destination:"PRESSING_WAREHOUSE_BULK"}),S([]),C(h(F)),E({})}},[t,l,d,h]);const R=N.useMemo(()=>({totalWeightKg:x.reduce((U,P)=>U+P,0),totalBags:x.length}),[x]),_=N.useMemo(()=>{if(!f.siteId||!f.seaweedTypeId)return{kg:0,bags:0};const U=m.filter(J=>J.siteId===f.siteId&&J.seaweedTypeId===f.seaweedTypeId),P=U.reduce((J,W)=>J+(W.inKg||0),0),F=U.reduce((J,W)=>J+(W.outKg||0),0),q=U.reduce((J,W)=>J+(W.inBags||0),0),z=U.reduce((J,W)=>J+(W.outBags||0),0);return{kg:P-F,bags:q-z}},[f.siteId,f.seaweedTypeId,m]),D=N.useCallback(()=>{const U={};return f.date||(U.date=s("validationRequired")),f.siteId||(U.siteId=s("validationRequired")),f.farmerId||(U.farmerId=s("validationRequired")),f.seaweedTypeId||(U.seaweedTypeId=s("validationRequired")),R.totalWeightKg<=0&&(U.bagWeights=s("validationAtLeastOneRequired")),U},[f,R,s]);N.useEffect(()=>{E(D())},[f,R,D]);const M=(U,P)=>{v(F=>({...F,[U]:P}))},I=U=>{v(P=>({...P,siteId:U,farmerId:""})),C(h(U))},O=U=>{U.preventDefault();const P=D();if(Object.keys(P).length>0){E(P);return}u({...f,totalWeightKg:R.totalWeightKg,totalBags:R.totalBags,bagWeights:x}),n()},A=Object.keys(T).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:s("newDelivery"),widthClass:"max-w-4xl",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:s("cancel")}),e.jsx(se,{onClick:O,disabled:A,children:s("receivedAtWarehouse")})]}),children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:s("date"),type:"date",value:f.date,onChange:U=>M("date",U.target.value),error:T.date,required:!0}),e.jsxs(De,{label:s("site"),value:f.siteId,onChange:U=>I(U.target.value),error:T.siteId,required:!0,children:[e.jsx("option",{value:"",children:s("selectSite")}),l.filter(U=>U.id!=="pressing-warehouse").map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]}),e.jsxs(De,{label:s("farmerLabel"),value:f.farmerId,onChange:U=>M("farmerId",U.target.value),error:T.farmerId,disabled:!f.siteId,required:!0,children:[e.jsx("option",{value:"",children:s("selectFarmer")}),w.map(U=>e.jsxs("option",{value:U.id,children:[U.firstName," ",U.lastName]},U.id))]}),e.jsxs(De,{label:s("seaweedType"),value:f.seaweedTypeId,onChange:U=>M("seaweedTypeId",U.target.value),error:T.seaweedTypeId,required:!0,children:[e.jsx("option",{value:"",children:s("selectType")}),d.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]}),e.jsxs(De,{containerClassName:"md:col-span-2",label:s("destination"),value:f.destination,onChange:U=>M("destination",U.target.value),children:[e.jsx("option",{value:"PRESSING_WAREHOUSE_BULK",children:s("pressedWarehouseTitle")}),e.jsx("option",{value:"SITE_STORAGE",children:s("onSiteStorageTitle")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-900/50 rounded-lg",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:[s("currentStock")," (",s("kg"),")"]}),e.jsx("p",{className:"text-xl font-bold",children:Fe(_.kg,r.localization)})]}),e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-900/50 rounded-lg",children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s("stockBags")}),e.jsx("p",{className:"text-xl font-bold",children:Fe(_.bags,{...r.localization,nonMonetaryDecimals:0})})]})]}),e.jsx(Ck,{weights:x,onChange:S}),T.bagWeights&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:T.bagWeights}),e.jsx("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[e.jsxs("span",{children:[s("totalWeightKgDelivery"),":"]}),e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:[R.totalWeightKg.toFixed(2)," kg ",e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",R.totalBags," ",s("bags"),")"]})]})]})})]})})},Ik=()=>{const{t}=je(),{settings:n}=$e(),{farmerDeliveries:s,sites:r,farmers:l,seaweedTypes:c,deleteFarmerDelivery:d}=qe(),[u,h]=N.useState(!1),[m,f]=N.useState(!1),[v,x]=N.useState(null),[S,w]=N.useState({key:"date",direction:"descending"}),C=N.useMemo(()=>new Map(r.map(A=>[A.id,A.name])),[r]),T=N.useMemo(()=>new Map(l.map(A=>[A.id,`${A.firstName} ${A.lastName}`])),[l]),E=N.useMemo(()=>new Map(c.map(A=>[A.id,A.name])),[c]),R=N.useMemo(()=>{let A=[...s];return A.sort((U,P)=>{let F,q;return S.key==="siteName"?F=C.get(U.siteId)||"":S.key==="farmerName"?F=T.get(U.farmerId)||"":S.key==="seaweedTypeName"?F=E.get(U.seaweedTypeId)||"":F=U[S.key],S.key==="siteName"?q=C.get(P.siteId)||"":S.key==="farmerName"?q=T.get(P.farmerId)||"":S.key==="seaweedTypeName"?q=E.get(P.seaweedTypeId)||"":q=P[S.key],F==null?1:q==null?-1:F<q?S.direction==="ascending"?-1:1:F>q?S.direction==="ascending"?1:-1:0}),A},[s,S,C,T,E]),_=A=>{let U="ascending";S.key===A&&S.direction==="ascending"&&(U="descending"),w({key:A,direction:U})},D=A=>S.key!==A?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):S.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),M=({sortKey:A,label:U,className:P})=>e.jsx("th",{className:`p-3 ${P}`,children:e.jsxs("button",{onClick:()=>_(A),className:`group flex items-center gap-2 w-full ${P!=null&&P.includes("text-right")?"justify-end":""}`,children:[U,D(A)]})}),I=A=>{x(A),f(!0)},O=()=>{v&&d(v),f(!1),x(null)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("farmerDeliveriesTitle")}),e.jsxs(se,{onClick:()=>h(!0),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("recordDelivery")]})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(M,{sortKey:"slipNo",label:t("slipNo")}),e.jsx(M,{sortKey:"date",label:t("date")}),e.jsx(M,{sortKey:"siteName",label:t("site")}),e.jsx(M,{sortKey:"farmerName",label:t("farmerLabel")}),e.jsx(M,{sortKey:"seaweedTypeName",label:t("seaweedType")}),e.jsx(M,{sortKey:"totalWeightKg",label:t("totalWeightKgDelivery"),className:"text-right"}),e.jsx(M,{sortKey:"totalBags",label:t("totalBags"),className:"text-right"}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[R.map(A=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3 font-mono",children:A.slipNo}),e.jsx("td",{className:"p-3",children:A.date}),e.jsx("td",{className:"p-3",children:C.get(A.siteId)||t("unknown")}),e.jsx("td",{className:"p-3",children:T.get(A.farmerId)||t("unknown")}),e.jsx("td",{className:"p-3",children:E.get(A.seaweedTypeId)||t("unknown")}),e.jsx("td",{className:"p-3 text-right",children:Fe(A.totalWeightKg,n.localization)}),e.jsx("td",{className:"p-3 text-right",children:A.totalBags}),e.jsx("td",{className:"p-3 text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(se,{variant:"danger",onClick:()=>I(A.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})})})]},A.id)),R.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"p-6 text-center text-gray-500",children:t("noDeliveriesRecorded")})})]})]})})}),u&&e.jsx(Ek,{isOpen:u,onClose:()=>h(!1)}),m&&e.jsx(Ut,{isOpen:m,onClose:()=>f(!1),onConfirm:O,title:t("confirmDeleteTitle"),message:t("confirmDeleteDelivery")})]})},_k=()=>{const{t}=je(),{settings:n}=$e(),{cuttingOperations:s,sites:r,serviceProviders:l,modules:c,farmers:d,deleteCuttingOperation:u}=qe(),[h,m]=N.useState(!1),[f,v]=N.useState(null),[x,S]=N.useState(!1),[w,C]=N.useState(null),[T,E]=N.useState({key:"date",direction:"descending"}),R=N.useMemo(()=>new Map(r.map(W=>[W.id,W.name])),[r]),_=N.useMemo(()=>new Map(l.map(W=>[W.id,W.name])),[l]),D=N.useMemo(()=>new Map(d.map(W=>[W.id,`${W.firstName} ${W.lastName}`])),[d]),M=N.useMemo(()=>{const W=new Map;return c.forEach(G=>{const B=G.farmerId?D.get(G.farmerId):void 0;W.set(G.id,{code:G.code,farmerName:B})}),W},[c,D]),I=N.useMemo(()=>{let W=[...s];return W.sort((G,B)=>{let X,$;return T.key==="siteName"?(X=R.get(G.siteId)||"",$=R.get(B.siteId)||""):T.key==="providerName"?(X=_.get(G.serviceProviderId)||"",$=_.get(B.serviceProviderId)||""):(X=G[T.key],$=B[T.key]),X<$?T.direction==="ascending"?-1:1:X>$?T.direction==="ascending"?1:-1:0}),W},[s,T,R,_]),O=W=>{let G="ascending";T.key===W&&T.direction==="ascending"&&(G="descending"),E({key:W,direction:G})},A=W=>T.key!==W?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):T.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),U=({sortKey:W,label:G,className:B})=>e.jsx("th",{className:`p-3 ${B}`,children:e.jsxs("button",{onClick:()=>O(W),className:`group flex items-center gap-2 hover:text-blue-500 dark:hover:text-blue-400 transition-colors w-full ${B!=null&&B.includes("text-right")?"justify-end":""} ${B!=null&&B.includes("text-center")?"justify-center":""}`,children:[G,A(W)]})}),P=W=>{v(W),m(!0)},F=()=>{v(null),m(!0)},q=()=>{v(null),m(!1)},z=W=>{C(W),S(!0)},J=()=>{w&&u(w),S(!1),C(null)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:t("cuttingOperationsTitle")}),e.jsxs(se,{onClick:F,children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("newPlanting")]})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(U,{sortKey:"date",label:t("date")}),e.jsx(U,{sortKey:"siteName",label:t("site")}),e.jsx(U,{sortKey:"providerName",label:t("serviceProvider")}),e.jsx("th",{className:"p-3",children:t("beneficiaryFarmers")}),e.jsx("th",{className:"p-3",children:t("modules")}),e.jsx(U,{sortKey:"totalAmount",label:t("totalAmount"),className:"text-right"}),e.jsx(U,{sortKey:"isPaid",label:t("status"),className:"text-center"}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsx("tbody",{children:I.map(W=>{const G=(()=>{if(W.beneficiaryFarmerId){const ae=D.get(W.beneficiaryFarmerId);return ae?[ae]:[]}const $=W.moduleCuts.map(ae=>ae.moduleId).map(ae=>{var H;return(H=c.find(ie=>ie.id===ae))==null?void 0:H.farmerId}).filter(ae=>!!ae);return[...new Set($)].map(ae=>D.get(ae)).filter(ae=>!!ae)})(),B=W.moduleCuts.map(X=>{const $=M.get(X.moduleId);return $?`${$.code} (${X.linesCut} l.)`:e.jsxs("span",{className:"font-mono text-[10px] text-gray-500",children:[t("unknown")," (ID: ",X.moduleId.substring(0,6),")"]})});return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"p-3",children:W.date}),e.jsx("td",{className:"p-3",title:W.siteId,children:R.get(W.siteId)||t("unknown")}),e.jsx("td",{className:"p-3",title:W.serviceProviderId,children:_.get(W.serviceProviderId)||t("unknown")}),e.jsx("td",{className:"p-3",children:G.length>0?e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"truncate",children:G[0]}),G.length>1&&e.jsxs("span",{className:"ml-1 text-xs bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full",children:["+",G.length-1]}),e.jsx("div",{className:"absolute bottom-full mb-2 w-max max-w-xs opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none z-10 p-2 text-sm text-white bg-gray-900 dark:bg-black rounded-lg shadow-lg",children:G.join(", ")})]}):e.jsx("span",{className:"text-gray-500 italic",children:t("noBeneficiary")})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex flex-wrap gap-1 items-center",children:[B.slice(0,3).map((X,$)=>e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded-full whitespace-nowrap flex items-center",children:X},$)),B.length>3&&e.jsx("div",{className:"relative group",children:e.jsx("span",{className:"text-xs bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded-full cursor-pointer",children:"..."})})]})}),e.jsx("td",{className:"p-3 text-right",children:Ae(W.totalAmount,n.localization)}),e.jsx("td",{className:"p-3 text-center",children:W.isPaid?e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",children:t("paid")}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",children:t("unpaid")})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(se,{variant:"ghost",onClick:()=>P(W),children:[e.jsx(te,{name:"Settings",className:"w-4 h-4"}),t("edit")]}),e.jsxs(se,{variant:"danger",onClick:()=>z(W.id),children:[e.jsx(te,{name:"Trash2",className:"w-4 h-4"}),t("delete")]})]})})]},W.id)})})]})})}),h&&e.jsx(tv,{isOpen:h,onClose:q,operationToEdit:f}),x&&e.jsx(Ut,{isOpen:x,onClose:()=>S(!1),onConfirm:J,title:t("confirmDeleteTitle"),message:t("confirmDeleteCuttingOperation")})]})},Ak=({weights:t,onChange:n})=>{const{t:s}=je(),r=N.useMemo(()=>{const c=[...t.map(String)],d=Math.max(1,Math.ceil((c.length+1)/10));for(;c.length<d*10;)c.push("");return c},[t]),l=(c,d)=>{const u=[...r];u[c]=d;const h=u.map(m=>parseFloat(m)).filter(m=>!isNaN(m)&&m>0);n(h)};return e.jsxs("div",{className:"space-y-2 col-span-1 md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[s("bagWeights")," (Kg)"]}),e.jsx("div",{className:"grid grid-cols-5 gap-2 max-h-48 overflow-y-auto p-2 border rounded-md dark:border-gray-600 bg-gray-50 dark:bg-gray-800",children:r.map((c,d)=>e.jsx(de,{type:"number",step:"0.01",placeholder:`${s("sac")} ${d+1}`,value:c,onChange:u=>l(d,u.target.value),className:"text-center text-xs"},d))}),e.jsxs("p",{className:"text-xs text-gray-500 text-right",children:[s("totalBags"),": ",t.length]})]})},Dk=({isOpen:t,onClose:n})=>{const{t:s}=je(),{settings:r}=$e(),{sites:l,seaweedTypes:c,employees:d,addSiteTransfer:u,stockMovements:h}=qe(),m=N.useMemo(()=>({date:new Date().toISOString().split("T")[0],sourceSiteId:"",destinationSiteId:"",seaweedTypeId:"",managerId:"",transporter:"",transport:"Truck",representative:""}),[]),[f,v]=N.useState(m),[x,S]=N.useState([]),[w,C]=N.useState({});N.useEffect(()=>{var A,U;t&&(v({...m,sourceSiteId:((A=l.find(P=>P.id!=="pressing-warehouse"))==null?void 0:A.id)||"",seaweedTypeId:((U=c[0])==null?void 0:U.id)||""}),S([]),C({}))},[t,l,c,m]);const T=N.useMemo(()=>({totalWeightKg:x.reduce((A,U)=>A+U,0),totalBags:x.length}),[x]),E=N.useMemo(()=>{if(!f.sourceSiteId||!f.seaweedTypeId)return{kg:0,bags:0};const A=h.filter(z=>z.siteId===f.sourceSiteId&&z.seaweedTypeId===f.seaweedTypeId),U=A.reduce((z,J)=>z+(J.inKg||0),0),P=A.reduce((z,J)=>z+(J.outKg||0),0),F=A.reduce((z,J)=>z+(J.inBags||0),0),q=A.reduce((z,J)=>z+(J.outBags||0),0);return{kg:U-P,bags:F-q}},[f.sourceSiteId,f.seaweedTypeId,h]),R=N.useMemo(()=>({kg:E.kg-T.totalWeightKg,bags:E.bags-T.totalBags}),[E,T]),_=N.useMemo(()=>{const A={id:"pressing-warehouse",name:s("pressedWarehouseTitle")};return[...l.filter(P=>P.id!==f.sourceSiteId&&P.id!=="pressing-warehouse"),A]},[l,f.sourceSiteId,s]),D=N.useCallback(()=>{const A={};return f.date||(A.date=s("validationRequired")),f.sourceSiteId||(A.sourceSiteId=s("validationRequired")),f.destinationSiteId||(A.destinationSiteId=s("validationRequired")),f.sourceSiteId===f.destinationSiteId&&(A.destinationSiteId=s("validationSameSite")),f.seaweedTypeId||(A.seaweedTypeId=s("validationRequired")),f.transporter||(A.transporter=s("validationRequired")),T.totalBags===0&&(A.bagWeights=s("validationAtLeastOneRequired")),R.kg<0?A.bagWeights=s("validationStockUnavailableWeight").replace("{availableStock}",Fe(E.kg,r.localization)):R.bags<0&&(A.bagWeights=s("validationStockUnavailableBags").replace("{availableStock}",String(E.bags))),A},[f,T,R,E,s,r.localization]);N.useEffect(()=>{C(D())},[f,T,D]);const M=(A,U)=>{const P={...f,[A]:U};A==="sourceSiteId"&&U===P.destinationSiteId&&(P.destinationSiteId=""),v(P)},I=A=>{A.preventDefault();const U=D();if(Object.keys(U).length>0){C(U);return}const P={...f,managerId:f.managerId||void 0,representative:f.representative||void 0,weightKg:T.totalWeightKg,bags:T.totalBags,bagWeights:x};u(P),n()},O=Object.keys(w).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:s("createShippingSlip"),widthClass:"max-w-4xl",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:s("cancel")}),e.jsx(se,{onClick:I,disabled:O,children:s("save")})]}),children:e.jsxs("form",{onSubmit:I,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-sm uppercase tracking-wide text-gray-500 border-b pb-1",children:s("originInformation")}),e.jsx(de,{label:s("date"),type:"date",value:f.date,onChange:A=>M("date",A.target.value),error:w.date,required:!0}),e.jsx(De,{label:s("sourceSite"),value:f.sourceSiteId,onChange:A=>M("sourceSiteId",A.target.value),error:w.sourceSiteId,required:!0,children:l.filter(A=>A.id!=="pressing-warehouse").map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))}),e.jsx(De,{label:s("seaweedType"),value:f.seaweedTypeId,onChange:A=>M("seaweedTypeId",A.target.value),error:w.seaweedTypeId,required:!0,children:c.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))}),e.jsxs("div",{className:`p-4 rounded-lg border ${R.kg<0?"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-700/50":"bg-gray-50 border-gray-200 dark:bg-gray-800 dark:border-gray-700"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:[s("currentStock"),":"]}),e.jsxs("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:[Fe(E.kg,r.localization)," Kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:[s("stockBags"),":"]}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:E.bags})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-sm uppercase tracking-wide text-gray-500 border-b pb-1",children:s("destination")+" & Transport"}),e.jsxs(De,{label:s("destinationSite"),value:f.destinationSiteId,onChange:A=>M("destinationSiteId",A.target.value),error:w.destinationSiteId,required:!0,children:[e.jsx("option",{value:"",children:s("selectSite")}),_.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(De,{label:s("transport"),value:f.transport,onChange:A=>M("transport",A.target.value),children:[e.jsx("option",{value:"Truck",children:s("transport_Truck")}),e.jsx("option",{value:"Boat",children:s("transport_Boat")})]}),e.jsx(de,{label:s("transporter"),value:f.transporter,onChange:A=>M("transporter",A.target.value),error:w.transporter,required:!0})]}),e.jsx(de,{label:s("representative"),value:f.representative,onChange:A=>M("representative",A.target.value),placeholder:"Nom du capitaine / chauffeur"}),e.jsxs(De,{label:s("manager"),value:f.managerId,onChange:A=>M("managerId",A.target.value),children:[e.jsx("option",{value:"",children:s("noManager")}),d.map(A=>e.jsxs("option",{value:A.id,children:[A.firstName," ",A.lastName]},A.id))]})]}),e.jsxs("div",{className:"md:col-span-2 border-t pt-4",children:[e.jsx(Ak,{weights:x,onChange:S}),w.bagWeights&&e.jsx("p",{className:"mt-2 text-sm text-red-600 font-medium",children:w.bagWeights})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-6 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:s("shippedBags")}),e.jsx("p",{className:"text-xl font-bold",children:T.totalBags})]}),e.jsxs("div",{className:"text-right border-l pl-6 border-gray-300 dark:border-gray-600",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:s("shippedWeightKg")}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[Fe(T.totalWeightKg,r.localization)," Kg"]})]})]})]})})},kk=({isOpen:t,onClose:n,transfer:s,action:r,onConfirm:l})=>{const{t:c}=je(),d=r===Ot.COMPLETED,[u,h]=N.useState({completionDate:new Date().toISOString().split("T")[0],receivedWeightKg:"",receivedBags:"",notes:""}),[m,f]=N.useState({});N.useEffect(()=>{t&&(h({completionDate:new Date().toISOString().split("T")[0],receivedWeightKg:String(s.weightKg),receivedBags:String(s.bags),notes:""}),f({}))},[t,s]);const v=N.useCallback(()=>{const T={};return u.completionDate||(T.completionDate=c("validationRequired")),d?((!u.receivedWeightKg||isNaN(parseFloat(u.receivedWeightKg))||parseFloat(u.receivedWeightKg)<0)&&(T.receivedWeightKg=c("validationNonNegative")),(!u.receivedBags||isNaN(parseInt(u.receivedBags,10))||parseInt(u.receivedBags,10)<0)&&(T.receivedBags=c("validationNonNegative"))):u.notes.trim()||(T.notes=c("validationRequired")),T},[u,d,c]);N.useEffect(()=>{f(v())},[u,v]);const x=(T,E)=>{h(R=>({...R,[T]:E}))},S=()=>{const T=v();if(Object.keys(T).length>0){f(T);return}const E={...s,status:r,completionDate:u.completionDate,notes:u.notes,receivedWeightKg:d?parseFloat(u.receivedWeightKg):void 0,receivedBags:d?parseInt(u.receivedBags,10):void 0};l(E)},w=c(d?"confirmCompleteTransferTitle":"confirmCancelTransferTitle"),C=d?parseFloat(u.receivedWeightKg||"0")-s.weightKg:0;return e.jsx(at,{isOpen:t,onClose:n,title:w,footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:c("cancel")}),e.jsx(se,{onClick:S,disabled:Object.keys(m).length>0,children:c("confirm")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(de,{label:c(d?"completionDate":"cancellationDate"),type:"date",value:u.completionDate,onChange:T=>x("completionDate",T.target.value),error:m.completionDate,required:!0}),d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-800 text-sm mb-4",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[c("shippedWeightKg"),":"]})," ",s.weightKg," Kg"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[c("shippedBags"),":"]})," ",s.bags]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{label:c("receivedWeightKg"),type:"number",step:"0.01",value:u.receivedWeightKg,onChange:T=>x("receivedWeightKg",T.target.value),error:m.receivedWeightKg,required:!0}),e.jsx(de,{label:c("receivedBags"),type:"number",value:u.receivedBags,onChange:T=>x("receivedBags",T.target.value),error:m.receivedBags,required:!0})]}),C!==0&&e.jsxs("p",{className:`text-xs font-bold text-right ${C<0?"text-red-500":"text-green-500"}`,children:["Difference: ",C>0?"+":"",C.toFixed(2)," Kg"]}),e.jsx(de,{label:`${c("notes")} (${c("optional")})`,value:u.notes,onChange:T=>x("notes",T.target.value),placeholder:"e.g. Broken bags, moisture loss..."})]}):e.jsx(de,{label:c("cancellationReason"),value:u.notes,onChange:T=>x("notes",T.target.value),error:m.notes,required:!0,autoFocus:!0})]})})},Rk=({history:t})=>{const{t:n,language:s}=je();if(!t||t.length===0)return e.jsx("p",{className:"p-4 text-gray-500",children:n("noHistory")});const r=[...t].sort((l,c)=>new Date(c.date).getTime()-new Date(l.date).getTime());return e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-bold uppercase text-gray-500 mb-3",children:n("siteTransferHistoryTitle")}),e.jsx("ol",{className:"relative border-l border-gray-200 dark:border-gray-700 ml-2",children:r.map((l,c)=>e.jsxs("li",{className:"mb-6 ml-6",children:[e.jsx("span",{className:"absolute flex items-center justify-center w-3 h-3 bg-blue-100 rounded-full -left-1.5 ring-4 ring-white dark:ring-gray-800 dark:bg-blue-900"}),e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(mn,{status:l.status}),e.jsx("time",{className:"block ml-4 text-xs font-normal leading-none text-gray-400 dark:text-gray-500",children:new Date(l.date).toLocaleString(s,{dateStyle:"long",timeStyle:"short"})})]}),l.notes&&e.jsx("p",{className:"text-sm font-normal text-gray-600 dark:text-gray-300 mt-1",children:l.notes})]},c))})]})},Mk=()=>{const{t}=je(),{siteTransfers:n,sites:s,seaweedTypes:r,updateSiteTransfer:l}=qe(),[c,d]=N.useState(!1),[u,h]=N.useState(!1),[m,f]=N.useState(null),[v,x]=N.useState(null),[S,w]=N.useState({key:"date",direction:"descending"}),[C,T]=N.useState(null),E=N.useMemo(()=>{const P=new Map(s.map(F=>[F.id,F.name]));return P.set("pressing-warehouse",t("pressedWarehouseTitle")),P},[s,t]),R=N.useMemo(()=>new Map(r.map(P=>[P.id,P.name])),[r]),_=N.useMemo(()=>{let P=[...n];return P.sort((F,q)=>{let z,J;return S.key==="sourceSiteName"?z=E.get(F.sourceSiteId)||"":S.key==="destinationSiteName"?z=E.get(F.destinationSiteId)||"":S.key==="seaweedTypeName"?z=R.get(F.seaweedTypeId)||"":z=F[S.key],S.key==="sourceSiteName"?J=E.get(q.sourceSiteId)||"":S.key==="destinationSiteName"?J=E.get(q.destinationSiteId)||"":S.key==="seaweedTypeName"?J=R.get(q.seaweedTypeId)||"":J=q[S.key],z==null?1:J==null?-1:z<J?S.direction==="ascending"?-1:1:z>J?S.direction==="ascending"?1:-1:0}),P},[n,S,E,R]),D=P=>{let F="ascending";S.key===P&&S.direction==="ascending"&&(F="descending"),w({key:P,direction:F})},M=({sortKey:P,label:F,className:q})=>e.jsx("th",{className:`p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 ${q}`,onClick:()=>D(P),children:e.jsxs("div",{className:`flex items-center gap-2 ${q!=null&&q.includes("text-right")?"justify-end":""}`,children:[F,S.key===P&&e.jsx(te,{name:S.direction==="ascending"?"ArrowUp":"ArrowDown",className:"w-3 h-3"})]})}),I=(P,F)=>{f(P),F===Ot.IN_TRANSIT||F===Ot.PENDING_RECEPTION?l({...P,status:F}):(x(F),h(!0))},O=P=>{l(P),h(!1),f(null),x(null)},A=P=>{const F="w-4 h-4 mr-1";switch(P.status){case Ot.AWAITING_OUTBOUND:return e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(se,{variant:"secondary",className:"!px-2 !py-1 text-xs",onClick:()=>I(P,Ot.IN_TRANSIT),children:[e.jsx(te,{name:"Truck",className:F})," ",t("status_IN_TRANSIT")]}),e.jsxs(se,{variant:"danger",className:"!px-2 !py-1 text-xs",onClick:()=>I(P,Ot.CANCELLED),children:[e.jsx(te,{name:"X",className:F})," ",t("cancel")]})]});case Ot.IN_TRANSIT:return e.jsxs(se,{variant:"secondary",className:"!px-2 !py-1 text-xs",onClick:()=>I(P,Ot.PENDING_RECEPTION),children:[e.jsx(te,{name:"MapPin",className:F})," ",t("status_PENDING_RECEPTION")]});case Ot.PENDING_RECEPTION:return e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(se,{variant:"primary",className:"!px-2 !py-1 text-xs",onClick:()=>I(P,Ot.COMPLETED),children:[e.jsx(te,{name:"Check",className:F})," ",t("confirm")]}),e.jsxs(se,{variant:"danger",className:"!px-2 !py-1 text-xs",onClick:()=>I(P,Ot.CANCELLED),children:[e.jsx(te,{name:"X",className:F})," ",t("cancel")]})]});default:return e.jsx("span",{className:"text-xs text-gray-500 italic",children:t("noActions")})}},U=P=>P.startsWith("st-")?`SLIP-${P.split("-")[1].slice(-6)}`:P;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("siteTransfersTitle")}),e.jsxs(se,{onClick:()=>d(!0),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5 mr-2"}),t("createShippingSlip")]})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto min-h-[400px]",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-10"}),e.jsx(M,{sortKey:"id",label:t("slipNo")}),e.jsx(M,{sortKey:"date",label:t("date")}),e.jsx(M,{sortKey:"sourceSiteName",label:t("sourceSite")}),e.jsx(M,{sortKey:"destinationSiteName",label:t("destinationSite")}),e.jsx(M,{sortKey:"seaweedTypeName",label:t("seaweedType")}),e.jsx(M,{sortKey:"weightKg",label:t("shippedWeightKg"),className:"text-right"}),e.jsx(M,{sortKey:"status",label:t("status")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[_.map(P=>{const F=C===P.id;return e.jsxs(ft.Fragment,{children:[e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>T(F?null:P.id),className:"text-gray-500 hover:text-blue-600 focus:outline-none",children:e.jsx(te,{name:"ChevronRight",className:`w-5 h-5 transition-transform ${F?"rotate-90":""}`})})}),e.jsx("td",{className:"p-3 font-mono font-medium text-blue-600 dark:text-blue-400",children:U(P.id)}),e.jsx("td",{className:"p-3",children:P.date}),e.jsx("td",{className:"p-3",children:E.get(P.sourceSiteId)||t("unknown")}),e.jsx("td",{className:"p-3",children:E.get(P.destinationSiteId)||t("unknown")}),e.jsx("td",{className:"p-3",children:R.get(P.seaweedTypeId)||t("unknown")}),e.jsx("td",{className:"p-3 text-right font-medium",children:P.weightKg.toFixed(2)}),e.jsx("td",{className:"p-3",children:e.jsx(mn,{status:P.status})}),e.jsx("td",{className:"p-3 text-right",children:A(P)})]}),F&&e.jsx("tr",{className:"bg-gray-100/50 dark:bg-gray-900/30",children:e.jsx("td",{colSpan:9,className:"p-0 border-b dark:border-gray-700/50",children:e.jsxs("div",{className:"p-4 pl-12 grid grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold uppercase text-gray-500 mb-2",children:t("transportDetails")}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"text-gray-500",children:[t("transporter"),":"]})," ",P.transporter]}),e.jsxs("p",{children:[e.jsxs("span",{className:"text-gray-500",children:[t("transport"),":"]})," ",P.transport||"-"]}),e.jsxs("p",{children:[e.jsxs("span",{className:"text-gray-500",children:[t("representative"),":"]})," ",P.representative||"-"]})]})]}),e.jsx("div",{children:e.jsx(Rk,{history:P.history})})]})})})]},P.id)}),_.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"p-8 text-center text-gray-500",children:t("noDataForReport")})})]})]})})}),c&&e.jsx(Dk,{isOpen:c,onClose:()=>d(!1)}),u&&m&&v&&e.jsx(kk,{isOpen:u,onClose:()=>h(!1),transfer:m,action:v,onConfirm:O})]})},Pk=()=>e.jsx(Mk,{}),Lk=()=>{const{t,language:n}=je(),{incidents:s,sites:r,employees:l,deleteIncident:c,incidentTypes:d,incidentSeverities:u}=qe(),[h,m]=N.useState(!1),[f,v]=N.useState(null),[x,S]=N.useState(!1),[w,C]=N.useState(null),[T,E]=N.useState({key:"date",direction:"descending"}),[R,_]=N.useState({siteId:"all",type:"all",severity:"all",status:"all"}),D=N.useMemo(()=>new Map(r.map(B=>[B.id,B.name])),[r]),M=N.useMemo(()=>new Map(l.map(B=>[B.id,`${B.firstName} ${B.lastName}`])),[l]),I=N.useMemo(()=>new Map(d.map(B=>[B.id,B.name])),[d]);N.useMemo(()=>new Map(u.map(B=>[B.id,B.name])),[u]);const O=N.useMemo(()=>{const B=s.filter(ae=>ae.status===ls.OPEN).length,X=s.filter(ae=>ae.status===ls.IN_PROGRESS).length,$=s.filter(ae=>ae.severity==="CRITICAL"&&(ae.status===ls.OPEN||ae.status===ls.IN_PROGRESS)).length;return{open:B,inProgress:X,critical:$}},[s]),A=(B,X)=>{_($=>({...$,[B]:X}))},U=()=>{_({siteId:"all",type:"all",severity:"all",status:"all"})},P=N.useMemo(()=>{let B=[...s].filter(X=>{const $=R.siteId==="all"||X.siteId===R.siteId,ae=R.type==="all"||X.type===R.type,H=R.severity==="all"||X.severity===R.severity,ie=R.status==="all"||X.status===R.status;return $&&ae&&H&&ie});return B.sort((X,$)=>{let ae,H;return T.key==="siteName"?ae=D.get(X.siteId)||"":T.key==="reportedByName"?ae=M.get(X.reportedById)||"":ae=X[T.key],T.key==="siteName"?H=D.get($.siteId)||"":T.key==="reportedByName"?H=M.get($.reportedById)||"":H=$[T.key],ae==null?1:H==null?-1:ae<H?T.direction==="ascending"?-1:1:ae>H?T.direction==="ascending"?1:-1:0}),B},[s,R,T,D,M]),F=B=>{let X="ascending";T.key===B&&T.direction==="ascending"&&(X="descending"),E({key:B,direction:X})},q=B=>T.key!==B?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):T.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),z=({sortKey:B,label:X,className:$})=>e.jsx("th",{className:`p-3 ${$}`,children:e.jsxs("button",{onClick:()=>F(B),className:`group flex items-center gap-2 w-full ${$!=null&&$.includes("text-right")?"justify-end":""}`,children:[X,q(B)]})}),J=(B=null)=>{v(B),m(!0)},W=B=>{C(B),S(!0)},G=()=>{w&&c(w),S(!1),C(null)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:t("incidentManagementTitle")}),e.jsxs(se,{onClick:()=>J(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("reportIncident")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"Bell",className:"w-8 h-8 text-blue-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("openIncidents")}),e.jsx("p",{className:"text-2xl font-bold",children:O.open})]})]})}),e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"Activity",className:"w-8 h-8 text-purple-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("inProgressIncidents")}),e.jsx("p",{className:"text-2xl font-bold",children:O.inProgress})]})]})}),e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{name:"AlertTriangle",className:"w-8 h-8 text-red-500 mr-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:t("criticalIncidents")}),e.jsx("p",{className:"text-2xl font-bold",children:O.critical})]})]})})]}),e.jsx(Ge,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 items-end mb-4",children:[e.jsxs(De,{label:t("site"),value:R.siteId,onChange:B=>A("siteId",B.target.value),children:[e.jsx("option",{value:"all",children:t("all")}),r.map(B=>e.jsx("option",{value:B.id,children:B.name},B.id))]}),e.jsxs(De,{label:t("incidentType"),value:R.type,onChange:B=>A("type",B.target.value),children:[e.jsx("option",{value:"all",children:t("all")}),d.map(B=>e.jsx("option",{value:B.id,children:B.name},B.id))]}),e.jsxs(De,{label:t("severity"),value:R.severity,onChange:B=>A("severity",B.target.value),children:[e.jsx("option",{value:"all",children:t("all")}),u.map(B=>e.jsx("option",{value:B.id,children:B.name},B.id))]}),e.jsxs(De,{label:t("status"),value:R.status,onChange:B=>A("status",B.target.value),children:[e.jsx("option",{value:"all",children:t("all")}),Object.values(ls).map(B=>e.jsx("option",{value:B,children:t(`status_${B}`)},B))]}),e.jsx(se,{variant:"secondary",onClick:U,className:"h-[42px] w-full",children:t("clearFilters")})]})}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(z,{sortKey:"date",label:t("date")}),e.jsx(z,{sortKey:"siteName",label:t("site")}),e.jsx(z,{sortKey:"type",label:t("incidentType")}),e.jsx(z,{sortKey:"severity",label:t("severity")}),e.jsx(z,{sortKey:"reportedByName",label:t("reportedBy")}),e.jsx(z,{sortKey:"status",label:t("status")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[P.map(B=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3",children:B.date}),e.jsx("td",{className:"p-3",children:D.get(B.siteId)||t("unknown")}),e.jsx("td",{className:"p-3",children:I.get(B.type)||B.type}),e.jsx("td",{className:"p-3",children:e.jsx(mn,{status:B.severity})}),e.jsx("td",{className:"p-3",children:M.get(B.reportedById)||t("unknown")}),e.jsx("td",{className:"p-3",children:e.jsx(mn,{status:B.status})}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(se,{variant:"ghost",onClick:()=>J(B),children:e.jsx(te,{name:"Edit2",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",onClick:()=>W(B.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]},B.id)),P.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-6 text-center text-gray-500",children:t("noIncidents")})})]})]})})}),h&&e.jsx(Ok,{isOpen:h,onClose:()=>m(!1),incident:f}),x&&e.jsx(Ut,{isOpen:x,onClose:()=>S(!1),onConfirm:G,title:t("confirmDeleteTitle"),message:t("confirmDeleteIncident")})]})},Ok=({isOpen:t,onClose:n,incident:s})=>{var G,B,X;const{t:r,language:l}=je(),{sites:c,employees:d,incidentTypes:u,incidentSeverities:h,modules:m,addIncident:f,updateIncident:v}=qe(),x=N.useRef(null),[S,w]=N.useState({date:new Date().toISOString().split("T")[0],siteId:((G=c[0])==null?void 0:G.id)||"",type:((B=u.find($=>!$.isDefault&&$.id!=="OTHER"))==null?void 0:B.id)||"PEST_DISEASE",severity:"LOW",affectedModuleIds:[],reportedById:((X=d[0])==null?void 0:X.id)||"",description:"",status:ls.OPEN,resolutionNotes:"",resolvedDate:""}),[C,T]=N.useState(null),[E,R]=N.useState(!1),[_,D]=N.useState(null),[M,I]=N.useState({});N.useEffect(()=>{w(s?{date:s.date,siteId:s.siteId,type:s.type,severity:s.severity,affectedModuleIds:s.affectedModuleIds,reportedById:s.reportedById,description:s.description,status:s.status,resolutionNotes:s.resolutionNotes||"",resolvedDate:s.resolvedDate||""}:$=>{var ae,H,ie;return{...$,siteId:((ae=c[0])==null?void 0:ae.id)||"",reportedById:((H=d[0])==null?void 0:H.id)||"",type:((ie=u[0])==null?void 0:ie.id)||"PEST_DISEASE"}}),T(null),D(null),I({})},[s,t,c,d,u]);const O=N.useMemo(()=>m.filter($=>$.siteId===S.siteId),[m,S.siteId]),A=N.useCallback(()=>{const $={};return S.date||($.date=r("validationRequired")),S.siteId||($.siteId=r("validationRequired")),S.type||($.type=r("validationRequired")),S.reportedById||($.reportedById=r("validationRequired")),S.description.trim()||($.description=r("validationRequired")),(S.status===ls.RESOLVED||S.status===ls.CLOSED)&&(S.resolvedDate||($.resolvedDate=r("validationRequired")),S.resolutionNotes.trim()||($.resolutionNotes=r("validationRequired"))),$},[S,r]);N.useEffect(()=>{I(A())},[S,A]);const U=($,ae)=>{w(H=>({...H,[$]:ae}))},P=$=>{w(ae=>{const H=ae.affectedModuleIds.includes($)?ae.affectedModuleIds.filter(ie=>ie!==$):[...ae.affectedModuleIds,$];return{...ae,affectedModuleIds:H}})},F=$=>{var H;const ae=(H=$.target.files)==null?void 0:H[0];if(ae){const ie=new FileReader;ie.onloadend=()=>{T(ie.result),z(ie.result)},ie.readAsDataURL(ae)}},q=async()=>{if(S.description){R(!0);try{const $=await jD(S.description,O.map(ae=>ae.code),u,h,l);if(D($),$.suggestedType&&w(ae=>({...ae,type:$.suggestedType})),$.suggestedSeverity&&w(ae=>({...ae,severity:$.suggestedSeverity})),$.suggestedModuleCodes&&$.suggestedModuleCodes.length>0){const ae=O.filter(H=>$.suggestedModuleCodes.includes(H.code)).map(H=>H.id);w(H=>({...H,affectedModuleIds:[...new Set([...H.affectedModuleIds,...ae])]}))}}catch($){console.error("AI Analysis failed",$)}finally{R(!1)}}},z=async $=>{R(!0);try{const ae=await TD($,l);if(ae){if(D({..._,imageAnalysis:ae}),ae.type==="PEST_DISEASE"){const H=u.find(ie=>ie.id==="PEST_DISEASE");H&&w(ie=>({...ie,type:H.id}))}if(ae.severity){const H=h.find(ie=>ie.id===ae.severity.toUpperCase());H&&w(ie=>({...ie,severity:H.id}))}ae.description&&w(H=>({...H,description:(H.description?H.description+`

`:"")+`[AI Analysis]: ${ae.description}`}))}}catch(ae){console.error("Image Analysis failed",ae)}finally{R(!1)}},J=$=>{$.preventDefault();const ae=A();if(Object.keys(ae).length>0){I(ae);return}const H={...S,resolutionNotes:S.resolutionNotes||void 0,resolvedDate:S.resolvedDate||void 0};s?v({...s,...H}):f(H),n()},W=Object.keys(M).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:r(s?"editIncident":"reportIncident"),widthClass:"max-w-4xl",children:e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:r("date"),type:"date",value:S.date,onChange:$=>U("date",$.target.value),error:M.date,required:!0}),e.jsx(De,{label:r("site"),value:S.siteId,onChange:$=>U("siteId",$.target.value),error:M.siteId,required:!0,children:c.map($=>e.jsx("option",{value:$.id,children:$.name},$.id))}),e.jsx(De,{label:r("incidentType"),value:S.type,onChange:$=>U("type",$.target.value),error:M.type,required:!0,children:u.map($=>e.jsx("option",{value:$.id,children:$.name},$.id))}),e.jsx(De,{label:r("severity"),value:S.severity,onChange:$=>U("severity",$.target.value),required:!0,children:h.map($=>e.jsx("option",{value:$.id,children:$.name},$.id))}),e.jsx(De,{label:r("reportedBy"),value:S.reportedById,onChange:$=>U("reportedById",$.target.value),error:M.reportedById,required:!0,children:d.map($=>e.jsxs("option",{value:$.id,children:[$.firstName," ",$.lastName]},$.id))}),e.jsx(De,{label:r("status"),value:S.status,onChange:$=>U("status",$.target.value),required:!0,children:Object.values(ls).map($=>e.jsx("option",{value:$,children:r(`status_${$}`)},$))})]}),e.jsxs("div",{className:"border p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:r("description")}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsxs(se,{type:"button",variant:"secondary",onClick:()=>{var $;return($=x.current)==null?void 0:$.click()},className:"text-xs",children:[e.jsx(te,{name:"Image",className:"w-4 h-4 mr-1"})," ",r("uploadPhoto")]}),e.jsx("input",{type:"file",ref:x,onChange:F,accept:"image/*",className:"hidden"}),e.jsxs(se,{type:"button",variant:"ghost",onClick:q,disabled:E||!S.description,className:"text-xs",children:[e.jsx(te,{name:"Bot",className:"w-4 h-4 mr-1"})," ",r("analyzeWithAI")]})]}),C&&e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:C,alt:"Preview",className:"h-32 w-auto object-cover rounded border"})}),e.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 focus:ring-2 focus:ring-blue-500",rows:4,value:S.description,onChange:$=>U("description",$.target.value),placeholder:r("descriptionPlaceholder")}),M.description&&e.jsx("p",{className:"text-xs text-red-600",children:M.description}),E&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1 animate-pulse",children:[r("analyzingSatellite"),"..."]}),_&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded text-sm",children:[e.jsxs("h4",{className:"font-bold flex items-center gap-1 text-blue-800 dark:text-blue-200",children:[e.jsx(te,{name:"Bot",className:"w-4 h-4"})," ",r("aiSuggestions")]}),_.imageAnalysis&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("p",{className:"font-semibold",children:[r("suggestedType"),": ",_.imageAnalysis.type]}),e.jsx("p",{children:_.imageAnalysis.description}),e.jsxs("p",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("strong",{children:[r("suggestedTreatment"),":"]})," ",_.imageAnalysis.treatments]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:r("affectedModules")}),e.jsxs("div",{className:"max-h-32 overflow-y-auto border rounded p-2 grid grid-cols-3 gap-2",children:[O.map($=>e.jsxs("label",{className:"flex items-center space-x-2 text-sm cursor-pointer",children:[e.jsx(jt,{checked:S.affectedModuleIds.includes($.id),onChange:()=>P($.id)}),e.jsx("span",{children:$.code})]},$.id)),O.length===0&&e.jsx("p",{className:"text-gray-500 text-sm col-span-3 text-center",children:"Select a site to view modules"})]})]}),(S.status===ls.RESOLVED||S.status===ls.CLOSED)&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:r("status_RESOLVED")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx(de,{label:r("resolvedDate"),type:"date",value:S.resolvedDate,onChange:$=>U("resolvedDate",$.target.value),error:M.resolvedDate,required:!0}),e.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",rows:3,value:S.resolutionNotes,onChange:$=>U("resolutionNotes",$.target.value),placeholder:r("resolutionNotes")}),M.resolutionNotes&&e.jsx("p",{className:"text-xs text-red-600",children:M.resolutionNotes})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-gray-700 mt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:n,children:r("cancel")}),e.jsx(se,{type:"submit",disabled:W,children:r("save")})]})]})})},Uk=()=>{const{t}=je(),{incidentTypes:n,addIncidentType:s,updateIncidentType:r,deleteIncidentType:l}=qe(),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,f]=N.useState(""),[v,x]=N.useState(!1),[S,w]=N.useState(null),C=D=>{D.isDefault||(h(D),d(!0))},T=()=>{u&&l(u.id),d(!1),h(null)},E=()=>{m.trim()&&(s({name:m.trim()}),f(""))},R=D=>{w(D),x(!0)},_=D=>{r(D),x(!1)};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6",children:t("incidentTypeManagementTitle")}),e.jsxs(Ge,{children:[e.jsx("div",{className:"space-y-4 mb-6",children:n.map(D=>e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-900/50 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:D.name}),D.isDefault&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",t("default"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{variant:"ghost",onClick:()=>R(D),children:[e.jsx(te,{name:"Edit2",className:"w-4 h-4"}),t("edit")]}),D.isDefault?e.jsx(te,{name:"Lock",className:"w-5 h-5 text-gray-400",title:t("cannotDeleteDefault")}):e.jsx(se,{variant:"danger",className:"p-2",onClick:()=>C(D),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})]},D.id))}),e.jsxs("div",{className:"mt-6 pt-6 border-t dark:border-gray-700",children:[e.jsx("h4",{className:"font-semibold mb-4",children:t("addIncidentType")}),e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(de,{containerClassName:"flex-grow",label:t("typeName"),value:m,onChange:D=>f(D.target.value)}),e.jsxs(se,{onClick:E,disabled:!m.trim(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("add")]})]})]})]}),v&&S&&e.jsx(Fk,{isOpen:v,onClose:()=>x(!1),type:S,onSave:_}),c&&u&&e.jsx(Ut,{isOpen:c,onClose:()=>d(!1),onConfirm:T,title:t("confirmDeleteTitle"),message:t("confirmDeleteIncidentType")})]})},Fk=({isOpen:t,onClose:n,type:s,onSave:r})=>{const{t:l}=je(),[c,d]=N.useState(s.name);N.useEffect(()=>{t&&d(s.name)},[t,s]);const u=()=>{c.trim()&&r({...s,name:c.trim()})};return e.jsx(at,{isOpen:t,onClose:n,title:l("editIncidentType"),footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{onClick:u,disabled:!c.trim(),children:l("save")})]}),children:e.jsx(de,{label:l("typeName"),value:c,onChange:h=>d(h.target.value),required:!0,autoFocus:!0})})},Bk=()=>{const{t}=je(),{incidentSeverities:n,addIncidentSeverity:s,updateIncidentSeverity:r,deleteIncidentSeverity:l}=qe(),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,f]=N.useState(""),[v,x]=N.useState(!1),[S,w]=N.useState(null),C=D=>{D.isDefault||(h(D),d(!0))},T=()=>{u&&l(u.id),d(!1),h(null)},E=()=>{m.trim()&&(s({name:m.trim()}),f(""))},R=D=>{w(D),x(!0)},_=D=>{r(D),x(!1)};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6",children:t("incidentSeverityManagementTitle")}),e.jsxs(Ge,{children:[e.jsx("div",{className:"space-y-4 mb-6",children:n.map(D=>e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-900/50 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:D.name}),D.isDefault&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",t("default"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{variant:"ghost",onClick:()=>R(D),children:[e.jsx(te,{name:"Edit2",className:"w-4 h-4"}),t("edit")]}),D.isDefault?e.jsx(te,{name:"Lock",className:"w-5 h-5 text-gray-400",title:t("cannotDeleteDefault")}):e.jsx(se,{variant:"danger",className:"p-2",onClick:()=>C(D),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})]},D.id))}),e.jsxs("div",{className:"mt-6 pt-6 border-t dark:border-gray-700",children:[e.jsx("h4",{className:"font-semibold mb-4",children:t("addIncidentSeverity")}),e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(de,{containerClassName:"flex-grow",label:t("severityName"),value:m,onChange:D=>f(D.target.value)}),e.jsxs(se,{onClick:E,disabled:!m.trim(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("add")]})]})]})]}),v&&S&&e.jsx(Gk,{isOpen:v,onClose:()=>x(!1),severity:S,onSave:_}),c&&u&&e.jsx(Ut,{isOpen:c,onClose:()=>d(!1),onConfirm:T,title:t("confirmDeleteTitle"),message:t("confirmDeleteIncidentSeverity")})]})},Gk=({isOpen:t,onClose:n,severity:s,onSave:r})=>{const{t:l}=je(),[c,d]=N.useState(s.name);N.useEffect(()=>{t&&d(s.name)},[t,s]);const u=()=>{c.trim()&&r({...s,name:c.trim()})};return e.jsx(at,{isOpen:t,onClose:n,title:l("editIncidentSeverity"),footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{onClick:u,disabled:!c.trim(),children:l("save")})]}),children:e.jsx(de,{label:l("severityName"),value:c,onChange:h=>d(h.target.value),required:!0,autoFocus:!0})})},zk=({isOpen:t,onClose:n,payment:s})=>{const{t:r}=je(),{farmers:l,employees:c,serviceProviders:d,addMonthlyPayment:u,updateMonthlyPayment:h}=qe(),m=N.useCallback(()=>{const _=new Date,D=_.getFullYear(),M=String(_.getMonth()+1).padStart(2,"0");return{date:_.toISOString().split("T")[0],period:`${D}-${M}`,recipientType:qt.FARMER,recipientId:"",amount:"",method:"cash",notes:"",paymentStatus:"PENDING",mobileProvider:"",phoneNumber:""}},[]),[f,v]=N.useState(m()),[x,S]=N.useState({});N.useEffect(()=>{t&&(v(s?{...s,amount:String(s.amount),notes:s.notes||"",mobileProvider:s.mobileProvider||"",phoneNumber:s.phoneNumber||"",paymentStatus:s.paymentStatus||"PENDING"}:m()),S({}))},[t,s,m]);const w=N.useMemo(()=>{switch(f.recipientType){case qt.FARMER:return l.map(_=>({value:_.id,label:`${_.firstName} ${_.lastName}`}));case qt.EMPLOYEE:return c.map(_=>({value:_.id,label:`${_.firstName} ${_.lastName}`}));case qt.SERVICE_PROVIDER:return d.map(_=>({value:_.id,label:_.name}));default:return[]}},[f.recipientType,l,c,d]),C=N.useCallback(()=>{const _={};return f.date||(_.date=r("validationRequired")),f.period||(_.period=r("validationRequired")),f.recipientType||(_.recipientType=r("validationRequired")),f.recipientId||(_.recipientId=r("validationRequired")),(!f.amount||isNaN(parseFloat(f.amount))||parseFloat(f.amount)<=0)&&(_.amount=r("validationPositiveNumber")),f.method==="mobile_money"&&(f.mobileProvider||(_.mobileProvider=r("validationRequired")),f.phoneNumber||(_.phoneNumber=r("validationRequired"))),_},[f,r]);N.useEffect(()=>{S(C())},[f,C]);const T=(_,D)=>{const M={...f,[_]:D};_==="recipientType"&&(M.recipientId=""),v(M)},E=_=>{var I;_.preventDefault();const D=C();if(Object.keys(D).length>0){S(D);return}const M={...f,amount:parseFloat(f.amount),notes:((I=f.notes)==null?void 0:I.trim())||void 0,mobileProvider:f.method==="mobile_money"?f.mobileProvider:void 0,phoneNumber:f.method==="mobile_money"?f.phoneNumber:void 0};s?h({...s,...M}):u(M),n()},R=Object.keys(x).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:r(s?"editPayment":"newPayment"),footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:r("cancel")}),e.jsx(se,{onClick:E,disabled:R,children:r("save")})]}),children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:r("paymentDate"),type:"date",value:f.date,onChange:_=>T("date",_.target.value),error:x.date,required:!0}),e.jsx(de,{label:r("period"),type:"month",value:f.period,onChange:_=>T("period",_.target.value),error:x.period,required:!0}),e.jsxs(De,{label:r("recipientType"),value:f.recipientType,onChange:_=>T("recipientType",_.target.value),error:x.recipientType,required:!0,children:[e.jsx("option",{value:"",children:r("selectRecipientType")}),Object.values(qt).map(_=>e.jsx("option",{value:_,children:r(`recipientType_${_}`)},_))]}),e.jsxs(De,{label:r("recipient"),value:f.recipientId,onChange:_=>T("recipientId",_.target.value),error:x.recipientId,disabled:!f.recipientType,required:!0,children:[e.jsx("option",{value:"",children:r("selectRecipient")}),w.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))]}),e.jsx(de,{label:r("amount"),type:"number",step:"any",value:f.amount,onChange:_=>T("amount",_.target.value),error:x.amount,required:!0}),e.jsxs(De,{label:r("paymentMethod"),value:f.method,onChange:_=>T("method",_.target.value),children:[e.jsx("option",{value:"cash",children:r("paymentMethod_cash")}),e.jsx("option",{value:"bank_transfer",children:r("paymentMethod_bank_transfer")}),e.jsx("option",{value:"mobile_money",children:r("paymentMethod_mobile_money")})]})]}),f.method==="mobile_money"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs(De,{label:"Mobile Money Provider",value:f.mobileProvider,onChange:_=>T("mobileProvider",_.target.value),error:x.mobileProvider,required:!0,children:[e.jsx("option",{value:"",children:"Select Provider"}),e.jsx("option",{value:"Orange Money",children:"Orange Money"}),e.jsx("option",{value:"M-Pesa",children:"M-Pesa"}),e.jsx("option",{value:"Airtel Money",children:"Airtel Money"}),e.jsx("option",{value:"Telma MVola",children:"Telma MVola"})]}),e.jsx(de,{label:"Phone Number",type:"tel",value:f.phoneNumber,onChange:_=>T("phoneNumber",_.target.value),error:x.phoneNumber,required:!0,placeholder:"+261..."})]}),s&&s.paymentStatus&&e.jsxs("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded text-sm",children:[e.jsxs("strong",{children:[r("paymentStatus"),": "]})," ",r(`status_${s.paymentStatus}`),s.transactionId&&e.jsxs("span",{className:"block text-xs text-gray-500 mt-1",children:[r("transactionId"),": ",s.transactionId]})]}),e.jsx(de,{label:`${r("notes")} (${r("optional")})`,value:f.notes,onChange:_=>T("notes",_.target.value)})]})})},nl=(t,n,s,r,l,c={})=>{var _,D;let d=(_=Vt.find(M=>M.code===l.country))==null?void 0:_.payroll;if(d||(d=(D=Vt.find(M=>M.code==="MG"))==null?void 0:D.payroll),!d){const M=t+n+s,I=r,O=M-I;return{baseSalary:t,bonuses:n,overtime:s,totalGross:M,deductions:[],otherDeductions:r,totalDeductions:I,netPay:O}}const{constants:u,labels:h}=d,m=u.socialContributions.map(M=>M.key),f=c.appliedDeductions===void 0?m:c.appliedDeductions,v=t+n+s,x=[];let S=0;f.length>0&&u.socialContributions.forEach(M=>{var I;if(f.includes(M.key)){const A=(M.cap?Math.min(v,M.cap):v)*M.rate;S+=A;const U=((I=h.socialContributions.find(P=>P.key===M.key))==null?void 0:I.label)||M.key;x.push({label:U,amount:A})}});const w=v-S;let C=0;if(w>0){for(const M of u.incomeTax.brackets)if(w>M.from){const I=Math.min(w,M.to===1/0?w:M.to)-M.from;I>0&&(C+=I*M.rate)}}u.incomeTax.minimumPerception&&C>0&&(C=Math.max(C,u.incomeTax.minimumPerception)),C>0&&x.push({label:h.incomeTax,amount:C});const E=x.reduce((M,I)=>M+I.amount,0)+r,R=v-E;return{baseSalary:t,bonuses:n,overtime:s,totalGross:v,deductions:x,otherDeductions:r,totalDeductions:E,netPay:R}},Tn=({label:t,children:n})=>e.jsxs("div",{className:"text-[10px] text-black",children:[e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("span",{className:"w-auto mr-2 whitespace-nowrap",children:t}),e.jsx("div",{className:"flex-grow font-semibold truncate pl-1",children:n||e.jsx(e.Fragment,{children:""})})]}),e.jsx("div",{className:"border-b border-black mt-0.5"})]}),Ey=({rows:t,periodName:n,pageIndex:s,totalPages:r,data:l})=>{var S,w,C,T,E;const{settings:c}=$e(),{t:d}=je(),u=N.useMemo(()=>{var R;return((R=Vt.find(_=>_.code===c.localization.country))==null?void 0:R.name)||c.localization.country},[c.localization.country]),h=l.columns.some(R=>R.key==="dryPrice"),m=(S=l.headerInfo.find(R=>R.label===d("site")))==null?void 0:S.value,f=(w=l.headerInfo.find(R=>R.label===d("seaweedType")))==null?void 0:w.value,v=(C=l.headerInfo.find(R=>R.label===d("date")))==null?void 0:C.value,x=s===r-1;return e.jsx(gs,{landscape:!0,children:e.jsxs("div",{className:"h-full flex flex-col text-[9px] text-black bg-white font-sans",children:[e.jsxs("header",{className:"mb-2",children:[e.jsxs("div",{className:"grid grid-cols-4 items-start",children:[e.jsx("div",{className:"col-span-1",children:c.company.logoUrl&&e.jsx("img",{src:c.company.logoUrl,alt:"Company Logo",className:"h-12 w-auto object-contain"})}),e.jsxs("div",{className:"col-span-2 text-center",children:[e.jsx("h1",{className:"font-bold text-sm uppercase mb-0.5",children:c.company.name}),e.jsxs("div",{className:"text-[8px] leading-none space-y-0 text-gray-700 flex flex-wrap justify-center gap-x-2",children:[e.jsxs("span",{children:[d("capital"),": ",Ae(c.company.capital,c.localization)]}),e.jsxs("span",{children:[d("address"),": ",c.company.address]}),e.jsxs("span",{children:[d("nif"),": ",c.company.nif]}),e.jsxs("span",{children:[d("stat"),": ",c.company.stat]}),e.jsxs("span",{children:[d("rc"),": ",c.company.rc]}),e.jsxs("span",{children:[d("phone"),": ",c.company.phone]}),e.jsxs("span",{children:[d("email"),": ",c.company.email]}),e.jsxs("span",{children:[d("country"),": ",u]})]})]}),e.jsx("div",{className:"col-span-1"})]}),e.jsx("div",{className:"text-center mt-1 mb-2",children:e.jsx("h2",{className:"text-sm font-bold uppercase underline decoration-2",children:l.title})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 mb-2",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Tn,{label:`${d("exploitationSite")}:`,children:m}),e.jsx(Tn,{label:`${d("dateLabel")} du paiement:`,children:v}),e.jsx(Tn,{label:`${d("totalPaymentAmount")}:`,children:Ae(l.totalValue,c.localization)}),e.jsx(Tn,{label:`(${d("totalAmountInWords")})`})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Tn,{label:`${d("seaweedType")}:`,children:f}),e.jsx(Tn,{label:`${d("checkNumber")}:`}),e.jsx(Tn,{label:`${d("pricePerKg")}:`,children:Ae(h?((T=t[0])==null?void 0:T.dryPrice)||0:((E=t[0])==null?void 0:E.wetPrice)||0,c.localization)})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Tn,{label:`${d("deliveryPeriod")}:`,children:n}),e.jsx(Tn,{label:`${d("checkAmount")}:`})]})]}),e.jsxs("table",{className:"w-full border-collapse border border-black text-[9px] text-black",children:[e.jsx("thead",{className:"font-bold bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-1 py-1 border border-black",children:"Trans. Date"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Farmer"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Weight"}),h&&e.jsx("th",{className:"px-1 py-1 border border-black",children:"Bags"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Value"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Credits"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Net Payable"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Responsible Signature"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Signature"})]})}),e.jsx("tbody",{children:t.map((R,_)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-1 py-0.5 border border-black text-center whitespace-nowrap",children:v}),e.jsx("td",{className:"px-1 py-0.5 border border-black truncate max-w-[150px]",children:R.beneficiaryName}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:Fe(R.netWeightKg??R.totalWeightKg,c.localization)}),h&&e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:R.totalBags}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:Ae(R.baseAmount,c.localization)}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:Ae(R.deduction,c.localization)}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right font-semibold",children:Ae(R.netAmount,c.localization)}),e.jsx("td",{className:"px-1 py-0.5 border border-black h-6"}),e.jsx("td",{className:"px-1 py-0.5 border border-black"})]},_))}),x&&e.jsx("tfoot",{className:"font-bold bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:h?5:4,className:"px-1 py-1 border border-black text-right uppercase",children:d("totalToPay")}),e.jsx("td",{className:"px-1 py-1 border border-black text-right",children:Ae(l.totalValue,c.localization)}),e.jsx("td",{colSpan:3,className:"px-1 py-1 border border-black"})]})})]}),e.jsx("div",{className:"mt-1 mb-4 text-[9px]",children:e.jsxs("span",{children:["(",d("totalAmountInWords"),"): ",l.totalValueInWords]})}),e.jsx("div",{className:"flex-grow"}),e.jsxs("footer",{className:"flex flex-col items-center justify-end text-center mt-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("p",{className:"font-bold text-xs mb-8",children:e.jsx("u",{children:d("theResponsible")})})}),e.jsxs("div",{className:"w-full border-t border-black pt-1 mt-2 flex flex-col items-center",children:[e.jsxs("p",{className:"text-[8px] text-gray-600",children:[c.company.name," - ",c.company.address]}),e.jsxs("p",{className:"text-[8px] font-bold mt-0.5",children:["Page ",s+1,"/",r]})]})]})]})})},Hk=({rows:t,periodName:n,pageIndex:s,totalPages:r,data:l})=>{var x,S,w;const{settings:c}=$e(),{t:d}=je(),u=N.useMemo(()=>{var C;return((C=Vt.find(T=>T.code===c.localization.country))==null?void 0:C.name)||c.localization.country},[c.localization.country]),h=(x=l.headerInfo.find(C=>C.label===d("site")))==null?void 0:x.value,m=(S=l.headerInfo.find(C=>C.label===d("seaweedType")))==null?void 0:S.value,f=(w=l.headerInfo.find(C=>C.label===d("paymentDate")))==null?void 0:w.value,v=s===r-1;return e.jsx(gs,{landscape:!0,children:e.jsxs("div",{className:"h-full flex flex-col text-[9px] text-black bg-white font-sans",children:[e.jsxs("header",{className:"mb-2",children:[e.jsxs("div",{className:"grid grid-cols-4 items-start",children:[e.jsx("div",{className:"col-span-1",children:c.company.logoUrl&&e.jsx("img",{src:c.company.logoUrl,alt:"Company Logo",className:"h-12 w-auto object-contain"})}),e.jsxs("div",{className:"col-span-2 text-center",children:[e.jsx("h1",{className:"font-bold text-sm uppercase mb-0.5",children:c.company.name}),e.jsxs("div",{className:"text-[8px] leading-none space-y-0 text-gray-700 flex flex-wrap justify-center gap-x-2",children:[e.jsxs("span",{children:[d("capital"),": ",Ae(c.company.capital,c.localization)]}),e.jsxs("span",{children:[d("address"),": ",c.company.address]}),e.jsxs("span",{children:[d("nif"),": ",c.company.nif]}),e.jsxs("span",{children:[d("stat"),": ",c.company.stat]}),e.jsxs("span",{children:[d("rc"),": ",c.company.rc]}),e.jsxs("span",{children:[d("phone"),": ",c.company.phone]}),e.jsxs("span",{children:[d("email"),": ",c.company.email]}),e.jsxs("span",{children:[d("country"),": ",u]})]})]})]}),e.jsx("div",{className:"text-center mt-1 mb-2",children:e.jsx("h2",{className:"text-sm font-bold uppercase underline decoration-2",children:l.title})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-x-4 mb-2",children:[e.jsx(Tn,{label:`${d("exploitationSite")}:`,children:h}),e.jsx(Tn,{label:`${d("seaweedType")}:`,children:m}),e.jsx(Tn,{label:`${d("deliveryPeriod")}:`,children:n}),e.jsx(Tn,{label:`${d("paymentDate")}:`,children:f})]}),e.jsxs("table",{className:"w-full border-collapse border border-black text-[9px] text-black",children:[e.jsx("thead",{className:"font-bold bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-1 py-1 border border-black",children:d("serviceDate")}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Provider"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Number of Lines"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Unit Price"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Amount to Pay"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Responsible Signature"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Signature"})]})}),e.jsx("tbody",{children:t.map((C,T)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-1 py-0.5 border border-black text-center whitespace-nowrap",children:C.date}),e.jsx("td",{className:"px-1 py-0.5 border border-black truncate max-w-[150px]",children:C.beneficiaryName}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:C.totalLines}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:C.averageUnitPrice!==null?Ae(C.averageUnitPrice,c.localization):d("various")}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right font-semibold",children:Ae(C.netAmount,c.localization)}),e.jsx("td",{className:"px-1 py-0.5 border border-black h-6"}),e.jsx("td",{className:"px-1 py-0.5 border border-black"})]},T))}),v&&e.jsx("tfoot",{className:"font-bold bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-1 py-1 border border-black text-right uppercase",children:d("totalToPay")}),e.jsx("td",{className:"px-1 py-1 border border-black text-right",children:Ae(l.totalValue,c.localization)}),e.jsx("td",{colSpan:2,className:"px-1 py-1 border border-black"})]})})]}),e.jsx("div",{className:"mt-1 mb-4 text-[9px]",children:e.jsxs("span",{children:["(",d("totalAmountInWords"),"): ",l.totalValueInWords]})}),e.jsx("div",{className:"flex-grow"}),e.jsxs("footer",{className:"flex flex-col items-center justify-end text-center mt-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("p",{className:"font-bold text-xs mb-8",children:e.jsx("u",{children:d("theResponsible")})})}),e.jsxs("div",{className:"w-full border-t border-black pt-1 mt-2 flex flex-col items-center",children:[e.jsxs("p",{className:"text-[8px] text-gray-600",children:[c.company.name," - ",c.company.address]}),e.jsxs("p",{className:"text-[8px] font-bold mt-0.5",children:["Page ",s+1,"/",r]})]})]})]})})},qk=({beneficiaryRows:t,pageIndex:n,totalPages:s,isLastPage:r,summaryData:l,denominations:c,data:d,periodName:u})=>{var w,C,T;const{settings:h}=$e(),{t:m}=je(),f=N.useMemo(()=>{var E;return((E=Vt.find(R=>R.code===h.localization.country))==null?void 0:E.name)||h.localization.country},[h.localization.country]),v=(w=d.headerInfo.find(E=>E.label===m("site")))==null?void 0:w.value,x=(C=d.headerInfo.find(E=>E.label===m("seaweedType")))==null?void 0:C.value,S=(T=d.headerInfo.find(E=>E.label===m("date")))==null?void 0:T.value;return e.jsx(gs,{landscape:!0,children:e.jsxs("div",{className:"h-full flex flex-col text-[9px] text-black bg-white font-sans",children:[e.jsxs("header",{className:"mb-2",children:[e.jsxs("div",{className:"grid grid-cols-4 items-start",children:[e.jsx("div",{className:"col-span-1",children:h.company.logoUrl&&e.jsx("img",{src:h.company.logoUrl,alt:"Company Logo",className:"h-12 w-auto object-contain"})}),e.jsxs("div",{className:"col-span-2 text-center",children:[e.jsx("h1",{className:"font-bold text-sm uppercase mb-0.5",children:h.company.name}),e.jsxs("div",{className:"text-[8px] leading-none space-y-0 text-gray-700 flex flex-wrap justify-center gap-x-2",children:[e.jsxs("span",{children:[m("capital"),": ",Ae(h.company.capital,h.localization)]}),e.jsxs("span",{children:[m("address"),": ",h.company.address]}),e.jsxs("span",{children:[m("nif"),": ",h.company.nif]}),e.jsxs("span",{children:[m("stat"),": ",h.company.stat]}),e.jsxs("span",{children:[m("rc"),": ",h.company.rc]}),e.jsxs("span",{children:[m("phone"),": ",h.company.phone]}),e.jsxs("span",{children:[m("email"),": ",h.company.email]}),e.jsxs("span",{children:[m("country"),": ",f]})]})]}),e.jsx("div",{className:"col-span-1"})]}),e.jsx("div",{className:"text-center mt-1 mb-2",children:e.jsx("h2",{className:"text-sm font-bold uppercase underline decoration-2",children:m("denominationBreakdown")})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 mb-2",children:[e.jsx(Tn,{label:`${m("exploitationSite")}:`,children:v}),e.jsx(Tn,{label:`${m("seaweedType")}:`,children:x}),e.jsx(Tn,{label:`${m("deliveryPeriod")}:`,children:u}),e.jsx(Tn,{label:`${m("dateLabel")} du paiement:`,children:S})]}),e.jsx("h3",{className:"font-bold text-[10px] my-1",children:m("breakdownByBeneficiary")}),e.jsxs("table",{className:"w-full border-collapse border border-black text-[9px] text-black",children:[e.jsx("thead",{className:"font-bold bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-1 py-1 border border-black",children:"Beneficiary"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Net Payable"}),c.map(E=>e.jsx("th",{className:"p-1 border border-black font-normal whitespace-nowrap",style:{fontSize:"8px"},children:Ae(E.value,h.localization)},E.id))]})}),e.jsx("tbody",{children:t.map((E,R)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-1 py-0.5 border border-black truncate max-w-[120px]",children:E.beneficiaryName}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right font-semibold",children:Ae(E.netAmount,h.localization)}),c.map(_=>e.jsx("td",{className:"px-1 py-0.5 border border-black text-center",children:E.breakdown[_.value]||""},_.id))]},R))})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-bold text-[10px] my-1 mt-4",children:m("summaryTable")}),e.jsxs("table",{className:"w-1/3 border-collapse border border-black text-[9px] text-black",children:[e.jsx("thead",{className:"font-bold bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-1 py-1 border border-black",children:"Denomination"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Quantity"}),e.jsx("th",{className:"px-1 py-1 border border-black",children:"Amount"})]})}),e.jsx("tbody",{children:l.map(E=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:Ae(E.value,h.localization)}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-center",children:E.count}),e.jsx("td",{className:"px-1 py-0.5 border border-black text-right",children:Ae(E.total,h.localization)})]},E.value))}),e.jsx("tfoot",{className:"font-bold bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"px-1 py-1 border border-black text-right",children:m("total")}),e.jsx("td",{className:"px-1 py-1 border border-black text-right",children:Ae(d.totalValue,h.localization)})]})})]})]}),e.jsx("div",{className:"flex-grow"}),e.jsxs("footer",{className:"flex flex-col items-center justify-end text-center mt-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("p",{className:"font-bold text-xs mb-8",children:e.jsx("u",{children:m("theResponsible")})})}),e.jsxs("div",{className:"w-full border-t border-black pt-1 mt-2 flex flex-col items-center",children:[e.jsxs("p",{className:"text-[8px] text-gray-600",children:[h.company.name," - ",h.company.address]}),e.jsxs("p",{className:"text-[8px] font-bold mt-0.5",children:["Page ",n+1,"/",s]})]})]})]})})},Vk=({data:t,autoDownload:n})=>{const{t:s}=je(),{settings:r}=$e(),[l,c]=N.useState(!1),d=N.useRef(!1),u=30,h=25,m=N.useMemo(()=>{switch(t.beneficiaryTypeLabel){case s("farmer"):return Ey;case s("provider"):return Hk;default:return Ey}},[t.beneficiaryTypeLabel,s]),f=N.useMemo(()=>{if(t.rows.length===0)return[[]];const D=[];for(let M=0;M<t.rows.length;M+=u)D.push(t.rows.slice(M,M+u));return D},[t.rows]),v=f.length,x=N.useMemo(()=>[...r.localization.denominations].sort((D,M)=>M.value-D.value),[r.localization.denominations]),S=N.useMemo(()=>t.rows.map(D=>{let M=D.netAmount;const I={};return x.forEach(O=>{const A=Math.floor(M/O.value);A>0&&(I[O.value]=A,M-=A*O.value,M=parseFloat(M.toFixed(r.localization.monetaryDecimals)))}),{beneficiaryName:D.beneficiaryName,netAmount:D.netAmount,breakdown:I}}),[t.rows,x,r.localization.monetaryDecimals]),w=N.useMemo(()=>{const D=new Map;return x.forEach(M=>D.set(M.value,{count:0,total:0})),S.forEach(M=>{for(const[I,O]of Object.entries(M.breakdown)){const A=parseFloat(I),U=D.get(A);U&&(U.count+=O,U.total+=O*A)}}),Array.from(D.entries()).map(([M,I])=>({value:M,...I})).filter(M=>M.count>0).sort((M,I)=>I.value-M.value)},[S,x]),C=N.useMemo(()=>{if(S.length===0)return[[]];const D=[];for(let M=0;M<S.length;M+=h)D.push(S.slice(M,M+h));return D},[S]),T=C.length,E=()=>{window.print()},R=N.useCallback(async()=>{if(!l){c(!0),document.body.classList.add("generating-pdf");try{const{jsPDF:D}=window.jspdf,M=window.html2canvas,I=document.getElementById("printable-area");if(!I)throw new Error("Printable area not found");const O=new D({orientation:"l",unit:"mm",format:"a4",compress:!0});O.setProperties({title:t.title,subject:"Payment Sheet",author:r.company.name,creator:"AlgaManage"});const A=I.getElementsByClassName("print-page");for(let U=0;U<A.length;U++){const F=(await M(A[U],{scale:4,useCORS:!0,windowWidth:1920,backgroundColor:"#ffffff"})).toDataURL("image/png");U>0&&O.addPage();const q=O.getImageProperties(F),z=O.internal.pageSize.getWidth(),J=q.height*z/q.width;O.addImage(F,"PNG",0,0,z,J,void 0,"FAST")}O.save(`PaymentSheet-${t.title.replace(/ /g,"_")}-${t.periodName.replace(/ /g,"_")}.pdf`)}catch(D){console.error("Error generating PDF:",D),alert(s("pdfGenerationError"))}finally{document.body.classList.remove("generating-pdf"),c(!1)}}},[l,t.title,t.periodName,s,r.company.name]);N.useEffect(()=>{n&&!d.current&&(d.current=!0,setTimeout(()=>{R()},500))},[n,R]);const _=m;return e.jsxs("div",{children:[e.jsx("div",{className:"fixed bottom-6 right-6 z-[1100] no-print flex gap-3",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-full shadow-xl border border-gray-200 dark:border-gray-700 flex gap-2 animate-in fade-in slide-in-from-bottom-4",children:[e.jsxs(se,{onClick:R,disabled:l,className:"rounded-full !px-4 shadow-sm",children:[e.jsx(te,{name:l?"Activity":"Download",className:`w-5 h-5 ${l?"animate-spin":""}`}),e.jsx("span",{className:"ml-2",children:s(l?"downloading":"downloadPdf")})]}),e.jsxs(se,{onClick:E,variant:"primary",className:"rounded-full !px-4 shadow-md",children:[e.jsx(te,{name:"Printer",className:"w-5 h-5"}),e.jsx("span",{className:"ml-2",children:s("print")})]})]})}),e.jsxs("div",{id:"printable-area",className:"text-black font-sans text-sm bg-gray-200 p-4 sm:p-8",children:[f.map((D,M)=>e.jsx(_,{rows:D,periodName:t.periodName,pageIndex:M,totalPages:v+T,data:t},`main-page-${M}`)),C.map((D,M)=>e.jsx(qk,{beneficiaryRows:D,pageIndex:v+M,totalPages:v+T,isLastPage:M===T-1,summaryData:w,denominations:x,data:t,periodName:t.periodName},`breakdown-page-${M}`))]})]})},Kk=async t=>new Promise(n=>{setTimeout(()=>{if(Math.random()>.1){const r=`TXN-${Date.now().toString(36).toUpperCase()}-${Math.floor(Math.random()*1e4)}`;n({success:!0,transactionId:r})}else n({success:!1,message:"Transaction failed: Insufficient funds or network timeout."})},2e3)}),$k=({data:t})=>{var d;const{settings:n}=$e(),{t:s,language:r}=je();N.useMemo(()=>{var u;return((u=Vt.find(h=>h.code===n.localization.country))==null?void 0:u.name)||n.localization.country},[n.localization.country]);const l=new Date(t.payment.date).toLocaleDateString(r==="fr"?"fr-FR":"en-GB"),c=t.payment.id.includes("pay-")?`PAY-${(d=t.payment.id.split("-").pop())==null?void 0:d.substring(0,6).toUpperCase()}`:`PAY-${t.payment.id.substring(0,8).toUpperCase()}`;return e.jsx(gs,{children:e.jsxs("div",{className:"max-w-xl mx-auto border border-gray-400 p-6 bg-white",children:[e.jsxs("header",{className:"flex justify-between items-start mb-6 border-b pb-4",children:[e.jsxs("div",{children:[e.jsx("img",{src:n.company.logoUrl,alt:"Logo",className:"h-12 mb-2 object-contain"}),e.jsx("h1",{className:"font-bold text-sm uppercase",children:n.company.name}),e.jsx("p",{className:"text-[10px] text-gray-600",children:n.company.address}),e.jsxs("p",{className:"text-[10px] text-gray-600",children:[s("phone"),": ",n.company.phone]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h2",{className:"text-xl font-bold uppercase",children:s("payslip")}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s("receiptNo"),": ",c]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s("dateLabel"),": ",l]})]})]}),e.jsx("section",{className:"mb-6 bg-gray-50 p-3 rounded border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-gray-500 uppercase",children:s("farmer")}),e.jsxs("span",{className:"font-bold",children:[t.farmer.firstName," ",t.farmer.lastName]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-gray-500 uppercase",children:s("code")}),e.jsx("span",{className:"font-mono",children:t.farmer.code})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-gray-500 uppercase",children:s("site")}),e.jsx("span",{children:t.siteName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-gray-500 uppercase",children:s("period")}),e.jsx("span",{children:t.payment.period})]})]})}),e.jsxs("section",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-bold uppercase border-b border-gray-300 mb-2 pb-1",children:s("paymentDetails")}),e.jsxs("table",{className:"w-full text-xs mb-4",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-1",children:s("description")}),e.jsx("th",{className:"text-right py-1",children:s("weightKg")}),e.jsx("th",{className:"text-right py-1",children:s("unitPrice")}),e.jsx("th",{className:"text-right py-1",children:s("amount")})]})}),e.jsxs("tbody",{children:[t.grossDetails.map((u,h)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-1",children:u.description}),e.jsx("td",{className:"text-right py-1",children:u.weight?Fe(u.weight,n.localization):"-"}),e.jsx("td",{className:"text-right py-1",children:u.unitPrice?Ae(u.unitPrice,n.localization):"-"}),e.jsx("td",{className:"text-right py-1",children:Ae(u.amount,n.localization)})]},h)),e.jsxs("tr",{className:"font-bold bg-gray-50",children:[e.jsx("td",{colSpan:3,className:"py-2 text-right",children:s("grossAmount")}),e.jsx("td",{className:"py-2 text-right",children:Ae(t.totalGross,n.localization)})]})]})]}),t.deductions.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-sm font-bold uppercase border-b border-gray-300 mb-2 pb-1 text-red-600",children:s("deductions")}),e.jsx("table",{className:"w-full text-xs mb-4",children:e.jsxs("tbody",{children:[t.deductions.map((u,h)=>e.jsxs("tr",{className:"border-b border-gray-100 text-red-600",children:[e.jsx("td",{className:"py-1",children:u.description}),e.jsxs("td",{className:"text-right py-1",children:["-",Ae(u.amount,n.localization)]})]},h)),e.jsxs("tr",{className:"font-bold bg-red-50 text-red-700",children:[e.jsx("td",{className:"py-2 text-right",children:s("totalDeductions")}),e.jsxs("td",{className:"py-2 text-right",children:["-",Ae(t.totalDeductions,n.localization)]})]})]})})]})]}),e.jsxs("section",{className:"mb-8 bg-blue-50 p-4 rounded border border-blue-200 flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-blue-900 uppercase",children:s("netPaid")}),e.jsx("span",{className:"text-2xl font-bold text-blue-900",children:Ae(t.netPaid,n.localization)})]}),e.jsxs("section",{className:"mb-8 text-xs text-gray-600",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[s("paymentMethod"),":"]})," ",s(`paymentMethod_${t.payment.method}`)]}),t.payment.method==="mobile_money"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[s("mobileMoneyRef"),":"]})," ",t.payment.transactionId||"N/A"]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[s("phone"),":"]})," ",t.payment.phoneNumber]})]}),t.payment.notes&&e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[s("notes"),":"]})," ",t.payment.notes]})]}),e.jsxs("footer",{className:"flex justify-between text-xs mt-12 pt-4 border-t border-gray-300",children:[e.jsxs("div",{className:"text-center w-1/3",children:[e.jsx("p",{className:"font-bold mb-8",children:s("paidBy")}),e.jsx("p",{children:n.company.name})]}),e.jsxs("div",{className:"text-center w-1/3",children:[e.jsx("p",{className:"font-bold mb-8",children:s("receivedBy")}),e.jsxs("p",{children:[t.farmer.firstName," ",t.farmer.lastName]})]})]})]})})},Wk=(t,n,s)=>{try{const[r,l]=t.split("-").map(Number);return new Date(r,l-1).toLocaleDateString(n,{month:"long",year:"numeric"})}catch{return t}},Yk=()=>null,dc=({onSelectAll:t,allSelected:n,header:s,children:r,footer:l})=>e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-4",children:e.jsx(jt,{checked:n,onChange:c=>t(c.target.checked)})}),s]})}),e.jsx("tbody",{children:r}),l&&e.jsx("tfoot",{className:"bg-gray-100 dark:bg-gray-800 font-bold border-t-2 border-gray-200 dark:border-gray-600",children:l})]}),Jk=({payees:t,onSelectOne:n,onSelectAll:s,allSelected:r,onUpdate:l})=>{const{t:c}=je(),{settings:d}=$e(),u=N.useMemo(()=>t.filter(h=>h.selected).reduce((h,m)=>({weight:h.weight+m.netWeightKg,base:h.base+m.baseAmount,deduction:h.deduction+m.deduction,net:h.net+m.netAmount}),{weight:0,base:0,deduction:0,net:0}),[t]);return e.jsx(dc,{onSelectAll:s,allSelected:r,header:e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-3",children:c("farmer")}),e.jsx("th",{className:"p-3 text-right",children:c("netWeightKg")}),e.jsx("th",{className:"p-3 text-right",children:c("wetPrice")}),e.jsx("th",{className:"p-3 text-right",children:c("baseAmount")}),e.jsx("th",{className:"p-3 text-right",children:c("adjustment")}),e.jsx("th",{className:"p-3 text-right",children:c("creditDeduction")}),e.jsx("th",{className:"p-3 text-right font-bold",children:c("netPayable")})]}),footer:e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"p-3 text-right uppercase",children:c("total")}),e.jsx("td",{className:"p-3 text-right",children:Fe(u.weight,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:"-"}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.base,d.localization)}),e.jsx("td",{className:"p-2 text-right",children:"-"}),e.jsx("td",{className:"p-3 text-right text-red-600",children:Ae(u.deduction,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.net,d.localization)})]}),children:t.map(h=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:h.selected,onChange:m=>n(h.id,m.target.checked)})}),e.jsx("td",{className:"p-3",children:h.name}),e.jsx("td",{className:"p-3 text-right",children:Fe(h.netWeightKg,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.wetPrice,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.baseAmount,d.localization)}),e.jsx("td",{className:"p-2 text-right",children:e.jsx(de,{type:"number",value:h.adjustment,onChange:m=>l(h.id,"adjustment",m.target.value),className:"text-right !py-1"})}),e.jsx("td",{className:"p-3 text-right text-red-600",children:Ae(h.deduction,d.localization)}),e.jsx("td",{className:"p-3 text-right font-bold",children:Ae(h.netAmount,d.localization)})]},h.id))})},Xk=({payees:t,onSelectOne:n,onSelectAll:s,allSelected:r,onUpdate:l})=>{const{t:c}=je(),{settings:d}=$e(),u=N.useMemo(()=>t.filter(h=>h.selected).reduce((h,m)=>({weight:h.weight+m.totalWeightKg,base:h.base+m.baseAmount,deduction:h.deduction+m.deduction,net:h.net+m.netAmount}),{weight:0,base:0,deduction:0,net:0}),[t]);return e.jsx(dc,{onSelectAll:s,allSelected:r,header:e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-3",children:c("farmer")}),e.jsx("th",{className:"p-3 text-right",children:c("totalWeightKg")}),e.jsx("th",{className:"p-3 text-right",children:c("dryPrice")}),e.jsx("th",{className:"p-3 text-right",children:c("baseAmount")}),e.jsx("th",{className:"p-3 text-right",children:c("adjustment")}),e.jsx("th",{className:"p-3 text-right",children:c("creditDeduction")}),e.jsx("th",{className:"p-3 text-right font-bold",children:c("netPayable")})]}),footer:e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"p-3 text-right uppercase",children:c("total")}),e.jsx("td",{className:"p-3 text-right",children:Fe(u.weight,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:"-"}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.base,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:"-"}),e.jsx("td",{className:"p-3 text-right text-red-600",children:Ae(u.deduction,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.net,d.localization)})]}),children:t.map(h=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:h.selected,onChange:m=>n(h.id,m.target.checked)})}),e.jsx("td",{className:"p-3",children:h.name}),e.jsx("td",{className:"p-3 text-right",children:Fe(h.totalWeightKg,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.dryPrice,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.baseAmount,d.localization)}),e.jsx("td",{className:"p-2 text-right",children:e.jsx(de,{type:"number",value:h.adjustment,onChange:m=>l(h.id,"adjustment",m.target.value),className:"text-right !py-1"})}),e.jsx("td",{className:"p-3 text-right text-red-600",children:Ae(h.deduction,d.localization)}),e.jsx("td",{className:"p-3 text-right font-bold",children:Ae(h.netAmount,d.localization)})]},h.id))})},Qk=({payees:t,onSelectOne:n,onSelectAll:s,allSelected:r,onUpdate:l})=>{const{t:c}=je(),{settings:d}=$e(),u=N.useMemo(()=>t.filter(h=>h.selected).reduce((h,m)=>({lines:h.lines+m.totalLines,base:h.base+m.baseAmount,net:h.net+m.netAmount}),{lines:0,base:0,net:0}),[t]);return e.jsx(dc,{onSelectAll:s,allSelected:r,header:e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-3",children:c("serviceDate")}),e.jsx("th",{className:"p-3",children:c("serviceProvider")}),e.jsx("th",{className:"p-3 text-right",children:c("numberOfLines")}),e.jsx("th",{className:"p-3 text-right",children:c("baseAmount")}),e.jsx("th",{className:"p-3 text-right",children:c("adjustment")}),e.jsx("th",{className:"p-3 text-right font-bold",children:c("netPayable")})]}),footer:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"p-3 text-right uppercase",children:c("total")}),e.jsx("td",{className:"p-3 text-right",children:u.lines}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.base,d.localization)}),e.jsx("td",{className:"p-2 text-right",children:"-"}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.net,d.localization)})]}),children:t.map(h=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:h.selected,onChange:m=>n(h.id,m.target.checked)})}),e.jsx("td",{className:"p-3",children:h.date}),e.jsx("td",{className:"p-3",children:h.name}),e.jsx("td",{className:"p-3 text-right",children:h.totalLines}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.baseAmount,d.localization)}),e.jsx("td",{className:"p-2 text-right",children:e.jsx(de,{type:"number",value:h.adjustment,onChange:m=>l(h.id,"adjustment",m.target.value),className:"text-right !py-1"})}),e.jsx("td",{className:"p-3 text-right font-bold",children:Ae(h.netAmount,d.localization)})]},h.id))})},Zk=({payees:t,onSelectOne:n,onSelectAll:s,allSelected:r,onUpdate:l})=>{const{t:c}=je(),{settings:d}=$e(),u=N.useMemo(()=>t.filter(h=>h.selected).reduce((h,m)=>({base:h.base+m.baseSalary,gross:h.gross+m.totalGross,deduction:h.deduction+m.totalDeductions,net:h.net+m.netPay}),{base:0,gross:0,deduction:0,net:0}),[t]);return e.jsx(dc,{onSelectAll:s,allSelected:r,header:e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-3",children:c("employee")}),e.jsx("th",{className:"p-3 text-right",children:c("grossSalary")}),e.jsx("th",{className:"p-3 w-32 text-right",children:c("bonuses")}),e.jsx("th",{className:"p-3 w-32 text-right",children:c("overtime")}),e.jsx("th",{className:"p-3 text-right",children:c("totalGross")}),e.jsx("th",{className:"p-3 text-right",children:c("totalDeductions")}),e.jsx("th",{className:"p-3 text-right font-bold",children:c("netPay")})]}),footer:e.jsxs("tr",{children:[e.jsx("td",{colSpan:2,className:"p-3 text-right uppercase",children:c("total")}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.base,d.localization)}),e.jsx("td",{className:"p-2 text-right",children:"-"}),e.jsx("td",{className:"p-2 text-right",children:"-"}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.gross,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.deduction,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(u.net,d.localization)})]}),children:t.map(h=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:h.selected,onChange:m=>n(h.id,m.target.checked)})}),e.jsx("td",{className:"p-3",children:h.name}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.baseSalary,d.localization)}),e.jsx("td",{className:"p-2 text-right",children:e.jsx(de,{type:"number",value:h.bonuses,onChange:m=>l(h.id,"bonuses",m.target.value),className:"text-right !py-1"})}),e.jsx("td",{className:"p-2 text-right",children:e.jsx(de,{type:"number",value:h.overtime,onChange:m=>l(h.id,"overtime",m.target.value),className:"text-right !py-1"})}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.totalGross,d.localization)}),e.jsx("td",{className:"p-3 text-right",children:Ae(h.totalDeductions,d.localization)}),e.jsx("td",{className:"p-3 text-right font-bold",children:Ae(h.netPay,d.localization)})]},h.id))})},e1=({onCancel:t,onConfirmSuccess:n,config:s})=>{const{t:r,language:l}=je(),{settings:c}=$e(),{farmers:d,sites:u,seaweedTypes:h,cultivationCycles:m,modules:f,farmerCredits:v,repayments:x,farmerDeliveries:S,cuttingOperations:w,serviceProviders:C,employees:T,addMultipleMonthlyPayments:E,addMultipleRepayments:R,updateMultipleCuttingOperations:_,markCyclesAsPaid:D,markDeliveriesAsPaid:M}=qe(),[I,O]=N.useState([]),[A,U]=N.useState({enabled:!0,type:"percentage",value:100}),[P,F]=N.useState(!1),[q,z]=N.useState(!1),[J,W]=N.useState(!1),[G,B]=N.useState(null),X=N.useCallback(()=>{var Ke;let fe=[];const{paymentType:Q,startDate:ee,endDate:ye,siteId:Le,seaweedTypeId:ke}=s,Re=ze=>{const Se=v.filter(be=>be.farmerId===ze).reduce((be,xe)=>be+xe.totalAmount,0),Oe=x.filter(be=>be.farmerId===ze).reduce((be,xe)=>be+xe.amount,0);return Se-Oe};if(Q==="farmer_wet")fe=d.filter(Se=>Le==="all"||Se.siteId===Le).map(Se=>{var Et;const Oe=m.filter(ot=>{const Pt=f.find(wt=>wt.id===ot.moduleId);return(Pt==null?void 0:Pt.farmerId)===Se.id&&ot.harvestDate&&ot.harvestDate>=ee&&ot.harvestDate<=ye&&!ot.paymentRunId&&(ke==="all"||ot.seaweedTypeId===ke)});if(Oe.length===0)return null;const be=Oe.reduce((ot,Pt)=>{var Kt;const wt=(Pt.harvestedWeight||0)-(Pt.cuttingsTakenAtHarvestKg||0),gt=((Kt=h.find(bs=>bs.id===Pt.seaweedTypeId))==null?void 0:Kt.wetPrice)||0;return ot+wt*gt},0),xe=Oe.reduce((ot,Pt)=>ot+((Pt.harvestedWeight||0)-(Pt.cuttingsTakenAtHarvestKg||0)),0),Ue=xe>0?be/xe:0;return{id:Se.id,type:qt.FARMER,name:`${Se.firstName} ${Se.lastName}`,siteName:((Et=u.find(ot=>ot.id===Se.siteId))==null?void 0:Et.name)||"",baseAmount:be,adjustment:0,deduction:0,netAmount:be,creditBalance:Re(Se.id),selected:!0,cycleIds:Oe.map(ot=>ot.id),harvestedWeightKg:Oe.reduce((ot,Pt)=>ot+(Pt.harvestedWeight||0),0),cuttingsWeightKg:Oe.reduce((ot,Pt)=>ot+(Pt.cuttingsTakenAtHarvestKg||0),0),netWeightKg:xe,wetPrice:Ue}}).filter(Se=>Se!==null&&Se.baseAmount>0);else if(Q==="farmer_dry"){const ze=d.filter(Oe=>Le==="all"||Oe.siteId===Le),Se=new Map(h.map(Oe=>[Oe.id,Oe.dryPrice]));fe=ze.map(Oe=>{var Pt;const be=S.filter(wt=>wt.farmerId===Oe.id&&wt.date>=ee&&wt.date<=ye&&!wt.paymentRunId&&(ke==="all"||wt.seaweedTypeId===ke));if(be.length===0)return null;const xe=be.reduce((wt,gt)=>{const Kt=Se.get(gt.seaweedTypeId)||0;return wt+gt.totalWeightKg*Kt},0),Ue=be.reduce((wt,gt)=>wt+gt.totalWeightKg,0),Ze=be.reduce((wt,gt)=>wt+gt.totalBags,0),Et=be.length>0&&Ue>0?xe/Ue:0;return{id:Oe.id,type:qt.FARMER,name:`${Oe.firstName} ${Oe.lastName}`,siteName:((Pt=u.find(wt=>wt.id===Oe.siteId))==null?void 0:Pt.name)||"",totalWeightKg:Ue,dryPrice:Et,baseAmount:xe,totalBags:Ze,adjustment:0,deduction:0,netAmount:xe,creditBalance:Re(Oe.id),selected:!0,deliveryIds:be.map(wt=>wt.id)}}).filter(Oe=>Oe!==null&&Oe.baseAmount>0)}else if(Q==="service_provider")fe=w.filter(Se=>!Se.isPaid&&Se.date>=ee&&Se.date<=ye&&(Le==="all"||Se.siteId===Le)&&(ke==="all"||Se.seaweedTypeId===ke)).map(Se=>{const Oe=C.find(Ue=>Ue.id===Se.serviceProviderId),be=Se.moduleCuts.reduce((Ue,Ze)=>Ue+Ze.linesCut,0);return{id:Se.id,serviceProviderId:Se.serviceProviderId,type:qt.SERVICE_PROVIDER,name:(Oe==null?void 0:Oe.name)||"Unknown",date:Se.date,unpaidOperations:1,baseAmount:Se.totalAmount,adjustment:0,deduction:0,netAmount:Se.totalAmount,selected:!0,operationIds:[Se.id],totalLines:be,averageUnitPrice:Se.unitPrice}}).filter(Se=>Se!==null&&Se.baseAmount>0);else if(Q==="employee_payroll"){if(!((Ke=Vt.find(Oe=>Oe.code===c.localization.country))==null?void 0:Ke.payroll)){alert(r("alert_noPayrollConfig"));return}fe=T.filter(Oe=>Le==="all"||Oe.siteId===Le).map(Oe=>{var Ue;const be=nl(Oe.grossWage,0,0,0,c.localization);return{id:Oe.id,type:qt.EMPLOYEE,name:`${Oe.firstName} ${Oe.lastName}`,siteName:((Ue=u.find(Ze=>Ze.id===Oe.siteId))==null?void 0:Ue.name)||"",selected:!0,baseAmount:be.totalGross,deduction:be.totalDeductions,netAmount:be.netPay,...be}})}O(fe)},[s,d,u,h,m,f,v,x,S,w,C,T,c.localization,r]);N.useEffect(()=>{X()},[X]);const $=(fe,Q,ee)=>{const ye=parseFloat(ee)||0;O(Le=>Le.map(ke=>{if(ke.id===fe){if(ke.type===qt.EMPLOYEE){const Re={...ke,[Q]:ye},Ke=nl(Re.baseSalary,Re.bonuses,Re.overtime,Re.otherDeductions,c.localization);return{...Re,...Ke,baseAmount:Ke.totalGross,deduction:Ke.totalDeductions,netAmount:Ke.netPay}}else if("adjustment"in ke){const Re=ke.baseAmount-ke.adjustment+ye;return{...ke,adjustment:ye,netAmount:Re-ke.deduction}}}return ke}))};N.useEffect(()=>{O(fe=>fe.map(Q=>{if(Q.type===qt.FARMER&&Q.selected){let ee=0;const ye=Q.baseAmount+Q.adjustment;return A.enabled&&Q.creditBalance&&Q.creditBalance>0&&(A.type==="percentage"?ee=ye*A.value/100:ee=A.value,ee=Math.min(ee,ye,Q.creditBalance)),{...Q,deduction:ee,netAmount:ye-ee}}return Q}))},[A,I.map(fe=>fe.baseAmount+(fe.type!==qt.EMPLOYEE?fe.adjustment:0)).join(",")]);const ae=fe=>{U(fe)},H=(fe,Q)=>{O(ee=>ee.map(ye=>ye.id===fe?{...ye,selected:Q}:ye))},ie=fe=>{O(Q=>Q.map(ee=>({...ee,selected:fe})))},ue=I.filter(fe=>fe.selected),Ne=I.length>0&&ue.length===I.length,oe=N.useMemo(()=>ue.reduce((fe,Q)=>(fe.base+=Q.baseAmount+(Q.type!==qt.EMPLOYEE?Q.adjustment:0),fe.deduction+=Q.deduction,fe.net+=Q.netAmount,fe),{base:0,deduction:0,net:0}),[ue]),ne=()=>{const fe=`pr-${Date.now()}`,Q=new Date().toISOString().split("T")[0],ee=[],ye=[],Le=[],ke=[],Re=[];ue.forEach(Ke=>{Ke.netAmount<=0&&Ke.deduction<=0||(Ke.netAmount>0&&ee.push({date:Q,period:s.periodName,recipientType:Ke.type,recipientId:Ke.serviceProviderId||Ke.id,amount:Ke.netAmount,method:"cash",notes:`Payment for period: ${s.startDate} to ${s.endDate}`,paymentRunId:fe,paymentStatus:"PENDING"}),"deduction"in Ke&&Ke.deduction>0&&Ke.type===qt.FARMER&&ye.push({date:Q,farmerId:Ke.id,amount:Ke.deduction,method:"harvest_deduction",notes:`Deduction from payment run: ${s.periodName}`,paymentRunId:fe}),Ke.type===qt.SERVICE_PROVIDER&&"operationIds"in Ke?Le.push(...Ke.operationIds):s.paymentType==="farmer_wet"&&"cycleIds"in Ke?ke.push(...Ke.cycleIds):s.paymentType==="farmer_dry"&&"deliveryIds"in Ke&&Re.push(...Ke.deliveryIds))}),ee.length>0&&E(ee),ye.length>0&&R(ye),Le.length>0&&_(Le,Q),ke.length>0&&D(ke,fe),Re.length>0&&M(Re,fe),n()},we=()=>{var Re,Ke;let fe="",Q="",ee=[];switch(s.paymentType){case"farmer_wet":fe=r("wetDeliveryPaymentSheetTitle"),Q=r("farmer"),ee=[{key:"name",label:r("farmer"),width:"25%"},{key:"harvestedWeightKg",label:r("harvestedWeightKg"),align:"right",format:"number",width:"12%"},{key:"cuttingsWeightKg",label:r("cuttingsWeightKg"),align:"right",format:"number",width:"12%"},{key:"netWeightKg",label:r("netWeightKg"),align:"right",format:"number",width:"12%"},{key:"wetPrice",label:r("wetPrice"),align:"right",format:"currency",width:"10%"},{key:"baseAmount",label:r("baseAmount"),align:"right",format:"currency",width:"12%"},{key:"deduction",label:r("creditDeduction"),align:"right",format:"currency",width:"12%"},{key:"netAmount",label:r("netPayable"),align:"right",format:"currency",width:"15%"}];break;case"farmer_dry":fe=r("dryDeliveryPaymentSheetTitle"),Q=r("farmer"),ee=[{key:"name",label:r("farmer"),width:"30%"},{key:"totalWeightKg",label:r("totalWeightKg"),align:"right",format:"number",width:"15%"},{key:"dryPrice",label:r("pricePerKg"),align:"right",format:"currency",width:"15%"},{key:"baseAmount",label:r("baseAmount"),align:"right",format:"currency",width:"15%"},{key:"deduction",label:r("creditDeduction"),align:"right",format:"currency",width:"15%"},{key:"netAmount",label:r("netPayable"),align:"right",format:"currency",width:"20%"}];break;case"service_provider":fe=r("cuttingPaymentSheetTitle"),Q=r("provider"),ee=[{key:"date",label:r("dateTrans"),width:"10%"},{key:"name",label:r("provider"),width:"30%"},{key:"totalLines",label:r("numberOfLines"),align:"right",format:"number",width:"15%"},{key:"averageUnitPrice",label:r("unitPrice"),align:"right",format:"currency",width:"15%"},{key:"netAmount",label:r("montantAPayer"),align:"right",format:"currency",width:"15%"}];break;case"employee_payroll":fe=r("employeePayroll"),Q=r("employee"),ee=[{key:"name",label:r("employee"),width:"25%"},{key:"baseSalary",label:r("grossSalary"),align:"right",format:"currency",width:"15%"},{key:"totalGross",label:r("totalGross"),align:"right",format:"currency",width:"15%"},{key:"totalDeductions",label:r("totalDeductions"),align:"right",format:"currency",width:"15%"},{key:"netPay",label:r("netPay"),align:"right",format:"currency",width:"15%"}];break}const ye=ue.reduce((ze,Se)=>ze+Se.netAmount,0),Le=s.seaweedTypeId!=="all"?(Re=h.find(ze=>ze.id===s.seaweedTypeId))==null?void 0:Re.name:r("various"),ke={title:fe,periodName:s.periodName,headerInfo:[{label:r("date"),value:new Date().toLocaleDateString(l)},{label:r("period"),value:`${s.startDate} - ${s.endDate}`},{label:r("site"),value:s.siteId==="all"?r("allSites"):(Ke=u.find(ze=>ze.id===s.siteId))==null?void 0:Ke.name},{label:r("seaweedType"),value:Le}],columns:ee,rows:ue.map(ze=>({beneficiaryName:ze.name,...ze})),totalLabel:r("totalToPay"),totalValue:ye,totalValueInWords:iv(ye,l,c.localization),denominations:c.localization.denominations,beneficiaryTypeLabel:Q,status:"Unpaid"};B(ke),W(!0)};return e.jsxs(Ge,{title:r("reviewPaymentRun"),children:[e.jsxs("p",{className:"mb-4",children:[s.periodName," (",s.startDate," to ",s.endDate,")"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:r("totalPayees")}),e.jsx("p",{className:"text-2xl font-bold",children:ue.length})]}),e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:r("totalBaseAmount")}),e.jsx("p",{className:"text-2xl font-bold",children:Ae(oe.base,c.localization)})]}),e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:r("totalDeductions")}),e.jsx("p",{className:"text-2xl font-bold",children:Ae(oe.deduction,c.localization)})]}),e.jsxs("div",{className:"p-4 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:r("totalNetPayable")}),e.jsx("p",{className:"text-2xl font-bold text-blue-800 dark:text-blue-200",children:Ae(oe.net,c.localization)})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex gap-4",children:[s.paymentType.startsWith("farmer")&&e.jsxs(se,{variant:"secondary",onClick:()=>F(!0),children:[e.jsx(te,{name:"Settings",className:"w-4 h-4"}),r("configureDeductions")]}),e.jsxs(se,{onClick:we,children:[e.jsx(te,{name:"Download",className:"w-4 h-4"}),r("downloadPdf")]}),e.jsxs(se,{onClick:()=>z(!0),disabled:ue.length===0,children:[e.jsx(te,{name:"Check",className:"w-4 h-4"}),r("confirmAndPay")]})]}),e.jsxs(se,{variant:"secondary",onClick:t,children:[e.jsx(te,{name:"ChevronLeft",className:"w-4 h-4"}),r("back")]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[s.paymentType==="farmer_wet"&&e.jsx(Jk,{payees:I,onSelectOne:H,onSelectAll:ie,allSelected:Ne,onUpdate:$}),s.paymentType==="farmer_dry"&&e.jsx(Xk,{payees:I,onSelectOne:H,onSelectAll:ie,allSelected:Ne,onUpdate:$}),s.paymentType==="service_provider"&&e.jsx(Qk,{payees:I,onSelectOne:H,onSelectAll:ie,allSelected:Ne,onUpdate:$}),s.paymentType==="employee_payroll"&&e.jsx(Zk,{payees:I,onSelectOne:H,onSelectAll:ie,allSelected:Ne,onUpdate:$})]}),G&&e.jsx(at,{isOpen:J,onClose:()=>W(!1),title:r("printDocuments"),widthClass:"max-w-screen-xl",children:e.jsx(Vk,{data:G})}),q&&e.jsx(Ut,{isOpen:q,onClose:()=>z(!1),onConfirm:ne,title:r("confirmPayment"),message:r("confirmPaymentMessage").replace("{count}",String(ue.length)),confirmText:r("confirm")}),P&&e.jsx(Yk,{isOpen:P,onClose:()=>F(!1),initialConfig:A,onSave:fe=>{ae(fe),F(!1)}})]})},t1=()=>{const{t,language:n}=je(),{settings:s}=$e(),{monthlyPayments:r,farmers:l,employees:c,serviceProviders:d,deleteMonthlyPayment:u,updateMonthlyPayment:h,repayments:m,cultivationCycles:f,farmerDeliveries:v,seaweedTypes:x,sites:S}=qe(),[w,C]=N.useState(!1),[T,E]=N.useState(null),[R,_]=N.useState(!1),[D,M]=N.useState(null),[I,O]=N.useState({key:"date",direction:"descending"}),[A,U]=N.useState(new Set),[P,F]=N.useState(!1),[q,z]=N.useState(null),J=N.useMemo(()=>{const oe=new Map;return l.forEach(ne=>oe.set(`${qt.FARMER}-${ne.id}`,`${ne.firstName} ${ne.lastName}`)),c.forEach(ne=>oe.set(`${qt.EMPLOYEE}-${ne.id}`,`${ne.firstName} ${ne.lastName}`)),d.forEach(ne=>oe.set(`${qt.SERVICE_PROVIDER}-${ne.id}`,ne.name)),oe},[l,c,d]),W=N.useMemo(()=>{let oe=[...r];return oe.sort((ne,we)=>{let fe,Q;return I.key==="recipientName"?(fe=J.get(`${ne.recipientType}-${ne.recipientId}`)||"",Q=J.get(`${we.recipientType}-${we.recipientId}`)||""):(fe=ne[I.key],Q=we[I.key]),fe<Q?I.direction==="ascending"?-1:1:fe>Q?I.direction==="ascending"?1:-1:0}),oe},[r,I,J]),G=oe=>{let ne="ascending";I.key===oe&&I.direction==="ascending"&&(ne="descending"),O({key:oe,direction:ne})},B=oe=>I.key!==oe?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):I.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),X=({sortKey:oe,label:ne})=>e.jsx("th",{className:"p-3",children:e.jsxs("button",{onClick:()=>G(oe),className:"group flex items-center gap-2 hover:text-blue-500 dark:hover:text-blue-400 transition-colors",children:[ne,B(oe)]})}),$=(oe=null)=>{E(oe),C(!0)},ae=oe=>{M(oe),_(!0)},H=()=>{D&&u(D),_(!1),M(null)},ie=async oe=>{if(!A.has(oe.id)){U(ne=>new Set(ne).add(oe.id)),h({...oe,paymentStatus:"PROCESSING"});try{const ne=await Kk(oe);ne.success?(h({...oe,paymentStatus:"COMPLETED",transactionId:ne.transactionId}),alert(`Payment Successful! Transaction ID: ${ne.transactionId}`)):(h({...oe,paymentStatus:"FAILED"}),alert(`Payment Failed: ${ne.message}`))}catch(ne){console.error("Payment processing error",ne),h({...oe,paymentStatus:"FAILED"}),alert("An unexpected error occurred.")}finally{U(ne=>{const we=new Set(ne);return we.delete(oe.id),we})}}},ue=oe=>{if(oe.recipientType!==qt.FARMER){alert("Only Farmer receipts are currently supported for detailed printing.");return}const ne=l.find(ze=>ze.id===oe.recipientId);if(!ne)return;const we=S.find(ze=>ze.id===ne.siteId),fe=oe.paymentRunId,Q=m.filter(ze=>ze.farmerId===ne.id&&ze.paymentRunId===fe),ee=[];f.filter(ze=>ze.paymentRunId===fe).forEach(ze=>{const Se=(ze.harvestedWeight||0)-(ze.cuttingsTakenAtHarvestKg||0),Oe=x.find(be=>be.id===ze.seaweedTypeId);ee.push({description:`Harvest: ${Oe==null?void 0:Oe.name} (${ze.harvestDate})`,weight:Se,unitPrice:Oe==null?void 0:Oe.wetPrice,amount:Se*((Oe==null?void 0:Oe.wetPrice)||0)})}),v.filter(ze=>ze.paymentRunId===fe).forEach(ze=>{const Se=x.find(Oe=>Oe.id===ze.seaweedTypeId);ee.push({description:`Delivery: ${Se==null?void 0:Se.name} (${ze.date})`,weight:ze.totalWeightKg,unitPrice:Se==null?void 0:Se.dryPrice,amount:ze.totalWeightKg*((Se==null?void 0:Se.dryPrice)||0)})}),ee.length===0&&ee.push({description:"Manual Payment / Adjustment",amount:oe.amount+Q.reduce((ze,Se)=>ze+Se.amount,0)});const ke=Q.map(ze=>({description:ze.notes||"Credit Repayment",amount:ze.amount})),Re=ee.reduce((ze,Se)=>ze+Se.amount,0),Ke=ke.reduce((ze,Se)=>ze+Se.amount,0);z({payment:oe,farmer:ne,siteName:(we==null?void 0:we.name)||"",grossDetails:ee,deductions:ke,totalGross:Re,totalDeductions:Ke,netPaid:oe.amount}),F(!0)},Ne=(oe,ne)=>{const we=`${oe}-${ne}`,fe=J.get(we);return fe||e.jsx("span",{className:"text-gray-500 italic",children:t("unknown")})};return e.jsxs(Ge,{title:t("paymentHistory"),children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx(X,{sortKey:"date",label:t("paymentDate")}),e.jsx(X,{sortKey:"period",label:t("period")}),e.jsx(X,{sortKey:"recipientName",label:t("recipient")}),e.jsx(X,{sortKey:"recipientType",label:t("recipientType")}),e.jsx("th",{className:"p-3 text-right",children:t("amount")}),e.jsx("th",{className:"p-3",children:t("paymentMethod")}),e.jsx("th",{className:"p-3",children:t("paymentStatus")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsx("tbody",{children:W.map(oe=>{const ne=A.has(oe.id);return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20",children:[e.jsx("td",{className:"p-3",children:oe.date}),e.jsx("td",{className:"p-3",children:Wk(oe.period,n)}),e.jsx("td",{className:"p-3 font-semibold",children:Ne(oe.recipientType,oe.recipientId)}),e.jsx("td",{className:"p-3",children:t(`recipientType_${oe.recipientType}`)}),e.jsx("td",{className:"p-3 text-right",children:Ae(oe.amount,s.localization)}),e.jsx("td",{className:"p-3",children:t(`paymentMethod_${oe.method}`)}),e.jsxs("td",{className:"p-3",children:[oe.paymentStatus?e.jsx(mn,{status:oe.paymentStatus}):"-",oe.transactionId&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-[100px]",title:oe.transactionId,children:oe.transactionId})]}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2 items-center",children:[oe.recipientType===qt.FARMER&&e.jsx(se,{variant:"ghost",onClick:()=>ue(oe),title:t("print"),children:e.jsx(te,{name:"Printer",className:"w-4 h-4"})}),oe.method==="mobile_money"&&(oe.paymentStatus==="PENDING"||oe.paymentStatus==="FAILED")&&e.jsx(se,{variant:"primary",className:"!py-1 !px-2 text-xs",onClick:()=>ie(oe),disabled:ne,children:ne?e.jsx(te,{name:"Activity",className:"w-3 h-3 animate-spin"}):t("payNow")}),e.jsx(se,{variant:"ghost",onClick:()=>$(oe),children:e.jsx(te,{name:"Settings",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",onClick:()=>ae(oe.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]},oe.id)})})]})}),w&&e.jsx(zk,{isOpen:w,onClose:()=>C(!1),payment:T}),R&&e.jsx(Ut,{isOpen:R,onClose:()=>_(!1),onConfirm:H,title:t("confirmDeletePayment"),message:t("confirmDeletePaymentMessage")}),q&&e.jsx(at,{isOpen:P,onClose:()=>F(!1),title:t("farmerReceipt"),widthClass:"max-w-screen-md",children:e.jsx($k,{data:q})})]})},n1=({onPrepare:t})=>{const{t:n}=je(),{sites:s,seaweedTypes:r}=qe(),[l,c]=N.useState({periodName:"",startDate:"",endDate:new Date().toISOString().split("T")[0],paymentType:"farmer_wet",siteId:"all",seaweedTypeId:"all"}),d=l.paymentType.startsWith("farmer")||l.paymentType==="service_provider";return e.jsxs(Ge,{title:n("paymentRunSetup"),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 items-end",children:[e.jsx(de,{label:n("periodName"),value:l.periodName,onChange:u=>c(h=>({...h,periodName:u.target.value})),placeholder:"e.g. July 2024 Payments",required:!0}),e.jsx(de,{label:n("startDate"),type:"date",value:l.startDate,onChange:u=>c(h=>({...h,startDate:u.target.value})),required:!0}),e.jsx(de,{label:n("endDate"),type:"date",value:l.endDate,onChange:u=>c(h=>({...h,endDate:u.target.value})),required:!0}),e.jsxs(De,{label:n("paymentType"),value:l.paymentType,onChange:u=>c(h=>({...h,paymentType:u.target.value})),children:[e.jsx("option",{value:"farmer_wet",children:n("wetDeliveryPayment")}),e.jsx("option",{value:"farmer_dry",children:n("dryDeliveryPayment")}),e.jsx("option",{value:"service_provider",children:n("serviceProviderPayment")}),e.jsx("option",{value:"employee_payroll",children:n("employeePayroll")})]}),e.jsxs(De,{label:n("site"),value:l.siteId,onChange:u=>c(h=>({...h,siteId:u.target.value})),children:[e.jsx("option",{value:"all",children:n("allSites")}),s.map(u=>e.jsx("option",{value:u.id,children:u.name},u.id))]}),d&&e.jsxs(De,{label:n("seaweedType"),value:l.seaweedTypeId,onChange:u=>c(h=>({...h,seaweedTypeId:u.target.value})),children:[e.jsx("option",{value:"all",children:n("allSeaweedTypes")}),r.map(u=>e.jsx("option",{value:u.id,children:u.name},u.id))]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(se,{onClick:()=>t(l),disabled:!l.periodName||!l.startDate||!l.endDate,children:n("preparePaymentRun")})})]})},s1=()=>{const{t}=je(),[n,s]=N.useState("setup"),[r,l]=N.useState(null),c=h=>{l(h),s("review")},d=()=>{l(null),s("setup")},u=()=>{alert(t("paymentsRecordedSuccess")),l(null),s("setup")};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:t("documentPaymentsTitle")}),n==="setup"&&e.jsx(n1,{onPrepare:c}),n==="review"&&r&&e.jsx(e1,{onCancel:d,onConfirmSuccess:u,config:r}),e.jsx("div",{className:"mt-8",children:e.jsx(t1,{})})]})},Lu=["PLANTING","PERIOD_1","PERIOD_2","PERIOD_3","PERIOD_4","PERIOD_5"],a1=({isOpen:t,onClose:n,test:s})=>{const{t:r}=je(),{sites:l,seaweedTypes:c,employees:d,addPeriodicTest:u,updatePeriodicTest:h,periodicTests:m}=qe(),[f,v]=N.useState({identity:"",date:new Date().toISOString().split("T")[0],siteId:"",seaweedTypeId:"",zoneId:"",period:"PLANTING",weightKg:0,growthRate:null,temperature:null,salinity:null,precipitation:null,windSpeed:null,windDirection:null,waveHeight:null,weatherDataSource:"manual",conductorId:""}),[x,S]=N.useState([]),[w,C]=N.useState({}),[T,E]=N.useState(!1),[R,_]=N.useState(null),D=N.useCallback(()=>{const A={};return f.identity.trim()||(A.identity=r("validationRequired")),f.date||(A.date=r("validationRequired")),f.siteId||(A.siteId=r("validationRequired")),f.seaweedTypeId||(A.seaweedTypeId=r("validationRequired")),f.zoneId||(A.zoneId=r("validationRequired")),f.conductorId||(A.conductorId=r("validationRequired")),(isNaN(f.weightKg)||f.weightKg<0)&&(A.weightKg=r("validationNonNegative")),A},[f,r]);N.useEffect(()=>{var A,U,P,F,q;v(s||{identity:"",date:new Date().toISOString().split("T")[0],siteId:((A=l[0])==null?void 0:A.id)||"",seaweedTypeId:((U=c[0])==null?void 0:U.id)||"",zoneId:((F=(P=l[0])==null?void 0:P.zones[0])==null?void 0:F.id)||"",period:"PLANTING",weightKg:0,growthRate:null,temperature:null,salinity:null,precipitation:null,windSpeed:null,windDirection:null,waveHeight:null,weatherDataSource:"manual",conductorId:((q=d[0])==null?void 0:q.id)||""}),C({}),E(!1),_(null)},[s,t,l,c,d]),N.useEffect(()=>{if(f.period==="PLANTING"||!f.identity||!f.date||f.weightKg<=0){f.growthRate!==null&&v(F=>({...F,growthRate:null}));return}const A=Lu.indexOf(f.period);if(A<=0)return;const U=Lu[A-1],P=m.find(F=>F.identity.toLowerCase()===f.identity.toLowerCase()&&F.period===U&&F.siteId===f.siteId);if(P&&P.weightKg>0&&P.date){const F=new Date(P.date).getTime(),z=(new Date(f.date).getTime()-F)/(1e3*60*60*24);if(z>0){const J=P.weightKg,W=f.weightKg,G=(Math.log(W)-Math.log(J))/z*100,B=parseFloat(G.toFixed(2));f.growthRate!==B&&v(X=>({...X,growthRate:B}))}else f.growthRate!==null&&v(J=>({...J,growthRate:null}))}else f.growthRate!==null&&v(F=>({...F,growthRate:null}))},[f.period,f.identity,f.weightKg,f.date,f.siteId,m,f.growthRate]),N.useEffect(()=>{C(D())},[f,D]),N.useEffect(()=>{const A=l.find(U=>U.id===f.siteId);S((A==null?void 0:A.zones)||[]),A&&!A.zones.some(U=>U.id===f.zoneId)&&v(U=>{var P;return{...U,zoneId:((P=A.zones[0])==null?void 0:P.id)||""}})},[f.siteId,l]);const M=async()=>{var U,P,F,q,z,J,W,G;E(!0),_(null);const A=l.find(B=>B.id===f.siteId);if(!A||!A.location||!f.date){_({type:"error",message:r("weatherFetchMissingInfo")}),E(!1);return}try{const[B,X]=A.location.split(","),$=on(B.trim()),ae=on(X.trim()),H=f.date,ie=`https://archive-api.open-meteo.com/v1/archive?latitude=${$.toFixed(4)}&longitude=${ae.toFixed(4)}&start_date=${H}&end_date=${H}&daily=temperature_2m_mean,precipitation_sum,wind_speed_10m_max,wind_direction_10m_dominant&timezone=auto`,ue=await fetch(ie);if(!ue.ok)throw new Error("Failed to fetch weather data from API.");const Ne=await ue.json();if(Ne.daily){const oe=Ne.daily,ne={...f};((U=oe.temperature_2m_mean)==null?void 0:U[0])!==null&&((P=oe.temperature_2m_mean)==null?void 0:P[0])!==void 0&&(ne.temperature=oe.temperature_2m_mean[0]),((F=oe.precipitation_sum)==null?void 0:F[0])!==null&&((q=oe.precipitation_sum)==null?void 0:q[0])!==void 0&&(ne.precipitation=oe.precipitation_sum[0]),((z=oe.wind_speed_10m_max)==null?void 0:z[0])!==null&&((J=oe.wind_speed_10m_max)==null?void 0:J[0])!==void 0&&(ne.windSpeed=oe.wind_speed_10m_max[0]),((W=oe.wind_direction_10m_dominant)==null?void 0:W[0])!==null&&((G=oe.wind_direction_10m_dominant)==null?void 0:G[0])!==void 0&&(ne.windDirection=oe.wind_direction_10m_dominant[0]),ne.waveHeight=null,ne.salinity=null,v(ne),_({type:"success",message:r("weatherFetchSuccess")})}else throw new Error("No daily data in weather API response.")}catch(B){console.error("Error fetching weather data:",B),_({type:"error",message:r("weatherFetchError")})}finally{E(!1)}},I=()=>{const A=D();if(Object.keys(A).length>0){C(A);return}s?h({...s,...f}):u(f),n()},O=Object.keys(w).length>0;return e.jsxs(at,{isOpen:t,onClose:n,title:r(s?"editTest":"addTest"),widthClass:"max-w-4xl",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(Ge,{title:r("sheetInfo"),className:"lg:col-span-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(de,{label:r("identity"),value:f.identity,onChange:A=>v(U=>({...U,identity:A.target.value})),error:w.identity,required:!0}),e.jsx(de,{label:r("date"),type:"date",value:f.date,onChange:A=>v(U=>({...U,date:A.target.value})),error:w.date,required:!0}),e.jsx(De,{label:r("site"),value:f.siteId,onChange:A=>v(U=>({...U,siteId:A.target.value})),error:w.siteId,required:!0,children:l.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))}),e.jsx(De,{label:r("seaweedType"),value:f.seaweedTypeId,onChange:A=>v(U=>({...U,seaweedTypeId:A.target.value})),error:w.seaweedTypeId,required:!0,children:c.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))}),e.jsx(De,{label:r("zoneName"),value:f.zoneId,onChange:A=>v(U=>({...U,zoneId:A.target.value})),disabled:!f.siteId,error:w.zoneId,required:!0,children:x.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))}),e.jsx(De,{label:r("period"),value:f.period,onChange:A=>v(U=>({...U,period:A.target.value})),required:!0,children:Lu.map(A=>e.jsx("option",{value:A,children:r(`period_${A}`)},A))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(de,{label:r("weightKg"),type:"number",value:f.weightKg,onChange:A=>v(U=>({...U,weightKg:parseFloat(A.target.value)||0})),error:w.weightKg,required:!0}),e.jsx(de,{label:`${r("growthRate")} (%)`,type:"number",value:f.growthRate!==null?f.growthRate:"",disabled:!0,placeholder:"Auto"})]}),e.jsx(De,{label:r("conductor"),value:f.conductorId,onChange:A=>v(U=>({...U,conductorId:A.target.value})),error:w.conductorId,required:!0,children:d.map(A=>e.jsxs("option",{value:A.id,children:[A.firstName," ",A.lastName]},A.id))})]})}),e.jsx(Ge,{title:r("weatherData"),className:"lg:col-span-2",children:e.jsxs("div",{className:"space-y-4",children:[R&&e.jsx("p",{className:`text-xs ${R.type==="success"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:R.message}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"weatherDataSource",value:"manual",checked:f.weatherDataSource==="manual",onChange:()=>v(A=>({...A,weatherDataSource:"manual"}))}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:r("manualEntry")})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"weatherDataSource",value:"auto",checked:f.weatherDataSource==="auto",onChange:()=>v(A=>({...A,weatherDataSource:"auto"}))}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:r("autoFill")})]})]}),f.weatherDataSource==="auto"&&e.jsxs(se,{type:"button",variant:"secondary",className:"w-full",onClick:M,disabled:T||!f.siteId||!f.date,children:[e.jsx(te,{name:T?"Activity":"Download",className:`w-5 h-5 ${T?"animate-spin":""}`}),r(T?"fetchingWeather":"fetchWeather")]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{label:`${r("temperature")} (C)`,type:"number",step:"any",value:f.temperature??"",onChange:A=>v(U=>({...U,temperature:A.target.value===""?null:parseFloat(A.target.value)})),disabled:f.weatherDataSource==="auto"}),e.jsx(de,{label:`${r("salinity")} ()`,type:"number",step:"any",value:f.salinity??"",onChange:A=>v(U=>({...U,salinity:A.target.value===""?null:parseFloat(A.target.value)}))}),e.jsx(de,{label:`${r("precipitation")} (mm)`,type:"number",step:"any",value:f.precipitation??"",onChange:A=>v(U=>({...U,precipitation:A.target.value===""?null:parseFloat(A.target.value)})),disabled:f.weatherDataSource==="auto"}),e.jsx(de,{label:`${r("windSpeed")} (km/h)`,type:"number",step:"any",value:f.windSpeed??"",onChange:A=>v(U=>({...U,windSpeed:A.target.value===""?null:parseFloat(A.target.value)})),disabled:f.weatherDataSource==="auto"}),e.jsx(de,{label:`${r("windDirection")} ()`,type:"number",step:"any",value:f.windDirection??"",onChange:A=>v(U=>({...U,windDirection:A.target.value===""?null:parseFloat(A.target.value)})),disabled:f.weatherDataSource==="auto"}),e.jsx(de,{label:`${r("waveHeight")} (m)`,type:"number",step:"any",value:f.waveHeight??"",onChange:A=>v(U=>({...U,waveHeight:A.target.value===""?null:parseFloat(A.target.value)}))})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 mt-4 border-t dark:border-gray-700",children:[e.jsx(se,{variant:"secondary",onClick:n,children:r("cancel")}),e.jsx(se,{onClick:I,disabled:O,children:r("save")})]})]})},r1=()=>{const{t}=je(),{periodicTests:n,sites:s,seaweedTypes:r,employees:l,deletePeriodicTest:c}=qe(),[d,u]=N.useState(!1),[h,m]=N.useState(null),[f,v]=N.useState(!1),[x,S]=N.useState(null),[w,C]=N.useState({key:"date",direction:"descending"}),{settings:T}=$e(),E=N.useMemo(()=>new Map(s.map(z=>[z.id,z.name])),[s]),R=N.useMemo(()=>new Map(r.map(z=>[z.id,z.name])),[r]),_=N.useMemo(()=>new Map(l.map(z=>[z.id,`${z.firstName} ${z.lastName}`])),[l]),D=N.useMemo(()=>{const z=new Map;return s.forEach(J=>J.zones.forEach(W=>z.set(W.id,W.name))),z},[s]),M=N.useMemo(()=>{let z=[...n];return z.sort((J,W)=>{let G,B;return w.key==="siteName"?G=E.get(J.siteId)||"":w.key==="seaweedTypeName"?G=R.get(J.seaweedTypeId)||"":w.key==="zoneName"?G=D.get(J.zoneId)||"":w.key==="conductorName"?G=_.get(J.conductorId)||"":G=J[w.key],w.key==="siteName"?B=E.get(W.siteId)||"":w.key==="seaweedTypeName"?B=R.get(W.seaweedTypeId)||"":w.key==="zoneName"?B=D.get(W.zoneId)||"":w.key==="conductorName"?B=_.get(W.conductorId)||"":B=W[w.key],G===null?1:B===null?-1:G<B?w.direction==="ascending"?-1:1:G>B?w.direction==="ascending"?1:-1:0}),z},[n,w,E,R,D,_]),I=z=>{let J="ascending";w.key===z&&w.direction==="ascending"&&(J="descending"),C({key:z,direction:J})},O=z=>w.key!==z?e.jsx(te,{name:"ChevronDown",className:"w-4 h-4 text-transparent group-hover:text-gray-400 transition-colors"}):w.direction==="ascending"?e.jsx(te,{name:"ArrowUp",className:"w-4 h-4"}):e.jsx(te,{name:"ArrowDown",className:"w-4 h-4"}),A=({sortKey:z,label:J,className:W})=>e.jsx("th",{className:`p-3 ${W}`,children:e.jsxs("button",{onClick:()=>I(z),className:`group flex items-center gap-2 w-full ${W!=null&&W.includes("text-right")?"justify-end":""}`,children:[J,O(z)]})}),U=(z=null)=>{m(z),u(!0)},P=z=>{S(z),v(!0)},F=()=>{x&&c(x),v(!1),S(null)},q=async()=>{const z=M.map(W=>({identity:W.identity,date:W.date,site:E.get(W.siteId)||t("unknown"),seaweedType:R.get(W.seaweedTypeId)||t("unknown"),zone:D.get(W.zoneId)||t("unknown"),period:t(`period_${W.period}`),weightKg:W.weightKg,growthRate:W.growthRate,temperature:W.temperature,salinity:W.salinity,precipitation:W.precipitation,windSpeed:W.windSpeed,windDirection:W.windDirection,waveHeight:W.waveHeight,conductor:_.get(W.conductorId)||t("unknown"),source:W.weatherDataSource==="auto"?t("autoFill"):t("manualEntry")})),J=[{header:t("identity"),key:"identity",width:15},{header:t("date"),key:"date",width:15},{header:t("site"),key:"site",width:20},{header:t("seaweedType"),key:"seaweedType",width:20},{header:t("zoning"),key:"zone",width:15},{header:t("period"),key:"period",width:15},{header:`${t("weightKg")} (Kg)`,key:"weightKg",width:15},{header:`${t("growthRate")} (%)`,key:"growthRate",width:15},{header:`${t("temperature")} (C)`,key:"temperature",width:15},{header:`${t("salinity")} ()`,key:"salinity",width:15},{header:`${t("precipitation")} (mm)`,key:"precipitation",width:15},{header:`${t("windSpeed")} (km/h)`,key:"windSpeed",width:15},{header:`${t("windDirection")} ()`,key:"windDirection",width:15},{header:`${t("waveHeight")} (m)`,key:"waveHeight",width:15},{header:t("conductor"),key:"conductor",width:20},{header:"Source",key:"source",width:15}];await Yr(z,J,`PeriodicTests_${new Date().toISOString().split("T")[0]}`,"Periodic Tests")};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("periodicTestsTitle")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(se,{onClick:q,variant:"secondary",children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-5 h-5 mr-2"}),t("exportExcel")]}),e.jsxs(se,{onClick:()=>U(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("addTest")]})]})]}),e.jsx(Ge,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs uppercase bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx(A,{sortKey:"identity",label:t("identity")}),e.jsx(A,{sortKey:"date",label:t("date")}),e.jsx(A,{sortKey:"siteName",label:t("site")}),e.jsx(A,{sortKey:"seaweedTypeName",label:t("seaweedType")}),e.jsx(A,{sortKey:"zoneName",label:t("zoning")}),e.jsx(A,{sortKey:"period",label:t("period")}),e.jsx(A,{sortKey:"weightKg",label:`${t("weightKg")} (Kg)`,className:"text-right"}),e.jsx(A,{sortKey:"growthRate",label:`${t("growthRate")} (%)`,className:"text-right"}),e.jsx(A,{sortKey:"temperature",label:`${t("temperature")} (C)`,className:"text-right"}),e.jsx(A,{sortKey:"salinity",label:`${t("salinity")} ()`,className:"text-right"}),e.jsx(A,{sortKey:"precipitation",label:`${t("precipitation")} (mm)`,className:"text-right"}),e.jsx(A,{sortKey:"windSpeed",label:`${t("windSpeed")} (km/h)`,className:"text-right"}),e.jsx(A,{sortKey:"windDirection",label:`${t("windDirection")} ()`,className:"text-right"}),e.jsx(A,{sortKey:"waveHeight",label:`${t("waveHeight")} (m)`,className:"text-right"}),e.jsx(A,{sortKey:"conductorName",label:t("conductor")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsx("tbody",{children:M.map(z=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/20 align-middle",children:[e.jsx("td",{className:"p-3 font-mono",children:z.identity}),e.jsx("td",{className:"p-3",children:z.date}),e.jsx("td",{className:"p-3",children:E.get(z.siteId)||t("unknown")}),e.jsx("td",{className:"p-3",children:R.get(z.seaweedTypeId)||t("unknown")}),e.jsx("td",{className:"p-3",children:D.get(z.zoneId)||t("unknown")}),e.jsx("td",{className:"p-3",children:t(`period_${z.period}`)}),e.jsx("td",{className:"p-3 text-right",children:Fe(z.weightKg,T.localization)}),e.jsx("td",{className:"p-3 text-right font-semibold",children:z.growthRate!==null?`${Fe(z.growthRate,T.localization)}`:"-"}),e.jsx("td",{className:"p-3 text-right",children:z.temperature!==null?Fe(z.temperature,T.localization):"-"}),e.jsx("td",{className:"p-3 text-right",children:z.salinity!==null?Fe(z.salinity,T.localization):"-"}),e.jsx("td",{className:"p-3 text-right",children:z.precipitation!==null?Fe(z.precipitation,T.localization):"-"}),e.jsx("td",{className:"p-3 text-right",children:z.windSpeed!==null?Fe(z.windSpeed,T.localization):"-"}),e.jsx("td",{className:"p-3 text-right",children:z.windDirection!==null?Fe(z.windDirection,T.localization):"-"}),e.jsx("td",{className:"p-3 text-right",children:z.waveHeight!==null?Fe(z.waveHeight,T.localization):"-"}),e.jsx("td",{className:"p-3",children:_.get(z.conductorId)||t("unknown")}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(se,{variant:"ghost",className:"p-2",onClick:()=>U(z),children:e.jsx(te,{name:"Settings",className:"w-4 h-4"})}),e.jsx(se,{variant:"danger",className:"p-2",onClick:()=>P(z.id),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]},z.id))})]})})}),d&&e.jsx(a1,{isOpen:d,onClose:()=>u(!1),test:h}),f&&e.jsx(Ut,{isOpen:f,onClose:()=>v(!1),onConfirm:F,title:t("confirmDeleteTitle"),message:t("confirmDeleteTest")})]})},is=({icon:t,label:n,value:s,fullWidth:r})=>e.jsxs("div",{className:`flex flex-col p-3 rounded-lg bg-gray-100/50 dark:bg-gray-900/50 ${r?"col-span-2":""}`,children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 dark:text-gray-400",children:[e.jsx(te,{name:t,className:"w-4 h-4 mr-2"}),e.jsx("span",{children:n})]}),e.jsx("div",{className:"mt-1 text-md font-semibold text-gray-900 dark:text-gray-100 truncate",children:s||"N/A"})]}),i1=({data:t,onClose:n})=>{const{t:s}=je(),{settings:r}=$e(),[l,c]=N.useState(!1),d=!!t,{module:u,site:h,zone:m,farmer:f,cycle:v,seaweedType:x}=t||{},S=r.localization.coordinateFormat;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 bg-black/30 z-40 transition-opacity duration-300 ${d?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:n,"aria-hidden":"true"}),e.jsxs("div",{className:`fixed top-0 right-0 h-full w-full max-w-md bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl border-l border-gray-200 dark:border-gray-700/50 shadow-2xl flex flex-col z-50 transform transition-transform duration-300 ease-in-out ${d?"translate-x-0":"translate-x-full"}`,role:"dialog","aria-modal":"true","aria-labelledby":"module-detail-panel-title",children:[e.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-inherit z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("moduleDetails")}),e.jsx("h2",{id:"module-detail-panel-title",className:"text-xl font-bold font-mono",children:u==null?void 0:u.code})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{variant:"ghost",onClick:()=>c(!0),children:[e.jsx(te,{name:"FileText",className:"w-4 h-4 mr-1"}),s("history")]}),e.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700","aria-label":s("close"),children:e.jsx(te,{name:"X",className:"w-6 h-6"})})]})]}),d&&e.jsxs("main",{className:"flex-grow overflow-y-auto p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:s("generalInformation")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(is,{icon:"MapPin",label:s("site"),value:h==null?void 0:h.name}),e.jsx(is,{icon:"Grid",label:s("zoneName"),value:m==null?void 0:m.name}),e.jsx(is,{icon:"User",label:s("farmer"),value:f?`${f.firstName} ${f.lastName}`:s("status_FREE")}),e.jsxs("div",{className:"flex flex-col p-3 rounded-lg bg-gray-100/50 dark:bg-gray-900/50",children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-500 dark:text-gray-400",children:[e.jsx(te,{name:"Activity",className:"w-4 h-4 mr-2"}),e.jsx("span",{children:s("status")})]}),e.jsx("div",{className:"mt-1",children:e.jsx(mn,{status:f?"ASSIGNED":"FREE"})})]}),e.jsx(is,{icon:"MapPin",label:s("latitude"),value:Bg(u.latitude||"",S,!0)}),e.jsx(is,{icon:"MapPin",label:s("longitude"),value:Bg(u.longitude||"",S,!1)})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:s("configuration")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(is,{icon:"Layers",label:s("lines"),value:u.lines}),e.jsx(is,{icon:"Package",label:s("galvanizedPoles"),value:u.poles.galvanized}),e.jsx(is,{icon:"Package",label:s("woodPoles"),value:u.poles.wood}),e.jsx(is,{icon:"Package",label:s("plasticPoles"),value:u.poles.plastic})]})]}),v&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:s("cultivationCycle")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(is,{icon:"Beaker",label:s("seaweedType"),value:x==null?void 0:x.name}),e.jsx(is,{icon:"Calendar",label:s("plantingDate"),value:v.plantingDate}),e.jsx(is,{icon:"Archive",label:s("initialWeight"),value:`${v.initialWeight} kg`})]})]})]})]}),d&&u&&e.jsx(i0,{isOpen:l,onClose:()=>c(!1),history:u.statusHistory,moduleCode:u.code})]})},l1=()=>{const{t}=je(),{settings:n}=$e(),s=n.localization.coordinateFormat,r=N.useRef(null),l=N.useRef(null),c=N.useRef(null),d=N.useRef(null),u=N.useRef(null),h=N.useRef(null),m=N.useRef(null),f=N.useRef(new Map),{sites:v,modules:x,cultivationCycles:S,farmers:w,employees:C,seaweedTypes:T}=qe(),[E,R]=N.useState(null),[_,D]=N.useState(!1),M=(A,U)=>{if(!A)return{color:"#808080",label:"Unknown"};const P=A.statusHistory||[],F=P.length>0?P[P.length-1].status:Je.FREE;if(F===Je.FREE)return{color:"#6b7280",label:t("status_FREE")};if(U&&(U.status===Je.PLANTED||U.status===Je.GROWING)){const q=new Date(U.plantingDate),J=Math.floor((new Date().getTime()-q.getTime())/(1e3*3600*24));return J>Zs?{color:"#ef4444",label:t("overdueHarvest")}:J>Zs-bm?{color:"#f59e0b",label:t("nearingHarvest")}:{color:"#22c55e",label:t("status_GROWING")}}return F===Je.HARVESTED||F===Je.DRYING||F===Je.BAGGING?{color:"#3b82f6",label:t(`status_${F}`)}:F===Je.MAINTENANCE?{color:"#f97316",label:t("status_MAINTENANCE")}:A.farmerId?{color:"#a855f7",label:t("status_ASSIGNED")}:{color:"#6b7280",label:t("status_FREE")}},I=[{color:"#22c55e",label:t("status_GROWING")},{color:"#f59e0b",label:t("nearingHarvest")},{color:"#ef4444",label:t("overdueHarvest")},{color:"#3b82f6",label:`${t("status_HARVESTED")} / ${t("status_DRYING")}`},{color:"#a855f7",label:t("status_ASSIGNED")},{color:"#6b7280",label:t("status_FREE")},{color:"#f97316",label:t("status_MAINTENANCE")}];N.useEffect(()=>{if(r.current&&!l.current){const A=L.map(r.current,{center:[-18.7669,46.8691],zoom:6,zoomControl:!1});L.control.zoom({position:"topleft"}).addTo(A);const U=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(A),P=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),F=L.featureGroup().addTo(A),q=L.featureGroup().addTo(A),z=L.featureGroup().addTo(A),J=L.featureGroup().addTo(A),W=L.layerGroup().addTo(A);c.current=F,d.current=q,u.current=z,h.current=J,m.current=W,l.current=A;const G={[t("streetView")]:U,[t("satelliteView")]:P},B={[`<i class="icon-sites"></i> ${t("sites")}`]:F,[`<i class="icon-zones"></i> ${t("zones")}`]:q,[`<i class="icon-modules"></i> ${t("modules")}`]:z};L.control.layers(G,B,{collapsed:!0,position:"topright"}).addTo(A)}},[t]),N.useEffect(()=>{const A=l.current;if(!A)return;c.current.clearLayers(),d.current.clearLayers(),u.current.clearLayers(),f.current.clear();const U=[];v.forEach(P=>{if(P.location)try{const q=P.location.split(",");if(q.length===2){const z=q[0].trim(),J=q[1].trim(),W=on(z),G=on(J),B=[W,G];U.push(B);const X=x.filter(fe=>fe.siteId===P.id),$=X.length,ae=w.filter(fe=>fe.siteId===P.id).length,ie=C.filter(fe=>fe.siteId===P.id).length,ue=new Set(X.map(fe=>fe.id)),Ne=S.filter(fe=>ue.has(fe.moduleId)&&(fe.status==="PLANTED"||fe.status==="GROWING")).reduce((fe,Q)=>fe+(Q.linesPlanted||0),0),oe=C.find(fe=>fe.id===P.managerId),ne=oe?`${oe.firstName} ${oe.lastName}`:t("noManager"),we=L.marker(B);we.bindPopup(`
                            <div class="font-sans text-xs min-w-[240px]">
                                <div class="bg-blue-600 text-white px-3 py-2 rounded-t flex justify-between items-center">
                                    <h3 class="font-bold text-sm truncate max-w-[160px]">${P.name}</h3>
                                    <span class="text-[10px] bg-blue-700 px-1.5 py-0.5 rounded opacity-90">${P.code}</span>
                                </div>
                                <div class="p-3 bg-white border border-gray-200 rounded-b shadow-sm">
                                    <div class="mb-3 flex justify-between items-center border-b border-gray-100 pb-2">
                                        <span class="text-gray-500 flex items-center gap-1"><i class="w-3 h-3 bg-gray-400 rounded-full block"></i> ${t("manager")}:</span>
                                        <span class="font-medium text-right truncate max-w-[120px] text-gray-800">${ne}</span>
                                    </div>
                                    <div class="grid grid-cols-2 gap-2">
                                        <div class="flex flex-col items-center justify-center p-2 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 transition-colors">
                                            <span class="font-bold text-blue-600 text-lg leading-none">${$}</span>
                                            <span class="text-[9px] text-gray-500 uppercase mt-1 font-semibold tracking-wide">${t("modules")}</span>
                                        </div>
                                        <div class="flex flex-col items-center justify-center p-2 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 transition-colors">
                                            <span class="font-bold text-green-600 text-lg leading-none">${ae}</span>
                                            <span class="text-[9px] text-gray-500 uppercase mt-1 font-semibold tracking-wide">${t("farmers")}</span>
                                        </div>
                                         <div class="flex flex-col items-center justify-center p-2 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 transition-colors">
                                            <span class="font-bold text-purple-600 text-lg leading-none">${ie}</span>
                                            <span class="text-[9px] text-gray-500 uppercase mt-1 font-semibold tracking-wide">${t("employees")}</span>
                                        </div>
                                         <div class="flex flex-col items-center justify-center p-2 bg-gray-50 rounded border border-gray-100 hover:bg-gray-100 transition-colors">
                                            <span class="font-bold text-orange-600 text-lg leading-none">${Ne}</span>
                                            <span class="text-[9px] text-gray-500 uppercase mt-1 font-semibold tracking-wide">${t("activeLines")}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `,{closeButton:!1,minWidth:240}),c.current.addLayer(we)}}catch(q){console.error(`Could not parse location for site ${P.name}: ${P.location}`,q)}(P.zones||[]).forEach(q=>{const z=Vu(q.geoPoints);if(z.length>=3){const J=z.reduce((B,X)=>({x:B.x+X.x,y:B.y+X.y}),{x:0,y:0});J.x/=z.length,J.y/=z.length,z.sort((B,X)=>{const $=Math.atan2(B.y-J.y,B.x-J.x),ae=Math.atan2(X.y-J.y,X.x-J.x);return $-ae});const W=z.map(B=>[B.y,B.x]);U.push(...W);const G=L.polygon(W,{color:"blue",weight:2,fillOpacity:.1});G.bindTooltip(q.name,{permanent:!0,direction:"center",className:"bg-transparent border-none shadow-none font-bold text-blue-800"}),d.current.addLayer(G)}})}),x.forEach(P=>{let F=null;if(P.latitude&&P.longitude)try{const B=on(P.latitude),X=on(P.longitude);F=L.latLng(B,X)}catch{}if(!F){const B=v.flatMap(X=>X.zones).find(X=>X.id===P.zoneId);if(B&&B.geoPoints&&B.geoPoints.length>0){const X=Vu(B.geoPoints);if(X.length>0){const $=X.map(ie=>[ie.y,ie.x]),H=L.polygon($).getBounds();H&&H.isValid()&&(F=H.getCenter())}}}if(!F)return;f.current.set(P.id,F);const q=S.find(B=>B.moduleId===P.id&&(B.status===Je.PLANTED||B.status===Je.GROWING||B.status===Je.CUTTING)),z=w.find(B=>B.id===P.farmerId),J=M(P,q),W=L.divIcon({html:`<div style="background-color: ${J.color}; width: 10px; height: 10px; border: 1px solid #fff; opacity: 1; box-shadow: 1px 1px 2px rgba(0,0,0,0.5);"></div>`,iconSize:[10,10],iconAnchor:[5,5],className:""}),G=L.marker(F,{icon:W});G.bindTooltip(`${P.code}`,{direction:"top",offset:[0,-5],className:"text-xs"}),G.on("click",()=>{const B=v.find(ie=>ie.id===P.siteId),X=B==null?void 0:B.zones.find(ie=>ie.id===P.zoneId),$=q?T.find(ie=>ie.id===q.seaweedTypeId):void 0,ae=q||S.filter(ie=>ie.moduleId===P.id).sort((ie,ue)=>new Date(ue.plantingDate).getTime()-new Date(ie.plantingDate).getTime())[0];R({module:P,cycle:ae,site:B,zone:X,seaweedType:$,farmer:z})}),u.current.addLayer(G)}),U.length>0&&A.fitBounds(U,{padding:[50,50]})},[v,x,S,w,C,T,t,s]),N.useEffect(()=>{const A=h.current;if(A&&(A.clearLayers(),E&&E.module)){const U=f.current.get(E.module.id);U&&L.circleMarker(U,{radius:16,color:"#facc15",fill:!1,weight:4,opacity:.8}).addTo(A)}},[E,x]);const O=()=>{D(!0),setTimeout(()=>{if(!l.current||!m.current){D(!1);return}const A=m.current;A.clearLayers();const U=l.current.getCenter();if(U){const P=U.lat,F=U.lng,q=L.circle([P+.005,F+.005],{color:"green",fillColor:"#22c55e",fillOpacity:.4,radius:1500,weight:1}).bindPopup(`<b>${t("biomassLegendHigh")}</b><br>NDVI: 0.75<br>${t("satelliteSource")}`),z=L.circle([P-.005,F-.005],{color:"red",fillColor:"#ef4444",fillOpacity:.4,radius:1e3,weight:1}).bindPopup(`<b>${t("algalBloomRisk")}</b><br>Chlorophyll-a: High<br>${t("satelliteSource")}`);A.addLayer(q),A.addLayer(z),l.current.setView([P,F],Math.max(l.current.getZoom(),13))}D(!1)},2e3)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("farmMapTitle")}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(se,{onClick:O,disabled:_,variant:"secondary",children:[e.jsx(te,{name:_?"Activity":"Eye",className:`w-5 h-5 mr-2 ${_?"animate-spin":""}`}),t(_?"analyzingSatellite":"loadSatelliteData")]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{ref:r,style:{height:"70vh"},className:"rounded-lg shadow-lg bg-blue-50 z-0"}),e.jsx("div",{className:"absolute bottom-8 left-4 z-[500] no-print hidden sm:block",children:e.jsx(Ge,{title:t("legend"),className:"p-3 !bg-white/90 backdrop-blur-sm border border-gray-200 shadow-lg",children:e.jsxs("div",{className:"space-y-2",children:[I.map(A=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-3 h-3 mr-2 border border-white shadow-sm",style:{backgroundColor:A.color}}),e.jsx("span",{className:"text-[10px] font-medium",children:A.label})]},A.label)),e.jsx("hr",{className:"my-2 border-gray-300"}),e.jsx("h4",{className:"text-[10px] font-bold mb-1",children:t("satelliteAnalysisTitle")}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-3 h-3 mr-2 border border-white shadow-sm bg-green-500/50 border-green-600"}),e.jsx("span",{className:"text-[10px] font-medium",children:t("biomassLegendHigh")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-3 h-3 mr-2 border border-white shadow-sm bg-red-500/50 border-red-600"}),e.jsx("span",{className:"text-[10px] font-medium",children:t("algalBloomRisk")})]})]})})})]}),e.jsx(i1,{data:E,onClose:()=>R(null)})]})},ec=({permission:t,children:n,fallback:s=null})=>{const{can:r}=ys();return r(t)?e.jsx(e.Fragment,{children:n}):e.jsx(e.Fragment,{children:s})},o1=({isOpen:t,onClose:n,role:s,onSave:r})=>{const{t:l}=je(),[c,d]=N.useState(new Set);N.useEffect(()=>{t&&d(new Set(s.permissions))},[t,s]);const u=(m,f)=>{d(v=>{const x=new Set(v);return f?x.add(m):x.delete(m),x})},h=()=>{r({...s,permissions:Array.from(c)})};return e.jsx(at,{isOpen:t,onClose:n,title:`${l("managePermissionsFor")} "${s.name}"`,widthClass:"max-w-4xl",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{onClick:h,children:l("save")})]}),children:e.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:Xy.map(m=>e.jsxs("div",{className:"p-4 border rounded-lg dark:border-gray-700",children:[e.jsx("h3",{className:"font-semibold mb-3",children:m.name}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:m.permissions.map(f=>e.jsxs("label",{className:"flex items-center p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700/50 cursor-pointer",children:[e.jsx(jt,{checked:c.has(f.id),onChange:v=>u(f.id,v.target.checked)}),e.jsx("span",{className:"ml-2 text-sm",children:f.label})]},f.id))})]},m.name))})})},c1=()=>{const{t}=je(),{roles:n,addRole:s,updateRole:r,deleteRole:l}=qe(),[c,d]=N.useState(!1),[u,h]=N.useState(null),[m,f]=N.useState(""),[v,x]=N.useState(!1),[S,w]=N.useState(null),[C,T]=N.useState(!1),E=O=>{O.isDefault||(h(O),d(!0))},R=()=>{u&&l(u.id),d(!1),h(null)},_=()=>{m.trim()&&(s({name:m.trim(),permissions:[]}),f(""))},D=O=>{w(O),x(!0)},M=O=>{w(O),T(!0)},I=O=>{r(O),x(!1),T(!1),w(null)};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-6",children:t("roleManagementTitle")}),e.jsxs(Ge,{children:[e.jsx("div",{className:"space-y-4 mb-6",children:n.map(O=>e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-900/50 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:O.name}),O.isDefault&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",t("default"),")"]})]}),e.jsx(ec,{permission:Ce.ROLES_MANAGE,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{variant:"secondary",onClick:()=>M(O),children:[e.jsx(te,{name:"UserCog",className:"w-4 h-4"}),t("managePermissions")]}),e.jsxs(se,{variant:"ghost",onClick:()=>D(O),children:[e.jsx(te,{name:"Edit2",className:"w-4 h-4"}),t("edit")]}),O.isDefault?e.jsx(te,{name:"Lock",className:"w-5 h-5 text-gray-400",title:t("cannotDeleteDefault")}):e.jsx(se,{variant:"danger",className:"p-2",onClick:()=>E(O),children:e.jsx(te,{name:"Trash2",className:"w-4 h-4"})})]})})]},O.id))}),e.jsx(ec,{permission:Ce.ROLES_MANAGE,children:e.jsxs("div",{className:"mt-6 pt-6 border-t dark:border-gray-700",children:[e.jsx("h4",{className:"font-semibold mb-4",children:t("addRole")}),e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(de,{containerClassName:"flex-grow",label:t("roleName"),value:m,onChange:O=>f(O.target.value)}),e.jsxs(se,{onClick:_,disabled:!m.trim(),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("add")]})]})]})})]}),v&&S&&e.jsx(d1,{isOpen:v,onClose:()=>x(!1),role:S,onSave:I}),C&&S&&e.jsx(o1,{isOpen:C,onClose:()=>T(!1),role:S,onSave:I}),c&&u&&e.jsx(Ut,{isOpen:c,onClose:()=>d(!1),onConfirm:R,title:t("confirmDeleteTitle"),message:t("confirmDeleteRole")})]})},d1=({isOpen:t,onClose:n,role:s,onSave:r})=>{const{t:l}=je(),[c,d]=N.useState(s.name);N.useEffect(()=>{t&&d(s.name)},[t,s]);const u=()=>{c.trim()&&r({...s,name:c.trim()})};return e.jsx(at,{isOpen:t,onClose:n,title:l("editRole"),footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{onClick:u,disabled:!c.trim(),children:l("save")})]}),children:e.jsx(de,{label:l("roleName"),value:c,onChange:h=>d(h.target.value),required:!0,autoFocus:!0})})},u1=({employeeId:t,appliedDeductions:n,onToggle:s})=>{const{settings:r}=$e(),[l,c]=N.useState(!1),d=N.useRef(null),u=N.useMemo(()=>{var h;return((h=Vt.find(m=>m.code===r.localization.country))==null?void 0:h.payroll)||Vt.find(m=>m.code==="MG").payroll},[r.localization.country]);return N.useEffect(()=>{const h=m=>{d.current&&!d.current.contains(m.target)&&c(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]),e.jsxs("div",{ref:d,className:"relative inline-flex",children:[e.jsx(se,{variant:"ghost",className:"p-1 !rounded-full",onClick:()=>c(!l),children:e.jsx(te,{name:"Settings",className:"w-4 h-4"})}),l&&e.jsx("div",{className:"absolute right-0 bottom-full mb-2 z-10 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-700 p-2 space-y-2",children:u.constants.socialContributions.map(h=>{var m;return e.jsxs("label",{className:"flex items-center text-sm cursor-pointer",children:[e.jsx(jt,{checked:n.includes(h.key),onChange:f=>s(t,h.key,f.target.checked)}),e.jsx("span",{className:"ml-2",children:((m=u.labels.socialContributions.find(f=>f.key===h.key))==null?void 0:m.label)||h.key})]},h.key)})})]})},m1=({isOpen:t,onClose:n,onApply:s,sites:r,roles:l,payrollConfig:c})=>{const{t:d}=je(),[u,h]=N.useState({applyTo:"all",filterValue:"",action:"set",values:{bonuses:"",overtime:"",other:""},configureSocialDeductions:!1,deductionsToApply:{},showAffectedEmployees:!0});N.useEffect(()=>{if(t){const f=c.constants.socialContributions.reduce((v,x)=>(v[x.key]=!0,v),{});h(v=>({...v,filterValue:"",deductionsToApply:f}))}},[t,c]);const m=()=>{s(u)};return e.jsx(at,{isOpen:t,onClose:n,title:d("bulkConfigure"),footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:d("cancel")}),e.jsx(se,{onClick:m,children:d("applyChanges")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(De,{label:d("applyTo"),value:u.applyTo,onChange:f=>h(v=>({...v,applyTo:f.target.value})),children:[e.jsx("option",{value:"all",children:d("allSelectedEmployees")}),e.jsx("option",{value:"site",children:d("bySite")}),e.jsx("option",{value:"role",children:d("byRole")})]}),u.applyTo==="site"&&e.jsxs(De,{label:d("site"),value:u.filterValue,onChange:f=>h(v=>({...v,filterValue:f.target.value})),children:[e.jsx("option",{value:"",children:d("selectSite")}),r.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]}),u.applyTo==="role"&&e.jsxs(De,{label:d("role"),value:u.filterValue,onChange:f=>h(v=>({...v,filterValue:f.target.value})),children:[e.jsx("option",{value:"",children:d("selectRole")}),l.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs(De,{label:"Action",value:u.action,onChange:f=>h(v=>({...v,action:f.target.value})),children:[e.jsx("option",{value:"set",children:d("setValue")}),e.jsx("option",{value:"add",children:d("addToExisting")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsx(de,{label:d("bonuses"),type:"number",placeholder:d("optional"),value:u.values.bonuses,onChange:f=>h(v=>({...v,values:{...v.values,bonuses:f.target.value}}))}),e.jsx(de,{label:d("overtime"),type:"number",placeholder:d("optional"),value:u.values.overtime,onChange:f=>h(v=>({...v,values:{...v.values,overtime:f.target.value}}))}),e.jsx(de,{label:d("otherDeductions"),type:"number",placeholder:d("optional"),value:u.values.other,onChange:f=>h(v=>({...v,values:{...v.values,other:f.target.value}}))})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 font-semibold",children:[e.jsx(jt,{checked:u.configureSocialDeductions,onChange:f=>h(v=>({...v,configureSocialDeductions:f.target.checked}))}),e.jsx("span",{children:d("configureSocialDeductions")})]}),u.configureSocialDeductions&&e.jsx("div",{className:"pl-6 mt-2 space-y-2",children:c.constants.socialContributions.map(f=>{var v;return e.jsxs("label",{className:"flex items-center text-sm",children:[e.jsx(jt,{checked:u.deductionsToApply[f.key]??!1,onChange:x=>h(S=>({...S,deductionsToApply:{...S.deductionsToApply,[f.key]:x.target.checked}}))}),e.jsx("span",{className:"ml-2",children:((v=c.labels.socialContributions.find(x=>x.key===f.key))==null?void 0:v.label)||f.key})]},f.key)})})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(jt,{checked:u.showAffectedEmployees,onChange:f=>h(v=>({...v,showAffectedEmployees:f.target.checked}))}),e.jsx("span",{children:d("showAffectedEmployeesAfterUpdate")})]})})]})})},f1=({isOpen:t,onClose:n,employeeNames:s})=>{const{t:r}=je();return e.jsxs(at,{isOpen:t,onClose:n,title:r("bulkUpdateSummary"),footer:e.jsx(se,{onClick:n,children:r("close")}),children:[e.jsx("p",{className:"mb-4",children:r("affectedEmployees").replace("{count}",String(s.length))}),e.jsx("div",{className:"max-h-60 overflow-y-auto bg-gray-100 dark:bg-gray-800/50 p-3 rounded-md",children:e.jsx("ul",{className:"list-disc list-inside",children:s.map(l=>e.jsx("li",{children:l},l))})})]})},p1=()=>{const{t}=je(),{employees:n,sites:s,addMultipleMonthlyPayments:r}=qe(),{settings:l}=$e(),[c,d]=N.useState(new Date().getMonth()),[u,h]=N.useState(new Date().getFullYear()),[m,f]=N.useState("all"),[v,x]=N.useState(new Set),[S,w]=N.useState([]),[C,T]=N.useState(new Set),E=N.useRef(null),[R,_]=N.useState(!1),[D,M]=N.useState(!1),[I,O]=N.useState(null),A=N.useMemo(()=>Array.from({length:10},(ne,we)=>new Date().getFullYear()-5+we),[]),U=N.useMemo(()=>["january","february","march","april","may","june","july","august","september","october","november","december"],[]),P=N.useMemo(()=>Array.from({length:12},(ne,we)=>we),[]),F=`${t(U[c])} ${u}`,q=N.useMemo(()=>{var ne;return((ne=Vt.find(we=>we.code===l.localization.country))==null?void 0:ne.payroll)||Vt.find(we=>we.code==="MG").payroll},[l.localization.country]),z=N.useMemo(()=>{const ne=new Date(u,c+1,0);let we=n.filter(fe=>{if(!fe.hireDate)return!1;const Q=new Date(fe.hireDate);return!isNaN(Q.getTime())&&Q<=ne});return m==="all"?we:we.filter(fe=>fe.siteId===m)},[n,m,u,c]),J=ne=>{x(we=>{const fe=new Set(we);return fe.has(ne)?fe.delete(ne):fe.add(ne),fe})},W=ne=>{ne.target.checked?x(new Set(z.map(we=>we.id))):x(new Set)};N.useEffect(()=>{if(E.current){const ne=v.size,we=z.length;E.current.checked=ne===we&&we>0,E.current.indeterminate=ne>0&&ne<we}},[v,z]);const G=ne=>{const we=parseFloat(ne.inputs.bonuses)||0,fe=parseFloat(ne.inputs.overtime)||0,Q=parseFloat(ne.inputs.other)||0;return{...nl(ne.employee.grossWage,we,fe,Q,l.localization,{appliedDeductions:ne.appliedDeductions}),employee:ne.employee,inputs:ne.inputs,appliedDeductions:ne.appliedDeductions}},B=()=>{const ne=n.filter(Q=>v.has(Q.id)),we=q?q.constants.socialContributions.map(Q=>Q.key):[],fe=ne.map(Q=>{const ee={bonuses:"0",overtime:"0",other:"0"};return{...nl(Q.grossWage,0,0,0,l.localization,{appliedDeductions:we}),employee:Q,inputs:ee,appliedDeductions:we}});w(fe),T(new Set)},X=(ne,we,fe)=>{w(Q=>Q.map(ee=>{if(ee.employee.id===ne){const ye={...ee,inputs:{...ee.inputs,[we]:fe}};return G(ye)}return ee}))},$=(ne,we,fe)=>{w(Q=>Q.map(ee=>{if(ee.employee.id===ne){const ye=new Set(ee.appliedDeductions);fe?ye.add(we):ye.delete(we);const Le={...ee,appliedDeductions:Array.from(ye)};return G(Le)}return ee}))},ae=ne=>{const we=[];w(fe=>fe.map(Q=>{const ee=Q.employee;let ye=!1;switch(ne.applyTo){case"all":ye=!0;break;case"site":ye=ee.siteId===ne.filterValue;break;case"role":ye=ee.role===ne.filterValue;break}if(ye){we.push(`${ee.firstName} ${ee.lastName}`);let Le={...Q.inputs},ke=[...Q.appliedDeductions];["bonuses","overtime","other"].forEach(Oe=>{const be=Oe;if(ne.values[be]){const xe=parseFloat(ne.values[be])||0,Ue=parseFloat(Le[be])||0,Ze=ne.action==="add"?Ue+xe:xe;Le[be]=String(Ze)}}),ne.configureSocialDeductions&&(ke=Object.entries(ne.deductionsToApply).filter(([,Oe])=>Oe).map(([Oe])=>Oe));const Re=parseFloat(Le.bonuses)||0,Ke=parseFloat(Le.overtime)||0,ze=parseFloat(Le.other)||0;return{...nl(ee.grossWage,Re,Ke,ze,l.localization,{appliedDeductions:ke}),employee:ee,inputs:Le,appliedDeductions:ke}}return Q})),_(!1),ne.showAffectedEmployees?O(we):O(null)},H=()=>{const ne=`${u}-${String(c+1).padStart(2,"0")}`,we=new Date().toISOString().split("T")[0],fe=`payroll-${Date.now()}`,Q=S.map(ee=>({date:we,period:ne,recipientType:qt.EMPLOYEE,recipientId:ee.employee.id,amount:ee.netPay,method:"cash",notes:JSON.stringify({type:"payroll_run",details:{gross:ee.totalGross,base:ee.baseSalary,bonuses:ee.inputs.bonuses,overtime:ee.inputs.overtime,deductions:ee.totalDeductions,otherDeductions:ee.inputs.other}}),paymentRunId:fe,paymentStatus:"PENDING"}));r(Q),M(!1),alert(t("payrollSavedSuccess"))},ie=ne=>{T(we=>{const fe=new Set(we);return fe.has(ne)?fe.delete(ne):fe.add(ne),fe})},ue=N.useMemo(()=>S.reduce((ne,we)=>({totalGross:ne.totalGross+we.totalGross,totalDeductions:ne.totalDeductions+we.totalDeductions,totalNet:ne.totalNet+we.netPay}),{totalGross:0,totalDeductions:0,totalNet:0}),[S]),{uniqueSites:Ne,uniqueRoles:oe}=N.useMemo(()=>{const ne=new Set,we=new Set;S.forEach(ee=>{ee.employee.siteId&&ne.add(ee.employee.siteId),ee.employee.role&&we.add(ee.employee.role)});const fe=s.filter(ee=>ne.has(ee.id)),Q=Array.from(we).sort();return{uniqueSites:fe,uniqueRoles:Q}},[S,s]);return e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:t("payrollCalculator")}),e.jsx(Ge,{className:"mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t("period")}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(De,{value:c,onChange:ne=>d(parseInt(ne.target.value)),children:P.map(ne=>e.jsx("option",{value:ne,children:t(U[ne])},ne))}),e.jsx(De,{value:u,onChange:ne=>h(parseInt(ne.target.value)),children:A.map(ne=>e.jsx("option",{value:ne,children:ne},ne))})]})]}),e.jsxs(De,{label:t("filterBySite"),value:m,onChange:ne=>f(ne.target.value),children:[e.jsx("option",{value:"all",children:t("allSites")}),s.map(ne=>e.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]})}),e.jsxs(Ge,{title:t("employeeSelection"),children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:t("selectEmployeesAndCalculate")}),e.jsx("div",{className:"max-h-96 overflow-y-auto border dark:border-gray-700 rounded-lg",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-50 dark:bg-gray-800/80 backdrop-blur-sm",children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-4",children:e.jsx(jt,{ref:E,onChange:W,"aria-label":t("selectAllEmployees")})}),e.jsx("th",{className:"p-3",children:t("name")}),e.jsx("th",{className:"p-3",children:t("site")}),e.jsx("th",{className:"p-3",children:t("role")}),e.jsx("th",{className:"p-3 text-right",children:t("grossWage")})]})}),e.jsx("tbody",{children:z.length>0?z.map(ne=>{var we;return e.jsxs("tr",{className:"border-b dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-800/30",children:[e.jsx("td",{className:"p-3",children:e.jsx(jt,{checked:v.has(ne.id),onChange:()=>J(ne.id)})}),e.jsxs("td",{className:"p-3 font-semibold",children:[ne.firstName," ",ne.lastName]}),e.jsx("td",{className:"p-3",children:((we=s.find(fe=>fe.id===ne.siteId))==null?void 0:we.name)||"N/A"}),e.jsx("td",{className:"p-3",children:ne.role}),e.jsx("td",{className:"p-3 text-right",children:Ae(ne.grossWage,l.localization)})]},ne.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-4 text-gray-500",children:t("noEmployeesMatchFilters")})})})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs(se,{onClick:B,disabled:v.size===0,children:[e.jsx(te,{name:"Calculator",className:"w-5 h-5"}),t("processPayrollFor").replace("{count}",String(v.size))]})})]}),S.length>0&&e.jsxs(Ge,{className:"mt-6",title:t("payrollResults"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("payrollSummaryForPeriod").replace("{period}",F)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(se,{variant:"secondary",onClick:()=>_(!0),children:[e.jsx(te,{name:"Settings",className:"w-4 h-4"}),t("bulkConfigure")]}),e.jsxs(se,{onClick:()=>M(!0),children:[e.jsx(te,{name:"Save",className:"w-4 h-4"}),t("save")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:t("totalGrossPay")}),e.jsx("p",{className:"text-2xl font-bold",children:Ae(ue.totalGross,l.localization)})]}),e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:t("totalAllDeductions")}),e.jsx("p",{className:"text-2xl font-bold",children:Ae(ue.totalDeductions,l.localization)})]}),e.jsxs("div",{className:"p-4 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:t("totalNetPay")}),e.jsx("p",{className:"text-2xl font-bold text-blue-800 dark:text-blue-200",children:Ae(ue.totalNet,l.localization)})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3 w-12"}),e.jsx("th",{className:"p-3 min-w-[150px]",children:t("employee")}),e.jsx("th",{className:"p-3 w-28 text-center",children:t("socialDeductions")}),e.jsx("th",{className:"p-3 text-right",children:t("grossSalary")}),e.jsx("th",{className:"p-3 w-32 text-right",children:t("bonuses")}),e.jsx("th",{className:"p-3 w-32 text-right",children:t("overtime")}),e.jsx("th",{className:"p-3 w-32 text-right",children:t("otherDeductions")}),e.jsx("th",{className:"p-3 text-right font-semibold",children:t("totalGross")}),e.jsx("th",{className:"p-3 text-right font-semibold",children:t("payrollTotalDeductions")}),e.jsx("th",{className:"p-3 text-right font-bold text-lg",children:t("netPay")})]})}),e.jsx("tbody",{children:S.map(ne=>{const we=C.has(ne.employee.id);return e.jsxs(ft.Fragment,{children:[e.jsxs("tr",{className:"border-b dark:border-gray-700/50 align-middle",children:[e.jsx("td",{className:"p-3 text-center",children:e.jsx(se,{variant:"ghost",className:"p-1 !rounded-full",onClick:()=>ie(ne.employee.id),children:e.jsx(te,{name:"ChevronRight",className:`w-5 h-5 transition-transform ${we?"rotate-90":""}`})})}),e.jsxs("td",{className:"p-3 font-semibold",children:[ne.employee.firstName," ",ne.employee.lastName]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx(u1,{employeeId:ne.employee.id,appliedDeductions:ne.appliedDeductions,onToggle:$})}),e.jsx("td",{className:"p-3 text-right",children:Ae(ne.baseSalary,l.localization)}),e.jsx("td",{children:e.jsx(de,{type:"number",value:ne.inputs.bonuses,onChange:fe=>X(ne.employee.id,"bonuses",fe.target.value),containerClassName:"w-full",className:"text-right"})}),e.jsx("td",{children:e.jsx(de,{type:"number",value:ne.inputs.overtime,onChange:fe=>X(ne.employee.id,"overtime",fe.target.value),containerClassName:"w-full",className:"text-right"})}),e.jsx("td",{children:e.jsx(de,{type:"number",value:ne.inputs.other,onChange:fe=>X(ne.employee.id,"other",fe.target.value),containerClassName:"w-full",className:"text-right"})}),e.jsx("td",{className:"p-3 text-right font-semibold",children:Ae(ne.totalGross,l.localization)}),e.jsx("td",{className:"p-3 text-right font-semibold",children:Ae(ne.totalDeductions,l.localization)}),e.jsx("td",{className:"p-3 text-right font-bold text-lg",children:Ae(ne.netPay,l.localization)})]}),we&&e.jsx("tr",{className:"bg-gray-100/50 dark:bg-gray-900/50",children:e.jsxs("td",{colSpan:10,className:"p-4",children:[e.jsx("h4",{className:"font-semibold text-md mb-2",children:t("deductionDetails")}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 pl-6",children:[ne.deductions.map(fe=>e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[fe.label,":"]}),e.jsx("span",{children:Ae(fe.amount,l.localization)})]},fe.label)),ne.deductions.length===0&&e.jsx("span",{className:"text-gray-500 text-xs",children:t("noStatutoryDeductions")})]})]})})]},ne.employee.id)})})]})})]}),e.jsx(m1,{isOpen:R,onClose:()=>_(!1),onApply:ae,sites:Ne,roles:oe,payrollConfig:q}),I&&e.jsx(f1,{isOpen:!!I,onClose:()=>O(null),employeeNames:I}),D&&e.jsx(Ut,{isOpen:D,onClose:()=>M(!1),onConfirm:H,title:t("confirmSavePayroll"),message:t("confirmSavePayrollMessage"),confirmText:t("save")})]})},h1=()=>{const{siteId:t}=Gy(),{sites:n}=qe(),{t:s}=je(),r=n.find(c=>c.id===t),l=r?`${s("cultivationCycleManagementTitle")} - ${r.name}`:s("cultivationCycleManagementTitle");return t?e.jsx(km,{initialFilters:{siteId:t},pageTitle:l}):e.jsx("div",{children:"Site not found"})},g1=()=>{const{typeId:t}=Gy(),{seaweedTypes:n}=qe(),{t:s}=je(),r=n.find(c=>c.id===t),l=r?`${s("cultivationCycleManagementTitle")} - ${r.name}`:s("cultivationCycleManagementTitle");return t?e.jsx(km,{initialFilters:{seaweedTypeId:t},pageTitle:l}):e.jsx("div",{children:"Seaweed type not found"})},Uo=({steps:t})=>e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch justify-between gap-2 my-8 relative",children:[e.jsx("div",{className:"hidden md:block absolute top-6 left-0 w-full h-1 bg-gray-200 dark:bg-gray-700 -z-10 transform translate-y-1/2"}),t.map((n,s)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center text-center group relative",children:[s!==t.length-1&&e.jsx("div",{className:"md:hidden absolute left-1/2 bottom-0 w-1 h-8 bg-gray-200 dark:bg-gray-700 transform translate-y-full -translate-x-1/2"}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-white dark:bg-gray-800 border-4 border-blue-100 dark:border-blue-900 flex items-center justify-center shadow-sm mb-3 z-10 group-hover:border-blue-500 transition-colors duration-300",children:e.jsx(te,{name:n.icon,className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsx("h4",{className:"font-bold text-sm text-gray-800 dark:text-gray-200 mb-1",children:n.title}),n.desc&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 px-2",children:n.desc})]},s))]}),Fo=({title:t,fields:n})=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700 p-4 my-4",children:[e.jsxs("h4",{className:"font-bold text-sm text-blue-800 dark:text-blue-300 mb-3 flex items-center",children:[e.jsx(te,{name:"Edit",className:"w-4 h-4 mr-2"}),t]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:n.map((s,r)=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-baseline text-xs",children:[e.jsxs("span",{className:"font-mono font-semibold text-gray-700 dark:text-gray-300 w-32 shrink-0",children:[s.name," ",s.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400 italic border-l-2 border-gray-200 dark:border-gray-600 pl-2 sm:ml-2",children:s.description})]},r))})]}),Ou=({title:t,subItems:n,color:s})=>{const r={blue:"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800",green:"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800",orange:"bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-800"};return e.jsxs("div",{className:`p-4 rounded-lg border ${r[s]} flex-1 min-w-[200px]`,children:[e.jsx("h4",{className:"font-bold mb-3 text-center uppercase text-sm",children:t}),e.jsx("ul",{className:"space-y-2",children:n.map((l,c)=>e.jsxs("li",{className:"flex items-center text-xs bg-white dark:bg-gray-800 p-2 rounded shadow-sm",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 bg-${s}-500`}),l]},c))})]})},Uu=({text:t})=>{const{t:n}=je();return e.jsxs("div",{className:"flex items-start p-3 bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 rounded-r text-xs my-4",children:[e.jsx(te,{name:"Sun",className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block mb-1",children:n("tip_title")}),t]})]})},x1=()=>{const{t}=je();return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm mb-3 text-gray-700 dark:text-gray-300",children:t("legend_module_status")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["FREE","ASSIGNED","PLANTED","GROWING","HARVESTED","DRYING"].map(n=>e.jsx(mn,{status:n},n))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 italic",children:t("legend_module_desc")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm mb-3 text-gray-700 dark:text-gray-300",children:t("legend_incident_severity")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["LOW","MEDIUM","HIGH","CRITICAL"].map(n=>e.jsx(mn,{status:n},n))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 italic",children:t("legend_incident_desc")})]})]})},ka=({title:t,children:n,defaultOpen:s=!1})=>{const[r,l]=N.useState(s);return e.jsxs(Ge,{className:"mb-4 overflow-hidden transition-all hover:shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer select-none p-1",onClick:()=>l(!r),children:[e.jsx("h2",{className:"text-lg font-bold uppercase tracking-wide text-gray-800 dark:text-gray-100",children:t}),e.jsx(te,{name:"ChevronDown",className:`w-6 h-6 transition-transform duration-200 ${r?"rotate-180":""}`})]}),e.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden ${r?"max-h-[3000px] opacity-100 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700/50":"max-h-0 opacity-0"}`,children:n})]})},y1=()=>{const{t}=je();return e.jsxs("div",{className:"pb-20 max-w-5xl mx-auto font-sans",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2 text-blue-900 dark:text-blue-100",children:t("userManual")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 max-w-2xl mx-auto text-sm",children:t("manual_introduction_text").replace(/<[^>]*>?/gm,"")})]}),e.jsx(ka,{title:t("manual_architecture_title"),defaultOpen:!0,children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(Ou,{title:t("operations"),color:"green",subItems:[t("siteManagementTitle"),t("moduleManagementTitle"),t("cultivationCycleManagementTitle"),t("harvestProcessingTitle")]}),e.jsx(Ou,{title:t("inventory"),color:"orange",subItems:[t("onSiteStorageTitle"),t("siteTransfersTitle"),t("pressedWarehouseTitle"),t("exports")]}),e.jsx(Ou,{title:t("stakeholders"),color:"blue",subItems:[t("farmerManagementTitle"),t("farmerCreditsTitle"),t("documentPaymentsTitle"),t("reports")]})]})}),e.jsxs(ka,{title:t("manual_setup_title"),children:[e.jsx("p",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:t("manual_setup_desc")}),e.jsx(Uo,{steps:[{title:t("step_sites"),icon:"MapPin",desc:t("step_desc_define_locations")},{title:t("step_modules"),icon:"Grid",desc:t("step_desc_create_infra")},{title:t("step_farmers"),icon:"User",desc:t("step_desc_add_personnel")},{title:t("step_assign"),icon:"UserCog",desc:t("step_desc_link_farmers")}]}),e.jsx(Fo,{title:t("siteManagementTitle"),fields:[{name:t("siteName"),description:t("field_site_name"),required:!0},{name:t("manager"),description:t("field_manager")},{name:t("zones"),description:t("field_zones")}]}),e.jsx(Uu,{text:t("tip_map_interaction")})]}),e.jsxs(ka,{title:t("manual_production_title"),children:[e.jsx("h3",{className:"font-bold text-md mb-2 text-gray-800 dark:text-gray-200",children:t("cyclePerformance")}),e.jsx(Uo,{steps:[{title:t("flow_planting"),icon:"GitBranch"},{title:t("flow_growing"),icon:"Sun"},{title:t("flow_harvest"),icon:"Scissors"},{title:t("flow_drying"),icon:"Wind"},{title:t("flow_bagging"),icon:"Archive"},{title:t("flow_stock"),icon:"Warehouse"}]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Fo,{title:t("guide_how_to_harvest"),fields:[{name:t("date"),description:t("date"),required:!0},{name:t("harvestedWeight"),description:t("field_harvest_weight"),required:!0},{name:t("cuttingsTaken"),description:t("field_cuttings_taken")},{name:t("linesHarvested"),description:t("numberOfLines"),required:!0}]}),e.jsxs("div",{className:"p-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("h4",{className:"font-bold mb-2",children:t("notes")}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:t("manual_desc_planting")}),e.jsx("li",{children:t("manual_desc_harvest")}),e.jsx("li",{children:t("manual_desc_processing")})]})]})]}),e.jsx(Uu,{text:t("tip_auto_growth")})]}),e.jsxs(ka,{title:t("manual_inventory_title"),children:[e.jsx(Uo,{steps:[{title:t("stocks_sur_sites"),icon:"MapPin",desc:t("step_desc_collection")},{title:t("flow_transfer"),icon:"Truck",desc:t("step_desc_shipping_slip")},{title:t("flow_warehouse"),icon:"Building",desc:t("step_desc_reception")},{title:t("flow_pressing"),icon:"Archive",desc:t("step_desc_processing")},{title:t("flow_export"),icon:"Globe",desc:t("step_desc_shipping")}]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 p-2 border-l-2 border-blue-500 bg-blue-50 dark:bg-blue-900/10",children:[e.jsxs("strong",{children:[t("notes"),":"]})," ",t("manual_inventory_note")]})]}),e.jsxs(ka,{title:t("manual_finance_title"),children:[e.jsx("p",{className:"text-sm mb-4",children:t("manual_finance_desc")}),e.jsx(Fo,{title:t("guide_how_to_pay"),fields:[{name:t("period"),description:t("deliveryPeriod"),required:!0},{name:t("paymentType"),description:t("desc_select_payment_type"),required:!0},{name:t("site"),description:t("desc_filter_site")}]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"p-3 border rounded-lg bg-green-50 dark:bg-green-900/20 dark:border-green-800",children:[e.jsx("h5",{className:"font-bold text-xs uppercase text-green-800 dark:text-green-300 mb-2",children:t("manual_finance_formula_title")}),e.jsx("p",{className:"text-xs font-mono whitespace-pre-line",children:e.jsx("strong",{children:t("manual_finance_formula_text")})})]}),e.jsxs("div",{className:"p-3 border rounded-lg bg-blue-50 dark:bg-blue-900/20 dark:border-blue-800",children:[e.jsx("h5",{className:"font-bold text-xs uppercase text-blue-800 dark:text-blue-300 mb-2",children:t("reports")}),e.jsx("p",{className:"text-xs",children:t("manual_finance_reports_text")})]})]})]}),e.jsxs(ka,{title:t("manual_monitoring_title"),children:[e.jsx(Uo,{steps:[{title:t("step_log_test"),icon:"Beaker",desc:t("step_desc_weekly")},{title:t("step_analyze_pest"),icon:"Camera",desc:t("step_desc_ai")},{title:t("step_resolve_incident"),icon:"Check",desc:t("step_desc_action")}]}),e.jsx(Fo,{title:t("guide_periodic_test"),fields:[{name:t("date"),description:t("date"),required:!0},{name:t("period"),description:t("desc_select_period"),required:!0},{name:t("field_water_temp"),description:t("desc_optional_api")},{name:t("field_salinity"),description:t("desc_manual_entry")}]}),e.jsx(Uu,{text:t("tip_ai_pest")})]}),e.jsx(ka,{title:t("manual_reports_title"),children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"p-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("span",{className:"font-bold text-blue-600",children:t("globalFarmReport")}),": ",t("report_type_global")]}),e.jsxs("div",{className:"p-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("span",{className:"font-bold text-blue-600",children:t("individualFarmerReport")}),": ",t("report_type_farmer")]}),e.jsxs("div",{className:"p-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("span",{className:"font-bold text-blue-600",children:t("documentPaymentsTitle")}),": ",t("report_type_payment")]})]})}),e.jsx(ka,{title:t("status_legend_title"),children:e.jsx(x1,{})}),e.jsx("div",{className:"mt-8 text-center text-xs text-gray-400",children:e.jsxs("p",{children:[t("appName")," v1.1 - ",t("manual_introduction")]})})]})},v1=(t,n)=>new Date(t,n+1,0).getDate(),b1=(t,n)=>{const s=new Date(t,n,1).getDay();return s===0?6:s-1},Iy=(t,n)=>t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear(),N1=()=>{const{t,language:n}=je(),{cultivationCycles:s,monthlyPayments:r,incidents:l,periodicTests:c,modules:d,seaweedTypes:u,incidentTypes:h,sites:m}=qe(),[f,v]=N.useState(new Date),[x,S]=N.useState(null),[w,C]=N.useState({HARVEST:!0,PAYMENT:!0,INCIDENT:!0,TEST:!0}),[T,E]=N.useState(!1),R=N.useMemo(()=>{const J=[];s.forEach(G=>{if(G.status===Je.PLANTED||G.status===Je.GROWING){const B=new Date(G.plantingDate),X=new Date(B);X.setDate(B.getDate()+Zs);const $=d.find(H=>H.id===G.moduleId),ae=u.find(H=>H.id===G.seaweedTypeId);J.push({id:`harvest-${G.id}`,date:X,type:"HARVEST",title:`${t("projectedHarvest")}: ${$==null?void 0:$.code}`,colorClass:"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/50 dark:text-green-200 dark:border-green-800",details:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("module"),":"]})," ",$==null?void 0:$.code]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("seaweedType"),":"]})," ",ae==null?void 0:ae.name]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("plantingDate"),":"]})," ",G.plantingDate]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("initialWeight"),":"]})," ",G.initialWeight," kg"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("status"),":"]})," ",e.jsx(mn,{status:G.status})]})]})})}});const W=new Set;return r.forEach(G=>{const B=G.paymentRunId||G.date;W.has(B)||(W.add(B),J.push({id:`pay-${G.id}`,date:new Date(G.date),type:"PAYMENT",title:`${t("paymentRun")}`,colorClass:"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/50 dark:text-blue-200 dark:border-blue-800",details:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("date"),":"]})," ",G.date]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("period"),":"]})," ",G.period]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Details available in Document Payments."})]})}))}),l.forEach(G=>{var $,ae;const B=(($=h.find(H=>H.id===G.type))==null?void 0:$.name)||G.type,X=((ae=m.find(H=>H.id===G.siteId))==null?void 0:ae.name)||"Unknown Site";J.push({id:`inc-${G.id}`,date:new Date(G.date),type:"INCIDENT",title:`${t("incidentsLabel")}: ${B}`,colorClass:"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/50 dark:text-red-200 dark:border-red-800",details:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("site"),":"]})," ",X]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("type"),":"]})," ",B]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("severity"),":"]})," ",e.jsx(mn,{status:G.severity})]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("status"),":"]})," ",e.jsx(mn,{status:G.status})]}),e.jsxs("p",{className:"italic",children:['"',G.description,'"']})]})})}),c.forEach(G=>{var X;const B=((X=m.find($=>$.id===G.siteId))==null?void 0:X.name)||"Unknown Site";J.push({id:`test-${G.id}`,date:new Date(G.date),type:"TEST",title:`${t("periodicTest")}: ${G.identity}`,colorClass:"bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900/50 dark:text-purple-200 dark:border-purple-800",details:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[t("identity"),":"]})," ",G.identity]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("site"),":"]})," ",B]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[t("growthRate"),":"]})," ",G.growthRate?`${G.growthRate}%`:"-"]})]})})}),J.filter(G=>w[G.type])},[s,r,l,c,d,u,h,m,t,w]),_=()=>{v(new Date(f.getFullYear(),f.getMonth()+1,1))},D=()=>{v(new Date(f.getFullYear(),f.getMonth()-1,1))},M=()=>{v(new Date)},I=async()=>{const J=new Date(f.getFullYear(),f.getMonth(),1),W=new Date(f.getFullYear(),f.getMonth()+1,0),G=R.filter(B=>B.date>=J&&B.date<=W).map(B=>({date:B.date.toLocaleDateString(n),type:B.type,title:B.title}));if(G.length===0){alert(t("noDataForReport"));return}await Yr(G,[{header:t("date"),key:"date",width:15},{header:t("category"),key:"type",width:15},{header:t("description"),key:"title",width:50}],`Calendar_${f.toLocaleDateString(n,{month:"long",year:"numeric"})}`,"Calendar Events")},O=f.getFullYear(),A=f.getMonth(),U=v1(O,A),P=b1(O,A),F=[];for(let J=0;J<P;J++)F.push(null);for(let J=1;J<=U;J++)F.push(new Date(O,A,J));const q=f.toLocaleDateString(n,{month:"long",year:"numeric"}),z=["mon","tue","wed","thu","fri","sat","sun"].map(J=>t(J));return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(te,{name:"Calendar",className:"w-8 h-8 text-blue-600"}),t("operationalCalendarTitle")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{variant:"secondary",onClick:I,className:"hidden sm:flex",children:[e.jsx(te,{name:"FileSpreadsheet",className:"w-5 h-5 mr-2"}),t("exportExcel")]}),e.jsxs("div",{className:"flex items-center bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-1",children:[e.jsx("button",{onClick:D,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:e.jsx(te,{name:"ChevronLeft",className:"w-5 h-5"})}),e.jsx("span",{className:"px-4 font-bold min-w-[150px] text-center capitalize",children:q}),e.jsx("button",{onClick:_,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:e.jsx(te,{name:"ChevronRight",className:"w-5 h-5"})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-2"}),e.jsx("button",{onClick:M,className:"px-3 py-1 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-md",children:"Today"}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-2"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>E(!T),className:`p-2 rounded-md ${T?"bg-blue-100 text-blue-700":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:t("filterEvents"),children:e.jsx(te,{name:"Filter",className:"w-5 h-5"})}),T&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-2 z-20",children:e.jsx("div",{className:"space-y-1",children:["HARVEST","PAYMENT","INCIDENT","TEST"].map(J=>e.jsxs("label",{className:"flex items-center p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w[J],onChange:W=>C(G=>({...G,[J]:W.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm capitalize",children:J.toLowerCase()})]},J))})})]})]})]})]}),e.jsxs(Ge,{className:"flex-grow flex flex-col p-0 overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:z.map(J=>e.jsx("div",{className:"py-3 text-center text-sm font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:J},J))}),e.jsx("div",{className:"grid grid-cols-7 flex-grow auto-rows-fr bg-gray-200 dark:bg-gray-700 gap-px",children:F.map((J,W)=>{if(!J)return e.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-900/50 min-h-[120px]"},`empty-${W}`);const G=R.filter(X=>Iy(X.date,J)),B=Iy(J,new Date);return e.jsxs("div",{className:`bg-white dark:bg-gray-900 min-h-[120px] p-2 flex flex-col transition-colors hover:bg-gray-50 dark:hover:bg-gray-800 relative ${B?"bg-blue-50/30":""}`,children:[e.jsx("span",{className:`text-sm font-medium mb-1 w-7 h-7 flex items-center justify-center rounded-full ${B?"bg-blue-600 text-white":"text-gray-700 dark:text-gray-300"}`,children:J.getDate()}),e.jsx("div",{className:"flex-grow space-y-1 overflow-y-auto max-h-[120px] custom-scrollbar",children:G.map(X=>e.jsx("div",{onClick:()=>S(X),className:`text-xs px-2 py-1 rounded border truncate cursor-pointer shadow-sm hover:opacity-80 transition-opacity ${X.colorClass}`,title:X.title,children:X.title},X.id))})]},J.toISOString())})})]}),x&&e.jsx(at,{isOpen:!!x,onClose:()=>S(null),title:x.title,widthClass:"max-w-md",footer:e.jsx(se,{onClick:()=>S(null),children:t("close")}),children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:`p-3 rounded-lg mb-4 border ${x.colorClass}`,children:e.jsx("span",{className:"font-bold uppercase tracking-wider text-xs",children:x.type})}),x.details]})})]})},_y=({year:t,siteName:n})=>{const{t:s}=je(),{settings:r}=$e(),l=N.useMemo(()=>{var c;return((c=Vt.find(d=>d.code===r.localization.country))==null?void 0:c.name)||r.localization.country},[r.localization.country]);return e.jsxs("header",{className:"mb-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("img",{src:r.company.logoUrl,alt:`${r.company.name} logo`,className:"h-10 w-auto object-contain"})}),e.jsxs("div",{className:"col-span-2 text-center",children:[e.jsx("h1",{className:"font-bold text-sm uppercase mb-0.5",children:r.company.name}),e.jsxs("div",{className:"text-[8px] leading-none space-y-0 text-gray-700",children:[e.jsxs("p",{children:[s("capital"),": ",Ae(r.company.capital,r.localization)]}),e.jsxs("p",{children:[s("address"),": ",r.company.address]}),e.jsxs("p",{children:[s("nif"),": ",r.company.nif," / ",s("stat"),": ",r.company.stat," / ",s("rc"),": ",r.company.rc]}),e.jsxs("p",{children:[s("phone"),": ",r.company.phone," / ",s("email"),": ",r.company.email]}),e.jsxs("p",{children:[s("country"),": ",l]})]})]}),e.jsx("div",{className:"col-span-1 text-right",children:e.jsx("p",{className:"font-bold text-xs",children:t})})]}),e.jsx("div",{className:"border-b-2 border-black mt-1 mb-2"}),e.jsx("h2",{className:"text-center text-base font-bold uppercase underline mb-1",children:s("farmerMonthlyReport")}),n&&e.jsx("h3",{className:"text-center text-sm font-bold text-blue-800 uppercase",children:n})]})},S1=({year:t})=>{const{t:n,language:s}=je(),{settings:r}=$e(),{cultivationCycles:l,modules:c,sites:d,seaweedTypes:u,farmers:h}=qe(),m=N.useMemo(()=>{const v={},x=new Date(t,0,1),S=new Date(t,11,31,23,59,59);return l.forEach(C=>{const T=c.find(I=>I.id===C.moduleId);if(!T||!T.farmerId||!T.siteId)return;const E=T.siteId,R=C.seaweedTypeId,_=T.farmerId,D=h.find(I=>I.id===_);if(!D)return;v[E]||(v[E]={}),v[E][R]||(v[E][R]={}),v[E][R][_]||(v[E][R][_]={name:`${D.lastName} ${D.firstName}`,months:Array.from({length:12},()=>({planted:0,harvested:0,production:0}))});const M=new Date(C.plantingDate);if(M>=x&&M<=S){const I=M.getMonth();v[E][R][_].months[I].planted+=C.linesPlanted||T.lines||0}if(C.harvestDate){const I=new Date(C.harvestDate);if(I>=x&&I<=S){const O=I.getMonth();v[E][R][_].months[O].harvested+=C.linesHarvested||0;const A=(C.harvestedWeight||0)-(C.cuttingsTakenAtHarvestKg||0);v[E][R][_].months[O].production+=A}}}),Object.keys(v).map(C=>{var R;const T=((R=d.find(_=>_.id===C))==null?void 0:R.name)||"Unknown Site",E=Object.keys(v[C]).map(_=>{var O;const D=((O=u.find(A=>A.id===_))==null?void 0:O.name)||"Unknown Type",M=Object.values(v[C][_]).sort((A,U)=>A.name.localeCompare(U.name)),I=Array.from({length:12},()=>({planted:0,harvested:0,production:0}));return M.forEach(A=>{A.months.forEach((U,P)=>{I[P].planted+=U.planted,I[P].harvested+=U.harvested,I[P].production+=U.production})}),{id:_,name:D,farmers:M,totals:I}}).sort((_,D)=>_.name.localeCompare(D.name));return{id:C,name:T,types:E}}).sort((C,T)=>C.name.localeCompare(T.name))},[h,l,c,t,d,u]),f=N.useMemo(()=>{const v=[];for(let x=0;x<12;x++)v.push(new Date(t,x,1).toLocaleDateString(s,{month:"short",year:"2-digit"}));return v},[t,s]);return m.length===0?e.jsxs(gs,{landscape:!0,children:[e.jsx(_y,{year:t}),e.jsxs("div",{className:"p-8 text-center border border-dashed border-gray-300 rounded-lg bg-gray-50",children:[e.jsx("p",{className:"text-sm text-gray-500",children:n("noDataForReport")}),e.jsx("div",{className:"mt-4 overflow-x-auto opacity-50",children:e.jsxs("table",{className:"w-full border-collapse border border-black text-[7px] text-black font-sans table-fixed",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-black p-1 font-bold bg-gray-100 text-left",style:{width:"180px"},children:n("farmer")}),f.map((v,x)=>e.jsx("th",{className:"border border-black p-1 font-bold bg-gray-100 text-center",colSpan:2,children:v},x))]})}),e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{className:"border border-black p-4 text-center",colSpan:25,children:"-"})})})]})})]})]}):e.jsx(e.Fragment,{children:m.map(v=>e.jsxs(gs,{landscape:!0,children:[e.jsx(_y,{year:t,siteName:v.name}),v.types.map(x=>e.jsxs("div",{className:"mb-8 break-inside-avoid",children:[e.jsxs("h4",{className:"font-bold text-xs mb-2 pl-2 border-l-4 border-green-500 bg-gray-50 p-1",children:[n("seaweedType"),": ",x.name]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-black text-[7px] text-black font-sans table-fixed",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-black p-1 font-bold bg-gray-100 text-left",style:{width:"180px"},children:n("farmer")}),f.map((S,w)=>e.jsx("th",{className:"border border-black p-1 font-bold bg-gray-100 text-center",colSpan:2,children:S},w))]})}),e.jsx("tbody",{children:x.farmers.map(S=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 font-bold",children:S.name}),S.months.map((w,C)=>e.jsxs(ft.Fragment,{children:[e.jsx("td",{className:"border border-black p-0.5 text-center align-middle",style:{width:"30px"},children:e.jsxs("div",{className:"flex flex-col leading-tight",children:[e.jsx("span",{className:"text-blue-600 font-semibold",children:w.planted||"-"}),e.jsx("span",{className:"border-t border-gray-300 my-0.5"}),e.jsx("span",{className:"text-red-600 font-semibold",children:w.harvested||"-"})]})}),e.jsx("td",{className:"border border-black p-0.5 text-center align-middle font-bold bg-gray-50/50",style:{width:"30px"},children:w.production?Fe(w.production,{...r.localization,nonMonetaryDecimals:0}):"-"})]},C))]},S.name))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("td",{className:"border border-black p-1 font-bold",children:n("total")}),x.totals.map((S,w)=>e.jsxs(ft.Fragment,{children:[e.jsx("td",{className:"border border-black p-0.5 text-center align-middle",children:e.jsxs("div",{className:"flex flex-col leading-tight",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:S.planted}),e.jsx("span",{className:"border-t border-gray-400 my-0.5"}),e.jsx("span",{className:"text-red-600 font-bold",children:S.harvested})]})}),e.jsx("td",{className:"border border-black p-0.5 text-center align-middle font-bold",children:Fe(S.production,{...r.localization,nonMonetaryDecimals:0})})]},w))]})})]})})]},x.id)),e.jsxs("div",{className:"mt-auto pt-4 flex gap-4 text-[8px] border-t border-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:n("legendColorBlue")})," ",n("legendPlantedLines")]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-red-600 font-bold",children:n("legendColorRed")})," ",n("legendHarvestedLines")]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-bold",children:n("legendColorBlack")})," ",n("legendProductionKg")]})]})]},v.id))})},sl=({title:t,generator:n,className:s,minimal:r=!1})=>{const{t:l}=je(),[c,d]=N.useState(""),[u,h]=N.useState(!1),[m,f]=N.useState(""),v=async()=>{h(!0),f("");try{const S=(await n()).split("###").map(w=>{if(!w.trim())return"";const[C,...T]=w.trim().split(`
`);return`
${`**${C.replace(/^[0-9.]+\s*/,"")}**`}
${T.join(`
`).trim()}`}).join(`
`).trim();d(S)}catch(x){console.error("Error generating narrative",x),f(l("errorGeneratingNarrative"))}finally{h(!1)}};return e.jsxs("div",{className:`flex flex-col h-full ${s||"mt-4"}`,children:[e.jsx("div",{className:"no-print mb-1 flex-shrink-0",children:e.jsxs(se,{onClick:v,disabled:u,className:"!text-xs !py-0.5 !px-2 h-6",children:[e.jsx(te,{name:u?"Activity":"Bot",className:`w-3 h-3 ${u?"animate-spin":""}`}),t]})}),e.jsxs("div",{className:`${r?"flex-grow overflow-hidden":"p-4 bg-white rounded-lg border border-gray-200"} min-h-[20px]`,children:[u&&e.jsxs("p",{className:"text-xs italic text-center text-black",children:[l("loading"),"..."]}),m&&e.jsx("p",{className:"text-xs text-red-600 text-center",children:m}),c&&e.jsx("div",{className:r?"text-xs leading-normal text-black whitespace-pre-wrap font-normal h-full text-justify":"prose prose-sm max-w-none whitespace-pre-wrap text-black",dangerouslySetInnerHTML:{__html:c.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br />")}})]})]})},j1=({month:t,year:n,farmerId:s})=>{const{t:r,language:l}=je(),{settings:c}=$e(),{farmers:d,sites:u,cultivationCycles:h,modules:m,incidents:f}=qe(),v=new Date(n,t).toLocaleDateString(l,{month:"long",year:"numeric"}),x=new Date(n,t,1),S=new Date(n,t+1,0,23,59,59);N.useMemo(()=>{var _;return((_=Vt.find(D=>D.code===c.localization.country))==null?void 0:_.name)||c.localization.country},[c.localization.country]);const w=N.useMemo(()=>d.find(_=>_.id===s),[d,s]),C=N.useMemo(()=>u.find(_=>_.id===(w==null?void 0:w.siteId)),[u,w]),T=N.useMemo(()=>m.filter(_=>_.farmerId===s),[m,s]),E=N.useMemo(()=>{const _=h.filter(U=>{const P=m.find(F=>F.id===U.moduleId);return(P==null?void 0:P.farmerId)===s&&(new Date(U.plantingDate)<=S&&new Date(U.plantingDate)>=x||U.harvestDate&&new Date(U.harvestDate)<=S&&new Date(U.harvestDate)>=x)}),D=_.filter(U=>U.harvestDate&&new Date(U.harvestDate)>=x&&new Date(U.harvestDate)<=S),M=_.filter(U=>new Date(U.plantingDate)>=x&&new Date(U.plantingDate)<=S),I=D.reduce((U,P)=>U+(P.harvestedWeight||0),0),O=_.filter(U=>U.status==="PLANTED"||U.status==="GROWING").length,A=f.filter(U=>new Date(U.date)>=x&&new Date(U.date)<=S&&U.affectedModuleIds.some(P=>T.some(F=>F.id===P)));return{plantedLines:M.reduce((U,P)=>U+(P.linesPlanted||0),0),harvestedLines:D.reduce((U,P)=>U+(P.linesHarvested||0),0),harvestedWeight:I,activeCycles:O,incidentsCount:A.length,incidents:A,harvestedCycles:D}},[h,m,s,x,S,f,T]),R=N.useMemo(()=>{const _=[];return E.harvestedCycles.forEach(M=>{if(M.harvestDate&&M.plantingDate&&M.harvestedWeight&&M.initialWeight){const I=(new Date(M.harvestDate).getTime()-new Date(M.plantingDate).getTime())/864e5,O=sc(M.initialWeight,M.harvestedWeight,I);O!==null&&_.push(O)}}),{avgGrowthRate:_.length>0?_.reduce((M,I)=>M+I,0)/_.length:0}},[E.harvestedCycles]);return w?e.jsxs(gs,{children:[e.jsxs("header",{className:"mb-6 border-b pb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-center uppercase mb-2",children:r("individualFarmerReport")}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[r("farmer"),":"]})," ",w.firstName," ",w.lastName]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[r("code"),":"]})," ",w.code]}),e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[r("site"),":"]})," ",C==null?void 0:C.name]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[r("period"),":"]})," ",v]}),e.jsx("p",{children:c.company.name})]})]})]}),e.jsxs("section",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 border-b border-gray-200 pb-1",children:r("productionSummary")}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{className:"bg-gray-100 p-3 rounded",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:r("totalPlantedLines")}),e.jsx("p",{className:"text-xl font-bold",children:E.plantedLines})]}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:r("totalHarvestedLines")}),e.jsx("p",{className:"text-xl font-bold",children:E.harvestedLines})]}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:r("totalHarvestedWeight")}),e.jsxs("p",{className:"text-xl font-bold",children:[Fe(E.harvestedWeight,c.localization)," kg"]})]}),e.jsxs("div",{className:"bg-gray-100 p-3 rounded",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:r("growthRate")}),e.jsxs("p",{className:"text-xl font-bold",children:[R.avgGrowthRate.toFixed(2),"%"]})]})]})]}),e.jsxs("section",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 border-b border-gray-200 pb-1",children:r("incidentsReported")}),E.incidents.length>0?e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"p-2",children:r("date")}),e.jsx("th",{className:"p-2",children:r("type")}),e.jsx("th",{className:"p-2",children:r("severity")})]})}),e.jsx("tbody",{children:E.incidents.map(_=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"p-2",children:_.date}),e.jsx("td",{className:"p-2",children:_.type}),e.jsx("td",{className:"p-2",children:_.severity})]},_.id))})]}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:r("noIncidentsForFarmer")})]}),e.jsx("section",{children:e.jsx(sl,{title:r("narrativeFarmerPerformance"),generator:()=>ND({farmerName:`${w.firstName} ${w.lastName}`,siteName:(C==null?void 0:C.name)||"",period:v,production:E,efficiency:R,incidentsCount:E.incidentsCount},l)})})]}):e.jsx("div",{children:r("noDataForReport")})},T1=({month:t,year:n,sections:s})=>{const{t:r,language:l}=je(),{settings:c}=$e(),{cultivationCycles:d,modules:u,sites:h,seaweedTypes:m,farmerCredits:f,repayments:v,farmers:x,creditTypes:S,stockMovements:w,employees:C,incidents:T,incidentTypes:E}=qe(),R=new Date(n,t).toLocaleDateString(l,{month:"long",year:"numeric"}),_=new Date(n,t,1),D=new Date(n,t+1,0,23,59,59),M=N.useMemo(()=>{var q;return((q=Vt.find(z=>z.code===c.localization.country))==null?void 0:q.name)||c.localization.country},[c.localization.country]),I=N.useMemo(()=>s.includes("production")?d.filter(q=>q.harvestDate&&new Date(q.harvestDate)>=_&&new Date(q.harvestDate)<=D).map(q=>{const z=u.find(G=>G.id===q.moduleId),J=q.harvestDate?(new Date(q.harvestDate).getTime()-new Date(q.plantingDate).getTime())/(1e3*3600*24):0,W=(q.harvestedWeight||0)-(q.cuttingsTakenAtHarvestKg||0);return{cycle:{...q,harvestedWeight:W},module:z,site:h.find(G=>G.id===(z==null?void 0:z.siteId)),seaweedType:m.find(G=>G.id===q.seaweedTypeId),duration:Math.round(J)}}).sort((q,z)=>new Date(q.cycle.harvestDate).getTime()-new Date(z.cycle.harvestDate).getTime()):[],[s,d,u,h,m,_,D]),O=N.useMemo(()=>{if(!s.includes("finance"))return{reportData:[],summaryStats:{totalCredits:0,totalAmount:0,topFarmers:[]}};const q=new Map(x.map(B=>[B.id,`${B.firstName} ${B.lastName}`])),z=new Map(S.map(B=>[B.id,B.name])),J=f.filter(B=>B.date&&new Date(B.date)>=_&&new Date(B.date)<=D).map(B=>({...B,farmerName:q.get(B.farmerId)||r("unknown"),creditTypeName:z.get(B.creditTypeId)||r("unknown")})),W=new Map;J.forEach(B=>{W.set(B.farmerName,(W.get(B.farmerName)||0)+B.totalAmount)});const G=Array.from(W.entries()).sort(([,B],[,X])=>X-B).slice(0,5).map(([B,X])=>({name:B,total:X}));return{reportData:J,summaryStats:{totalCredits:J.length,totalAmount:J.reduce((B,X)=>B+X.totalAmount,0),topFarmers:G}}},[s,f,x,S,_,D,r]),A=N.useMemo(()=>{if(!s.includes("inventory"))return{reportData:[],summaryStats:{totalKg:0,totalBags:0,totalValue:0}};const q=new Map;w.forEach(G=>{if(new Date(G.date)<=D){const B=`${G.siteId}|${G.seaweedTypeId}`,X=q.get(B)||{kg:0,bags:0};X.kg+=(G.inKg||0)-(G.outKg||0),X.bags+=(G.inBags||0)-(G.outBags||0),q.set(B,X)}});const z=new Map(h.map(G=>[G.id,G.name])),J=new Map(m.map(G=>[G.id,{name:G.name,dryPrice:G.dryPrice}])),W=Array.from(q.entries()).map(([G,B])=>{const[X,$]=G.split("|"),ae=z.get(X)||r("unknown"),H=J.get($),ie=(H==null?void 0:H.name)||r("unknown"),ue=B.kg*((H==null?void 0:H.dryPrice)||0);return{siteName:ae,seaweedTypeName:ie,currentStockKg:Math.max(0,B.kg),currentStockBags:Math.max(0,B.bags),value:ue}}).filter(G=>G.currentStockKg>.01||G.currentStockBags>0);return{reportData:W,summaryStats:{totalKg:W.reduce((G,B)=>G+B.currentStockKg,0),totalBags:W.reduce((G,B)=>G+B.currentStockBags,0),totalValue:W.reduce((G,B)=>G+B.value,0)}}},[s,w,h,m,D,r]),U=N.useCallback(async()=>I.length===0?r("noDataForReport"):await CD(I,l),[I,l,r]),P=N.useCallback(async()=>O.reportData.length===0?r("noDataForReport"):await ED(O.reportData,O.summaryStats,l),[O,l,r]),F=N.useCallback(async()=>A.reportData.length===0?r("noDataForReport"):await ID(A.reportData,A.summaryStats,l),[A,l,r]);return e.jsxs(gs,{children:[e.jsx("header",{className:"mb-8 border-b-2 border-gray-800 dark:border-gray-200 pb-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center",children:[e.jsx("div",{className:"col-span-1",children:e.jsx("img",{src:c.company.logoUrl,alt:`${c.company.name} logo`,className:"h-14 w-auto object-contain"})}),e.jsxs("div",{className:"col-span-2 text-center",children:[e.jsx("h1",{className:"font-bold text-xl uppercase mb-1 text-gray-900 dark:text-gray-100",children:c.company.name}),e.jsxs("div",{className:"text-[9px] leading-tight space-y-0 text-gray-600 dark:text-gray-400",children:[e.jsxs("p",{children:[r("address"),": ",c.company.address]}),e.jsxs("p",{children:[r("nif"),": ",c.company.nif," / ",r("stat"),": ",c.company.stat]}),e.jsxs("p",{children:[r("country"),": ",M]})]})]}),e.jsxs("div",{className:"col-span-1 text-right",children:[e.jsx("h2",{className:"text-xl font-bold uppercase text-gray-900 dark:text-gray-100",children:r("customReportTitle")}),e.jsx("p",{className:"font-bold text-sm mt-1 text-blue-600 dark:text-blue-400",children:R})]})]})}),s.includes("production")&&e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsxs("h3",{className:"text-lg font-bold uppercase border-b-2 border-blue-500 mb-4 pb-1 text-blue-800 dark:text-blue-300 flex items-center",children:[e.jsx("span",{className:"bg-blue-500 w-2 h-6 mr-2 rounded-sm inline-block"}),r("section_production")]}),e.jsx("div",{className:"overflow-x-auto mb-4 border rounded-lg border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"w-full text-left text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-50 dark:bg-blue-900/30 border-b border-blue-200 dark:border-blue-800",children:[e.jsx("th",{className:"p-3 font-bold text-blue-900 dark:text-blue-100",children:r("site")}),e.jsx("th",{className:"p-3 font-bold text-blue-900 dark:text-blue-100",children:r("module")}),e.jsx("th",{className:"p-3 font-bold text-blue-900 dark:text-blue-100",children:r("seaweedType")}),e.jsxs("th",{className:"p-3 font-bold text-blue-900 dark:text-blue-100 text-right",children:[r("harvestedWeight")," (Net Kg)"]}),e.jsx("th",{className:"p-3 font-bold text-blue-900 dark:text-blue-100 text-right",children:r("duration")})]})}),e.jsx("tbody",{children:I.length>0?I.map((q,z)=>{var J,W,G;return e.jsxs("tr",{className:`border-b border-gray-200 dark:border-gray-700 ${z%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-800/50"}`,children:[e.jsx("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:(J=q.site)==null?void 0:J.name}),e.jsx("td",{className:"p-2 font-mono text-gray-600 dark:text-gray-400",children:(W=q.module)==null?void 0:W.code}),e.jsx("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:(G=q.seaweedType)==null?void 0:G.name}),e.jsx("td",{className:"p-2 text-right font-medium text-gray-900 dark:text-gray-100",children:Fe(q.cycle.harvestedWeight||0,c.localization)}),e.jsxs("td",{className:"p-2 text-right text-gray-600 dark:text-gray-400",children:[q.duration," ",r("days")]})]},q.cycle.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-4 text-center italic text-gray-500 dark:text-gray-400",children:r("noDataForReport")})})})]})}),I.length>0&&e.jsx(sl,{title:r("aiAnalysis"),generator:U,minimal:!0})]}),s.includes("finance")&&e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsxs("h3",{className:"text-lg font-bold uppercase border-b-2 border-green-500 mb-4 pb-1 text-green-800 dark:text-green-300 flex items-center",children:[e.jsx("span",{className:"bg-green-500 w-2 h-6 mr-2 rounded-sm inline-block"}),r("section_finance")]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6 text-center",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 shadow-sm",children:[e.jsx("p",{className:"text-xs uppercase tracking-wider text-green-600 dark:text-green-400 mb-1",children:r("totalCreditsIssued")}),e.jsx("p",{className:"font-bold text-2xl text-green-900 dark:text-green-100",children:O.summaryStats.totalCredits})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 shadow-sm",children:[e.jsx("p",{className:"text-xs uppercase tracking-wider text-green-600 dark:text-green-400 mb-1",children:r("totalCreditAmount")}),e.jsx("p",{className:"font-bold text-2xl text-green-900 dark:text-green-100",children:Ae(O.summaryStats.totalAmount,c.localization)})]})]}),O.reportData.length>0&&e.jsx(sl,{title:r("aiAnalysis"),generator:P,minimal:!0})]}),s.includes("inventory")&&e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsxs("h3",{className:"text-lg font-bold uppercase border-b-2 border-yellow-500 mb-4 pb-1 text-yellow-800 dark:text-yellow-300 flex items-center",children:[e.jsx("span",{className:"bg-yellow-500 w-2 h-6 mr-2 rounded-sm inline-block"}),r("section_inventory")]}),e.jsx("div",{className:"overflow-x-auto mb-4 border rounded-lg border-gray-200 dark:border-gray-700",children:e.jsxs("table",{className:"w-full text-left text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-yellow-50 dark:bg-yellow-900/30 border-b border-yellow-200 dark:border-yellow-800",children:[e.jsx("th",{className:"p-3 font-bold text-yellow-900 dark:text-yellow-100",children:r("site")}),e.jsx("th",{className:"p-3 font-bold text-yellow-900 dark:text-yellow-100",children:r("seaweedType")}),e.jsx("th",{className:"p-3 font-bold text-yellow-900 dark:text-yellow-100 text-right",children:r("stockKg")}),e.jsx("th",{className:"p-3 font-bold text-yellow-900 dark:text-yellow-100 text-right",children:r("stockBales")})]})}),e.jsx("tbody",{children:A.reportData.length>0?A.reportData.map((q,z)=>e.jsxs("tr",{className:`border-b border-gray-200 dark:border-gray-700 ${z%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-800/50"}`,children:[e.jsx("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:q.siteName}),e.jsx("td",{className:"p-2 text-gray-800 dark:text-gray-200",children:q.seaweedTypeName}),e.jsx("td",{className:"p-2 text-right font-medium text-gray-900 dark:text-gray-100",children:Fe(q.currentStockKg,c.localization)}),e.jsx("td",{className:"p-2 text-right font-medium text-gray-900 dark:text-gray-100",children:Fe(q.currentStockBags,{...c.localization,nonMonetaryDecimals:0})})]},`${q.siteName}-${q.seaweedTypeName}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-4 text-center italic text-gray-500 dark:text-gray-400",children:r("noDataForReport")})})})]})}),A.reportData.length>0&&e.jsx(sl,{title:r("aiAnalysis"),generator:F,minimal:!0})]}),s.includes("incidents")&&e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsxs("h3",{className:"text-lg font-bold uppercase border-b-2 border-red-500 mb-4 pb-1 text-red-800 dark:text-red-300 flex items-center",children:[e.jsx("span",{className:"bg-red-500 w-2 h-6 mr-2 rounded-sm inline-block"}),r("section_incidents")]}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-center",children:e.jsx("p",{className:"text-sm italic text-gray-500 dark:text-gray-400",children:r("noMajorIncidents")})})]})]})},Jr=({children:t,className:n=""})=>e.jsx("div",{className:`report-page-landscape bg-white shadow-lg mx-auto my-8 flex flex-col h-auto min-h-[210mm] overflow-visible print:overflow-visible print:shadow-none ${n}`,children:e.jsx("div",{className:"flex-grow flex flex-col font-sans text-xs leading-normal text-black p-6 box-border w-full",children:t})}),Xr=({period:t,title:n})=>{const{settings:s}=$e(),{t:r}=je();return e.jsxs("header",{className:"flex-shrink-0 text-black relative mb-4 border-b-2 border-gray-800 pb-2",children:[e.jsx("div",{className:"absolute top-0 right-0 text-[9px] font-bold text-gray-600",children:t}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:s.company.logoUrl,alt:"Logo",className:"h-10 w-auto object-contain"})}),e.jsxs("div",{className:"flex-grow text-center",children:[e.jsx("h1",{className:"font-bold text-sm uppercase mb-1 tracking-wide",children:s.company.name}),e.jsxs("div",{className:"text-[8px] text-gray-600 flex flex-wrap justify-center gap-x-3 leading-tight",children:[e.jsxs("span",{children:[r("company_sarl")," ",Ae(s.company.capital,s.localization)]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{children:["NIF: ",s.company.nif]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{children:["STAT: ",s.company.stat]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{children:["RCS: ",s.company.rc]})]}),e.jsxs("div",{className:"text-[8px] text-gray-600 flex flex-wrap justify-center gap-x-3 leading-tight mt-0.5",children:[e.jsx("span",{children:s.company.address}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{children:[r("phone"),": ",s.company.phone]})]})]}),e.jsx("div",{className:"w-20"})," "]}),e.jsx("div",{className:"text-center mt-3",children:n&&e.jsx("h2",{className:"font-bold text-sm uppercase tracking-wider inline-block pb-0.5",children:n})})]})},Qr=({page:t,totalPages:n})=>e.jsxs("div",{className:"mt-auto pt-4 text-center text-[8px] text-gray-500 border-t border-gray-300 print:mt-auto break-before-avoid",children:["Page ",t," / ",n]}),le=({children:t,className:n="",colSpan:s,rowSpan:r,header:l=!1,align:c="center",bold:d=!1,title:u})=>e.jsx("td",{colSpan:s,rowSpan:r,title:u,className:`px-1 py-0.5 border border-gray-400 text-[8px] text-black align-middle text-${c} ${l?"font-bold bg-gray-100 text-gray-900":""} ${d?"font-bold":""} ${n}`,children:t||e.jsx(e.Fragment,{children:""})}),Ra=({generator:t,className:n="",title:s})=>{const{t:r}=je();return e.jsxs("div",{className:`text-black flex flex-col mt-4 break-inside-avoid ${n}`,children:[e.jsxs("div",{className:"font-bold text-[9px] mb-1 uppercase text-blue-800 border-b border-blue-200 inline-block self-start",children:[s," :"]}),e.jsx("div",{className:"relative text-[9pt] leading-snug text-justify text-gray-800 bg-gray-50 p-2 rounded border border-gray-200",children:e.jsx(sl,{title:r("narratif_explicatif_tableau"),generator:t,minimal:!0,className:"mt-0 !h-auto"})})]})},w1=({month:t,year:n})=>{const{t:s,language:r}=je(),l=qe(),{sites:c,seaweedTypes:d,cultivationCycles:u,modules:h,incidents:m,periodicTests:f,farmers:v,stockMovements:x,pressedStockMovements:S,exportDocuments:w,creditTypes:C,farmerCredits:T,repayments:E,employees:R,roles:_,monthlyPayments:D,incidentTypes:M}=l,I=N.useMemo(()=>{const B=new Date(n,t,1),X=new Date(n,t+1,0,23,59,59),$=new Date(n,t).toLocaleDateString(r,{month:"long",year:"numeric"}).toUpperCase(),ae=[];for(let fe=0;fe<12;fe++){const Q=new Date(n,fe),ee=Q.toLocaleString(r,{month:"short"}).replace(".","").toUpperCase(),ye=Q.getFullYear().toString().slice(-2);ae.push(`${ee} ${ye}`)}const H=[];for(let fe=5;fe>=0;fe--)H.push(new Date(n,t-fe));const ie=new Date(n,t+1),ue=new Date(n,t+2),Ne=new Date(n,t+3),oe=[ie.toLocaleDateString(r,{month:"long",year:"numeric"}).toUpperCase(),ue.toLocaleDateString(r,{month:"long",year:"numeric"}).toUpperCase(),Ne.toLocaleDateString(r,{month:"long",year:"numeric"}).toUpperCase()],we=new Date(n,t-1,1).toLocaleDateString(r,{month:"long",year:"numeric"}).toUpperCase();return{startDate:B,endDate:X,period:$,year:n,month:t,months:ae,sixMonths:H,prevMonthName:we,nextMonths:oe}},[n,t,r]),{pivotData:O,sortedIncidentTypes:A,displaySites:U,displaySeaweedTypes:P,onSiteStockReportData:F,pressedWarehouseReportData:q,monthlyProductionData:z}=N.useMemo(()=>{const B={},X=()=>({farmerCount:0,lineAge:{"0-10":0,"11-20":0,"21-30":0,"30-40":0,"40-50":0,">50":0},totalLinesInWater:0,totalLinesHarvested:0,totalLinesPlanted:0,productionKg:0,avgGrowthRate:0,growthRateCount:0,forecast:{m1:0,m2:0,m3:0},incidents:{},weather:{tempSum:0,tempCount:0,salinitySum:0,salinityCount:0,rainSum:0,rainCount:0,windSpeedSum:0,windSpeedCount:0,windDirSum:0,windDirCount:0}});d.forEach(Q=>{B[Q.id]={},c.forEach(ee=>{B[Q.id][ee.id]=X()}),B[Q.id].TOTAL=X()});const $={};c.forEach(Q=>{$[Q.id]={},d.forEach(ee=>{$[Q.id][ee.id]=Array.from({length:12},()=>({production:0,growthRateSum:0,growthRateCount:0}))})}),u.forEach(Q=>{const ee=h.find(Re=>Re.id===Q.moduleId);if(!ee)return;const ye=Q.seaweedTypeId,Le=ee.siteId;if(Q.harvestDate&&Q.harvestedWeight&&$[Le]&&$[Le][ye]){const Re=new Date(Q.harvestDate);if(Re.getFullYear()===n){const Ke=Re.getMonth(),ze=$[Le][ye][Ke],Se=(Q.harvestedWeight||0)-(Q.cuttingsTakenAtHarvestKg||0);if(ze.production+=Se,Q.initialWeight&&Q.initialWeight>0){const Oe=(Re.getTime()-new Date(Q.plantingDate).getTime())/864e5;if(Oe>0){const be=(Math.log(Q.harvestedWeight)-Math.log(Q.initialWeight))/Oe*100;ze.growthRateSum+=be,ze.growthRateCount++}}}}if(!B[ye]||!B[ye][Le])return;[B[ye][Le],B[ye].TOTAL].forEach(Re=>{if((Q.status===Je.PLANTED||Q.status===Je.GROWING)&&new Date(Q.plantingDate)<=I.endDate){const Ke=Q.linesPlanted||ee.lines||0,ze=(I.endDate.getTime()-new Date(Q.plantingDate).getTime())/(1e3*60*60*24);Re.totalLinesInWater+=Ke;let Se=">50";ze<=10?Se="0-10":ze<=20?Se="11-20":ze<=30?Se="21-30":ze<=40?Se="30-40":ze<=50&&(Se="40-50"),Re.lineAge[Se]+=Ke;const be=new Date(new Date(Q.plantingDate).getTime()+Zs*24*60*60*1e3).getMonth(),xe=new Date(n,t+1).getMonth(),Ue=new Date(n,t+2).getMonth(),Ze=new Date(n,t+3).getMonth(),Et=Ke*.8;be===xe?Re.forecast.m1+=Et:be===Ue?Re.forecast.m2+=Et:be===Ze&&(Re.forecast.m3+=Et)}if(Q.harvestDate&&new Date(Q.harvestDate)>=I.startDate&&new Date(Q.harvestDate)<=I.endDate){Re.totalLinesHarvested+=Q.linesHarvested||0;const Ke=(Q.harvestedWeight||0)-(Q.cuttingsTakenAtHarvestKg||0);if(Re.productionKg+=Ke,Q.harvestedWeight&&Q.initialWeight&&Q.initialWeight>0){const ze=(new Date(Q.harvestDate).getTime()-new Date(Q.plantingDate).getTime())/864e5;if(ze>0){const Se=(Math.log(Q.harvestedWeight)-Math.log(Q.initialWeight))/ze*100;Re.avgGrowthRate=(Re.avgGrowthRate*Re.growthRateCount+Se)/(Re.growthRateCount+1),Re.growthRateCount++}}}new Date(Q.plantingDate)>=I.startDate&&new Date(Q.plantingDate)<=I.endDate&&(Re.totalLinesPlanted+=Q.linesPlanted||ee.lines||0)})});const ae={};h.forEach(Q=>{var ee;if(Q.farmerId&&Q.siteId){const ye=u.find(ke=>ke.moduleId===Q.id&&(ke.status==="PLANTED"||ke.status==="GROWING")),Le=ye?ye.seaweedTypeId:(ee=d[0])==null?void 0:ee.id;if(Le){const ke=`${Le}-${Q.siteId}`,Re=`${Le}-TOTAL`;ae[ke]||(ae[ke]=new Set),ae[Re]||(ae[Re]=new Set),ae[ke].add(Q.farmerId),ae[Re].add(Q.farmerId)}}}),Object.entries(ae).forEach(([Q,ee])=>{const[ye,Le]=Q.split("-");B[ye]&&B[ye][Le]&&(B[ye][Le].farmerCount=ee.size)});const H={};m.forEach(Q=>{const ee=new Date(Q.date);if(ee>=I.startDate&&ee<=I.endDate){H[Q.type]=(H[Q.type]||0)+1;const ye=new Set;Q.affectedModuleIds&&Q.affectedModuleIds.length>0&&Q.affectedModuleIds.forEach(Le=>{var ze;const ke=h.find(Se=>Se.id===Le);if(!ke)return;let Re=u.find(Se=>Se.moduleId===ke.id&&new Date(Se.plantingDate)<=ee&&(!Se.harvestDate||new Date(Se.harvestDate)>=ee));Re||(Re=u.filter(Oe=>Oe.moduleId===ke.id&&new Date(Oe.plantingDate)<=ee).sort((Oe,be)=>new Date(be.plantingDate).getTime()-new Date(Oe.plantingDate).getTime())[0]);const Ke=Re?Re.seaweedTypeId:(ze=d[0])==null?void 0:ze.id;Ke&&ke.siteId&&ye.add(`${Ke}|${ke.siteId}`)}),ye.forEach(Le=>{const[ke,Re]=Le.split("|");B[ke]&&B[ke][Re]&&(B[ke][Re].incidents[Q.type]=(B[ke][Re].incidents[Q.type]||0)+1,B[ke].TOTAL.incidents[Q.type]=(B[ke].TOTAL.incidents[Q.type]||0)+1)})}}),f.forEach(Q=>{var ee,ye;new Date(Q.date)>=I.startDate&&new Date(Q.date)<=I.endDate&&[(ee=B[Q.seaweedTypeId])==null?void 0:ee[Q.siteId],(ye=B[Q.seaweedTypeId])==null?void 0:ye.TOTAL].forEach(ke=>{ke&&(Q.temperature&&(ke.weather.tempSum+=Q.temperature,ke.weather.tempCount++),Q.salinity&&(ke.weather.salinitySum+=Q.salinity,ke.weather.salinityCount++),Q.precipitation&&(ke.weather.rainSum+=Q.precipitation,ke.weather.rainCount++),Q.windSpeed&&(ke.weather.windSpeedSum+=Q.windSpeed,ke.weather.windSpeedCount++),Q.windDirection&&(ke.weather.windDirSum+=Q.windDirection,ke.weather.windDirCount++))})});const ie={};c.forEach(Q=>{Q.id!=="pressing-warehouse"&&(ie[Q.id]={},d.forEach(ee=>{ie[Q.id][ee.id]={openingKg:0,openingBags:0,entriesKg:0,entriesBags:0,exitsKg:0,exitsBags:0,closingKg:0,closingBags:0}}))}),x.forEach(Q=>{if(Q.siteId==="pressing-warehouse"||!ie[Q.siteId]||!ie[Q.siteId][Q.seaweedTypeId])return;const ee=new Date(Q.date),ye=ie[Q.siteId][Q.seaweedTypeId];ee<I.startDate?(ye.openingKg+=(Q.inKg||0)-(Q.outKg||0),ye.openingBags+=(Q.inBags||0)-(Q.outBags||0)):ee<=I.endDate&&(ye.entriesKg+=Q.inKg||0,ye.entriesBags+=Q.inBags||0,ye.exitsKg+=Q.outKg||0,ye.exitsBags+=Q.outBags||0)}),Object.values(ie).forEach(Q=>{Object.values(Q).forEach(ee=>{ee.closingKg=ee.openingKg+ee.entriesKg-ee.exitsKg,ee.closingBags=ee.openingBags+ee.entriesBags-ee.exitsBags})});const ue={};d.forEach(Q=>{ue[Q.id]={bulk:{openingKg:0,openingBags:0,entriesKg:0,entriesBags:0,exitsKg:0,exitsBags:0,closingKg:0,closingBags:0},pressed:{openingKg:0,openingBales:0,entriesKg:0,entriesBales:0,exitsKg:0,exitsBales:0,closingKg:0,closingBales:0}}}),S.forEach(Q=>{if(!ue[Q.seaweedTypeId])return;const ee=new Date(Q.date)<I.startDate,ye=new Date(Q.date)>=I.startDate&&new Date(Q.date)<=I.endDate;if(Q.type===ut.BULK_IN_FROM_SITE||Q.type===ut.FARMER_DELIVERY){const Le=Q.inBales||0;ee&&(ue[Q.seaweedTypeId].bulk.openingKg+=Q.inKg||0,ue[Q.seaweedTypeId].bulk.openingBags+=Le),ye&&(ue[Q.seaweedTypeId].bulk.entriesKg+=Q.inKg||0,ue[Q.seaweedTypeId].bulk.entriesBags+=Le)}if(Q.type===ut.PRESSING_CONSUMPTION){const Le=Q.outBales||0;ee&&(ue[Q.seaweedTypeId].bulk.openingKg-=Q.outKg||0,ue[Q.seaweedTypeId].bulk.openingBags-=Le),ye&&(ue[Q.seaweedTypeId].bulk.exitsKg+=Q.outKg||0,ue[Q.seaweedTypeId].bulk.exitsBags+=Le)}(Q.type===ut.INITIAL_STOCK||Q.type===ut.PRESSING_IN)&&(ee&&(ue[Q.seaweedTypeId].pressed.openingKg+=Q.inKg||0,ue[Q.seaweedTypeId].pressed.openingBales+=Q.inBales||0),ye&&Q.type===ut.PRESSING_IN&&(ue[Q.seaweedTypeId].pressed.entriesKg+=Q.inKg||0,ue[Q.seaweedTypeId].pressed.entriesBales+=Q.inBales||0)),(Q.type===ut.EXPORT_OUT||Q.type===ut.RETURN_TO_SITE)&&(ee&&(ue[Q.seaweedTypeId].pressed.openingKg-=Q.outKg||0,ue[Q.seaweedTypeId].pressed.openingBales-=Q.outBales||0),ye&&(ue[Q.seaweedTypeId].pressed.exitsKg+=Q.outKg||0,ue[Q.seaweedTypeId].pressed.exitsBales+=Q.outBales||0))}),Object.keys(ue).forEach(Q=>{const ee=ue[Q];ee.bulk.closingKg=ee.bulk.openingKg+ee.bulk.entriesKg-ee.bulk.exitsKg,ee.bulk.closingBags=ee.bulk.openingBags+ee.bulk.entriesBags-ee.bulk.exitsBags,ee.pressed.closingKg=ee.pressed.openingKg+ee.pressed.entriesKg-ee.pressed.exitsKg,ee.pressed.closingBales=ee.pressed.openingBales+ee.pressed.entriesBales-ee.pressed.exitsBales});const Ne=c.filter(Q=>Q.id!=="pressing-warehouse");let oe=d;d.length===0&&(oe=[{id:"default",name:s("allSeaweedTypes"),dryPrice:0,wetPrice:0,scientificName:"",description:"",priceHistory:[]}]);const we=Object.keys(H).sort((Q,ee)=>H[ee]-H[Q]).slice(0,3).map(Q=>{var ee;return((ee=M.find(ye=>ye.id===Q))==null?void 0:ee.name)||Q}),fe={totalLinesInWater:Object.values(B).reduce((Q,ee)=>Q+ee.TOTAL.totalLinesInWater,0),totalHarvestedLines:Object.values(B).reduce((Q,ee)=>Q+ee.TOTAL.totalLinesHarvested,0),totalPlantedLines:Object.values(B).reduce((Q,ee)=>Q+ee.TOTAL.totalLinesPlanted,0),totalProductionKg:Object.values(B).reduce((Q,ee)=>Q+ee.TOTAL.productionKg,0),avgGrowthRate:Object.values(B).reduce((Q,ee)=>Q+ee.TOTAL.avgGrowthRate,0)/(Object.keys(B).length||1),incidentCount:Object.values(H).reduce((Q,ee)=>Q+ee,0)};return{pivotData:B,sortedIncidentTypes:we,displaySites:Ne,displaySeaweedTypes:oe,onSiteStockReportData:ie,pressedWarehouseReportData:ue,monthlyProductionData:$,page1Data:fe}},[u,h,v,m,f,c,d,I,x,S,n,t,M,s]),{groupedFarmerStats:J,totals:W}=N.useMemo(()=>{const B=new Map,X=ue=>`${ue.getFullYear()}-${ue.getMonth()}`,$=(ue,Ne,oe)=>{B.has(ue)||B.set(ue,new Map);const ne=B.get(ue);ne.has(Ne)||ne.set(Ne,new Map);const we=ne.get(Ne);return we.has(oe)||we.set(oe,{planted:0,harvested:0,production:0}),we.get(oe)};u.forEach(ue=>{const Ne=h.find(ee=>ee.id===ue.moduleId);if(!(Ne!=null&&Ne.farmerId))return;const oe=Ne.farmerId,ne=ue.seaweedTypeId,we=new Date(ue.plantingDate),fe=X(we),Q=$(oe,ne,fe);if(Q.planted+=ue.linesPlanted||Ne.lines||0,ue.harvestDate){const ee=new Date(ue.harvestDate),ye=X(ee),Le=$(oe,ne,ye);Le.harvested+=ue.linesHarvested||0;const ke=(ue.harvestedWeight||0)-(ue.cuttingsTakenAtHarvestKg||0);Le.production+=ke}});const ae={};v.forEach(ue=>{const Ne=c.find(ne=>ne.id===ue.siteId);if(!Ne)return;const oe=B.get(ue.id);oe&&oe.forEach((ne,we)=>{const fe=I.sixMonths.map(ee=>{const ye=X(ee);return ne.get(ye)||{planted:0,harvested:0,production:0}});if(fe.some(ee=>ee.planted>0||ee.harvested>0||ee.production>0)){const ee=d.find(ye=>ye.id===we);if(!ee)return;ae[Ne.id]||(ae[Ne.id]={siteName:Ne.name,seaweedTypes:{}}),ae[Ne.id].seaweedTypes[we]||(ae[Ne.id].seaweedTypes[we]={typeName:ee.name,farmers:[]}),ae[Ne.id].seaweedTypes[we].farmers.push({id:ue.id,name:`${ue.lastName} ${ue.firstName}`,stats:fe})}})});const H=Object.values(ae).map(ue=>({...ue,seaweedTypes:Object.values(ue.seaweedTypes).map(Ne=>({...Ne,farmers:Ne.farmers.sort((oe,ne)=>oe.name.localeCompare(ne.name))})).sort((Ne,oe)=>Ne.typeName.localeCompare(oe.typeName))})).sort((ue,Ne)=>ue.siteName.localeCompare(Ne.siteName)),ie=I.sixMonths.map((ue,Ne)=>H.reduce((oe,ne)=>(ne.seaweedTypes.forEach(we=>{we.farmers.forEach(fe=>{const Q=fe.stats[Ne];oe.planted+=Q.planted,oe.harvested+=Q.harvested,oe.production+=Q.production})}),oe),{planted:0,harvested:0,production:0}));return{groupedFarmerStats:H,totals:ie}},[v,I.sixMonths,u,h,c,d]),G=6;return e.jsxs(e.Fragment,{children:[e.jsx(C1,{period:I.period,pivotData:O,displaySites:U,displaySeaweedTypes:P,incidentTypes:A,nextMonths:I.nextMonths,t:s,page:1,totalPages:G}),e.jsx(E1,{period:I.period,employees:R,sites:U,roles:_,page:2,totalPages:G,monthlyPayments:D,month:t,year:n}),e.jsx(I1,{period:I.period,onSiteData:F,warehouseData:q,sites:U,seaweedTypes:d,page:3,totalPages:G}),e.jsx(_1,{period:I.period,year:I.year,exportDocuments:w,seaweedTypes:d,page:4,totalPages:G}),e.jsx(A1,{period:I.period,months:I.months,monthlyData:z,year:n,sites:U,seaweedTypes:d,page:5,totalPages:G}),e.jsx(D1,{period:I.period,sixMonths:I.sixMonths,prevMonthName:I.prevMonthName,creditTypes:C,farmerCredits:T,repayments:E,year:n,month:t,groupedData:J,totals:W,page:6,totalPages:G})]})},C1=({period:t,pivotData:n,displaySites:s,displaySeaweedTypes:r,incidentTypes:l,nextMonths:c,t:d,page:u,totalPages:h})=>{const{settings:m}=$e(),f=(S,w)=>{var C;return(C=n[S])==null?void 0:C[w]},v=S=>{const w=d("days");return S.includes(">")?`> 50 ${w}`:`${S} ${w}`},x=1+(s.length+1)*r.length;return e.jsxs(Jr,{children:[e.jsx(Xr,{period:t,title:d("globalFarmReport")}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"w-full overflow-hidden",children:e.jsxs("table",{className:"w-full border-collapse mb-2 table-fixed text-[8px]",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"150px"}}),Array.from({length:x-1}).map((S,w)=>e.jsx("col",{},w))]}),e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsxs(le,{rowSpan:2,header:!0,className:"align-middle bg-gray-200 border-b-2 border-gray-500 text-center",children:[d("period"),":",e.jsx("br",{}),t]}),r.map(S=>e.jsx(le,{colSpan:s.length+1,header:!0,className:"bg-blue-50 border-b border-blue-300 text-blue-900 uppercase tracking-widest",children:S.name},S.id))]}),e.jsx("tr",{children:r.map(S=>e.jsxs(ft.Fragment,{children:[s.map(w=>e.jsx(le,{header:!0,className:"bg-gray-50 text-gray-700 font-semibold",children:w.name},w.id)),e.jsx(le,{header:!0,className:"bg-blue-100 text-blue-900 font-bold border-l border-blue-200",children:d("total")})]},S.id))})]}),e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx(le,{colSpan:x,header:!0,align:"left",className:"pl-2 bg-gray-200 uppercase text-[9px] tracking-wider border-t-2 border-gray-600 font-bold",children:d("apercuGeneralDeLaFerme")})}),e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"font-semibold bg-gray-50 pl-2",children:d("fermier_effectif")}),r.map(S=>{var w;return e.jsxs(ft.Fragment,{children:[s.map(C=>{var T;return e.jsx(le,{children:((T=f(S.id,C.id))==null?void 0:T.farmerCount)||"-"},C.id)}),e.jsx(le,{bold:!0,className:"bg-gray-100 border-l border-gray-300",children:((w=f(S.id,"TOTAL"))==null?void 0:w.farmerCount)||"-"})]},S.id)})]}),e.jsx("tr",{children:e.jsx(le,{colSpan:x,header:!0,align:"left",className:"pl-2 bg-gray-100 uppercase text-[8px] tracking-wider border-t border-gray-300 font-bold",children:d("tranche_age_lignes")})}),["0-10","11-20","21-30","30-40","40-50",">50"].map((S,w)=>e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-gray-600 border-r border-gray-300",children:v(S)}),r.map(C=>{var T;return e.jsxs(ft.Fragment,{children:[s.map(E=>{var R;return e.jsx(le,{children:((R=f(C.id,E.id))==null?void 0:R.lineAge[S])||"-"},E.id)}),e.jsx(le,{bold:!0,className:"bg-gray-50 border-l border-gray-300",children:((T=f(C.id,"TOTAL"))==null?void 0:T.lineAge[S])||"-"})]},C.id)})]},S)),e.jsx("tr",{children:e.jsx(le,{colSpan:x,header:!0,align:"left",className:"pl-2 bg-gray-100 uppercase text-[8px] tracking-wider border-t border-gray-300 font-bold",children:d("bilan_lignes")})}),e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 font-bold text-blue-900 border-r border-gray-300",children:d("total_lignes_eau")}),r.map(S=>{var w;return e.jsxs(ft.Fragment,{children:[s.map(C=>{var T;return e.jsx(le,{bold:!0,className:"text-blue-900",children:((T=f(S.id,C.id))==null?void 0:T.totalLinesInWater)||"-"},C.id)}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-blue-900 border-l border-blue-200",children:((w=f(S.id,"TOTAL"))==null?void 0:w.totalLinesInWater)||"-"})]},S.id)})]}),e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-gray-600 border-r border-gray-300",children:d("total_lignes_recoltees")}),r.map(S=>{var w;return e.jsxs(ft.Fragment,{children:[s.map(C=>{var T;return e.jsx(le,{children:((T=f(S.id,C.id))==null?void 0:T.totalLinesHarvested)||"-"},C.id)}),e.jsx(le,{bold:!0,className:"bg-gray-50 border-l border-gray-300",children:((w=f(S.id,"TOTAL"))==null?void 0:w.totalLinesHarvested)||"-"})]},S.id)})]}),e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-gray-600 border-r border-gray-300",children:d("total_lignes_plantees")}),r.map(S=>{var w;return e.jsxs(ft.Fragment,{children:[s.map(C=>{var T;return e.jsx(le,{children:((T=f(S.id,C.id))==null?void 0:T.totalLinesPlanted)||"-"},C.id)}),e.jsx(le,{bold:!0,className:"bg-gray-50 border-l border-gray-300",children:((w=f(S.id,"TOTAL"))==null?void 0:w.totalLinesPlanted)||"-"})]},S.id)})]}),e.jsxs("tr",{className:"border-t-2 border-gray-400",children:[e.jsx(le,{header:!0,align:"left",className:"bg-green-100 text-green-900 uppercase font-bold pl-2",children:d("production_periode_kg")}),r.map(S=>{var w,C;return e.jsxs(ft.Fragment,{children:[s.map(T=>{var E,R;return e.jsx(le,{className:"font-bold bg-green-50",children:(E=f(S.id,T.id))!=null&&E.productionKg?Fe((R=f(S.id,T.id))==null?void 0:R.productionKg,m.localization):"-"},T.id)}),e.jsx(le,{bold:!0,className:"bg-green-100 text-green-900 border-l border-green-300",children:(w=f(S.id,"TOTAL"))!=null&&w.productionKg?Fe((C=f(S.id,"TOTAL"))==null?void 0:C.productionKg,m.localization):"-"})]},S.id)})]}),e.jsxs("tr",{children:[e.jsx(le,{header:!0,align:"left",className:"bg-yellow-100 text-yellow-900 uppercase font-bold pl-2",children:d("taux_croissance_moyen")}),r.map(S=>{var w,C;return e.jsxs(ft.Fragment,{children:[s.map(T=>{var E,R;return e.jsx(le,{className:"bg-yellow-50",children:(((E=f(S.id,T.id))==null?void 0:E.avgGrowthRate)||0)>0?`${(((R=f(S.id,T.id))==null?void 0:R.avgGrowthRate)||0).toFixed(2)}%`:"-"},T.id)}),e.jsx(le,{bold:!0,className:"bg-yellow-100 text-yellow-900 border-l border-yellow-300",children:(((w=f(S.id,"TOTAL"))==null?void 0:w.avgGrowthRate)||0)>0?`${(((C=f(S.id,"TOTAL"))==null?void 0:C.avgGrowthRate)||0).toFixed(2)}%`:"-"})]},S.id)})]}),e.jsx("tr",{children:e.jsx(le,{colSpan:x,header:!0,align:"left",className:"pl-2 bg-gray-100 uppercase text-[8px] tracking-wider border-t border-gray-300 font-bold",children:d("prevision_production")})}),["m1","m2","m3"].map((S,w)=>e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-gray-600 border-r border-gray-300",children:c[w]}),r.map(C=>{var T,E;return e.jsxs(ft.Fragment,{children:[s.map(R=>{var _,D;return e.jsx(le,{children:(_=f(C.id,R.id))!=null&&_.forecast[S]?Fe((D=f(C.id,R.id))==null?void 0:D.forecast[S],m.localization):"-"},R.id)}),e.jsx(le,{bold:!0,className:"bg-gray-50 border-l border-gray-300",children:(T=f(C.id,"TOTAL"))!=null&&T.forecast[S]?Fe((E=f(C.id,"TOTAL"))==null?void 0:E.forecast[S],m.localization):"-"})]},C.id)})]},S)),e.jsx("tr",{children:e.jsx(le,{colSpan:x,className:"bg-gray-200 text-black font-bold py-1.5 text-center text-[9px] border-t-2 border-gray-600 tracking-widest",children:d("monitoringReport").toUpperCase()})}),e.jsx("tr",{children:e.jsx(le,{colSpan:x,header:!0,align:"left",className:"pl-2 bg-gray-200 uppercase text-[8px] tracking-wider font-bold",children:d("incidentsLabel")})}),l.length>0?l.map((S,w)=>e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-red-700 font-medium border-r border-gray-300",children:S}),r.map(C=>{var T;return e.jsxs(ft.Fragment,{children:[s.map(E=>{var R,_;return e.jsx(le,{className:(R=f(C.id,E.id))!=null&&R.incidents[S]?"bg-red-50 font-bold text-red-600":"",children:((_=f(C.id,E.id))==null?void 0:_.incidents[S])||"-"},E.id)}),e.jsx(le,{bold:!0,className:"bg-gray-50 border-l border-gray-300",children:((T=f(C.id,"TOTAL"))==null?void 0:T.incidents[S])||"-"})]},C.id)})]},S)):e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-green-600 italic bg-green-50",children:d("noMajorIncidents")}),e.jsx(le,{colSpan:x-1,className:"bg-gray-50",children:"-"})]}),e.jsx("tr",{children:e.jsx(le,{colSpan:x,header:!0,align:"left",className:"pl-2 bg-gray-100 uppercase text-[8px] tracking-wider border-t border-gray-300 font-bold",children:d("vent")})}),e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-gray-600 border-r border-gray-300",children:d("vitesse_kmh")}),r.map(S=>e.jsxs(ft.Fragment,{children:[s.map(w=>{const C=f(S.id,w.id);return e.jsx(le,{children:C&&C.weather.windSpeedCount?(C.weather.windSpeedSum/C.weather.windSpeedCount).toFixed(1):"-"},w.id)}),e.jsx(le,{className:"bg-gray-50 border-l border-gray-300",children:"-"})]},S.id))]}),e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-gray-600 border-r border-gray-300",children:d("direction_deg")}),r.map(S=>e.jsxs(ft.Fragment,{children:[s.map(w=>{const C=f(S.id,w.id);return e.jsx(le,{children:C&&C.weather.windDirCount?(C.weather.windDirSum/C.weather.windDirCount).toFixed(0):"-"},w.id)}),e.jsx(le,{className:"bg-gray-50 border-l border-gray-300",children:"-"})]},S.id))]}),e.jsx("tr",{children:e.jsx(le,{colSpan:x,header:!0,align:"left",className:"pl-2 bg-gray-100 uppercase text-[8px] tracking-wider border-t border-gray-300 font-bold",children:d("autres_parametres")})}),[{label:"temperature_c",key:"temp"},{label:"salinite_ppt",key:"salinity"},{label:"pluviometrie_mm",key:"rain"}].map((S,w)=>e.jsxs("tr",{children:[e.jsx(le,{align:"left",className:"pl-4 text-gray-600 border-r border-gray-300",children:d(S.label)}),r.map(C=>e.jsxs(ft.Fragment,{children:[s.map(T=>{const E=f(C.id,T.id),R=E==null?void 0:E.weather[`${S.key}Count`],_=E==null?void 0:E.weather[`${S.key}Sum`];return e.jsx(le,{children:R?(_/R).toFixed(1):"-"},T.id)}),e.jsx(le,{bold:!0,align:"center",className:"bg-gray-50 border-l border-gray-300",children:d("averageShort")})]},C.id))]},S.label))]})]})}),e.jsx(Ra,{title:d("narratif_explicatif_tableau"),generator:async()=>_D({})})]}),e.jsx(Qr,{page:u,totalPages:h})]})},E1=({period:t,employees:n,sites:s,roles:r,page:l,totalPages:c,monthlyPayments:d,month:u,year:h})=>{const{t:m}=je(),{settings:f}=$e(),v=N.useMemo(()=>{const T=new Map;if(!d)return T;const E=`${h}-${String(u+1).padStart(2,"0")}`;return d.filter(_=>_.period.startsWith(E)&&_.recipientType===qt.EMPLOYEE).forEach(_=>{try{const D=JSON.parse(_.notes||"{}");D.type==="payroll_run"&&D.details&&D.details.gross!==void 0&&T.set(_.recipientId,parseFloat(D.details.gross)||0)}catch{}}),T},[d,h,u]),x=N.useCallback((T,E,R)=>{const _=n.filter(O=>O.role===T&&O.employeeType===E&&(R?O.siteId===R:!0)),D=_.length,M=O=>v.get(O.id)??0,I=_.reduce((O,A)=>O+M(A),0);return{count:D,amount:I}},[n,v]),S=["PERMANENT","CASUAL"],w=r.map(T=>T.name).sort(),C=N.useMemo(()=>{const T={};return S.forEach(E=>{T[E]={totalCount:0,totalAmount:0,sites:{}},s.forEach(R=>T[E].sites[R.id]={count:0,amount:0}),w.forEach(R=>{const _=x(R,E);T[E].totalCount+=_.count,T[E].totalAmount+=_.amount,s.forEach(D=>{const M=x(R,E,D.id);T[E].sites[D.id].count+=M.count,T[E].sites[D.id].amount+=M.amount})})}),T},[r,s,x]);return e.jsxs(Jr,{children:[e.jsx(Xr,{period:t,title:m("repartition_salaries_site")}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"w-full",children:e.jsxs("table",{className:"w-full border-collapse text-[7px] table-fixed border border-gray-400",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"8%"}}),e.jsx("col",{style:{width:"12%"}}),s.map(T=>e.jsxs(ft.Fragment,{children:[e.jsx("col",{}),e.jsx("col",{})]},T.id))]}),e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx(le,{rowSpan:2,className:"w-[20%] border-gray-400 bg-gray-100"}),e.jsx(le,{colSpan:2,header:!0,className:"bg-blue-100 text-blue-900 font-bold border-b border-gray-400 uppercase text-center",children:m("total")}),s.map(T=>e.jsx(le,{colSpan:2,header:!0,className:"bg-gray-50 border-b border-gray-400 uppercase text-center font-bold",children:T.name},T.id))]}),e.jsxs("tr",{children:[e.jsx(le,{header:!0,className:"bg-blue-50 text-center border-r border-blue-200",children:m("effectif")}),e.jsx(le,{header:!0,className:"bg-blue-50 text-center",children:m("montant_du_mois")}),s.map(T=>e.jsxs(ft.Fragment,{children:[e.jsx(le,{header:!0,className:"bg-gray-50 text-center border-l border-gray-300",children:m("effectif")}),e.jsx(le,{header:!0,className:"bg-gray-50 text-center",children:m("montant_du_mois")})]},`sub-${T.id}`))]})]}),e.jsx("tbody",{children:S.map(T=>e.jsxs(ft.Fragment,{children:[e.jsx("tr",{children:e.jsx(le,{colSpan:3+s.length*2,header:!0,align:"left",className:"pl-2 bg-gray-200 uppercase tracking-widest border-t-2 border-gray-400 font-bold",children:m(T==="CASUAL"?"journalier":"permanent")})}),w.map(E=>{const R=x(E,T);return R.count===0?null:e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{align:"left",className:"pl-2 font-medium border-r border-gray-300",children:E}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-center border-r border-blue-100",children:R.count}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-right pr-2",children:R.amount?Ae(R.amount,f.localization):"-"}),s.map(_=>{const D=x(E,T,_.id);return e.jsxs(ft.Fragment,{children:[e.jsx(le,{className:`text-center border-l border-gray-300 ${D.count?"":"text-gray-300"}`,children:D.count||"-"}),e.jsx(le,{className:`text-right pr-2 ${D.amount?"":"text-gray-300"}`,children:D.amount?Ae(D.amount,f.localization):"-"})]},_.id)})]},`${T}-${E}`)}),e.jsxs("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-400",children:[e.jsx(le,{align:"left",className:"pl-2 uppercase border-r border-gray-400",children:m(T==="CASUAL"?"total_journalier":"total_permanent")}),e.jsx(le,{className:"bg-blue-200 text-center border-r border-blue-300",children:C[T].totalCount}),e.jsx(le,{className:"bg-blue-200 text-right pr-2",children:Ae(C[T].totalAmount,f.localization)}),s.map(E=>e.jsxs(ft.Fragment,{children:[e.jsx(le,{className:"text-center border-l border-gray-400 bg-gray-50",children:C[T].sites[E.id].count}),e.jsx(le,{className:"text-right pr-2 bg-gray-50",children:Ae(C[T].sites[E.id].amount,f.localization)})]},`tot-${E.id}`))]})]},T))})]})}),e.jsx("div",{className:"w-full",children:e.jsx(Ra,{title:m("narratif_repartition_salaries"),generator:async()=>AD({})})})]}),e.jsx(Qr,{page:l,totalPages:c})]})},I1=({period:t,onSiteData:n,warehouseData:s,sites:r,seaweedTypes:l,page:c,totalPages:d})=>{const{t:u}=je(),{settings:h}=$e(),m=e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"16%"}}),e.jsx("col",{style:{width:"6%"}})," ",e.jsx("col",{style:{width:"5%"}})," ",e.jsx("col",{style:{width:"10%"}}),e.jsx("col",{style:{width:"6%"}})," ",e.jsx("col",{style:{width:"5%"}})," ",e.jsx("col",{style:{width:"10%"}}),e.jsx("col",{style:{width:"6%"}})," ",e.jsx("col",{style:{width:"5%"}})," ",e.jsx("col",{style:{width:"10%"}}),e.jsx("col",{style:{width:"6%"}})," ",e.jsx("col",{style:{width:"5%"}})," ",e.jsx("col",{style:{width:"10%"}})]});return e.jsxs(Jr,{children:[e.jsx(Xr,{period:t}),e.jsxs("div",{className:"flex flex-col gap-6 mt-2",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"font-bold text-sm uppercase mb-2 text-black border-l-4 border-green-600 pl-2",children:[u("stocks_sur_sites")," :"]}),e.jsxs("table",{className:"w-full border-collapse mb-1 text-[8px] table-fixed",children:[m,e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx(le,{rowSpan:2,className:"bg-white border-none"}),e.jsx(le,{colSpan:3,header:!0,className:"bg-gray-200 border-gray-400 text-center uppercase font-bold",children:u("stock_ouverture")}),e.jsx(le,{colSpan:3,header:!0,className:"bg-green-100 border-green-300 text-green-900 text-center uppercase font-bold",children:u("entrees")}),e.jsx(le,{colSpan:3,header:!0,className:"bg-red-100 border-red-300 text-red-900 text-center uppercase font-bold",children:u("sorties")}),e.jsx(le,{colSpan:3,header:!0,className:"bg-blue-100 border-blue-300 text-blue-900 text-center uppercase font-bold",children:u("stock_fermeture")})]}),e.jsxs("tr",{children:[e.jsx(le,{header:!0,className:"bg-gray-100",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-gray-100",children:u("sac")}),e.jsx(le,{header:!0,className:"bg-gray-100",children:u("valeur")}),e.jsx(le,{header:!0,className:"bg-green-50",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-green-50",children:u("sac")}),e.jsx(le,{header:!0,className:"bg-green-50",children:u("valeur")}),e.jsx(le,{header:!0,className:"bg-red-50",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-red-50",children:u("sac")}),e.jsx(le,{header:!0,className:"bg-red-50",children:u("valeur")}),e.jsx(le,{header:!0,className:"bg-blue-50",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-blue-50",children:u("sac")}),e.jsx(le,{header:!0,className:"bg-blue-50",children:u("valeur")})]})]}),e.jsx("tbody",{children:r.map(f=>e.jsxs(ft.Fragment,{children:[e.jsx("tr",{children:e.jsx(le,{header:!0,align:"left",colSpan:13,className:"bg-gray-200 uppercase tracking-wider border-t-2 border-gray-500 font-bold pl-2",children:f.name})}),l.map(v=>{var w;const x=((w=n[f.id])==null?void 0:w[v.id])||{openingKg:0,openingBags:0,entriesKg:0,entriesBags:0,exitsKg:0,exitsBags:0,closingKg:0,closingBags:0},S=v.dryPrice||0;return e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{className:"pl-4 font-medium border-r border-gray-300",align:"left",children:v.name}),e.jsx(le,{className:"text-right",children:x.openingKg?Fe(x.openingKg,h.localization):"-"}),e.jsx(le,{className:"text-center",children:x.openingBags||"-"}),e.jsx(le,{className:"text-right border-r border-gray-300",children:x.openingKg?Ae(x.openingKg*S,h.localization):"-"}),e.jsx(le,{className:"text-green-700 text-right bg-green-50/30",children:x.entriesKg?Fe(x.entriesKg,h.localization):"-"}),e.jsx(le,{className:"text-green-700 text-center bg-green-50/30",children:x.entriesBags||"-"}),e.jsx(le,{className:"text-green-700 text-right border-r border-gray-300 bg-green-50/30",children:x.entriesKg?Ae(x.entriesKg*S,h.localization):"-"}),e.jsx(le,{className:"text-red-700 text-right bg-red-50/30",children:x.exitsKg?Fe(x.exitsKg,h.localization):"-"}),e.jsx(le,{className:"text-red-700 text-center bg-red-50/30",children:x.exitsBags||"-"}),e.jsx(le,{className:"text-red-700 text-right border-r border-gray-300 bg-red-50/30",children:x.exitsKg?Ae(x.exitsKg*S,h.localization):"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-right text-blue-900",children:x.closingKg?Fe(x.closingKg,h.localization):"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-center text-blue-900",children:x.closingBags||"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-right text-blue-900",children:x.closingKg?Ae(x.closingKg*S,h.localization):"-"})]},v.id)})]},f.id))})]}),e.jsx(Ra,{title:u("narratif_stocks_sites"),generator:async()=>DD({})})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"font-bold text-sm uppercase mb-2 text-black border-l-4 border-orange-500 pl-2",children:[u("stock_magasin_presse")," :"]}),e.jsxs("table",{className:"w-full border-collapse mb-1 text-[8px] table-fixed",children:[m,e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx(le,{rowSpan:2,className:"bg-white border-none"}),e.jsx(le,{colSpan:3,header:!0,className:"bg-gray-200 border-gray-400 text-center uppercase font-bold",children:u("stock_ouverture")}),e.jsx(le,{colSpan:3,header:!0,className:"bg-green-100 border-green-300 text-green-900 text-center uppercase font-bold",children:u("entrees")}),e.jsx(le,{colSpan:3,header:!0,className:"bg-red-100 border-red-300 text-red-900 text-center uppercase font-bold",children:u("sorties")}),e.jsx(le,{colSpan:3,header:!0,className:"bg-blue-100 border-blue-300 text-blue-900 text-center uppercase font-bold",children:u("stock_fermeture")})]}),e.jsxs("tr",{children:[e.jsx(le,{header:!0,className:"bg-gray-100",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-gray-100",children:u("colis")}),e.jsx(le,{header:!0,className:"bg-gray-100",children:u("valeur")}),e.jsx(le,{header:!0,className:"bg-green-50",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-green-50",children:u("colis")}),e.jsx(le,{header:!0,className:"bg-green-50",children:u("valeur")}),e.jsx(le,{header:!0,className:"bg-red-50",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-red-50",children:u("colis")}),e.jsx(le,{header:!0,className:"bg-red-50",children:u("valeur")}),e.jsx(le,{header:!0,className:"bg-blue-50",children:u("poids_kg")}),e.jsx(le,{header:!0,className:"bg-blue-50",children:u("colis")}),e.jsx(le,{header:!0,className:"bg-blue-50",children:u("valeur")})]})]}),e.jsx("tbody",{children:l.map((f,v)=>{const x=s[f.id],S=f.dryPrice||0;return x?e.jsxs(ft.Fragment,{children:[e.jsx("tr",{children:e.jsx(le,{header:!0,align:"left",colSpan:13,className:"bg-gray-200 uppercase tracking-wider border-t-2 border-gray-400 font-bold pl-2",children:f.name.toUpperCase()})}),e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{className:"pl-4 font-medium text-gray-600 border-r border-gray-300",align:"left",children:u("algues_en_vrac")}),e.jsx(le,{className:"text-right",children:x.bulk.openingKg?Fe(x.bulk.openingKg,h.localization):"-"}),e.jsx(le,{className:"text-center",children:x.bulk.openingBags||"-"}),e.jsx(le,{className:"text-right border-r border-gray-300",children:x.bulk.openingKg?Ae(x.bulk.openingKg*S,h.localization):"-"}),e.jsx(le,{className:"text-green-700 text-right bg-green-50/30",children:x.bulk.entriesKg?Fe(x.bulk.entriesKg,h.localization):"-"}),e.jsx(le,{className:"text-green-700 text-center bg-green-50/30",children:x.bulk.entriesBags||"-"}),e.jsx(le,{className:"text-green-700 text-right border-r border-gray-300 bg-green-50/30",children:x.bulk.entriesKg?Ae(x.bulk.entriesKg*S,h.localization):"-"}),e.jsx(le,{className:"text-red-700 text-right bg-red-50/30",children:x.bulk.exitsKg?Fe(x.bulk.exitsKg,h.localization):"-"}),e.jsx(le,{className:"text-red-700 text-center bg-red-50/30",children:x.bulk.exitsBags||"-"}),e.jsx(le,{className:"text-red-700 text-right border-r border-gray-300 bg-red-50/30",children:x.bulk.exitsKg?Ae(x.bulk.exitsKg*S,h.localization):"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-right text-blue-900",children:x.bulk.closingKg?Fe(x.bulk.closingKg,h.localization):"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-center text-blue-900",children:x.bulk.closingBags||"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-right text-blue-900",children:x.bulk.closingKg?Ae(x.bulk.closingKg*S,h.localization):"-"})]}),e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{className:"pl-4 font-medium text-gray-600 border-r border-gray-300",align:"left",children:u("algues_pressees")}),e.jsx(le,{className:"text-right",children:x.pressed.openingKg?Fe(x.pressed.openingKg,h.localization):"-"}),e.jsx(le,{className:"text-center",children:x.pressed.openingBales||"-"}),e.jsx(le,{className:"text-right border-r border-gray-300",children:x.pressed.openingKg?Ae(x.pressed.openingKg*S,h.localization):"-"}),e.jsx(le,{className:"text-green-700 text-right bg-green-50/30",children:x.pressed.entriesKg?Fe(x.pressed.entriesKg,h.localization):"-"}),e.jsx(le,{className:"text-green-700 text-center bg-green-50/30",children:x.pressed.entriesBales||"-"}),e.jsx(le,{className:"text-green-700 text-right border-r border-gray-300 bg-green-50/30",children:x.pressed.entriesKg?Ae(x.pressed.entriesKg*S,h.localization):"-"}),e.jsx(le,{className:"text-red-700 text-right bg-red-50/30",children:x.pressed.exitsKg?Fe(x.pressed.exitsKg,h.localization):"-"}),e.jsx(le,{className:"text-red-700 text-center bg-red-50/30",children:x.pressed.exitsBales||"-"}),e.jsx(le,{className:"text-red-700 text-right border-r border-gray-300 bg-red-50/30",children:x.pressed.exitsKg?Ae(x.pressed.exitsKg*S,h.localization):"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-right text-blue-900",children:x.pressed.closingKg?Fe(x.pressed.closingKg,h.localization):"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-center text-blue-900",children:x.pressed.closingBales||"-"}),e.jsx(le,{bold:!0,className:"bg-blue-50 text-right text-blue-900",children:x.pressed.closingKg?Ae(x.pressed.closingKg*S,h.localization):"-"})]})]},`presse-algue-${f.id}`):null})})]}),e.jsx(Ra,{title:u("narratif_stocks_magasin"),generator:async()=>kD({})})]})]}),e.jsx(Qr,{page:c,totalPages:d})]})},_1=({period:t,year:n,exportDocuments:s,seaweedTypes:r,page:l,totalPages:c})=>{const{t:d}=je(),{settings:u}=$e(),h=x=>{if(x.length===0)return e.jsx("tr",{children:e.jsx(le,{colSpan:8,align:"center",className:"italic text-gray-500 py-4 bg-gray-50",children:"- No exports -"})});const S={};return r.forEach(w=>S[w.id]=[]),x.forEach(w=>{S[w.seaweedTypeId]||(S[w.seaweedTypeId]=[]),S[w.seaweedTypeId].push(w)}),r.map(w=>{var M;const C=S[w.id]||[];if(C.length===0)return null;const T=C.reduce((I,O)=>I+O.containers.reduce((A,U)=>A+U.seaweedWeightKg,0),0),E=C.reduce((I,O)=>I+O.containers.reduce((A,U)=>A+U.packagesCount,0),0),R=C.reduce((I,O)=>I+O.containers.length,0),_=C.reduce((I,O)=>I+O.containers.reduce((A,U)=>A+U.value,0),0),D=((M=C[0])==null?void 0:M.currency)||u.localization.currency;return e.jsxs(ft.Fragment,{children:[e.jsx("tr",{children:e.jsx(le,{header:!0,align:"left",colSpan:7,className:"bg-gray-200 uppercase font-bold tracking-wider border-t-2 border-gray-500 pl-2",children:w.name.toUpperCase()})}),C.map(I=>{const O=I.containers.reduce((F,q)=>F+q.seaweedWeightKg,0),A=I.containers.reduce((F,q)=>F+q.packagesCount,0),U=I.containers.length,P=I.containers.reduce((F,q)=>F+q.value,0);return e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{className:"text-right pr-4",children:Fe(O,u.localization)}),e.jsx(le,{className:"text-right pr-4",children:Fe(A,{...u.localization,nonMonetaryDecimals:0})}),e.jsx(le,{className:"text-center",children:U}),e.jsx(le,{className:"text-right pr-4",children:Ae(P,{...u.localization,currencySymbol:I.currency})}),e.jsx(le,{children:I.invoiceNo}),e.jsx(le,{children:I.poNo}),e.jsx(le,{children:I.destinationCountry})]},I.id)}),e.jsxs("tr",{className:"border-t border-gray-400 font-bold bg-gray-50",children:[e.jsx(le,{bold:!0,className:"text-right pr-4 border-r border-gray-300",children:Fe(T,u.localization)}),e.jsx(le,{bold:!0,className:"text-right pr-4 border-r border-gray-300",children:Fe(E,{...u.localization,nonMonetaryDecimals:0})}),e.jsx(le,{bold:!0,className:"text-center border-r border-gray-300",children:R}),e.jsx(le,{bold:!0,className:"text-right pr-4 border-r border-gray-300",children:Ae(_,{...u.localization,currencySymbol:D})}),e.jsx(le,{colSpan:3,align:"left",className:"bg-gray-100 pl-2 italic text-gray-500",children:d("total")})]})]},w.id)})},m=N.useMemo(()=>s.filter(x=>x.date.includes(String(n))),[s,t,n]),f=N.useMemo(()=>s.filter(x=>new Date(x.date).getFullYear()===n),[s,n]),v=({title:x,docs:S})=>e.jsxs("section",{className:"mb-4 flex-shrink-0",children:[e.jsx("p",{className:"text-xs mb-2 text-black font-bold uppercase border-b border-black inline-block",children:x}),e.jsxs("table",{className:"w-full border-collapse border border-gray-400 table-fixed text-[8px]",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"12%"}}),e.jsx("col",{style:{width:"10%"}}),e.jsx("col",{style:{width:"8%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs(le,{header:!0,className:"bg-gray-100 border-b border-gray-400",children:[d("quantite_expedie")," (Kg)"]}),e.jsxs(le,{header:!0,className:"bg-gray-100 border-b border-gray-400",children:[d("colis")," (",d("baleSingular"),")"]}),e.jsxs(le,{header:!0,className:"bg-gray-100 border-b border-gray-400",children:[d("nombre_conteneur")," (TC)"]}),e.jsx(le,{header:!0,className:"bg-gray-100 border-b border-gray-400",children:d("valeur_totale")}),e.jsx(le,{header:!0,className:"bg-gray-100 border-b border-gray-400",children:d("facture_n")}),e.jsx(le,{header:!0,className:"bg-gray-100 border-b border-gray-400",children:d("po")}),e.jsx(le,{header:!0,className:"bg-gray-100 border-b border-gray-400",children:d("destinataire")})]})}),e.jsx("tbody",{children:h(S)})]})]});return e.jsxs(Jr,{children:[e.jsx(Xr,{period:t}),e.jsxs("h3",{className:"font-bold text-sm uppercase mb-2 text-black border-l-4 border-purple-600 pl-2",children:[d("liste_exportations_realisees")," :"]}),e.jsxs("div",{className:"flex-grow flex flex-col gap-4 mt-2 overflow-visible",children:[e.jsx(v,{title:`${d("de_la_periode")} (${t})`,docs:m}),e.jsx(v,{title:`${d("de_annee")} (${n})`,docs:f}),e.jsx(Ra,{title:d("narratif_exportations_realisees"),generator:async()=>RD({})})]}),e.jsx(Qr,{page:l,totalPages:c})]})},A1=({period:t,months:n,monthlyData:s,year:r,sites:l,seaweedTypes:c,page:d,totalPages:u})=>{const{t:h}=je(),{settings:m}=$e();return e.jsxs(Jr,{children:[e.jsx(Xr,{period:t,title:h("production_mensuelle_par_site")}),e.jsxs("div",{className:"flex-grow flex flex-col gap-2 mt-2 overflow-visible",children:[e.jsxs("table",{className:"w-full border-collapse text-[6px] flex-shrink-0 table-fixed border border-gray-400",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"14%"}}),n.map((f,v)=>e.jsxs(ft.Fragment,{children:[e.jsx("col",{style:{width:"3.5%"}}),e.jsx("col",{style:{width:"3.6%"}})]},v))]}),e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx(le,{rowSpan:2,className:"bg-gray-200 border-gray-400"}),n.map((f,v)=>e.jsx(le,{colSpan:2,header:!0,className:"bg-blue-100 border-gray-400 border-b text-blue-900 uppercase font-bold text-[7px]",children:f},v))]}),e.jsx("tr",{children:n.map((f,v)=>e.jsxs(ft.Fragment,{children:[e.jsx(le,{header:!0,className:"text-[5px] border-gray-400 bg-gray-50 px-0 border-r",children:"%"}),e.jsx(le,{header:!0,className:"text-[5px] border-gray-400 bg-gray-50 px-0",children:"Kg"})]},`sub-h-${v}`))})]}),e.jsx("tbody",{children:l.map(f=>e.jsxs(ft.Fragment,{children:[e.jsx("tr",{children:e.jsx(le,{colSpan:1+n.length*2,header:!0,align:"left",className:"bg-gray-200 py-1 px-2 uppercase font-bold border-t-2 border-gray-400",children:f.name})}),c.map(v=>{var S;const x=((S=s[f.id])==null?void 0:S[v.id])||[];return e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{className:"pl-4 font-semibold bg-gray-50 border-r border-gray-300",align:"left",children:v.name}),n.map((w,C)=>{const T=x[C],E=T&&T.growthRateCount>0?T.growthRateSum/T.growthRateCount:0;return e.jsxs(ft.Fragment,{children:[e.jsx(le,{className:"border-r border-gray-200 text-[6px] text-center",children:E>0?`${E.toFixed(1)}`:"-"}),e.jsx(le,{className:"border-r border-gray-300 text-[6px] text-center bg-gray-50 font-medium",children:T&&T.production>0?Fe(T.production,{...m.localization,nonMonetaryDecimals:0}):"-"})]},C)})]},v.id)})]},f.id))})]}),e.jsx(Ra,{title:h("narratif_production_mensuelle"),generator:async()=>MD({})})]}),e.jsx(Qr,{page:d,totalPages:u})]})},D1=({period:t,sixMonths:n,prevMonthName:s,creditTypes:r,farmerCredits:l,repayments:c,year:d,month:u,groupedData:h,totals:m,page:f,totalPages:v})=>{const{t:x,language:S}=je(),{settings:w}=$e(),C=n.map(R=>{const _=R.toLocaleString(S,{month:"short"}).replace(".","").toUpperCase(),D=R.getFullYear().toString().slice(-2);return`${_} ${D}`}),T=e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"20%"}}),C.map((R,_)=>e.jsxs(ft.Fragment,{children:[e.jsx("col",{style:{width:"4%"}}),e.jsx("col",{style:{width:"4%"}}),e.jsx("col",{style:{width:"5%"}})]},_))]}),E=N.useMemo(()=>{const R=U=>{const P={},F={balance:0,farmers:new Set},q=l.filter(G=>new Date(G.date)<=U),z=c.filter(G=>new Date(G.date)<=U),J=q.reduce((G,B)=>G+B.totalAmount,0),W=z.reduce((G,B)=>G+B.amount,0);return F.balance=J-W,r.forEach(G=>{const B=q.filter(H=>H.creditTypeId===G.id),X=B.reduce((H,ie)=>H+ie.totalAmount,0),$=J>0?X/J:0,ae=W*$;P[G.id]={balance:X-ae,farmers:new Set(B.map(H=>H.farmerId)).size},B.forEach(H=>F.farmers.add(H.farmerId))}),{stats:P,totalStats:{balance:F.balance,farmers:F.farmers.size}}},_=new Date(d,u,0,23,59,59),D=new Date(d,u+1,0,23,59,59),M=R(_),I=R(D),O=c.filter(U=>new Date(U.date)<new Date(d,u,1)&&new Date(U.date)>=new Date(d,u-1,1)).reduce((U,P)=>U+P.amount,0),A=c.filter(U=>new Date(U.date)>=new Date(d,u,1)&&new Date(U.date)<=D).reduce((U,P)=>U+P.amount,0);return{prevMonthStats:M,currMonthStats:I,prevMonthRepayments:O,currMonthRepayments:A}},[l,c,r,d,u]);return e.jsxs(Jr,{children:[e.jsx(Xr,{period:t}),e.jsxs("div",{className:"flex-grow flex flex-col gap-4 mt-2 overflow-visible",children:[e.jsxs("section",{className:"flex flex-col",children:[e.jsxs("h3",{className:"font-bold text-sm uppercase mb-2 text-black flex-shrink-0 border-l-4 border-yellow-500 pl-2",children:[x("situation_credits")," :"]}),e.jsxs("table",{className:"w-full border-collapse flex-shrink-0 mb-2 border border-gray-400 table-fixed text-[8px]",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"12.5%"}})," ",e.jsx("col",{style:{width:"12.5%"}})," ",e.jsx("col",{style:{width:"12.5%"}}),e.jsx("col",{style:{width:"12.5%"}})," ",e.jsx("col",{style:{width:"12.5%"}})," ",e.jsx("col",{style:{width:"12.5%"}})]}),e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx(le,{rowSpan:2,header:!0,className:"bg-gray-100 border-gray-400"}),e.jsx(le,{colSpan:3,header:!0,className:"bg-gray-200 text-gray-600 uppercase font-bold border-gray-400 border-b text-center",children:s}),e.jsx(le,{colSpan:3,header:!0,className:"bg-blue-100 text-blue-900 uppercase font-bold border-gray-400 border-b border-l-2 border-l-blue-300 text-center",children:t})]}),e.jsxs("tr",{children:[e.jsx(le,{header:!0,className:"text-[7px] bg-gray-50 border-gray-300",children:x("effectif_fermiers_concernes")}),e.jsx(le,{header:!0,className:"text-[7px] bg-gray-50 border-gray-300",children:x("solde_credits")}),e.jsx(le,{header:!0,className:"text-[7px] bg-gray-50 border-gray-300",children:x("total_remboursements")}),e.jsx(le,{header:!0,className:"bg-blue-50 text-[7px] border-l-2 border-l-blue-300",children:x("effectif_fermiers_concernes")}),e.jsx(le,{header:!0,className:"bg-blue-50 text-[7px]",children:x("solde_credits")}),e.jsx(le,{header:!0,className:"bg-blue-50 text-[7px]",children:x("total_remboursements")})]})]}),e.jsx("tbody",{children:r.map(R=>{const _=E.prevMonthStats.stats[R.id],D=E.currMonthStats.stats[R.id];return e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{header:!0,align:"left",className:"pl-2 text-gray-700 border-r border-gray-300",children:R.name}),e.jsx(le,{className:"text-center",children:(_==null?void 0:_.farmers)||"-"}),e.jsx(le,{className:"text-right pr-2",children:_!=null&&_.balance?Ae(_.balance,w.localization):"-"}),e.jsx(le,{className:"text-right pr-2 border-r-2 border-r-blue-300",children:"-"}),e.jsx(le,{className:"bg-blue-50 font-semibold text-center text-blue-900",children:(D==null?void 0:D.farmers)||"-"}),e.jsx(le,{className:"bg-blue-50 font-semibold text-right pr-2 text-blue-900",children:D!=null&&D.balance?Ae(D.balance,w.localization):"-"}),e.jsx(le,{className:"bg-blue-50 font-semibold text-right pr-2 text-blue-900",children:"-"})]},R.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"font-bold bg-gray-100 border-t-2 border-gray-400",children:[e.jsx(le,{header:!0,align:"left",className:"pl-2 border-r border-gray-300",children:x("total")}),e.jsx(le,{className:"text-center",children:E.prevMonthStats.totalStats.farmers}),e.jsx(le,{className:"text-right pr-2",children:Ae(E.prevMonthStats.totalStats.balance,w.localization)}),e.jsx(le,{className:"text-right pr-2 border-r-2 border-r-blue-300",children:Ae(E.prevMonthRepayments,w.localization)}),e.jsx(le,{className:"bg-blue-100 font-bold text-center text-blue-900",children:E.currMonthStats.totalStats.farmers}),e.jsx(le,{className:"bg-blue-100 font-bold text-right pr-2 text-blue-900",children:Ae(E.currMonthStats.totalStats.balance,w.localization)}),e.jsx(le,{className:"bg-blue-100 font-bold text-right pr-2 text-blue-900",children:Ae(E.currMonthRepayments,w.localization)})]})})]}),e.jsx(Ra,{title:x("narratif_situation_credits"),generator:async()=>PD(E)})]}),e.jsxs("section",{className:"flex flex-col mt-4",children:[e.jsx("h3",{className:"font-bold text-sm uppercase mb-2 text-black flex-shrink-0 border-l-4 border-indigo-500 pl-2",children:x("statistique_individuelle_fermiers")}),e.jsx("div",{className:"border border-gray-400 overflow-hidden",children:e.jsxs("table",{className:"w-full border-collapse text-[6px] table-fixed",children:[T,e.jsxs("thead",{className:"sticky top-0 z-10",children:[e.jsxs("tr",{children:[e.jsx(le,{rowSpan:2,header:!0,className:"bg-gray-200 align-middle text-[8px] border-b-2 border-gray-500",children:x("farmer")}),C.map((R,_)=>e.jsx(le,{colSpan:3,header:!0,className:"bg-gray-100 border-b border-gray-400 font-bold",children:R},_))]}),e.jsx("tr",{children:C.map((R,_)=>e.jsxs(ft.Fragment,{children:[e.jsx(le,{header:!0,className:"text-[6px] p-0 border-r border-gray-300 bg-white font-normal",title:x("status_PLANTED"),children:x("status_PLANTED").charAt(0)}),e.jsx(le,{header:!0,className:"text-[6px] p-0 border-r border-gray-300 bg-white font-normal",title:x("status_HARVESTED"),children:x("status_HARVESTED").charAt(0)}),e.jsx(le,{header:!0,className:"text-[6px] p-0 border-r border-gray-400 bg-white font-normal",children:"Kg"})]},`sub-h-${_}`))})]}),e.jsx("tbody",{children:h.map(R=>e.jsxs(ft.Fragment,{children:[e.jsx("tr",{children:e.jsx(le,{colSpan:1+C.length*3,header:!0,align:"left",className:"bg-blue-100 py-1 text-[8px] uppercase tracking-widest border-t-2 border-gray-500 font-bold pl-2",children:R.siteName})}),R.seaweedTypes.map(_=>e.jsxs(ft.Fragment,{children:[e.jsx("tr",{children:e.jsx(le,{colSpan:1+C.length*3,header:!0,align:"left",className:"bg-green-50 py-0.5 pl-4 text-[7px] text-green-800 italic border-t border-gray-300 font-medium",children:_.typeName})}),_.farmers.map(D=>e.jsxs("tr",{className:"border-b border-gray-300",children:[e.jsx(le,{align:"left",className:"align-middle truncate px-1 border-r border-gray-300 bg-white font-normal",title:D.name,children:D.name}),D.stats.map((M,I)=>e.jsxs(ft.Fragment,{children:[e.jsx(le,{className:"border-r border-gray-200 text-center align-middle text-blue-600 font-semibold",children:M.planted||"-"}),e.jsx(le,{className:"border-r border-gray-200 text-center align-middle text-red-600 font-semibold",children:M.harvested||"-"}),e.jsx(le,{className:"font-bold border-r border-gray-300 text-right pr-1 align-middle bg-gray-50/50",children:M.production?Fe(M.production,{...w.localization,nonMonetaryDecimals:0}):"-"})]},`cell-group-${I}`))]},D.id))]},_.typeName))]},R.siteName))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"font-bold border-t-2 border-gray-500",children:[e.jsx(le,{header:!0,className:"align-middle uppercase tracking-widest text-[8px] border-r border-gray-400",children:x("total")}),m.map((R,_)=>e.jsxs(ft.Fragment,{children:[e.jsx(le,{header:!0,className:"border-r border-gray-300 text-center align-middle text-blue-600 font-bold",children:R.planted}),e.jsx(le,{header:!0,className:"border-r border-gray-300 text-center align-middle text-red-600 font-bold",children:R.harvested}),e.jsx(le,{header:!0,className:"font-bold border-r border-gray-400 text-right pr-1 align-middle bg-gray-100",children:Fe(R.production,{...w.localization,nonMonetaryDecimals:0})})]},`total-cell-group-${_}`))]})})]})}),e.jsx(Ra,{title:x("narratif_statistique_individuelle"),generator:async()=>LD(h)})]})]}),e.jsx(Qr,{page:f,totalPages:v})]})},k1=()=>{const{t}=je(),{farmers:n}=qe(),{settings:s}=$e(),[r,l]=N.useState("global_farm_report"),[c,d]=N.useState(()=>new Date().getMonth()),[u,h]=N.useState(()=>new Date().getFullYear()),[m,f]=N.useState(""),[v,x]=N.useState(["production","finance","inventory"]),[S,w]=N.useState(!1),[C,T]=N.useState(!1),[E,R]=N.useState(!1),_=N.useMemo(()=>Array.from({length:10},(W,G)=>new Date().getFullYear()-5+G),[]),D=N.useMemo(()=>["january","february","march","april","may","june","july","august","september","october","november","december"],[]),M=N.useMemo(()=>Array.from({length:12},(W,G)=>G),[]),I=N.useMemo(()=>[...n].sort((W,G)=>W.firstName.localeCompare(G.firstName)),[n]);N.useEffect(()=>{I.length>0&&!m&&f(I[0].id)},[I,m]);const O=()=>{w(!0)},A=()=>{window.print()},U=async()=>{R(!0);try{const W=`${r}_${u}_${c+1}`,G=t("reportsTitle");await GD(G,W)}catch(W){console.error("Excel export failed",W),alert("Export failed. See console for details.")}finally{R(!1)}},P=async()=>{T(!0),document.body.classList.add("generating-pdf");try{const{jsPDF:W}=window.jspdf,G=window.html2canvas,B=document.getElementById("printable-area");if(!B)throw new Error("Printable area not found");const X=["farmer_monthly","global_farm_report"].includes(r),$=X?"l":"p",ae=new W({orientation:$,unit:"mm",format:"a4",compress:!0});ae.setProperties({title:`${r.replace(/_/g," ").toUpperCase()} - ${u}-${(c+1).toString().padStart(2,"0")}`,subject:"AlgaManage Report",author:s.company.name||"AlgaManage",creator:"AlgaManage System"});const H=B.getElementsByClassName(X?"report-page-landscape":"print-page"),ie=H.length>0?H:B.getElementsByClassName("print-page");for(let oe=0;oe<ie.length;oe++){const ne=ie[oe],we=await G(ne,{scale:3,useCORS:!0,logging:!1,windowWidth:X?1920:1200,windowHeight:ne.scrollHeight+50,backgroundColor:"#ffffff"}),fe=we.toDataURL("image/jpeg",.95),Q=we.width,ee=we.height,ye=ae.internal.pageSize.getWidth(),Le=ae.internal.pageSize.getHeight(),ke=ye/Q,Re=ee*ke;oe>0&&ae.addPage(),Re<=Le+2,ae.addImage(fe,"JPEG",0,0,ye,Re,void 0,"FAST")}const ue=(c+1).toString().padStart(2,"0"),Ne=r.split("_").map(oe=>oe.charAt(0).toUpperCase()+oe.slice(1)).join("_");ae.save(`${Ne}_${u}_${ue}.pdf`)}catch(W){console.error("Error generating PDF:",W),alert(t("pdfGenerationError"))}finally{document.body.classList.remove("generating-pdf"),T(!1)}},F=W=>{x(G=>G.includes(W)?G.filter(B=>B!==W):[...G,W]),w(!1)},q=["individual_farmer","custom","global_farm_report"].includes(r),z=["farmer_monthly"].includes(r),J=()=>{if(!S)return e.jsx("div",{className:"text-center p-8 text-gray-500 no-print",children:t("selectFiltersAndGenerate")});switch(r){case"global_farm_report":return e.jsx(w1,{month:c,year:u});case"farmer_monthly":return e.jsx(S1,{year:u});case"individual_farmer":return e.jsx(j1,{month:c,year:u,farmerId:m});case"custom":return e.jsx(T1,{month:c,year:u,sections:v});default:return null}};return e.jsxs("div",{className:"pb-20",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:t("reportsTitle")}),e.jsx(Ge,{title:t("selectReportType"),className:"mb-6 no-print",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 items-end",children:[e.jsxs(De,{label:t("selectReportType"),value:r,onChange:W=>{l(W.target.value),w(!1)},children:[e.jsx("option",{value:"global_farm_report",children:t("globalFarmReport")}),e.jsx("option",{value:"custom",children:t("customReport")}),e.jsx("option",{value:"farmer_monthly",children:t("farmerMonthlyReport")}),e.jsx("option",{value:"individual_farmer",children:t("individualFarmerReport")})]}),q&&e.jsxs(e.Fragment,{children:[e.jsx(De,{label:t("month"),value:c,onChange:W=>d(parseInt(W.target.value)),children:M.map(W=>e.jsx("option",{value:W,children:t(D[W])},W))}),e.jsx(De,{label:t("year"),value:u,onChange:W=>h(parseInt(W.target.value)),children:_.map(W=>e.jsx("option",{value:W,children:W},W))})]}),z&&e.jsx(De,{label:t("year"),value:u,onChange:W=>h(parseInt(W.target.value)),children:_.map(W=>e.jsx("option",{value:W,children:W},W))}),r==="individual_farmer"&&e.jsx(De,{label:t("selectFarmer"),value:m,onChange:W=>f(W.target.value),children:I.map(W=>e.jsxs("option",{value:W.id,children:[W.firstName," ",W.lastName]},W.id))}),e.jsx("div",{className:q||z?"":"xl:col-start-5",children:e.jsxs(se,{onClick:O,className:"w-full h-[42px]",children:[e.jsx(te,{name:"FileText",className:"w-5 h-5"}),t("generateReport")]})})]}),r==="custom"&&e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300",children:t("selectSections")}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(jt,{checked:v.includes("production"),onChange:()=>F("production")}),e.jsx("span",{className:"text-sm",children:t("section_production")})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(jt,{checked:v.includes("finance"),onChange:()=>F("finance")}),e.jsx("span",{className:"text-sm",children:t("section_finance")})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(jt,{checked:v.includes("inventory"),onChange:()=>F("inventory")}),e.jsx("span",{className:"text-sm",children:t("section_inventory")})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(jt,{checked:v.includes("hr"),onChange:()=>F("hr")}),e.jsx("span",{className:"text-sm",children:t("section_hr")})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(jt,{checked:v.includes("incidents"),onChange:()=>F("incidents")}),e.jsx("span",{className:"text-sm",children:t("section_incidents")})]})]})]})]})}),S&&e.jsx("div",{className:"fixed bottom-6 right-6 z-50 no-print flex gap-3",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-full shadow-xl border border-gray-200 dark:border-gray-700 flex gap-2 animate-in fade-in slide-in-from-bottom-4",children:[e.jsxs(se,{variant:"secondary",onClick:U,disabled:E,className:"rounded-full !px-4 shadow-sm",children:[e.jsx(te,{name:E?"Activity":"FileSpreadsheet",className:`w-5 h-5 ${E?"animate-spin":""}`}),e.jsx("span",{className:"ml-2 hidden sm:inline",children:t("exportExcel")})]}),e.jsxs(se,{variant:"secondary",onClick:P,disabled:C,className:"rounded-full !px-4 shadow-sm",children:[e.jsx(te,{name:C?"Activity":"Download",className:`w-5 h-5 ${C?"animate-spin":""}`}),e.jsx("span",{className:"ml-2 hidden sm:inline",children:t(C?"downloading":"downloadPdf")})]}),e.jsxs(se,{variant:"primary",onClick:A,className:"rounded-full !px-4 shadow-md",children:[e.jsx(te,{name:"Printer",className:"w-5 h-5"}),e.jsx("span",{className:"ml-2 hidden sm:inline",children:t("print")})]})]})}),e.jsx("div",{id:"printable-area",className:"overflow-x-auto pb-8",children:J()})]})},R1=({isOpen:t,onClose:n,currentUser:s,onInviteSent:r})=>{const{t:l}=je(),{roles:c,addInvitation:d,addRole:u}=qe(),[h,m]=N.useState({recipient:"",channel:"EMAIL",roleId:""}),[f,v]=N.useState({}),[x,S]=N.useState("role"),[w,C]=N.useState(new Set),[T,E]=N.useState(new Set);N.useEffect(()=>{var I,O;t&&(m({recipient:"",channel:"EMAIL",roleId:((I=c.find(A=>A.isDefault))==null?void 0:I.id)||((O=c[0])==null?void 0:O.id)||""}),C(new Set),S("role"),v({}))},[t,c]);const R=N.useCallback(()=>{const I={};return h.recipient.trim()?h.channel==="EMAIL"&&!/\S+@\S+\.\S+/.test(h.recipient)?I.recipient=l("validationEmail"):h.channel==="WHATSAPP"&&!/^\+?\d{7,15}$/.test(h.recipient)&&(I.recipient=l("validationPhone")):I.recipient=l("validationRequired"),x==="role"&&!h.roleId&&(I.roleId=l("validationRequired")),x==="custom"&&w.size===0&&(I.customPermissions=l("validationSelectAtLeastOne")),I},[h,l,x,w]);N.useEffect(()=>{v(R())},[h,x,w,R]);const _=()=>{if(Object.keys(f).length>0||!s)return;let I=h.roleId;if(x==="custom"){const P=l("customRoleFor").replace("{recipient}",h.recipient),F=u({name:P,permissions:Array.from(w)});if(F)I=F.id;else return}const O=d({recipient:h.recipient,channel:h.channel,roleId:I,invitedBy:s.id,status:rl.PENDING,expiresAt:new Date(Date.now()+10080*60*1e3).toISOString()}),U=`${`${window.location.origin}${window.location.pathname}#/signup`}?token=${O.token}`;r(U,h.channel),n()},D=I=>{E(O=>{const A=new Set(O);return A.has(I)?A.delete(I):A.add(I),A})},M=Object.keys(f).length>0;return e.jsx(at,{isOpen:t,onClose:n,title:l("inviteUser"),widthClass:"max-w-3xl",footer:e.jsxs(e.Fragment,{children:[e.jsx(se,{variant:"secondary",onClick:n,children:l("cancel")}),e.jsx(se,{onClick:_,disabled:M,children:l("sendInvitation")})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:l("inviteMode")}),e.jsxs("div",{className:"flex gap-4 p-1 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsx(se,{variant:x==="role"?"primary":"ghost",onClick:()=>S("role"),className:"flex-1",children:l("selectRoleMode")}),e.jsx(se,{variant:x==="custom"?"primary":"ghost",onClick:()=>S("custom"),className:"flex-1",children:l("customPermissionsMode")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(De,{label:l("channel"),value:h.channel,onChange:I=>m(O=>({...O,channel:I.target.value,recipient:""})),children:[e.jsx("option",{value:"EMAIL",children:"Email"}),e.jsx("option",{value:"WHATSAPP",children:"WhatsApp"})]}),e.jsx(de,{label:h.channel==="EMAIL"?l("email"):l("phoneNumber"),type:h.channel==="EMAIL"?"email":"tel",value:h.recipient,onChange:I=>m(O=>({...O,recipient:I.target.value})),error:f.recipient,placeholder:h.channel==="WHATSAPP"?"+261...":"name@example.com",required:!0})]}),x==="role"&&e.jsxs(De,{label:l("role"),value:h.roleId,onChange:I=>m(O=>({...O,roleId:I.target.value})),error:f.roleId,required:!0,children:[e.jsx("option",{value:"",children:l("selectRole")}),c.map(I=>e.jsx("option",{value:I.id,children:I.name},I.id))]}),x==="custom"&&e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto border p-2 rounded-lg dark:border-gray-600",children:[Xy.map(I=>e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>D(I.name),className:"flex justify-between items-center p-2 bg-gray-100 dark:bg-gray-700 rounded cursor-pointer",children:[e.jsx("h4",{className:"font-semibold text-sm",children:I.name}),e.jsx(te,{name:"ChevronDown",className:`w-5 h-5 transition-transform ${T.has(I.name)?"rotate-180":""}`})]}),T.has(I.name)&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 p-2",children:I.permissions.map(O=>e.jsxs("label",{className:"flex items-center p-1 hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded cursor-pointer",children:[e.jsx(jt,{checked:w.has(O.id),onChange:A=>{C(U=>{const P=new Set(U);return A.target.checked?P.add(O.id):P.delete(O.id),P})}}),e.jsx("span",{className:"ml-2 text-sm",children:O.label})]},O.id))})]},I.name)),f.customPermissions&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:f.customPermissions})]})]})})},M1=()=>{const{t,language:n}=je(),{users:s,roles:r,invitations:l,deleteInvitation:c}=qe(),{currentUser:d}=ys(),[u,h]=N.useState(!1),[m,f]=N.useState("users"),[v,x]=N.useState(null),[S,w]=N.useState(null),C=N.useMemo(()=>new Map(r.map(D=>[D.id,D.name])),[r]),T=D=>{c(D),x(null)},E=D=>{const I=`${`${window.location.origin}${window.location.pathname}#/signup`}?token=${D.token}`;if(D.channel==="WHATSAPP"){const O=t("resendWhatsAppMessage").replace("{link}",I),A=`https://wa.me/${D.recipient.replace(/\+/g,"")}?text=${encodeURIComponent(O)}`;w({link:A,channel:"WHATSAPP"})}else w({link:I,channel:"EMAIL"})},R=l.filter(D=>D.status===rl.PENDING&&new Date(D.expiresAt)>new Date),_=N.useMemo(()=>new Map(s.map(D=>[D.id,`${D.firstName} ${D.lastName}`])),[s]);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("userManagement")}),e.jsx(ec,{permission:Ce.USERS_INVITE,children:e.jsxs(se,{onClick:()=>h(!0),children:[e.jsx(te,{name:"PlusCircle",className:"w-5 h-5"}),t("inviteUser")]})})]}),e.jsxs(Ge,{children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[e.jsx("button",{onClick:()=>f("users"),className:`${m==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:t("currentUsers")}),e.jsxs("button",{onClick:()=>f("invitations"),className:`${m==="invitations"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:[t("pendingInvitations")," (",R.length,")"]})]})}),m==="users"&&e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3",children:t("name")}),e.jsx("th",{className:"p-3",children:t("email")}),e.jsx("th",{className:"p-3",children:t("role")})]})}),e.jsx("tbody",{children:s.map(D=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsxs("td",{className:"p-3",children:[D.firstName," ",D.lastName]}),e.jsx("td",{className:"p-3",children:D.email}),e.jsx("td",{className:"p-3",children:C.get(D.roleId)||D.roleId})]},D.id))})]})}),m==="invitations"&&e.jsx("div",{className:"overflow-x-auto mt-4",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b dark:border-gray-700",children:[e.jsx("th",{className:"p-3",children:t("recipient")}),e.jsx("th",{className:"p-3",children:t("channel")}),e.jsx("th",{className:"p-3",children:t("role")}),e.jsx("th",{className:"p-3",children:t("expiresAt")}),e.jsx("th",{className:"p-3",children:t("invitedBy")}),e.jsx("th",{className:"p-3 text-right",children:t("actions")})]})}),e.jsxs("tbody",{children:[R.map(D=>e.jsxs("tr",{className:"border-b dark:border-gray-700/50",children:[e.jsx("td",{className:"p-3",children:D.recipient}),e.jsx("td",{className:"p-3",children:D.channel}),e.jsx("td",{className:"p-3",children:C.get(D.roleId)||D.roleId}),e.jsx("td",{className:"p-3",children:new Date(D.expiresAt).toLocaleDateString(n)}),e.jsx("td",{className:"p-3",children:_.get(D.invitedBy)||"N/A"}),e.jsx("td",{className:"p-3 text-right",children:e.jsx(ec,{permission:Ce.USERS_INVITE,children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(se,{variant:"secondary",onClick:()=>E(D),children:t("resend")}),e.jsx(se,{variant:"danger",onClick:()=>x(D.id),children:t("revoke")})]})})})]},D.id)),R.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center p-8 text-gray-500",children:t("noPendingInvitations")})})]})]})})]}),e.jsx(R1,{isOpen:u,onClose:()=>h(!1),currentUser:d,onInviteSent:(D,M)=>w({link:D,channel:M})}),v&&e.jsx(Ut,{isOpen:!!v,onClose:()=>x(null),onConfirm:()=>T(v),title:t("revokeInvitation"),message:t("confirmRevokeInvitation"),confirmText:t("revoke")}),S&&e.jsxs(at,{isOpen:!!S,onClose:()=>w(null),title:t("invitationSent"),children:[e.jsx("p",{children:S.channel==="EMAIL"?t("invitationLinkMessage"):t("invitationWhatsAppMessage")}),S.channel==="EMAIL"?e.jsx(de,{value:S.link,readOnly:!0,className:"mt-2"}):e.jsx("a",{href:S.link,target:"_blank",rel:"noopener noreferrer",children:e.jsx(se,{className:"mt-2 w-full",children:t("openWhatsApp")})})]})]})},P1=()=>{const{t}=je(),{currentUser:n,updateProfile:s}=ys(),[r,l]=N.useState({firstName:"",lastName:"",email:"",phone:""}),[c,d]=N.useState(!1),[u,h]=N.useState(null);N.useEffect(()=>{n&&l({firstName:n.firstName||"",lastName:n.lastName||"",email:n.email||"",phone:n.phone||""})},[n]);const m=v=>{l(x=>({...x,[v.target.name]:v.target.value}))},f=v=>{if(v.preventDefault(),!r.firstName||!r.lastName||!r.email){h({type:"error",text:t("validationRequired")});return}try{s({firstName:r.firstName,lastName:r.lastName,email:r.email,phone:r.phone}),h({type:"success",text:t("profileUpdatedSuccess")}),d(!1),setTimeout(()=>h(null),3e3)}catch{h({type:"error",text:"Failed to update profile"})}};return e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("userProfileTitle")}),!c&&e.jsxs(se,{onClick:()=>d(!0),variant:"secondary",children:[e.jsx(te,{name:"Edit2",className:"w-4 h-4"}),t("editProfile")]})]}),e.jsxs(Ge,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 pb-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"w-20 h-20 rounded-full bg-blue-600 text-white flex items-center justify-center text-2xl font-bold shadow-md",children:[r.firstName.charAt(0),r.lastName.charAt(0)]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:[n==null?void 0:n.firstName," ",n==null?void 0:n.lastName]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm uppercase",children:((n==null?void 0:n.roleId)||"").replace(/_/g," ")})]})]}),u&&e.jsx("div",{className:`p-3 mb-4 rounded-md text-sm text-center ${u.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:u.text}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(de,{label:t("firstName"),name:"firstName",value:r.firstName,onChange:m,disabled:!c,required:!0}),e.jsx(de,{label:t("lastName"),name:"lastName",value:r.lastName,onChange:m,disabled:!c,required:!0})]}),e.jsx(de,{label:t("email"),name:"email",type:"email",value:r.email,onChange:m,disabled:!c,required:!0}),e.jsx(de,{label:t("phoneNumber"),name:"phone",type:"tel",value:r.phone,onChange:m,disabled:!c,placeholder:"+123456789"}),c&&e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(se,{type:"button",variant:"secondary",onClick:()=>{d(!1),h(null)},children:t("cancel")}),e.jsx(se,{type:"submit",children:t("saveChanges")})]})]})]})]})},L1=()=>{const{t,language:n}=je(),s=xs();N.useEffect(()=>{window.scrollTo(0,0)},[]);const r=t("appName"),l="LANXIS S.a.r.l";return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 font-sans",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-20 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold shadow-sm",children:r.charAt(0)}),e.jsx("span",{className:"font-bold text-lg hidden sm:block",children:r})]}),e.jsxs(se,{variant:"secondary",onClick:()=>s(-1),children:[e.jsx(te,{name:"X",className:"w-5 h-5 mr-2"}),t("close")]})]})}),e.jsx("main",{className:"max-w-5xl mx-auto px-4 py-8 md:py-12",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 md:p-12 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-8 mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:n==="fr"?"Conditions Gnrales d'Utilisation":"Terms of Use"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:n==="fr"?`diteur du service : ${l}`:`Service Provider: ${l}`}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:n==="fr"?`Dernire mise  jour : ${new Date().toLocaleDateString("fr-FR")}`:`Last Updated: ${new Date().toLocaleDateString("en-US")}`})]}),e.jsx("div",{className:"prose dark:prose-invert max-w-none text-sm md:text-base leading-relaxed text-justify space-y-8",children:n==="fr"?e.jsxs(e.Fragment,{children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"1. Acceptation des Conditions"}),e.jsxs("p",{children:["Bienvenue sur ",e.jsx("strong",{children:r}),", un logiciel dit et fourni par ",e.jsx("strong",{children:l}),". En accdant  ce logiciel, en crant un compte ou en utilisant toute partie du Service pour la gestion de vos activits agricoles, vous acceptez d'tre li par les prsentes Conditions Gnrales d'Utilisation (CGU)."]}),e.jsxs("p",{className:"mt-2",children:["Si vous n'acceptez pas ces termes, vous ne devez pas accder  l'Application ni l'utiliser. Ces conditions rgissent la relation contractuelle entre vous (l'Utilisateur ou l'Entit Agricole) et ",l,"."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"2. Description du Service"}),e.jsxs("p",{children:[l," met  disposition ",r,", un systme logiciel de gestion (ERP) conu pour l'aquaculture et la culture d'algues. Le Service fournit des outils numriques pour la gestion des sites de production, le suivi des cycles de culture, la gestion des stocks, le suivi des ressources humaines et la gestion financire."]}),e.jsxs("p",{className:"mt-2",children:[`L'Application est fournie "telle quelle". `,l," se rserve le droit de modifier, suspendre ou interrompre tout aspect du Service (mises  jour, nouvelles fonctionnalits)  tout moment pour amliorer l'exprience utilisateur ou pour des raisons techniques."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"3. Comptes et Scurit"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Identifiants :"})," Vous tes responsable de la confidentialit de vos identifiants de connexion. Toute action effectue via votre compte est rpute avoir t effectue par vous ou votre organisation."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Exactitude :"})," Vous vous engagez  fournir des informations exactes concernant votre entit agricole (nom, identifiants fiscaux) dans les paramtres de l'Application."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Scurit :"})," Vous devez informer ",l," immdiatement de toute violation de scurit ou utilisation non autorise de votre compte."]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"4. Licence d'Utilisation et Proprit Intellectuelle"}),e.jsxs("p",{children:[l," vous accorde une licence limite, non exclusive, non transfrable et rvocable pour utiliser ",r," uniquement pour vos besoins internes de gestion agricole."]}),e.jsxs("p",{className:"mt-2",children:["Tous les droits de proprit intellectuelle relatifs au logiciel, y compris le code source, les bases de donnes, les algorithmes et l'interface utilisateur, demeurent la proprit exclusive de ",e.jsx("strong",{children:l}),"."]}),e.jsx("p",{className:"mt-2",children:"Vous ne pouvez pas :"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1 mt-1",children:[e.jsxs("li",{children:["Revendre, sous-licencier ou distribuer l'Application  des tiers sans accord crit de ",l,"."]}),e.jsx("li",{children:"Copier, modifier ou crer des uvres drives bases sur le logiciel."}),e.jsx("li",{children:"Tenter de dcompiler ou d'extraire le code source de l'Application."})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"5. Proprit des Donnes"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vos Donnes :"})," Vous conservez tous les droits, titres et intrts sur les donnes que vous saisissez dans ",r," (donnes de rcolte, informations sur vos fermiers, donnes financires, etc.)."]}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Usage :"})," En utilisant le Service, vous accordez  ",l," le droit d'hberger, de traiter et d'afficher vos donnes uniquement dans le but de vous fournir le Service (par exemple, pour gnrer vos rapports ou vos tableaux de bord). ",l," s'engage  ne pas vendre vos donnes agricoles  des tiers."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"6. Limitation de Responsabilit"}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-100 dark:border-red-800",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Avertissement sur les prdictions :"}),e.jsxs("p",{children:[r," inclut des outils d'analyse et de prdiction (via IA ou algorithmes) concernant les rcoltes, la mto ou les risques biologiques. Ces informations sont fournies  titre indicatif uniquement pour aider  la prise de dcision.",l," ne garantit pas l'exactitude de ces prdictions et ne saurait tre tenu responsable des pertes de rcoltes, des pertes financires ou des dcisions agricoles prises sur la base de ces donnes."]})]}),e.jsxs("p",{className:"mt-4",children:["Dans toute la mesure permise par la loi, ",l," ne sera pas responsable des dommages indirects, incidents ou conscutifs rsultant de votre utilisation du Service."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"7. Rsiliation"}),e.jsxs("p",{children:[l," peut suspendre ou rsilier votre accs au Service immdiatement, sans pravis ni responsabilit, en cas de violation des prsentes Conditions."]}),e.jsx("p",{className:"mt-2",children:"Vous pouvez cesser d'utiliser l'Application  tout moment. Sur demande, vos donnes peuvent tre supprimes de nos serveurs, sous rserve des obligations lgales de conservation."})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"8. Droit Applicable"}),e.jsxs("p",{children:["Tout litige relatif  l'interprtation ou  l'excution des prsentes conditions sera soumis  la comptence exclusive des tribunaux du lieu du sige social de ",l,"."]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"1. Acceptance of Terms"}),e.jsxs("p",{children:["Welcome to ",e.jsx("strong",{children:r}),", a software provided and published by ",e.jsx("strong",{children:l}),". By accessing this software, creating an account, or using any part of the Service for managing your agricultural activities, you agree to be bound by these Terms of Use."]}),e.jsxs("p",{className:"mt-2",children:["If you do not agree to these terms, you must not access or use the Application. These terms govern the contractual relationship between you (the User or Agricultural Entity) and ",l,"."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"2. Description of Service"}),e.jsxs("p",{children:[l," provides ",r,", an ERP (Enterprise Resource Planning) management system designed for aquaculture and seaweed farming. The Service provides digital tools for production site management, cultivation cycle tracking, inventory management, human resources tracking, and financial management."]}),e.jsxs("p",{className:"mt-2",children:['The Application is provided "as is". ',l," reserves the right to modify, suspend, or discontinue any aspect of the Service (updates, new features) at any time to improve user experience or for technical reasons."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"3. Accounts and Security"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Credentials:"})," You are responsible for the confidentiality of your login credentials. Any action performed via your account is deemed to have been performed by you or your organization."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Accuracy:"})," You agree to provide accurate information regarding your agricultural entity (name, tax IDs) within the Application settings."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Security:"})," You must notify ",l," immediately of any security breach or unauthorized use of your account."]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"4. License to Use and Intellectual Property"}),e.jsxs("p",{children:[l," grants you a limited, non-exclusive, non-transferable, and revocable license to use ",r," solely for your internal agricultural management needs."]}),e.jsxs("p",{className:"mt-2",children:["All intellectual property rights related to the software, including source code, databases, algorithms, and the user interface, remain the exclusive property of ",e.jsx("strong",{children:l}),"."]}),e.jsx("p",{className:"mt-2",children:"You may not:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1 mt-1",children:[e.jsxs("li",{children:["Resell, sublicense, or distribute the Application to third parties without written consent from ",l,"."]}),e.jsx("li",{children:"Copy, modify, or create derivative works based on the software."}),e.jsx("li",{children:"Attempt to decompile or extract the source code of the Application."})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"5. Data Ownership"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Your Data:"})," You retain all rights, title, and interest in the data you enter into ",r," (harvest data, farmer information, financial records, etc.)."]}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Usage:"})," By using the Service, you grant ",l," the right to host, process, and display your data solely for the purpose of providing the Service to you (e.g., generating your reports or dashboards). ",l," commits not to sell your agricultural data to third parties."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"6. Limitation of Liability"}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-100 dark:border-red-800",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Disclaimer regarding predictions:"}),e.jsxs("p",{children:[r," includes analysis and prediction tools (via AI or algorithms) regarding harvests, weather, or biological risks. This information is provided for indicative purposes only to assist in decision-making.",l," does not guarantee the accuracy of these predictions and shall not be held liable for crop losses, financial losses, or agricultural decisions made based on this data."]})]}),e.jsxs("p",{className:"mt-4",children:["To the fullest extent permitted by law, ",l," shall not be liable for any indirect, incidental, or consequential damages arising from your use of the Service."]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"7. Termination"}),e.jsxs("p",{children:[l," may suspend or terminate your access to the Service immediately, without prior notice or liability, in the event of a breach of these Terms."]}),e.jsx("p",{className:"mt-2",children:"You may stop using the Application at any time. Upon request, your data can be deleted from our servers, subject to legal retention obligations."})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3",children:"8. Governing Law"}),e.jsxs("p",{children:["Any dispute relating to the interpretation or execution of these terms shall be subject to the exclusive jurisdiction of the courts where ",l," is registered."]})]})]})})]})})]})},O1=()=>e.jsx(nj,{children:e.jsx(oj,{children:e.jsx(cj,{children:e.jsx(dj,{children:e.jsx(mj,{children:e.jsx(U1,{})})})})})}),U1=()=>e.jsx(HS,{children:e.jsxs(yS,{children:[e.jsx(tt,{path:"/login",element:e.jsx(bj,{})}),e.jsx(tt,{path:"/signup",element:e.jsx(jj,{})}),e.jsx(tt,{path:"/forgot-password",element:e.jsx(Tj,{})}),e.jsx(tt,{path:"/reset-password",element:e.jsx(wj,{})}),e.jsx(tt,{path:"/terms",element:e.jsx(L1,{})}),e.jsxs(tt,{element:e.jsx(vj,{}),children:[e.jsxs(tt,{element:e.jsx(Xs,{permission:Ce.DASHBOARD_VIEW}),children:[e.jsx(tt,{path:"/",element:e.jsx(tl,{to:"/dashboard",replace:!0})}),e.jsx(tt,{path:"/dashboard",element:e.jsx(kj,{})})]}),e.jsx(tt,{element:e.jsx(Xs,{}),children:e.jsx(tt,{path:"/profile",element:e.jsx(P1,{})})}),e.jsxs(tt,{element:e.jsx(Xs,{permission:Ce.SETTINGS_VIEW}),children:[e.jsx(tt,{path:"/settings",element:e.jsx(tl,{to:"/settings/general"})}),e.jsx(tt,{path:"/settings/general",element:e.jsx(Rj,{})}),e.jsx(tt,{path:"/settings/users",element:e.jsx(M1,{})}),e.jsx(tt,{path:"/settings/roles",element:e.jsx(c1,{})}),e.jsx(tt,{path:"/settings/incident-types",element:e.jsx(Uk,{})}),e.jsx(tt,{path:"/settings/incident-severities",element:e.jsx(Bk,{})})]}),e.jsxs(tt,{element:e.jsx(Xs,{permission:Ce.OPERATIONS_VIEW}),children:[e.jsx(tt,{path:"/sites",element:e.jsx(Oj,{})}),e.jsx(tt,{path:"/sites/:siteId/cultivation",element:e.jsx(h1,{})}),e.jsx(tt,{path:"/seaweed-types",element:e.jsx(Kj,{})}),e.jsx(tt,{path:"/seaweed-types/:typeId/cultivation",element:e.jsx(g1,{})}),e.jsx(tt,{path:"/modules",element:e.jsx(Yj,{})}),e.jsx(tt,{path:"/operations/cutting",element:e.jsx(_k,{})}),e.jsx(tt,{path:"/operations/map",element:e.jsx(l1,{})}),e.jsx(tt,{path:"/operations/calendar",element:e.jsx(N1,{})}),e.jsx(tt,{path:"/cultivation",element:e.jsx(VD,{})}),e.jsx(tt,{path:"/harvesting",element:e.jsx(KD,{})}),e.jsx(tt,{path:"/drying",element:e.jsx($D,{})}),e.jsx(tt,{path:"/bagging",element:e.jsx(YD,{})})]}),e.jsxs(tt,{element:e.jsx(Xs,{permission:Ce.INVENTORY_VIEW}),children:[e.jsx(tt,{path:"/inventory/on-site-storage",element:e.jsx(nk,{})}),e.jsx(tt,{path:"/inventory/farmer-deliveries",element:e.jsx(Ik,{})}),e.jsx(tt,{path:"/inventory/site-transfers",element:e.jsx(Pk,{})}),e.jsx(tt,{path:"/inventory/pressed-warehouse",element:e.jsx(xk,{})}),e.jsx(tt,{path:"/exports",element:e.jsx(jk,{})})]}),e.jsxs(tt,{element:e.jsx(Xs,{permission:Ce.STAKEHOLDERS_VIEW}),children:[e.jsx(tt,{path:"/farmers",element:e.jsx(ik,{})}),e.jsx(tt,{path:"/employees",element:e.jsx(uk,{})}),e.jsx(tt,{path:"/providers",element:e.jsx(Tk,{})}),e.jsx(tt,{path:"/farmer-credits",element:e.jsx(Bj,{})}),e.jsx(tt,{path:"/document-payments",element:e.jsx(s1,{})}),e.jsx(tt,{path:"/payroll-calculator",element:e.jsx(p1,{})})]}),e.jsxs(tt,{element:e.jsx(Xs,{permission:Ce.MONITORING_VIEW}),children:[e.jsx(tt,{path:"/monitoring/incidents",element:e.jsx(Lk,{})}),e.jsx(tt,{path:"/monitoring/tests",element:e.jsx(r1,{})})]}),e.jsx(tt,{element:e.jsx(Xs,{permission:Ce.REPORTS_VIEW}),children:e.jsx(tt,{path:"/reports",element:e.jsx(k1,{})})}),e.jsx(tt,{element:e.jsx(Xs,{}),children:e.jsx(tt,{path:"/manual",element:e.jsx(y1,{})})})]}),e.jsx(tt,{path:"*",element:e.jsx(tl,{to:"/login",replace:!0})})]})}),lv=document.getElementById("root");if(!lv)throw new Error("Could not find root element to mount to");const F1=vN.createRoot(lv);F1.render(e.jsx(ft.StrictMode,{children:e.jsx(O1,{})}));
